var app=function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){var e=t.default;if("function"==typeof e){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}var n={exports:{}};!function(t){const e=Symbol.for("piconeuro:Error");t.exports={ERROR:e,get:function(t){let e=null;return t((t=>{e=t}))(),e},next:async function(t,e=1,n=!1){let o=null;n&&(t=r(t,n));for await(const n of c(t,e+1))o=n;return o},until:async function(t,e,n=-1){let r,o;const i=new Promise(((t,e)=>{r=t,o=e}));let s=null;n>0&&(s=setTimeout((()=>{o(new Error("until($n) timed out"))}),n));const a=t((t=>{e(t)&&(s&&clearTimeout(s),r(t))}));return i.finally(a),i},write:a,writable:a,notEqual:i,notEqualDeep:s,memo:function(t){let e;const n=new Set;let r=null;return function(i){return n.add(i),r?i(e):r=t(o),()=>{n.delete(i),n.length||(r&&r(),r=null)}};function o(t){e=t;for(const e of n)e(t)}},mute:function(t,n){if("function"!=typeof n)throw new Error("expected a mutation function");return function(r){let o=Promise.resolve(0);return t((t=>{const i=n(t);i&&"function"==typeof i.then&&"function"==typeof i.catch?o=o.then((()=>i.then(r).catch((t=>{console.error("n:mute() failed: ",t),r(e,t)})))):r(i)}))}},init:function(t,e){return function(n){let r=!1,i=function(){},s=!1;return"function"==typeof e&&(i=e((t=>{s=!0,r||n(t)}))),s||n(o(t)),()=>{r=!0,i()}}},when:function(t){if(!t||"function"!=typeof t.then)throw new Error("Expected a Promise");return function(n){return t.then(n).catch((t=>{console.error("n:when() failed: ",t),n(e,t)})),function(){}}},combine:function(...t){if(!Array.isArray(t)||!t.length)throw new Error("A list of neurons is required");const e=[];if(1===t.length&&"function"!=typeof t[0]){const n=t[0];t=[];for(const r in n)t.push(n[r]),e.push(r)}return function(n){if("function"!=typeof n)throw new Error("Derivation function required");const r=[],o=[];let i=t.length;const s=[];for(let e=0;e<t.length;e++)s.push(t[e](a.bind(null,e)));return()=>{for(const t of s)t()};function a(t,s){r[t]||(r[t]=!0,i--),o[t]=s,i||(e.length?n(o.reduce(((t,n,r)=>(t[e[r]]=n,t)),{})):n(o))}}},isSync:async function(t,e=100){let n=!1,r=!1,o=()=>{n=!0};t((()=>o()))();let i=null;const s=new Promise((t=>{i=t}));o=()=>{r=!0,i()};let a=setTimeout((()=>{a=null,i()}),e);if(await s,a)clearTimeout(a);else if(!n&&!r)throw new Error("Neuron did not fire during grace period");return n&&!r},_isSync:function(t){let e=!1,n=()=>{e=!0};return t((()=>n()))(),n=()=>{throw new Error("NeuronNotSync, subscription invoked after unsubscribe()")},e},gate:function(t,e=!1){const n="function"==typeof e?e:e?i:s;return function(e){let r,i=!0;return t((t=>{const s=n(t,r);(i||s)&&(i=!1,r=o(t),e(t))}))}},settle:function(t,e=10,n=!1){return function(r){let o,i,s=!0;const a=t((t=>{o=t,n&&s&&(s=!1,r(o)),i&&clearTimeout(i),i=setTimeout((()=>{i=null,r(o)}),e)}));return()=>{a&&a(),i&&clearTimeout(i)}}},iter:c,nfo:r};let n=0;function r(e,r){if(!t.exports.V)return e;const o=n++;r||(r=`NFO${a(o)}`);const i=console.info.bind(null,r);let s=0;return t=>{let n=0;const r=i.bind(null,`SYN${a(s++)}`);r(`>>${a(n)}>> connected`);const o=e((e=>{r(`!!${a(n++)}!! `,e),t(e)}));return()=>{o(),r(`<<${a(n)}<< disconnected`)}};function a(t,e=2){return(t+"").padStart(e,"0")}}function o(t){return Array.isArray(t)?[...t]:"object"==typeof t&&null!==t?{...t}:t}function i(t,e){return Array.isArray(t)&&Array.isArray(e)?e.length!==t.length||!!t.find(((t,n)=>e[n]!==t)):"object"==typeof t&&"object"==typeof e&&null!==t&&null!==e?(n=Object.keys(t),r=Object.keys(e).length,!(n.length===r&&!n.find((n=>t[n]!==e[n])))):t!==e;var n,r}function s(t,e){return Array.isArray(t)&&Array.isArray(e)?e.length!==t.length||!!t.find(((t,n)=>s(e[n],t))):"object"==typeof t&&"object"==typeof e&&null!==t&&null!==e?(n=Object.keys(t),r=Object.keys(e).length,!(n.length===r&&!n.find((n=>s(t[n],e[n]))))):t!==e;var n,r}function a(t){const e=new Set;return[function(n){return e.add(n),n(t),()=>{e.delete(n)}},function(n){if(i(t,n)){t=n;for(const t of e)t(n)}return n}]}async function*c(t,e=5){const n=[],r=[];s();let o=0;const i=t((t=>{(-1===e||++o<e)&&s();const r=n.shift();r&&r(t)}));for(;r.length;){const t=r.shift(),e=await t;yield e}function s(){let t=null;const e=new Promise((e=>{t=e}));n.push(t),r.push(e)}i()}t.exports.V=1}(n);for(var r={},o={byteLength:function(t){var e=h(t),n=e[0],r=e[1];return 3*(n+r)/4-r},toByteArray:function(t){var e,n,r=h(t),o=r[0],i=r[1],c=new a(function(t,e,n){return 3*(e+n)/4-n}(0,o,i)),u=0,l=i>0?o-4:o;for(n=0;n<l;n+=4)e=s[t.charCodeAt(n)]<<18|s[t.charCodeAt(n+1)]<<12|s[t.charCodeAt(n+2)]<<6|s[t.charCodeAt(n+3)],c[u++]=e>>16&255,c[u++]=e>>8&255,c[u++]=255&e;2===i&&(e=s[t.charCodeAt(n)]<<2|s[t.charCodeAt(n+1)]>>4,c[u++]=255&e);1===i&&(e=s[t.charCodeAt(n)]<<10|s[t.charCodeAt(n+1)]<<4|s[t.charCodeAt(n+2)]>>2,c[u++]=e>>8&255,c[u++]=255&e);return c},fromByteArray:function(t){for(var e,n=t.length,r=n%3,o=[],s=16383,a=0,c=n-r;a<c;a+=s)o.push(f(t,a,a+s>c?c:a+s));1===r?(e=t[n-1],o.push(i[e>>2]+i[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(i[e>>10]+i[e>>4&63]+i[e<<2&63]+"="));return o.join("")}},i=[],s=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u=0,l=c.length;u<l;++u)i[u]=c[u],s[c.charCodeAt(u)]=u;function h(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function f(t,e,n){for(var r,o,s=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(i[(o=r)>>18&63]+i[o>>12&63]+i[o>>6&63]+i[63&o]);return s.join("")}s["-".charCodeAt(0)]=62,s["_".charCodeAt(0)]=63;var d={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?o-1:0,f=n?-1:1,d=t[e+h];for(h+=f,i=d&(1<<-l)-1,d>>=-l,l+=a;l>0;i=256*i+t[e+h],h+=f,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),i-=u}return(d?-1:1)*s*Math.pow(2,i-r)},write:function(t,e,n,r,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,h=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:i-1,g=r?1:-1,A=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*c-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[n+d]=255&a,d+=g,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[n+d]=255&s,d+=g,s/=256,u-=8);t[n+d-g]|=128*A}};
/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <https://feross.org>
	 * @license  MIT
	 */
!function(t){const e=o,n=d,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},t.INSPECT_MAX_BYTES=50;const i=2147483647;function s(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,a.prototype),e}function a(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return l(t)}return c(t,e,n)}function c(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|A(t,e);let r=s(n);const o=r.write(t,e);o!==n&&(r=r.slice(0,o));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(z(t,Uint8Array)){const e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return h(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(z(t,ArrayBuffer)||t&&z(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(z(t,SharedArrayBuffer)||t&&z(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return a.from(r,e,n);const o=function(t){if(a.isBuffer(t)){const e=0|g(t.length),n=s(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||J(t.length)?s(0):h(t);if("Buffer"===t.type&&Array.isArray(t.data))return h(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return a.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function l(t){return u(t),s(t<0?0:0|g(t))}function h(t){const e=t.length<0?0:0|g(t.length),n=s(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,a.prototype),r}function g(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function A(t,e){if(a.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||z(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(o)return r?-1:V(t).length;e=(""+e).toLowerCase(),o=!0}}function p(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Q(this,e,n);case"utf8":case"utf-8":return _(this,e,n);case"ascii":return S(this,e,n);case"latin1":case"binary":return x(this,e,n);case"base64":return B(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),J(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=a.from(e,r)),a.isBuffer(e))return 0===e.length?-1:I(t,e,n,r,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):I(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function I(t,e,n,r,o){let i,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let r=-1;for(i=n;i<a;i++)if(u(t,i)===u(e,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===c)return r*s}else-1!==r&&(i-=i-r),r=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){let n=!0;for(let r=0;r<c;r++)if(u(t,i+r)!==u(e,r)){n=!1;break}if(n)return i}return-1}function b(t,e,n,r){n=Number(n)||0;const o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=e.length;let s;for(r>i/2&&(r=i/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(J(r))return s;t[n+s]=r}return s}function E(t,e,n,r){return q(V(e,t.length-n),t,n,r)}function w(t,e,n,r){return q(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function C(t,e,n,r){return q(G(e),t,n,r)}function v(t,e,n,r){return q(function(t,e){let n,r,o;const i=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function B(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function _(t,e,n){n=Math.min(t.length,n);const r=[];let o=e;for(;o<n;){const e=t[o];let i=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=n){let n,r,a,c;switch(s){case 1:e<128&&(i=e);break;case 2:n=t[o+1],128==(192&n)&&(c=(31&e)<<6|63&n,c>127&&(i=c));break;case 3:n=t[o+1],r=t[o+2],128==(192&n)&&128==(192&r)&&(c=(15&e)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=t[o+1],r=t[o+2],a=t[o+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=s}return function(t){const e=t.length;if(e<=k)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=k));return n}(r)}t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(t,e,n){return c(t,e,n)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?s(t):void 0!==e?"string"==typeof n?s(t).fill(e,n):s(t).fill(e):s(t)}(t,e,n)},a.allocUnsafe=function(t){return l(t)},a.allocUnsafeSlow=function(t){return l(t)},a.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==a.prototype},a.compare=function(t,e){if(z(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),z(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=a.allocUnsafe(e);let o=0;for(n=0;n<t.length;++n){let e=t[n];if(z(e,Uint8Array))o+e.length>r.length?(a.isBuffer(e)||(e=a.from(e)),e.copy(r,o)):Uint8Array.prototype.set.call(r,e,o);else{if(!a.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,o)}o+=e.length}return r},a.byteLength=A,a.prototype._isBuffer=!0,a.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},a.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},a.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},a.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?_(this,0,t):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(t,e,n,r,o){if(z(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;let i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0);const c=Math.min(i,s),u=this.slice(r,o),l=t.slice(e,n);for(let t=0;t<c;++t)if(u[t]!==l[t]){i=u[t],s=l[t];break}return i<s?-1:s<i?1:0},a.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},a.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},a.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},a.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return b(this,t,e,n);case"utf8":case"utf-8":return E(this,t,e,n);case"ascii":case"latin1":case"binary":return w(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return v(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function S(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function x(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function Q(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=e;r<n;++r)o+=W[t[r]];return o}function M(t,e,n){const r=t.slice(e,n);let o="";for(let t=0;t<r.length-1;t+=2)o+=String.fromCharCode(r[t]+256*r[t+1]);return o}function T(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function D(t,e,n,r,o,i){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function $(t,e,n,r,o){K(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function L(t,e,n,r,o){K(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n+7]=i,i>>=8,t[n+6]=i,i>>=8,t[n+5]=i,i>>=8,t[n+4]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function U(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(t,e,r,o,i){return e=+e,r>>>=0,i||U(t,0,r,4),n.write(t,e,r,o,23,4),r+4}function F(t,e,r,o,i){return e=+e,r>>>=0,i||U(t,0,r,8),n.write(t,e,r,o,52,8),r+8}a.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUintLE=a.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return r},a.prototype.readUintBE=a.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);let r=this[t+--e],o=1;for(;e>0&&(o*=256);)r+=this[t+--e]*o;return r},a.prototype.readUint8=a.prototype.readUInt8=function(t,e){return t>>>=0,e||T(t,1,this.length),this[t]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(t,e){return t>>>=0,e||T(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(t,e){return t>>>=0,e||T(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(t,e){return t>>>=0,e||T(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(t,e){return t>>>=0,e||T(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readBigUInt64LE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(o)<<BigInt(32))})),a.prototype.readBigUInt64BE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(o)})),a.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},a.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||T(t,e,this.length);let r=e,o=1,i=this[t+--r];for(;r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},a.prototype.readInt8=function(t,e){return t>>>=0,e||T(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){t>>>=0,e||T(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(t,e){t>>>=0,e||T(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(t,e){return t>>>=0,e||T(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return t>>>=0,e||T(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readBigInt64LE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),a.prototype.readBigInt64BE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),a.prototype.readFloatLE=function(t,e){return t>>>=0,e||T(t,4,this.length),n.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return t>>>=0,e||T(t,4,this.length),n.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return t>>>=0,e||T(t,8,this.length),n.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return t>>>=0,e||T(t,8,this.length),n.read(this,t,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){D(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){D(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},a.prototype.writeUint8=a.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,1,255,0),this[e]=255&t,e+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeBigUInt64LE=X((function(t,e=0){return $(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeBigUInt64BE=X((function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}let o=0,i=1,s=0;for(this[e]=255&t;++o<n&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},a.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);D(this,t,e,n,r-1,-r)}let o=n-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},a.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},a.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||D(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeBigInt64LE=X((function(t,e=0){return $(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeBigInt64BE=X((function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeFloatLE=function(t,e,n){return O(this,t,e,!0,n)},a.prototype.writeFloatBE=function(t,e,n){return O(this,t,e,!1,n)},a.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},a.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},a.prototype.copy=function(t,e,n,r){if(!a.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const o=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),o},a.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{const i=a.isBuffer(t)?t:a.from(t,r),s=i.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=i[o%s]}return this};const N={};function P(t,e,n){N[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function Y(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function K(t,e,n,r,o,i){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let o;throw o=i>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new N.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,n){R(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||j(e,t.length-(n+1))}(r,o,i)}function R(t,e){if("number"!=typeof t)throw new N.ERR_INVALID_ARG_TYPE(e,"number",t)}function j(t,e,n){if(Math.floor(t)!==t)throw R(t,n),new N.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new N.ERR_BUFFER_OUT_OF_BOUNDS;throw new N.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}P("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),P("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),P("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=Y(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=Y(o)),o+="n"),r+=` It must be ${e}. Received ${o}`,r}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function V(t,e){let n;e=e||1/0;const r=t.length;let o=null;const i=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function G(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,r){let o;for(o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function z(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function J(t){return t!=t}const W=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)e[r+o]=t[n]+t[o]}return e}();function X(t){return"undefined"==typeof BigInt?Z:t}function Z(){throw new Error("BigInt not supported")}}(r);var g={},A={},p={supports:function(...t){const e=t.reduce(((t,e)=>Object.assign(t,e)),{});return Object.assign(e,{snapshots:e.snapshots||!1,permanence:e.permanence||!1,seek:e.seek||!1,clear:e.clear||!1,getMany:e.getMany||!1,keyIterator:e.keyIterator||!1,valueIterator:e.valueIterator||!1,iteratorNextv:e.iteratorNextv||!1,iteratorAll:e.iteratorAll||!1,status:e.status||!1,createIfMissing:e.createIfMissing||!1,errorIfExists:e.errorIfExists||!1,deferredOpen:e.deferredOpen||!1,promises:e.promises||!1,streams:e.streams||!1,encodings:Object.assign({},e.encodings),events:Object.assign({},e.events),additionalMethods:Object.assign({},e.additionalMethods)})}},y={},m=class extends Error{constructor(t,e){super(t||""),"object"==typeof e&&null!==e&&(e.code&&(this.code=String(e.code)),e.expected&&(this.expected=!0),e.transient&&(this.transient=!0),e.cause&&(this.cause=e.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},I={};let b=null;var E=function(){return null===b&&(b={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),b},w={},C={};const v=m,B=new Set(["buffer","view","utf8"]);C.Encoding=class{constructor(t){if(this.encode=t.encode||this.encode,this.decode=t.decode||this.decode,this.name=t.name||this.name,this.format=t.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!B.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");t.createViewTranscoder&&(this.createViewTranscoder=t.createViewTranscoder),t.createBufferTranscoder&&(this.createBufferTranscoder=t.createBufferTranscoder),t.createUTF8Transcoder&&(this.createUTF8Transcoder=t.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new v(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new v(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new v(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};const{Buffer:_}=r||{},{Encoding:k}=C,S=E;class x extends k{constructor(t){super({...t,format:"buffer"})}createViewTranscoder(){return new Q({encode:this.encode,decode:t=>this.decode(_.from(t.buffer,t.byteOffset,t.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class Q extends k{constructor(t){super({...t,format:"view"})}createBufferTranscoder(){return new x({encode:t=>{const e=this.encode(t);return _.from(e.buffer,e.byteOffset,e.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}w.BufferFormat=x,w.ViewFormat=Q,w.UTF8Format=class extends k{constructor(t){super({...t,format:"utf8"})}createBufferTranscoder(){return new x({encode:t=>_.from(this.encode(t),"utf8"),decode:t=>this.decode(t.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:t,textDecoder:e}=S();return new Q({encode:e=>t.encode(this.encode(e)),decode:t=>this.decode(e.decode(t)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};const{Buffer:M}=r||{Buffer:{isBuffer:()=>!1}},{textEncoder:T,textDecoder:D}=E(),{BufferFormat:$,ViewFormat:L,UTF8Format:U}=w,O=t=>t;I.utf8=new U({encode:function(t){return M.isBuffer(t)?t.toString("utf8"):ArrayBuffer.isView(t)?D.decode(t):String(t)},decode:O,name:"utf8",createViewTranscoder(){return new L({encode:function(t){return ArrayBuffer.isView(t)?t:T.encode(t)},decode:function(t){return D.decode(t)},name:`${this.name}+view`})},createBufferTranscoder(){return new $({encode:function(t){return M.isBuffer(t)?t:ArrayBuffer.isView(t)?M.from(t.buffer,t.byteOffset,t.byteLength):M.from(String(t),"utf8")},decode:function(t){return t.toString("utf8")},name:`${this.name}+buffer`})}}),I.json=new U({encode:JSON.stringify,decode:JSON.parse,name:"json"}),I.buffer=new $({encode:function(t){return M.isBuffer(t)?t:ArrayBuffer.isView(t)?M.from(t.buffer,t.byteOffset,t.byteLength):M.from(String(t),"utf8")},decode:O,name:"buffer",createViewTranscoder(){return new L({encode:function(t){return ArrayBuffer.isView(t)?t:M.from(String(t),"utf8")},decode:function(t){return M.from(t.buffer,t.byteOffset,t.byteLength)},name:`${this.name}+view`})}}),I.view=new L({encode:function(t){return ArrayBuffer.isView(t)?t:T.encode(t)},decode:O,name:"view",createBufferTranscoder(){return new $({encode:function(t){return M.isBuffer(t)?t:ArrayBuffer.isView(t)?M.from(t.buffer,t.byteOffset,t.byteLength):M.from(String(t),"utf8")},decode:O,name:`${this.name}+buffer`})}}),I.hex=new $({encode:function(t){return M.isBuffer(t)?t:M.from(String(t),"hex")},decode:function(t){return t.toString("hex")},name:"hex"}),I.base64=new $({encode:function(t){return M.isBuffer(t)?t:M.from(String(t),"base64")},decode:function(t){return t.toString("base64")},name:"base64"});const F=m,N=I,{Encoding:P}=C,{BufferFormat:Y,ViewFormat:K,UTF8Format:R}=w,j=Symbol("formats"),H=Symbol("encodings"),V=new Set(["buffer","view","utf8"]);y.Transcoder=class{constructor(t){if(!Array.isArray(t))throw new TypeError("The first argument 'formats' must be an array");if(!t.every((t=>V.has(t))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[H]=new Map,this[j]=new Set(t);for(const t in N)try{this.encoding(t)}catch(t){if("LEVEL_ENCODING_NOT_SUPPORTED"!==t.code)throw t}}encodings(){return Array.from(new Set(this[H].values()))}encoding(t){let e=this[H].get(t);if(void 0===e){if("string"==typeof t&&""!==t){if(e=q[t],!e)throw new F(`Encoding '${t}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof t||null===t)throw new TypeError("First argument 'encoding' must be a string or object");e=function(t){if(t instanceof P)return t;const e="type"in t&&"string"==typeof t.type?t.type:void 0,n=t.name||e||"anonymous-"+z++;switch(function(t){return"format"in t&&void 0!==t.format?t.format:"buffer"in t&&"boolean"==typeof t.buffer?t.buffer?"buffer":"utf8":"code"in t&&Number.isInteger(t.code)?"view":"buffer"}(t)){case"view":return new K({...t,name:n});case"utf8":return new R({...t,name:n});case"buffer":return new Y({...t,name:n});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(t)}const{name:n,format:r}=e;if(!this[j].has(r))if(this[j].has("view"))e=e.createViewTranscoder();else if(this[j].has("buffer"))e=e.createBufferTranscoder();else{if(!this[j].has("utf8"))throw new F(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});e=e.createUTF8Transcoder()}for(const r of[t,n,e.name,e.commonName])this[H].set(r,e)}return e}};const G={binary:N.buffer,"utf-8":N.utf8},q={...N,...G};let z=0;var J,W={exports:{}},X="object"==typeof Reflect?Reflect:null,Z=X&&"function"==typeof X.apply?X.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};J=X&&"function"==typeof X.ownKeys?X.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var tt=Number.isNaN||function(t){return t!=t};function et(){et.init.call(this)}W.exports=et,W.exports.once=function(t,e){return new Promise((function(n,r){function o(n){t.removeListener(e,i),r(n)}function i(){"function"==typeof t.removeListener&&t.removeListener("error",o),n([].slice.call(arguments))}ht(t,e,i,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&ht(t,"error",e,n)}(t,o,{once:!0})}))},et.EventEmitter=et,et.prototype._events=void 0,et.prototype._eventsCount=0,et.prototype._maxListeners=void 0;var nt=10;function rt(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function ot(t){return void 0===t._maxListeners?et.defaultMaxListeners:t._maxListeners}function it(t,e,n,r){var o,i,s,a;if(rt(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"==typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=ot(t))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return t}function st(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function at(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=st.bind(r);return o.listener=n,r.wrapFn=o,o}function ct(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):lt(o,o.length)}function ut(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function lt(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function ht(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function o(i){r.once&&t.removeEventListener(e,o),n(i)}))}}Object.defineProperty(et,"defaultMaxListeners",{enumerable:!0,get:function(){return nt},set:function(t){if("number"!=typeof t||t<0||tt(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");nt=t}}),et.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},et.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||tt(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},et.prototype.getMaxListeners=function(){return ot(this)},et.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(e.length>0&&(i=e[0]),i instanceof Error)throw i;var s=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw s.context=i,s}var a=o[t];if(void 0===a)return!1;if("function"==typeof a)Z(a,this,e);else{var c=a.length,u=lt(a,c);for(n=0;n<c;++n)Z(u[n],this,e)}return!0},et.prototype.addListener=function(t,e){return it(this,t,e,!1)},et.prototype.on=et.prototype.addListener,et.prototype.prependListener=function(t,e){return it(this,t,e,!0)},et.prototype.once=function(t,e){return rt(e),this.on(t,at(this,t,e)),this},et.prototype.prependOnceListener=function(t,e){return rt(e),this.prependListener(t,at(this,t,e)),this},et.prototype.removeListener=function(t,e){var n,r,o,i,s;if(rt(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},et.prototype.off=et.prototype.removeListener,et.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},et.prototype.listeners=function(t){return ct(this,t,!0)},et.prototype.rawListeners=function(t){return ct(this,t,!1)},et.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):ut.call(t,e)},et.prototype.listenerCount=ut,et.prototype.eventNames=function(){return this._eventsCount>0?J(this._events):[]};var ft={},dt="function"==typeof queueMicrotask?queueMicrotask:t=>Promise.resolve().then(t);ft.fromCallback=function(t,e){if(void 0===t){var n=new Promise((function(e,n){t=function(t,r){t?n(t):e(r)}}));t[void 0!==e?e:"promise"]=n}else if("function"!=typeof t)throw new TypeError("Callback must be a function");return t},ft.fromPromise=function(t,e){if(void 0===e)return t;t.then((function(t){dt((()=>e(null,t)))})).catch((function(t){dt((()=>e(t)))}))};var gt={},At={getCallback:function(t,e){return"function"==typeof t?t:e},getOptions:function(t,e){return"object"==typeof t&&null!==t?t:void 0!==e?e:{}}};const{fromCallback:pt}=ft,yt=m,{getOptions:mt,getCallback:It}=At,bt=Symbol("promise"),Et=Symbol("callback"),wt=Symbol("working"),Ct=Symbol("handleOne"),vt=Symbol("handleMany"),Bt=Symbol("autoClose"),_t=Symbol("finishWork"),kt=Symbol("returnMany"),St=Symbol("closing"),xt=Symbol("handleClose"),Qt=Symbol("closed"),Mt=Symbol("closeCallbacks"),Tt=Symbol("keyEncoding"),Dt=Symbol("valueEncoding"),$t=Symbol("abortOnClose"),Lt=Symbol("legacy"),Ut=Symbol("keys"),Ot=Symbol("values"),Ft=Symbol("limit"),Nt=Symbol("count"),Pt=Object.freeze({}),Yt=()=>{};let Kt=!1;class Rt{constructor(t,e,n){if("object"!=typeof t||null===t){throw new TypeError(`The first argument must be an abstract-level database, received ${null===t?"null":typeof t}`)}if("object"!=typeof e||null===e)throw new TypeError("The second argument must be an options object");this[Qt]=!1,this[Mt]=[],this[wt]=!1,this[St]=!1,this[Bt]=!1,this[Et]=null,this[Ct]=this[Ct].bind(this),this[vt]=this[vt].bind(this),this[xt]=this[xt].bind(this),this[Tt]=e[Tt],this[Dt]=e[Dt],this[Lt]=n,this[Ft]=Number.isInteger(e.limit)&&e.limit>=0?e.limit:1/0,this[Nt]=0,this[$t]=!!e.abortOnClose,this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get count(){return this[Nt]}get limit(){return this[Ft]}next(t){let e;if(void 0===t)e=new Promise(((e,n)=>{t=(t,r,o)=>{t?n(t):this[Lt]?void 0===r&&void 0===o?e():e([r,o]):e(r)}}));else if("function"!=typeof t)throw new TypeError("Callback must be a function");return this[St]?this.nextTick(t,new yt("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[wt]?this.nextTick(t,new yt("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[wt]=!0,this[Et]=t,this[Nt]>=this[Ft]?this.nextTick(this[Ct],null):this._next(this[Ct])),e}_next(t){this.nextTick(t)}nextv(t,e,n){return n=It(e,n),n=pt(n,bt),e=mt(e,Pt),Number.isInteger(t)?(this[St]?this.nextTick(n,new yt("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[wt]?this.nextTick(n,new yt("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(t<1&&(t=1),this[Ft]<1/0&&(t=Math.min(t,this[Ft]-this[Nt])),this[wt]=!0,this[Et]=n,t<=0?this.nextTick(this[vt],null,[]):this._nextv(t,e,this[vt])),n[bt]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[bt])}_nextv(t,e,n){const r=[],o=(e,i,s)=>e?n(e):(this[Lt]?void 0===i&&void 0===s:void 0===i)?n(null,r):(r.push(this[Lt]?[i,s]:i),void(r.length===t?n(null,r):this._next(o)));this._next(o)}all(t,e){return e=It(t,e),e=pt(e,bt),t=mt(t,Pt),this[St]?this.nextTick(e,new yt("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[wt]?this.nextTick(e,new yt("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[wt]=!0,this[Et]=e,this[Bt]=!0,this[Nt]>=this[Ft]?this.nextTick(this[vt],null,[]):this._all(t,this[vt])),e[bt]}_all(t,e){let n=this[Nt];const r=[],o=()=>{const t=this[Ft]<1/0?Math.min(1e3,this[Ft]-n):1e3;t<=0?this.nextTick(e,null,r):this._nextv(t,Pt,i)},i=(t,i)=>{t?e(t):0===i.length?e(null,r):(r.push.apply(r,i),n+=i.length,o())};o()}[_t](){const t=this[Et];return this[$t]&&null===t?Yt:(this[wt]=!1,this[Et]=null,this[St]&&this._close(this[xt]),t)}[kt](t,e,n){this[Bt]?this.close(t.bind(null,e,n)):t(e,n)}seek(t,e){if(e=mt(e,Pt),this[St]);else{if(this[wt])throw new yt("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const n=this.db.keyEncoding(e.keyEncoding||this[Tt]),r=n.format;e.keyEncoding!==r&&(e={...e,keyEncoding:r});const o=this.db.prefixKey(n.encode(t),r);this._seek(o,e)}}}_seek(t,e){throw new yt("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(t){if(t=pt(t,bt),this[Qt])this.nextTick(t);else if(this[St])this[Mt].push(t);else if(this[St]=!0,this[Mt].push(t),this[wt]){if(this[$t]){this[_t]()(new yt("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))}}else this._close(this[xt]);return t[bt]}_close(t){this.nextTick(t)}[xt](){this[Qt]=!0,this.db.detachResource(this);const t=this[Mt];this[Mt]=[];for(const e of t)e()}async*[Symbol.asyncIterator](){try{let t;for(;void 0!==(t=await this.next());)yield t}finally{this[Qt]||await this.close()}}}class jt extends Rt{constructor(t,e){super(t,e,!0),this[Ut]=!1!==e.keys,this[Ot]=!1!==e.values}[Ct](t,e,n){const r=this[_t]();if(t)return r(t);try{e=this[Ut]&&void 0!==e?this[Tt].decode(e):void 0,n=this[Ot]&&void 0!==n?this[Dt].decode(n):void 0}catch(t){return r(new Ht("entry",t))}void 0===e&&void 0===n||this[Nt]++,r(null,e,n)}[vt](t,e){const n=this[_t]();if(t)return this[kt](n,t);try{for(const t of e){const e=t[0],n=t[1];t[0]=this[Ut]&&void 0!==e?this[Tt].decode(e):void 0,t[1]=this[Ot]&&void 0!==n?this[Dt].decode(n):void 0}}catch(t){return this[kt](n,new Ht("entries",t))}this[Nt]+=e.length,this[kt](n,null,e)}end(t){return Kt||"undefined"==typeof console||(Kt=!0,console.warn(new yt("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(t)}}class Ht extends yt{constructor(t,e){super(`Iterator could not decode ${t}`,{code:"LEVEL_DECODE_ERROR",cause:e})}}for(const t of["_ended property","_nexting property","_end method"])Object.defineProperty(jt.prototype,t.split(" ")[0],{get(){throw new yt(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new yt(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})}});jt.keyEncoding=Tt,jt.valueEncoding=Dt,gt.AbstractIterator=jt,gt.AbstractKeyIterator=class extends Rt{constructor(t,e){super(t,e,!1)}[Ct](t,e){const n=this[_t]();if(t)return n(t);try{e=void 0!==e?this[Tt].decode(e):void 0}catch(t){return n(new Ht("key",t))}void 0!==e&&this[Nt]++,n(null,e)}[vt](t,e){const n=this[_t]();if(t)return this[kt](n,t);try{for(let t=0;t<e.length;t++){const n=e[t];e[t]=void 0!==n?this[Tt].decode(n):void 0}}catch(t){return this[kt](n,new Ht("keys",t))}this[Nt]+=e.length,this[kt](n,null,e)}},gt.AbstractValueIterator=class extends Rt{constructor(t,e){super(t,e,!1)}[Ct](t,e){const n=this[_t]();if(t)return n(t);try{e=void 0!==e?this[Dt].decode(e):void 0}catch(t){return n(new Ht("value",t))}void 0!==e&&this[Nt]++,n(null,e)}[vt](t,e){const n=this[_t]();if(t)return this[kt](n,t);try{for(let t=0;t<e.length;t++){const n=e[t];e[t]=void 0!==n?this[Dt].decode(n):void 0}}catch(t){return this[kt](n,new Ht("values",t))}this[Nt]+=e.length,this[kt](n,null,e)}};var Vt={};const{AbstractKeyIterator:Gt,AbstractValueIterator:qt}=gt,zt=Symbol("iterator"),Jt=Symbol("callback"),Wt=Symbol("handleOne"),Xt=Symbol("handleMany");class Zt extends Gt{constructor(t,e){super(t,e),this[zt]=t.iterator({...e,keys:!0,values:!1}),this[Wt]=this[Wt].bind(this),this[Xt]=this[Xt].bind(this)}}class te extends qt{constructor(t,e){super(t,e),this[zt]=t.iterator({...e,keys:!1,values:!0}),this[Wt]=this[Wt].bind(this),this[Xt]=this[Xt].bind(this)}}for(const t of[Zt,te]){const e=t===Zt,n=e?t=>t[0]:t=>t[1];t.prototype._next=function(t){this[Jt]=t,this[zt].next(this[Wt])},t.prototype[Wt]=function(t,n,r){const o=this[Jt];t?o(t):o(null,e?n:r)},t.prototype._nextv=function(t,e,n){this[Jt]=n,this[zt].nextv(t,e,this[Xt])},t.prototype._all=function(t,e){this[Jt]=e,this[zt].all(t,this[Xt])},t.prototype[Xt]=function(t,e){const r=this[Jt];t?r(t):r(null,e.map(n))},t.prototype._seek=function(t,e){this[zt].seek(t,e)},t.prototype._close=function(t){this[zt].close(t)}}Vt.DefaultKeyIterator=Zt,Vt.DefaultValueIterator=te;var ee={};const{AbstractIterator:ne,AbstractKeyIterator:re,AbstractValueIterator:oe}=gt,ie=m,se=Symbol("nut"),ae=Symbol("undefer"),ce=Symbol("factory");class ue extends ne{constructor(t,e){super(t,e),this[se]=null,this[ce]=()=>t.iterator(e),this.db.defer((()=>this[ae]()))}}class le extends re{constructor(t,e){super(t,e),this[se]=null,this[ce]=()=>t.keys(e),this.db.defer((()=>this[ae]()))}}class he extends oe{constructor(t,e){super(t,e),this[se]=null,this[ce]=()=>t.values(e),this.db.defer((()=>this[ae]()))}}for(const t of[ue,le,he])t.prototype[ae]=function(){"open"===this.db.status&&(this[se]=this[ce]())},t.prototype._next=function(t){null!==this[se]?this[se].next(t):"opening"===this.db.status?this.db.defer((()=>this._next(t))):this.nextTick(t,new ie("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._nextv=function(t,e,n){null!==this[se]?this[se].nextv(t,e,n):"opening"===this.db.status?this.db.defer((()=>this._nextv(t,e,n))):this.nextTick(n,new ie("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._all=function(t,e){null!==this[se]?this[se].all(e):"opening"===this.db.status?this.db.defer((()=>this._all(t,e))):this.nextTick(e,new ie("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._seek=function(t,e){null!==this[se]?this[se]._seek(t,e):"opening"===this.db.status&&this.db.defer((()=>this._seek(t,e)))},t.prototype._close=function(t){null!==this[se]?this[se].close(t):"opening"===this.db.status?this.db.defer((()=>this._close(t))):this.nextTick(t)};ee.DeferredIterator=ue,ee.DeferredKeyIterator=le,ee.DeferredValueIterator=he;var fe={},de={};const{fromCallback:ge}=ft,Ae=m,{getCallback:pe,getOptions:ye}=At,me=Symbol("promise"),Ie=Symbol("status"),be=Symbol("operations"),Ee=Symbol("finishClose"),we=Symbol("closeCallbacks");de.AbstractChainedBatch=class{constructor(t){if("object"!=typeof t||null===t){throw new TypeError(`The first argument must be an abstract-level database, received ${null===t?"null":typeof t}`)}this[be]=[],this[we]=[],this[Ie]="open",this[Ee]=this[Ee].bind(this),this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get length(){return this[be].length}put(t,e,n){if("open"!==this[Ie])throw new Ae("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(t)||this.db._checkValue(e);if(r)throw r;const o=n&&null!=n.sublevel?n.sublevel:this.db,i=n,s=o.keyEncoding(n&&n.keyEncoding),a=o.valueEncoding(n&&n.valueEncoding),c=s.format;n={...n,keyEncoding:c,valueEncoding:a.format},o!==this.db&&(n.sublevel=null);const u=o.prefixKey(s.encode(t),c),l=a.encode(e);return this._put(u,l,n),this[be].push({...i,type:"put",key:t,value:e}),this}_put(t,e,n){}del(t,e){if("open"!==this[Ie])throw new Ae("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(t);if(n)throw n;const r=e&&null!=e.sublevel?e.sublevel:this.db,o=e,i=r.keyEncoding(e&&e.keyEncoding),s=i.format;return e={...e,keyEncoding:s},r!==this.db&&(e.sublevel=null),this._del(r.prefixKey(i.encode(t),s),e),this[be].push({...o,type:"del",key:t}),this}_del(t,e){}clear(){if("open"!==this[Ie])throw new Ae("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[be]=[],this}_clear(){}write(t,e){return e=pe(t,e),e=ge(e,me),t=ye(t),"open"!==this[Ie]?this.nextTick(e,new Ae("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(e):(this[Ie]="writing",this._write(t,(t=>{this[Ie]="closing",this[we].push((()=>e(t))),t||this.db.emit("batch",this[be]),this._close(this[Ee])}))),e[me]}_write(t,e){}close(t){return t=ge(t,me),"closing"===this[Ie]?this[we].push(t):"closed"===this[Ie]?this.nextTick(t):(this[we].push(t),"writing"!==this[Ie]&&(this[Ie]="closing",this._close(this[Ee]))),t[me]}_close(t){this.nextTick(t)}[Ee](){this[Ie]="closed",this.db.detachResource(this);const t=this[we];this[we]=[];for(const e of t)e()}};const{AbstractChainedBatch:Ce}=de,ve=m,Be=Symbol("encoded");fe.DefaultChainedBatch=class extends Ce{constructor(t){super(t),this[Be]=[]}_put(t,e,n){this[Be].push({...n,type:"put",key:t,value:e})}_del(t,e){this[Be].push({...e,type:"del",key:t})}_clear(){this[Be]=[]}_write(t,e){"opening"===this.db.status?this.db.defer((()=>this._write(t,e))):"open"===this.db.status?0===this[Be].length?this.nextTick(e):this.db._batch(this[Be],t,e):this.nextTick(e,new ve("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};const _e=m,ke=Object.prototype.hasOwnProperty,Se=new Set(["lt","lte","gt","gte"]);
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
let xe;var Qe,Me,Te="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:t):t=>(xe||(xe=Promise.resolve())).then(t).catch((t=>setTimeout((()=>{throw t}),0)));var De,$e,Le,Ue={};const{supports:Oe}=p,{Transcoder:Fe}=y,{EventEmitter:Ne}=W.exports,{fromCallback:Pe}=ft,Ye=m,{AbstractIterator:Ke}=gt,{DefaultKeyIterator:Re,DefaultValueIterator:je}=Vt,{DeferredIterator:He,DeferredKeyIterator:Ve,DeferredValueIterator:Ge}=ee,{DefaultChainedBatch:qe}=fe,{getCallback:ze,getOptions:Je}=At,We=function(t,e){const n={};for(const r in t)if(ke.call(t,r)&&"keyEncoding"!==r&&"valueEncoding"!==r){if("start"===r||"end"===r)throw new _e(`The legacy range option '${r}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===r)throw new _e("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});Se.has(r)?n[r]=e.encode(t[r]):n[r]=t[r]}return n.reverse=!!n.reverse,n.limit=Number.isInteger(n.limit)&&n.limit>=0?n.limit:-1,n},Xe=Symbol("promise"),Ze=Symbol("landed"),tn=Symbol("resources"),en=Symbol("closeResources"),nn=Symbol("operations"),rn=Symbol("undefer"),on=Symbol("deferOpen"),sn=Symbol("options"),an=Symbol("status"),cn=Symbol("defaultOptions"),un=Symbol("transcoder"),ln=Symbol("keyEncoding"),hn=Symbol("valueEncoding"),fn=()=>{};class dn extends Ne{constructor(t,e){if(super(),"object"!=typeof t||null===t)throw new TypeError("The first argument 'manifest' must be an object");e=Je(e);const{keyEncoding:n,valueEncoding:r,passive:o,...i}=e;this[tn]=new Set,this[nn]=[],this[on]=!0,this[sn]=i,this[an]="opening",this.supports=Oe(t,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==t.snapshots,permanence:!1!==t.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:t.encodings||{},events:Object.assign({},t.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[un]=new Fe(pn(this)),this[ln]=this[un].encoding(n||"utf8"),this[hn]=this[un].encoding(r||"utf8");for(const t of this[un].encodings())this.supports.encodings[t.commonName]||(this.supports.encodings[t.commonName]=!0);this[cn]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[ln].commonName,valueEncoding:this[hn].commonName}),key:Object.freeze({keyEncoding:this[ln].commonName})},this.nextTick((()=>{this[on]&&this.open({passive:!1},fn)}))}get status(){return this[an]}keyEncoding(t){return this[un].encoding(null!=t?t:this[ln])}valueEncoding(t){return this[un].encoding(null!=t?t:this[hn])}open(t,e){e=ze(t,e),e=Pe(e,Xe),(t={...this[sn],...Je(t)}).createIfMissing=!1!==t.createIfMissing,t.errorIfExists=!!t.errorIfExists;const n=t=>{"closing"===this[an]||"opening"===this[an]?this.once(Ze,t?()=>n(t):n):"open"!==this[an]?e(new Ye("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:t})):e()};return t.passive?"opening"===this[an]?this.once(Ze,n):this.nextTick(n):"closed"===this[an]||this[on]?(this[on]=!1,this[an]="opening",this.emit("opening"),this._open(t,(t=>{if(t)return this[an]="closed",this[en]((()=>{this.emit(Ze),n(t)})),void this[rn]();this[an]="open",this[rn](),this.emit(Ze),"open"===this[an]&&this.emit("open"),"open"===this[an]&&this.emit("ready"),n()}))):"open"===this[an]?this.nextTick(n):this.once(Ze,(()=>this.open(t,e))),e[Xe]}_open(t,e){this.nextTick(e)}close(t){t=Pe(t,Xe);const e=n=>{"opening"===this[an]||"closing"===this[an]?this.once(Ze,n?e(n):e):"closed"!==this[an]?t(new Ye("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):t()};if("open"===this[an]){this[an]="closing",this.emit("closing");const t=t=>{this[an]="open",this[rn](),this.emit(Ze),e(t)};this[en]((()=>{this._close((n=>{if(n)return t(n);this[an]="closed",this[rn](),this.emit(Ze),"closed"===this[an]&&this.emit("closed"),e()}))}))}else"closed"===this[an]?this.nextTick(e):this.once(Ze,(()=>this.close(t)));return t[Xe]}[en](t){if(0===this[tn].size)return this.nextTick(t);let e=this[tn].size,n=!0;const r=()=>{0==--e&&(n?this.nextTick(t):t())};for(const t of this[tn])t.close(r);n=!1,this[tn].clear()}_close(t){this.nextTick(t)}get(t,e,n){if(n=ze(e,n),n=Pe(n,Xe),e=Je(e,this[cn].entry),"opening"===this[an])return this.defer((()=>this.get(t,e,n))),n[Xe];if(An(this,n))return n[Xe];const r=this._checkKey(t);if(r)return this.nextTick(n,r),n[Xe];const o=this.keyEncoding(e.keyEncoding),i=this.valueEncoding(e.valueEncoding),s=o.format,a=i.format;return e.keyEncoding===s&&e.valueEncoding===a||(e=Object.assign({},e,{keyEncoding:s,valueEncoding:a})),this._get(this.prefixKey(o.encode(t),s),e,((t,e)=>{if(t)return("LEVEL_NOT_FOUND"===t.code||t.notFound||/NotFound/i.test(t))&&(t.code||(t.code="LEVEL_NOT_FOUND"),t.notFound||(t.notFound=!0),t.status||(t.status=404)),n(t);try{e=i.decode(e)}catch(t){return n(new Ye("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:t}))}n(null,e)})),n[Xe]}_get(t,e,n){this.nextTick(n,new Error("NotFound"))}getMany(t,e,n){if(n=ze(e,n),n=Pe(n,Xe),e=Je(e,this[cn].entry),"opening"===this[an])return this.defer((()=>this.getMany(t,e,n))),n[Xe];if(An(this,n))return n[Xe];if(!Array.isArray(t))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[Xe];if(0===t.length)return this.nextTick(n,null,[]),n[Xe];const r=this.keyEncoding(e.keyEncoding),o=this.valueEncoding(e.valueEncoding),i=r.format,s=o.format;e.keyEncoding===i&&e.valueEncoding===s||(e=Object.assign({},e,{keyEncoding:i,valueEncoding:s}));const a=new Array(t.length);for(let e=0;e<t.length;e++){const o=t[e],s=this._checkKey(o);if(s)return this.nextTick(n,s),n[Xe];a[e]=this.prefixKey(r.encode(o),i)}return this._getMany(a,e,((t,e)=>{if(t)return n(t);try{for(let t=0;t<e.length;t++)void 0!==e[t]&&(e[t]=o.decode(e[t]))}catch(t){return n(new Ye(`Could not decode one or more of ${e.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:t}))}n(null,e)})),n[Xe]}_getMany(t,e,n){this.nextTick(n,null,new Array(t.length).fill(void 0))}put(t,e,n,r){if(r=ze(n,r),r=Pe(r,Xe),n=Je(n,this[cn].entry),"opening"===this[an])return this.defer((()=>this.put(t,e,n,r))),r[Xe];if(An(this,r))return r[Xe];const o=this._checkKey(t)||this._checkValue(e);if(o)return this.nextTick(r,o),r[Xe];const i=this.keyEncoding(n.keyEncoding),s=this.valueEncoding(n.valueEncoding),a=i.format,c=s.format;n.keyEncoding===a&&n.valueEncoding===c||(n=Object.assign({},n,{keyEncoding:a,valueEncoding:c}));const u=this.prefixKey(i.encode(t),a),l=s.encode(e);return this._put(u,l,n,(n=>{if(n)return r(n);this.emit("put",t,e),r()})),r[Xe]}_put(t,e,n,r){this.nextTick(r)}del(t,e,n){if(n=ze(e,n),n=Pe(n,Xe),e=Je(e,this[cn].key),"opening"===this[an])return this.defer((()=>this.del(t,e,n))),n[Xe];if(An(this,n))return n[Xe];const r=this._checkKey(t);if(r)return this.nextTick(n,r),n[Xe];const o=this.keyEncoding(e.keyEncoding),i=o.format;return e.keyEncoding!==i&&(e=Object.assign({},e,{keyEncoding:i})),this._del(this.prefixKey(o.encode(t),i),e,(e=>{if(e)return n(e);this.emit("del",t),n()})),n[Xe]}_del(t,e,n){this.nextTick(n)}batch(t,e,n){if(!arguments.length){if("opening"===this[an])return new qe(this);if("open"!==this[an])throw new Ye("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(n="function"==typeof t?t:ze(e,n),n=Pe(n,Xe),e=Je(e,this[cn].empty),"opening"===this[an])return this.defer((()=>this.batch(t,e,n))),n[Xe];if(An(this,n))return n[Xe];if(!Array.isArray(t))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[Xe];if(0===t.length)return this.nextTick(n),n[Xe];const r=new Array(t.length),{keyEncoding:o,valueEncoding:i,...s}=e;for(let e=0;e<t.length;e++){if("object"!=typeof t[e]||null===t[e])return this.nextTick(n,new TypeError("A batch operation must be an object")),n[Xe];const s=Object.assign({},t[e]);if("put"!==s.type&&"del"!==s.type)return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[Xe];const a=this._checkKey(s.key);if(a)return this.nextTick(n,a),n[Xe];const c=null!=s.sublevel?s.sublevel:this,u=c.keyEncoding(s.keyEncoding||o),l=u.format;if(s.key=c.prefixKey(u.encode(s.key),l),s.keyEncoding=l,"put"===s.type){const t=this._checkValue(s.value);if(t)return this.nextTick(n,t),n[Xe];const e=c.valueEncoding(s.valueEncoding||i);s.value=e.encode(s.value),s.valueEncoding=e.format}c!==this&&(s.sublevel=null),r[e]=s}return this._batch(r,s,(e=>{if(e)return n(e);this.emit("batch",t),n()})),n[Xe]}_batch(t,e,n){this.nextTick(n)}sublevel(t,e){return this._sublevel(t,gn.defaults(e))}_sublevel(t,e){return new gn(this,t,e)}prefixKey(t,e){return t}clear(t,e){if(e=ze(t,e),e=Pe(e,Xe),t=Je(t,this[cn].empty),"opening"===this[an])return this.defer((()=>this.clear(t,e))),e[Xe];if(An(this,e))return e[Xe];const n=t,r=this.keyEncoding(t.keyEncoding);return(t=We(t,r)).keyEncoding=r.format,0===t.limit?this.nextTick(e):this._clear(t,(t=>{if(t)return e(t);this.emit("clear",n),e()})),e[Xe]}_clear(t,e){this.nextTick(e)}iterator(t){const e=this.keyEncoding(t&&t.keyEncoding),n=this.valueEncoding(t&&t.valueEncoding);if((t=We(t,e)).keys=!1!==t.keys,t.values=!1!==t.values,t[Ke.keyEncoding]=e,t[Ke.valueEncoding]=n,t.keyEncoding=e.format,t.valueEncoding=n.format,"opening"===this[an])return new He(this,t);if("open"!==this[an])throw new Ye("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(t)}_iterator(t){return new Ke(this,t)}keys(t){const e=this.keyEncoding(t&&t.keyEncoding),n=this.valueEncoding(t&&t.valueEncoding);if((t=We(t,e))[Ke.keyEncoding]=e,t[Ke.valueEncoding]=n,t.keyEncoding=e.format,t.valueEncoding=n.format,"opening"===this[an])return new Ve(this,t);if("open"!==this[an])throw new Ye("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(t)}_keys(t){return new Re(this,t)}values(t){const e=this.keyEncoding(t&&t.keyEncoding),n=this.valueEncoding(t&&t.valueEncoding);if((t=We(t,e))[Ke.keyEncoding]=e,t[Ke.valueEncoding]=n,t.keyEncoding=e.format,t.valueEncoding=n.format,"opening"===this[an])return new Ge(this,t);if("open"!==this[an])throw new Ye("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(t)}_values(t){return new je(this,t)}defer(t){if("function"!=typeof t)throw new TypeError("The first argument must be a function");this[nn].push(t)}[rn](){if(0===this[nn].length)return;const t=this[nn];this[nn]=[];for(const e of t)e()}attachResource(t){if("object"!=typeof t||null===t||"function"!=typeof t.close)throw new TypeError("The first argument must be a resource object");this[tn].add(t)}detachResource(t){this[tn].delete(t)}_chainedBatch(){return new qe(this)}_checkKey(t){if(null==t)return new Ye("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(t){if(null==t)return new Ye("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}dn.prototype.nextTick=function(){if(Me)return Qe;Me=1;const t=Te;return Qe=function(e,...n){0===n.length?t(e):t((()=>e(...n)))}}();const{AbstractSublevel:gn}=function(){if(Le)return $e;Le=1;const t=m,{Buffer:e}=r||{},{AbstractSublevelIterator:n,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:i}=function(){if(De)return Ue;De=1;const{AbstractIterator:t,AbstractKeyIterator:e,AbstractValueIterator:n}=gt,r=Symbol("unfix"),o=Symbol("iterator"),i=Symbol("handleOne"),s=Symbol("handleMany"),a=Symbol("callback");class c extends t{constructor(t,e,n,c){super(t,e),this[o]=n,this[r]=c,this[i]=this[i].bind(this),this[s]=this[s].bind(this),this[a]=null}[i](t,e,n){const o=this[a];if(t)return o(t);void 0!==e&&(e=this[r](e)),o(t,e,n)}[s](t,e){const n=this[a];if(t)return n(t);for(const t of e){const e=t[0];void 0!==e&&(t[0]=this[r](e))}n(t,e)}}class u extends e{constructor(t,e,n,c){super(t,e),this[o]=n,this[r]=c,this[i]=this[i].bind(this),this[s]=this[s].bind(this),this[a]=null}[i](t,e){const n=this[a];if(t)return n(t);void 0!==e&&(e=this[r](e)),n(t,e)}[s](t,e){const n=this[a];if(t)return n(t);for(let t=0;t<e.length;t++){const n=e[t];void 0!==n&&(e[t]=this[r](n))}n(t,e)}}class l extends n{constructor(t,e,n){super(t,e),this[o]=n}}for(const t of[c,u])t.prototype._next=function(t){this[a]=t,this[o].next(this[i])},t.prototype._nextv=function(t,e,n){this[a]=n,this[o].nextv(t,e,this[s])},t.prototype._all=function(t,e){this[a]=e,this[o].all(t,this[s])};for(const t of[l])t.prototype._next=function(t){this[o].next(t)},t.prototype._nextv=function(t,e,n){this[o].nextv(t,e,n)},t.prototype._all=function(t,e){this[o].all(t,e)};for(const t of[c,u,l])t.prototype._seek=function(t,e){this[o].seek(t,e)},t.prototype._close=function(t){this[o].close(t)};return Ue.AbstractSublevelIterator=c,Ue.AbstractSublevelKeyIterator=u,Ue.AbstractSublevelValueIterator=l,Ue}(),s=Symbol("prefix"),a=Symbol("upperBound"),c=Symbol("prefixRange"),u=Symbol("parent"),l=Symbol("unfix"),h=new TextEncoder,f={separator:"!"};$e=function({AbstractLevel:r}){class g extends r{static defaults(e){if("string"==typeof e)throw new t("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(e&&e.open)throw new t("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==e?f:e.separator?e:{...e,separator:"!"}}constructor(e,n,r){const{separator:o,manifest:i,...c}=g.defaults(r);n=y(n,o);const f=o.charCodeAt(0)+1,m=e[u]||e;if(!h.encode(n).every((t=>t>f&&t<127)))throw new t(`Prefix must use bytes > ${f} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(d(m,i),c);const I=(e.prefix||"")+o+n+o,b=I.slice(0,-1)+String.fromCharCode(f);this[u]=m,this[s]=new A(I),this[a]=new A(b),this[l]=new p,this.nextTick=m.nextTick}prefixKey(t,n){if("utf8"===n)return this[s].utf8+t;if(0===t.byteLength)return this[s][n];if("view"===n){const e=this[s].view,n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n}{const n=this[s].buffer;return e.concat([n,t],n.byteLength+t.byteLength)}}[c](t,e){void 0!==t.gte?t.gte=this.prefixKey(t.gte,e):void 0!==t.gt?t.gt=this.prefixKey(t.gt,e):t.gte=this[s][e],void 0!==t.lte?t.lte=this.prefixKey(t.lte,e):void 0!==t.lt?t.lt=this.prefixKey(t.lt,e):t.lte=this[a][e]}get prefix(){return this[s].utf8}get db(){return this[u]}_open(t,e){this[u].open({passive:!0},e)}_put(t,e,n,r){this[u].put(t,e,n,r)}_get(t,e,n){this[u].get(t,e,n)}_getMany(t,e,n){this[u].getMany(t,e,n)}_del(t,e,n){this[u].del(t,e,n)}_batch(t,e,n){this[u].batch(t,e,n)}_clear(t,e){this[c](t,t.keyEncoding),this[u].clear(t,e)}_iterator(t){this[c](t,t.keyEncoding);const e=this[u].iterator(t),r=this[l].get(this[s].utf8.length,t.keyEncoding);return new n(this,t,e,r)}_keys(t){this[c](t,t.keyEncoding);const e=this[u].keys(t),n=this[l].get(this[s].utf8.length,t.keyEncoding);return new o(this,t,e,n)}_values(t){this[c](t,t.keyEncoding);const e=this[u].values(t);return new i(this,t,e)}}return{AbstractSublevel:g}};const d=function(t,e){return{...t.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...e,encodings:{utf8:g(t,"utf8"),buffer:g(t,"buffer"),view:g(t,"view")}}},g=function(t,e){return!!t.supports.encodings[e]&&t.keyEncoding(e).name===e};class A{constructor(t){this.utf8=t,this.view=h.encode(t),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class p{constructor(){this.cache=new Map}get(t,e){let n=this.cache.get(e);return void 0===n&&(n="view"===e?function(t,e){return e.subarray(t)}.bind(null,t):function(t,e){return e.slice(t)}.bind(null,t),this.cache.set(e,n)),n}}const y=function(t,e){let n=0,r=t.length;for(;n<r&&t[n]===e;)n++;for(;r>n&&t[r-1]===e;)r--;return t.slice(n,r)};return $e}()({AbstractLevel:dn});A.AbstractLevel=dn,A.AbstractSublevel=gn;const An=function(t,e){return"open"!==t[an]&&(t.nextTick(e,new Ye("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},pn=function(t){return Object.keys(t.supports.encodings).filter((e=>!!t.supports.encodings[e]))};g.AbstractLevel=A.AbstractLevel,g.AbstractSublevel=A.AbstractSublevel,g.AbstractIterator=gt.AbstractIterator,g.AbstractKeyIterator=gt.AbstractKeyIterator,g.AbstractValueIterator=gt.AbstractValueIterator,g.AbstractChainedBatch=de.AbstractChainedBatch;
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var yn=function(t,e,n){if("number"!=typeof e)throw new Error("second argument must be a Number");let r,o,i,s,a,c,u=!0;Array.isArray(t)?(r=[],i=o=t.length):(s=Object.keys(t),r={},i=o=s.length);function l(t){function e(){n&&n(t,r),n=null}u?mn(e):e()}function h(e,n,u){if(r[e]=u,n&&(a=!0),0==--i||n)l(n);else if(!a&&c<o){let e;s?(e=s[c],c+=1,t[e]((function(t,n){h(e,t,n)}))):(e=c,c+=1,t[e]((function(t,n){h(e,t,n)})))}}c=e,i?s?s.some((function(n,r){return t[n]((function(t,e){h(n,t,e)})),r===e-1})):t.some((function(t,n){return t((function(t,e){h(n,t,e)})),n===e-1})):l(null);u=!1};const mn=Te;var In={},bn="function"==typeof queueMicrotask?queueMicrotask:t=>Promise.resolve().then(t);In.fromCallback=function(t,e){if(void 0===t){var n=new Promise((function(e,n){t=function(t,r){t?n(t):e(r)}}));t[void 0!==e?e:"promise"]=n}else if("function"!=typeof t)throw new TypeError("Callback must be a function");return t},In.fromPromise=function(t,e){if(void 0===e)return t;t.then((function(t){bn((()=>e(null,t)))})).catch((function(t){bn((()=>e(t)))}))};var En={},wn=function(t){const e=void 0!==t.gte?t.gte:void 0!==t.gt?t.gt:void 0,n=void 0!==t.lte?t.lte:void 0!==t.lt?t.lt:void 0,r=void 0===t.gte,o=void 0===t.lte;return void 0!==e&&void 0!==n?IDBKeyRange.bound(e,n,r,o):void 0!==e?IDBKeyRange.lowerBound(e,r):void 0!==n?IDBKeyRange.upperBound(n,o):null};const Cn=new TextEncoder;var vn=function(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):Cn.encode(t)};const{AbstractIterator:Bn}=g,_n=wn,kn=vn,Sn=Symbol("cache"),xn=Symbol("finished"),Qn=Symbol("options"),Mn=Symbol("currentOptions"),Tn=Symbol("position"),Dn=Symbol("location"),$n=Symbol("first"),Ln={};function Un(t){"function"==typeof t.commit&&t.commit()}En.Iterator=class extends Bn{constructor(t,e,n){super(t,n),this[Sn]=[],this[xn]=0===this.limit,this[Qn]=n,this[Mn]={...n},this[Tn]=void 0,this[Dn]=e,this[$n]=!0}_nextv(t,e,n){if(this[$n]=!1,this[xn])return this.nextTick(n,null,[]);if(this[Sn].length>0)return t=Math.min(t,this[Sn].length),this.nextTick(n,null,this[Sn].splice(0,t));let r;void 0!==this[Tn]&&(this[Qn].reverse?(this[Mn].lt=this[Tn],this[Mn].lte=void 0):(this[Mn].gt=this[Tn],this[Mn].gte=void 0));try{r=_n(this[Mn])}catch(t){return this[xn]=!0,this.nextTick(n,null,[])}const o=this.db.db.transaction([this[Dn]],"readonly"),i=o.objectStore(this[Dn]),s=[];if(this[Qn].reverse){i[!this[Qn].values&&i.openKeyCursor?"openKeyCursor":"openCursor"](r,"prev").onsuccess=e=>{const n=e.target.result;if(n){const{key:e,value:r}=n;this[Tn]=e,s.push([this[Qn].keys&&void 0!==e?kn(e):void 0,this[Qn].values&&void 0!==r?kn(r):void 0]),s.length<t?n.continue():Un(o)}else this[xn]=!0}}else{let e,n;const a=()=>{if(void 0===e||void 0===n)return;const r=Math.max(e.length,n.length);0===r||t===1/0?this[xn]=!0:this[Tn]=e[r-1],s.length=r;for(let t=0;t<r;t++){const r=e[t],o=n[t];s[t]=[this[Qn].keys&&void 0!==r?kn(r):void 0,this[Qn].values&&void 0!==o?kn(o):void 0]}Un(o)};this[Qn].keys||t<1/0?i.getAllKeys(r,t<1/0?t:void 0).onsuccess=t=>{e=t.target.result,a()}:(e=[],this.nextTick(a)),this[Qn].values?i.getAll(r,t<1/0?t:void 0).onsuccess=t=>{n=t.target.result,a()}:(n=[],this.nextTick(a))}o.onabort=()=>{n(o.error||new Error("aborted by user")),n=null},o.oncomplete=()=>{n(null,s),n=null}}_next(t){if(this[Sn].length>0){const[e,n]=this[Sn].shift();this.nextTick(t,null,e,n)}else if(this[xn])this.nextTick(t);else{let e=Math.min(100,this.limit-this.count);this[$n]&&(this[$n]=!1,e=1),this._nextv(e,Ln,((e,n)=>{if(e)return t(e);this[Sn]=n,this._next(t)}))}}_all(t,e){this[$n]=!1;const n=this[Sn].splice(0,this[Sn].length),r=this.limit-this.count-n.length;if(r<=0)return this.nextTick(e,null,n);this._nextv(r,Ln,((t,r)=>{if(t)return e(t);n.length>0&&(r=n.concat(r)),e(null,r)}))}_seek(t,e){let n;this[$n]=!0,this[Sn]=[],this[xn]=!1,this[Tn]=void 0,this[Mn]={...this[Qn]};try{n=_n(this[Qn])}catch(t){return void(this[xn]=!0)}null===n||n.includes(t)?this[Qn].reverse?this[Mn].lte=t:this[Mn].gte=t:this[xn]=!0}};const{AbstractLevel:On}=g,Fn=m,Nn=yn,{fromCallback:Pn}=In,{Iterator:Yn}=En,Kn=vn,Rn=function(t,e,n,r,o){if(0===r.limit)return t.nextTick(o);const i=t.db.transaction([e],"readwrite"),s=i.objectStore(e);let a=0;i.oncomplete=function(){o()},i.onabort=function(){o(i.error||new Error("aborted by user"))};const c=s.openKeyCursor?"openKeyCursor":"openCursor",u=r.reverse?"prev":"next";s[c](n,u).onsuccess=function(t){const e=t.target.result;e&&(s.delete(e.key).onsuccess=function(){(r.limit<=0||++a<r.limit)&&e.continue()})}},jn=wn,Hn="level-js-",Vn=Symbol("idb"),Gn=Symbol("namePrefix"),qn=Symbol("location"),zn=Symbol("version"),Jn=Symbol("store"),Wn=Symbol("onComplete"),Xn=Symbol("promise");class Zn extends On{constructor(t,e,n){if("function"==typeof e||"function"==typeof n)throw new Fn("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:r,version:o,...i}=e||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},i),"string"!=typeof t)throw new Error("constructor requires a location string argument");this[qn]=t,this[Gn]=null==r?Hn:r,this[zn]=parseInt(o||1,10),this[Vn]=null}get location(){return this[qn]}get namePrefix(){return this[Gn]}get version(){return this[zn]}get db(){return this[Vn]}get type(){return"browser-level"}_open(t,e){const n=indexedDB.open(this[Gn]+this[qn],this[zn]);n.onerror=function(){e(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[Vn]=n.result,e()},n.onupgradeneeded=t=>{const e=t.target.result;e.objectStoreNames.contains(this[qn])||e.createObjectStore(this[qn])}}[Jn](t){return this[Vn].transaction([this[qn]],t).objectStore(this[qn])}[Wn](t,e){const n=t.transaction;n.onabort=function(){e(n.error||new Error("aborted by user"))},n.oncomplete=function(){e(null,t.result)}}_get(t,e,n){const r=this[Jn]("readonly");let o;try{o=r.get(t)}catch(t){return this.nextTick(n,t)}this[Wn](o,(function(t,e){return t?n(t):void 0===e?n(new Fn("Entry not found",{code:"LEVEL_NOT_FOUND"})):void n(null,Kn(e))}))}_getMany(t,e,n){const r=this[Jn]("readonly"),o=t.map((t=>e=>{let n;try{n=r.get(t)}catch(t){return e(t)}n.onsuccess=()=>{const t=n.result;e(null,void 0===t?t:Kn(t))},n.onerror=t=>{t.stopPropagation(),e(n.error)}}));Nn(o,16,n)}_del(t,e,n){const r=this[Jn]("readwrite");let o;try{o=r.delete(t)}catch(t){return this.nextTick(n,t)}this[Wn](o,n)}_put(t,e,n,r){const o=this[Jn]("readwrite");let i;try{i=o.put(e,t)}catch(t){return this.nextTick(r,t)}this[Wn](i,r)}_iterator(t){return new Yn(this,this[qn],t)}_batch(t,e,n){const r=this[Jn]("readwrite"),o=r.transaction;let i,s=0;o.onabort=function(){n(i||o.error||new Error("aborted by user"))},o.oncomplete=function(){n()},function e(){const n=t[s++],a=n.key;let c;try{c="del"===n.type?r.delete(a):r.put(n.value,a)}catch(t){return i=t,void o.abort()}s<t.length?c.onsuccess=e:"function"==typeof o.commit&&o.commit()}()}_clear(t,e){let n,r;try{n=jn(t)}catch(t){return this.nextTick(e)}if(t.limit>=0)return Rn(this,this[qn],n,t,e);try{const t=this[Jn]("readwrite");r=n?t.delete(n):t.clear()}catch(t){return this.nextTick(e,t)}this[Wn](r,e)}_close(t){this[Vn].close(),this.nextTick(t)}}Zn.destroy=function(t,e,n){"function"==typeof e&&(n=e,e=Hn),n=Pn(n,Xn);const r=indexedDB.deleteDatabase(e+t);return r.onsuccess=function(){n()},r.onerror=function(t){n(t)},n[Xn]};var tr=Zn;const er="0123456789bcdefghjkmnpqrstuvwxyz";class nr{static encode(t,e,n){if(void 0===n){for(let n=1;n<=12;n++){const r=nr.encode(t,e,n),o=nr.decode(r);if(o.lat==t&&o.lon==e)return r}n=12}if(t=Number(t),e=Number(e),n=Number(n),isNaN(t)||isNaN(e)||isNaN(n))throw new Error("Invalid geohash");let r=0,o=0,i=!0,s="",a=-90,c=90,u=-180,l=180;for(;s.length<n;){if(i){const t=(u+l)/2;e>=t?(r=2*r+1,u=t):(r*=2,l=t)}else{const e=(a+c)/2;t>=e?(r=2*r+1,a=e):(r*=2,c=e)}i=!i,5==++o&&(s+=er.charAt(r),o=0,r=0)}return s}static decode(t){const e=nr.bounds(t),n=e.sw.lat,r=e.sw.lon,o=e.ne.lat,i=e.ne.lon;let s=(n+o)/2,a=(r+i)/2;return s=s.toFixed(Math.floor(2-Math.log(o-n)/Math.LN10)),a=a.toFixed(Math.floor(2-Math.log(i-r)/Math.LN10)),{lat:Number(s),lon:Number(a)}}static bounds(t){if(0==t.length)throw new Error("Invalid geohash");t=t.toLowerCase();let e=!0,n=-90,r=90,o=-180,i=180;for(let s=0;s<t.length;s++){const a=t.charAt(s),c=er.indexOf(a);if(-1==c)throw new Error("Invalid geohash");for(let t=4;t>=0;t--){const s=c>>t&1;if(e){const t=(o+i)/2;1==s?o=t:i=t}else{const t=(n+r)/2;1==s?n=t:r=t}e=!e}}return{sw:{lat:n,lon:o},ne:{lat:r,lon:i}}}static adjacent(t,e){if(t=t.toLowerCase(),e=e.toLowerCase(),0==t.length)throw new Error("Invalid geohash");if(-1=="nsew".indexOf(e))throw new Error("Invalid direction");const n=t.slice(-1);let r=t.slice(0,-1);const o=t.length%2;return-1!={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]}[e][o].indexOf(n)&&""!=r&&(r=nr.adjacent(r,e)),r+er.charAt({n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]}[e][o].indexOf(n))}static neighbours(t){return{n:nr.adjacent(t,"n"),ne:nr.adjacent(nr.adjacent(t,"n"),"e"),e:nr.adjacent(t,"e"),se:nr.adjacent(nr.adjacent(t,"s"),"e"),s:nr.adjacent(t,"s"),sw:nr.adjacent(nr.adjacent(t,"s"),"w"),w:nr.adjacent(t,"w"),nw:nr.adjacent(nr.adjacent(t,"n"),"w")}}}var rr={exports:{}},or={exports:{}};function ir(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var sr,ar={exports:{}},cr=function t(e,n){if(!e){var r=new ur(n);throw Error.captureStackTrace&&Error.captureStackTrace(r,t),r}};class ur extends Error{}function lr(t){t.fill(0)}ur.prototype.name="AssertionError",function(t){var e,n=cr,r=(e=globalThis.crypto||globalThis.msCrypto)&&e.getRandomValues?function(t,n){for(let r=0;r<n;r+=65536)e.getRandomValues(new Uint8Array(t.buffer,r+t.byteOffset,Math.min(n-r,65536)))}:null!=ir&&(e=ir("crypto"))&&e.randomBytes?function(t,n){new Uint8Array(t.buffer,t.byteOffset,n).set(e.randomBytes(n))}:function(){throw new Error("No secure random number generator available")};Object.defineProperty(t.exports,"randombytes",{value:r}),t.exports.randombytes_buf=function(t){n(t,"out must be given"),r(t,t.byteLength)}}(ar);var hr={sodium_malloc:function(t){return new Uint8Array(t)},sodium_free:function(t){lr(t),function(){if(sr)return sr;var t=globalThis.MessageChannel;null==t&&({MessageChannel:t}=ir("worker_threads"));return sr=new t}().port1.postMessage(t.buffer,[t.buffer])},sodium_memzero:lr},fr={exports:{}};!function(t){function e(t,e,n,r,o){var i=0;for(let s=0;s<o;s++)i|=t[e+s]^n[r+s];return(1&i-1>>>8)-1}t.exports={crypto_verify_16:function(t,n,r,o){return 0===e(t,n,r,o,16)},crypto_verify_32:function(t,n,r,o){return 0===e(t,n,r,o,32)},crypto_verify_64:function(t,n,r,o){return 0===e(t,n,r,o,64)}},Object.defineProperty(t.exports,"vn",{value:e})}(fr);const dr=cr,{vn:gr}=fr.exports;var Ar={sodium_increment:function(t){const e=t.byteLength;for(var n=1,r=0;r<e;r++)n+=t[r],t[r]=n,n>>=8},sodium_memcmp:function(t,e){return dr(t.byteLength===e.byteLength,"buffers must be the same size"),0===gr(t,0,e,0,t.byteLength)},sodium_is_zero:function(t){var e=0;for(let n=0;n<t.length;n++)e|=t[n];return 0===e}},pr={exports:{}};function yr(t){return t.length}var mr={byteLength:yr,toString:function(t){const e=t.byteLength;let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n},write:function(t,e,n=0,r=yr(e)){const o=Math.min(r,t.byteLength-n);for(let r=0;r<o;r++)t[n+r]=e.charCodeAt(r);return o}};const Ir="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",br=new Uint8Array(256);for(let t=0;t<Ir.length;t++)br[Ir.charCodeAt(t)]=t;function Er(t){let e=t.length;return 61===t.charCodeAt(e-1)&&e--,e>1&&61===t.charCodeAt(e-1)&&e--,3*e>>>2}br[45]=62,br[95]=63;var wr={byteLength:Er,toString:function(t){const e=t.byteLength;let n="";for(let r=0;r<e;r+=3)n+=Ir[t[r]>>2]+Ir[(3&t[r])<<4|t[r+1]>>4]+Ir[(15&t[r+1])<<2|t[r+2]>>6]+Ir[63&t[r+2]];return e%3==2?n=n.substring(0,n.length-1)+"=":e%3==1&&(n=n.substring(0,n.length-2)+"=="),n},write:function(t,e,n=0,r=Er(e)){const o=Math.min(r,t.byteLength-n);for(let n=0,r=0;n<o;n+=4){const o=br[e.charCodeAt(n)],i=br[e.charCodeAt(n+1)],s=br[e.charCodeAt(n+2)],a=br[e.charCodeAt(n+3)];t[r++]=o<<2|i>>4,t[r++]=(15&i)<<4|s>>2,t[r++]=(3&s)<<6|63&a}return o}};function Cr(t){return t.length>>>1}var vr={byteLength:Cr,toString:function(t){const e=t.byteLength;t=new DataView(t.buffer,t.byteOffset,e);let n="",r=0;for(let o=e-e%4;r<o;r+=4)n+=t.getUint32(r).toString(16).padStart(8,"0");for(;r<e;r++)n+=t.getUint8(r).toString(16).padStart(2,"0");return n},write:function(t,e,n=0,r=Cr(e)){const o=Math.min(r,t.byteLength-n);for(let r=0;r<o;r++){const o=Br(e.charCodeAt(2*r)),i=Br(e.charCodeAt(2*r+1));if(void 0===o||void 0===i)return t.subarray(0,r);t[n+r]=o<<4|i}return o}};function Br(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:void 0}function _r(t){let e=0;for(let n=0,r=t.length;n<r;n++){const o=t.charCodeAt(n);if(o>=55296&&o<=56319&&n+1<r){const r=t.charCodeAt(n+1);if(r>=56320&&r<=57343){e+=4,n++;continue}}e+=o<=127?1:o<=2047?2:3}return e}let kr,Sr;if("undefined"!=typeof TextDecoder){const t=new TextDecoder;kr=function(e){return t.decode(e)}}else kr=function(t){const e=t.byteLength;let n="",r=0;for(;r<e;){let o=t[r];if(o<=127){n+=String.fromCharCode(o),r++;continue}let i=0,s=0;if(o<=223?(i=1,s=31&o):o<=239?(i=2,s=15&o):o<=244&&(i=3,s=7&o),e-r-i>0){let e=0;for(;e<i;)o=t[r+e+1],s=s<<6|63&o,e+=1}else s=65533,i=e-r;n+=String.fromCodePoint(s),r+=i+1}return n};if("undefined"!=typeof TextEncoder){const t=new TextEncoder;Sr=function(e,n,r=0,o=_r(n)){const i=Math.min(o,e.byteLength-r);return t.encodeInto(n,e.subarray(r,r+i)),i}}else Sr=function(t,e,n=0,r=_r(e)){const o=Math.min(r,t.byteLength-n);t=t.subarray(n,n+o);let i=0,s=0;for(;i<e.length;){const n=e.codePointAt(i);if(n<=127){t[s++]=n,i++;continue}let r=0,o=0;for(n<=2047?(r=6,o=192):n<=65535?(r=12,o=224):n<=2097151&&(r=18,o=240),t[s++]=o|n>>r,r-=6;r>=0;)t[s++]=128|n>>r&63,r-=6;i+=n>=65536?2:1}return o};function xr(t){return 2*t.length}var Qr={byteLength:xr,toString:function(t){const e=t.byteLength;let n="";for(let r=0;r<e-1;r+=2)n+=String.fromCharCode(t[r]+256*t[r+1]);return n},write:function(t,e,n=0,r=xr(e)){const o=Math.min(r,t.byteLength-n);let i=o;for(let r=0;r<e.length&&!((i-=2)<0);++r){const o=e.charCodeAt(r),i=o>>8,s=o%256;t[n+2*r]=s,t[n+2*r+1]=i}return o}};const Mr=mr,Tr=wr,Dr=vr,$r={byteLength:_r,toString:kr,write:Sr},Lr=Qr;function Ur(t){switch(t){case"ascii":return Mr;case"base64":return Tr;case"hex":return Dr;case"utf8":case"utf-8":case void 0:return $r;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Lr;default:throw new Error(`Unknown encoding: ${t}`)}}function Or(t){return t instanceof Uint8Array}function Fr(t,e,n){return"string"==typeof t?function(t,e){const n=Ur(e),r=new Uint8Array(n.byteLength(t));return n.write(r,t,0,r.byteLength),r}(t,e):Array.isArray(t)?function(t){const e=new Uint8Array(t.length);return e.set(t),e}(t):ArrayBuffer.isView(t)?function(t){const e=new Uint8Array(t.byteLength);return e.set(t),e}(t):function(t,e,n){return new Uint8Array(t,e,n)}(t,e,n)}function Nr(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}var Pr={isBuffer:Or,alloc:function(t,e,n){const r=new Uint8Array(t);return void 0!==e&&e(r,e,0,r.byteLength,n),r},allocUnsafe:function(t){return new Uint8Array(t)},allocUnsafeSlow:function(t){return new Uint8Array(t)},byteLength:function(t,e){return Ur(e).byteLength(t)},compare:function(t,e){if(t===e)return 0;const n=Math.min(t.byteLength,e.byteLength);t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let r=0;for(let o=n-n%4;r<o;r+=4){const n=t.getUint32(r),o=e.getUint32(r);if(n<o)return-1;if(n>o)return 1}for(;r<n;r++){const n=t.getUint8(r),o=e.getUint8(r);if(n<o)return-1;if(n>o)return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0},concat:function(t,e){void 0===e&&(e=t.reduce(((t,e)=>t+e.byteLength),0));const n=new Uint8Array(e);return t.reduce(((t,e)=>(n.set(e,t),t+e.byteLength)),0),n},copy:function(t,e,n=0,r=0,o=t.byteLength){if(o>0&&o<r)return 0;if(o===r)return 0;if(0===t.byteLength||0===e.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(r<0||r>=t.byteLength)throw new RangeError("sourceStart is out of range");if(o<0)throw new RangeError("sourceEnd is out of range");n>=e.byteLength&&(n=e.byteLength),o>t.byteLength&&(o=t.byteLength),e.byteLength-n<o-r&&(o=e.length-n+r);const i=o-r;return t===e?e.copyWithin(n,r,o):e.set(t.subarray(r,o),n),i},equals:function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;const n=t.byteLength;t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let r=0;for(let o=n-n%4;r<o;r+=4)if(t.getUint32(r)!==e.getUint32(r))return!1;for(;r<n;r++)if(t.getUint8(r)!==e.getUint8(r))return!1;return!0},fill:function(t,e,n,r,o){if("string"==typeof e?"string"==typeof n?(o=n,n=0,r=t.byteLength):"string"==typeof r&&(o=r,r=t.byteLength):"number"==typeof val?e&=255:"boolean"==typeof val&&(e=+e),n<0||t.byteLength<n||t.byteLength<r)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===r&&(r=t.byteLength),r<=n)return t;if(e||(e=0),"number"==typeof e)for(let o=n;o<r;++o)t[o]=e;else{const i=(e=Or(e)?e:Fr(e,o)).byteLength;for(let o=0;o<r-n;++o)t[o+n]=e[o%i]}return t},from:Fr,swap16:function(t){const e=t.byteLength;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<e;n+=2)Nr(t,n,n+1);return t},swap32:function(t){const e=t.byteLength;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<e;n+=4)Nr(t,n,n+3),Nr(t,n+1,n+2);return t},swap64:function(t){const e=t.byteLength;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<e;n+=8)Nr(t,n,n+7),Nr(t,n+1,n+6),Nr(t,n+2,n+5),Nr(t,n+3,n+4);return t},toBuffer:function(t){return t},toString:function(t,e,n=0,r=t.byteLength){const o=t.byteLength;return n>=o||r<=n?"":(n<0&&(n=0),r>o&&(r=o),(0!==n||r<o)&&(t=t.subarray(n,r)),Ur(e).toString(t))},write:function(t,e,n,r,o){return void 0===n?o="utf8":void 0===r&&"string"==typeof n?(o=n,n=void 0):void 0===o&&"string"==typeof r&&(o=r,r=void 0),Ur(o).write(t,e,n,r)}};const Yr=cr,Kr=Pr;var Rr=Vr;const jr=128;var Hr=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Vr(){return this instanceof Vr?(this.hh=new Int32Array(8),this.hl=new Int32Array(8),this.buffer=new Uint8Array(128),this.finalised=!1,this.bytesRead=0,this.pos=0,this.hh[0]=1779033703,this.hh[1]=3144134277,this.hh[2]=1013904242,this.hh[3]=2773480762,this.hh[4]=1359893119,this.hh[5]=2600822924,this.hh[6]=528734635,this.hh[7]=1541459225,this.hl[0]=4089235720,this.hl[1]=2227873595,this.hl[2]=4271175723,this.hl[3]=1595750129,this.hl[4]=2917565137,this.hl[5]=725511199,this.hl[6]=4215389547,this.hl[7]=327033209,this):new Vr}function Gr(t,e,n,r){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=255&n,t[e+4]=r>>24&255,t[e+5]=r>>16&255,t[e+6]=r>>8&255,t[e+7]=255&r}function qr(t,e,n,r){for(var o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B,_,k,S,x,Q=new Int32Array(16),M=new Int32Array(16),T=t[0],D=t[1],$=t[2],L=t[3],U=t[4],O=t[5],F=t[6],N=t[7],P=e[0],Y=e[1],K=e[2],R=e[3],j=e[4],H=e[5],V=e[6],G=e[7],q=0;r>=128;){for(w=0;w<16;w++)C=8*w+q,Q[w]=n[C+0]<<24|n[C+1]<<16|n[C+2]<<8|n[C+3],M[w]=n[C+4]<<24|n[C+5]<<16|n[C+6]<<8|n[C+7];for(w=0;w<80;w++)if(o=T,i=D,s=$,a=L,c=U,u=O,l=F,N,f=P,d=Y,g=K,A=R,p=j,y=H,m=V,G,_=65535&(B=G),k=B>>>16,S=65535&(v=N),x=v>>>16,_+=65535&(B=(j>>>14|U<<18)^(j>>>18|U<<14)^(U>>>9|j<<23)),k+=B>>>16,S+=65535&(v=(U>>>14|j<<18)^(U>>>18|j<<14)^(j>>>9|U<<23)),x+=v>>>16,_+=65535&(B=j&H^~j&V),k+=B>>>16,S+=65535&(v=U&O^~U&F),x+=v>>>16,_+=65535&(B=Hr[2*w+1]),k+=B>>>16,S+=65535&(v=Hr[2*w]),x+=v>>>16,v=Q[w%16],k+=(B=M[w%16])>>>16,S+=65535&v,x+=v>>>16,S+=(k+=(_+=65535&B)>>>16)>>>16,_=65535&(B=E=65535&_|k<<16),k=B>>>16,S=65535&(v=b=65535&S|(x+=S>>>16)<<16),x=v>>>16,_+=65535&(B=(P>>>28|T<<4)^(T>>>2|P<<30)^(T>>>7|P<<25)),k+=B>>>16,S+=65535&(v=(T>>>28|P<<4)^(P>>>2|T<<30)^(P>>>7|T<<25)),x+=v>>>16,k+=(B=P&Y^P&K^Y&K)>>>16,S+=65535&(v=T&D^T&$^D&$),x+=v>>>16,h=65535&(S+=(k+=(_+=65535&B)>>>16)>>>16)|(x+=S>>>16)<<16,I=65535&_|k<<16,_=65535&(B=A),k=B>>>16,S=65535&(v=a),x=v>>>16,k+=(B=E)>>>16,S+=65535&(v=b),x+=v>>>16,D=o,$=i,L=s,U=a=65535&(S+=(k+=(_+=65535&B)>>>16)>>>16)|(x+=S>>>16)<<16,O=c,F=u,N=l,T=h,Y=f,K=d,R=g,j=A=65535&_|k<<16,H=p,V=y,G=m,P=I,w%16==15)for(C=0;C<16;C++)v=Q[C],_=65535&(B=M[C]),k=B>>>16,S=65535&v,x=v>>>16,v=Q[(C+9)%16],_+=65535&(B=M[(C+9)%16]),k+=B>>>16,S+=65535&v,x+=v>>>16,b=Q[(C+1)%16],_+=65535&(B=((E=M[(C+1)%16])>>>1|b<<31)^(E>>>8|b<<24)^(E>>>7|b<<25)),k+=B>>>16,S+=65535&(v=(b>>>1|E<<31)^(b>>>8|E<<24)^b>>>7),x+=v>>>16,b=Q[(C+14)%16],k+=(B=((E=M[(C+14)%16])>>>19|b<<13)^(b>>>29|E<<3)^(E>>>6|b<<26))>>>16,S+=65535&(v=(b>>>19|E<<13)^(E>>>29|b<<3)^b>>>6),x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,Q[C]=65535&S|x<<16,M[C]=65535&_|k<<16;_=65535&(B=P),k=B>>>16,S=65535&(v=T),x=v>>>16,v=t[0],k+=(B=e[0])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[0]=T=65535&S|x<<16,e[0]=P=65535&_|k<<16,_=65535&(B=Y),k=B>>>16,S=65535&(v=D),x=v>>>16,v=t[1],k+=(B=e[1])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[1]=D=65535&S|x<<16,e[1]=Y=65535&_|k<<16,_=65535&(B=K),k=B>>>16,S=65535&(v=$),x=v>>>16,v=t[2],k+=(B=e[2])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[2]=$=65535&S|x<<16,e[2]=K=65535&_|k<<16,_=65535&(B=R),k=B>>>16,S=65535&(v=L),x=v>>>16,v=t[3],k+=(B=e[3])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[3]=L=65535&S|x<<16,e[3]=R=65535&_|k<<16,_=65535&(B=j),k=B>>>16,S=65535&(v=U),x=v>>>16,v=t[4],k+=(B=e[4])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[4]=U=65535&S|x<<16,e[4]=j=65535&_|k<<16,_=65535&(B=H),k=B>>>16,S=65535&(v=O),x=v>>>16,v=t[5],k+=(B=e[5])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[5]=O=65535&S|x<<16,e[5]=H=65535&_|k<<16,_=65535&(B=V),k=B>>>16,S=65535&(v=F),x=v>>>16,v=t[6],k+=(B=e[6])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[6]=F=65535&S|x<<16,e[6]=V=65535&_|k<<16,_=65535&(B=G),k=B>>>16,S=65535&(v=N),x=v>>>16,v=t[7],k+=(B=e[7])>>>16,S+=65535&v,x+=v>>>16,x+=(S+=(k+=(_+=65535&B)>>>16)>>>16)>>>16,t[7]=N=65535&S|x<<16,e[7]=G=65535&_|k<<16,q+=128,r-=128}}function zr(t){if(!(this instanceof zr))return new zr(t);this.pad=Kr.alloc(128),this.inner=Vr(),this.outer=Vr();const e=Kr.alloc(64);t.byteLength>128&&(Vr().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}Vr.prototype.update=function(t,e){Yr(!1===this.finalised,"Hash instance finalised");var[n,r]=function(t,e){var n=Kr.from(t,e);return[n,n.byteLength]}(t,e);this.bytesRead+=r;const o=r+this.pos&-128;this.buffer.set(n.subarray(0,jr-this.pos),this.pos);const i=this.pos;return(r-=jr-this.pos)>=0&&(qr(this.hh,this.hl,this.buffer,128),this.pos=0),r>127&&(qr(this.hh,this.hl,n.subarray(jr-i,o-i),o-jr),r%=128),this.buffer.set(n.subarray(n.byteLength-r)),this.pos=127&this.bytesRead,this.buffer.fill(0,this.pos),this},Vr.prototype.digest=function(t,e=0){if(Yr(!1===this.finalised,"Hash instance finalised"),this.finalised=!0,this.buffer.fill(0,this.pos),this.buffer[this.pos]=128,this.pos>111&&(qr(this.hh,this.hl,this.buffer,128),this.buffer.fill(0),this.pos=0),Gr(this.buffer,120,this.bytesRead/536870912|0,this.bytesRead<<3),qr(this.hh,this.hl,this.buffer,128),t instanceof Uint8Array&&t.byteLength>63){for(let n=0;n<8;n++)Gr(t,8*n+e,this.hh[n],this.hl[n]);return t}const n=new Uint8Array(64);for(let t=0;t<8;t++)Gr(n,8*t,this.hh[t],this.hl[t]);return"string"==typeof t?Kr.toString(n,t):n},zr.prototype.update=function(t,e){return this.inner.update(t,e),this},zr.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},Vr.HMAC=zr;var Jr,Wr,Xr={exports:{}},Zr=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),to=(Jr={"wasm-binary:./sha512.wat"(t,e){e.exports=Zr("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")}},function(){return Wr||(0,Jr[Object.keys(Jr)[0]])((Wr={exports:{}}).exports,Wr),Wr.exports})(),eo=new WebAssembly.Module(to);const no=cr,ro=Pr,oo=(io={imports:{debug:{log(...t){console.log(...t.map((t=>(t>>>0).toString(16).padStart(8,"0"))))},log_tee:t=>(console.log((t>>>0).toString(16).padStart(8,"0")),t)}}},new WebAssembly.Instance(eo,io).exports);var io;let so=0;const ao=[];Xr.exports=lo;const co=Xr.exports.SHA512_BYTES=64,uo=128;function lo(){if(!(this instanceof lo))return new lo;if(!oo)throw new Error("WASM not loaded. Wait for Sha512.ready(cb)");ao.length||(ao.push(so),so+=216),this.finalized=!1,this.digestLength=co,this.pointer=ao.pop(),this.pos=0,this.wasm=oo,this._memory=new Uint8Array(oo.memory.buffer),this._memory.fill(0,this.pointer,this.pointer+216),this.pointer+this.digestLength>this._memory.length&&this._realloc(this.pointer+216)}function ho(t){if(!(this instanceof ho))return new ho(t);this.pad=ro.alloc(128),this.inner=lo(),this.outer=lo();const e=ro.alloc(64);t.byteLength>128&&(lo().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}function fo(){}lo.prototype._realloc=function(t){oo.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(oo.memory.buffer)},lo.prototype.update=function(t,e){no(!1===this.finalized,"Hash instance finalized"),so%8!=0&&(so+=8-so%8),no(so%8==0,"input should be aligned for int64");const[n,r]=function(t,e){var n=ro.from(t,e);return[n,n.byteLength]}(t,e);return no(n instanceof Uint8Array,"input must be Uint8Array or Buffer"),so+t.length>this._memory.length&&this._realloc(so+t.length),this._memory.fill(0,so,so+function(t,e){return t+e-1&-e}(r,uo)-uo),this._memory.set(n.subarray(0,uo-this.pos),this.pointer+80+this.pos),this._memory.set(n.subarray(uo-this.pos),so),this.pos=this.pos+r&127,oo.sha512(this.pointer,so,r,0),this},lo.prototype.digest=function(t,e=0){no(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,ao.push(this.pointer);const n=this.pointer+80+this.pos;this._memory.fill(0,n,this.pointer+80+uo),oo.sha512(this.pointer,so,0,1);const r=this._memory.subarray(this.pointer,this.pointer+this.digestLength);if(!t)return r;if("string"==typeof t)return ro.toString(r,t);no(t instanceof Uint8Array,"output must be Uint8Array or Buffer"),no(t.byteLength>=this.digestLength+e,"output must have at least 'SHA512_BYTES' bytes remaining");for(let n=0;n<this.digestLength;n++)t[n+e]=r[n];return t},lo.WASM=oo,lo.WASM_SUPPORTED="undefined"!=typeof WebAssembly,lo.ready=function(t){return t||(t=fo),oo?(t(),Promise.resolve()):t(new Error("WebAssembly not supported"))},lo.prototype.ready=lo.ready,ho.prototype.update=function(t,e){return this.inner.update(t,e),this},ho.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},lo.HMAC=ho;const go=Rr,Ao=Xr.exports;var po=go;pr.exports=function(){return new po},pr.exports.ready=function(t){Ao.ready((function(){t()}))},pr.exports.WASM_SUPPORTED=Ao.SUPPORTED,pr.exports.WASM_LOADED=!1,pr.exports.SHA512_BYTES=64,Ao.ready((function(t){t||(pr.exports.WASM_LOADED=!0,pr.exports=po=Ao)}));const{crypto_verify_32:yo}=fr.exports,mo=pr.exports,Io=cr;var bo={crypto_auth_BYTES:32,crypto_auth_KEYBYTES:32,crypto_auth:function(t,e,n){Io(32===t.byteLength,"out should be 'crypto_auth_BYTES' in length"),Io(32===n.byteLength,"key should be 'crypto_auth_KEYBYTES' in length");const r=new Uint8Array(64),o=mo.HMAC(n);o.update(e),o.digest(r),t.set(r.subarray(0,32))},crypto_auth_verify:function(t,e,n){Io(32===t.byteLength,"h should be 'crypto_auth_BYTES' in length"),Io(32===n.byteLength,"key should be 'crypto_auth_KEYBYTES' in length");const r=mo.HMAC(n).update(e).digest();return yo(t,0,r,0)}};const Eo=pr.exports,wo=cr;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");function Co(t,e,n){return wo(64===t.byteLength,"out must be 'crypto_hash_sha512_BYTES' bytes long"),Eo().update(e.subarray(0,n)).digest(t),0}var vo={crypto_hash:function(t,e,n){return Co(t,e,n)},crypto_hash_sha512:Co,crypto_hash_sha512_BYTES:64,crypto_hash_BYTES:64};if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var Bo=function(t){var e,n=new Float64Array(16);if(t)for(e=0;e<t.length;e++)n[e]=t[e];return n},_o=new Uint8Array(32);_o[0]=9;var ko=Bo(),So=Bo([1]),xo=Bo([56129,1]),Qo=Bo([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Mo=Bo([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),To=Bo([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Do=Bo([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$o=Bo([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Lo(t,e,n){var r,o,i=0,s=0,a=0,c=0,u=0,l=0,h=0,f=0,d=0,g=0,A=0,p=0,y=0,m=0,I=0,b=0,E=0,w=0,C=0,v=0,B=0,_=0,k=0,S=0,x=0,Q=0,M=0,T=0,D=0,$=0,L=0,U=n[0],O=n[1],F=n[2],N=n[3],P=n[4],Y=n[5],K=n[6],R=n[7],j=n[8],H=n[9],V=n[10],G=n[11],q=n[12],z=n[13],J=n[14],W=n[15];i+=(r=e[0])*U,s+=r*O,a+=r*F,c+=r*N,u+=r*P,l+=r*Y,h+=r*K,f+=r*R,d+=r*j,g+=r*H,A+=r*V,p+=r*G,y+=r*q,m+=r*z,I+=r*J,b+=r*W,s+=(r=e[1])*U,a+=r*O,c+=r*F,u+=r*N,l+=r*P,h+=r*Y,f+=r*K,d+=r*R,g+=r*j,A+=r*H,p+=r*V,y+=r*G,m+=r*q,I+=r*z,b+=r*J,E+=r*W,a+=(r=e[2])*U,c+=r*O,u+=r*F,l+=r*N,h+=r*P,f+=r*Y,d+=r*K,g+=r*R,A+=r*j,p+=r*H,y+=r*V,m+=r*G,I+=r*q,b+=r*z,E+=r*J,w+=r*W,c+=(r=e[3])*U,u+=r*O,l+=r*F,h+=r*N,f+=r*P,d+=r*Y,g+=r*K,A+=r*R,p+=r*j,y+=r*H,m+=r*V,I+=r*G,b+=r*q,E+=r*z,w+=r*J,C+=r*W,u+=(r=e[4])*U,l+=r*O,h+=r*F,f+=r*N,d+=r*P,g+=r*Y,A+=r*K,p+=r*R,y+=r*j,m+=r*H,I+=r*V,b+=r*G,E+=r*q,w+=r*z,C+=r*J,v+=r*W,l+=(r=e[5])*U,h+=r*O,f+=r*F,d+=r*N,g+=r*P,A+=r*Y,p+=r*K,y+=r*R,m+=r*j,I+=r*H,b+=r*V,E+=r*G,w+=r*q,C+=r*z,v+=r*J,B+=r*W,h+=(r=e[6])*U,f+=r*O,d+=r*F,g+=r*N,A+=r*P,p+=r*Y,y+=r*K,m+=r*R,I+=r*j,b+=r*H,E+=r*V,w+=r*G,C+=r*q,v+=r*z,B+=r*J,_+=r*W,f+=(r=e[7])*U,d+=r*O,g+=r*F,A+=r*N,p+=r*P,y+=r*Y,m+=r*K,I+=r*R,b+=r*j,E+=r*H,w+=r*V,C+=r*G,v+=r*q,B+=r*z,_+=r*J,k+=r*W,d+=(r=e[8])*U,g+=r*O,A+=r*F,p+=r*N,y+=r*P,m+=r*Y,I+=r*K,b+=r*R,E+=r*j,w+=r*H,C+=r*V,v+=r*G,B+=r*q,_+=r*z,k+=r*J,S+=r*W,g+=(r=e[9])*U,A+=r*O,p+=r*F,y+=r*N,m+=r*P,I+=r*Y,b+=r*K,E+=r*R,w+=r*j,C+=r*H,v+=r*V,B+=r*G,_+=r*q,k+=r*z,S+=r*J,x+=r*W,A+=(r=e[10])*U,p+=r*O,y+=r*F,m+=r*N,I+=r*P,b+=r*Y,E+=r*K,w+=r*R,C+=r*j,v+=r*H,B+=r*V,_+=r*G,k+=r*q,S+=r*z,x+=r*J,Q+=r*W,p+=(r=e[11])*U,y+=r*O,m+=r*F,I+=r*N,b+=r*P,E+=r*Y,w+=r*K,C+=r*R,v+=r*j,B+=r*H,_+=r*V,k+=r*G,S+=r*q,x+=r*z,Q+=r*J,M+=r*W,y+=(r=e[12])*U,m+=r*O,I+=r*F,b+=r*N,E+=r*P,w+=r*Y,C+=r*K,v+=r*R,B+=r*j,_+=r*H,k+=r*V,S+=r*G,x+=r*q,Q+=r*z,M+=r*J,T+=r*W,m+=(r=e[13])*U,I+=r*O,b+=r*F,E+=r*N,w+=r*P,C+=r*Y,v+=r*K,B+=r*R,_+=r*j,k+=r*H,S+=r*V,x+=r*G,Q+=r*q,M+=r*z,T+=r*J,D+=r*W,I+=(r=e[14])*U,b+=r*O,E+=r*F,w+=r*N,C+=r*P,v+=r*Y,B+=r*K,_+=r*R,k+=r*j,S+=r*H,x+=r*V,Q+=r*G,M+=r*q,T+=r*z,D+=r*J,$+=r*W,b+=(r=e[15])*U,s+=38*(w+=r*F),a+=38*(C+=r*N),c+=38*(v+=r*P),u+=38*(B+=r*Y),l+=38*(_+=r*K),h+=38*(k+=r*R),f+=38*(S+=r*j),d+=38*(x+=r*H),g+=38*(Q+=r*V),A+=38*(M+=r*G),p+=38*(T+=r*q),y+=38*(D+=r*z),m+=38*($+=r*J),I+=38*(L+=r*W),i=(r=(i+=38*(E+=r*O))+(o=1)+65535)-65536*(o=Math.floor(r/65536)),s=(r=s+o+65535)-65536*(o=Math.floor(r/65536)),a=(r=a+o+65535)-65536*(o=Math.floor(r/65536)),c=(r=c+o+65535)-65536*(o=Math.floor(r/65536)),u=(r=u+o+65535)-65536*(o=Math.floor(r/65536)),l=(r=l+o+65535)-65536*(o=Math.floor(r/65536)),h=(r=h+o+65535)-65536*(o=Math.floor(r/65536)),f=(r=f+o+65535)-65536*(o=Math.floor(r/65536)),d=(r=d+o+65535)-65536*(o=Math.floor(r/65536)),g=(r=g+o+65535)-65536*(o=Math.floor(r/65536)),A=(r=A+o+65535)-65536*(o=Math.floor(r/65536)),p=(r=p+o+65535)-65536*(o=Math.floor(r/65536)),y=(r=y+o+65535)-65536*(o=Math.floor(r/65536)),m=(r=m+o+65535)-65536*(o=Math.floor(r/65536)),I=(r=I+o+65535)-65536*(o=Math.floor(r/65536)),b=(r=b+o+65535)-65536*(o=Math.floor(r/65536)),i=(r=(i+=o-1+37*(o-1))+(o=1)+65535)-65536*(o=Math.floor(r/65536)),s=(r=s+o+65535)-65536*(o=Math.floor(r/65536)),a=(r=a+o+65535)-65536*(o=Math.floor(r/65536)),c=(r=c+o+65535)-65536*(o=Math.floor(r/65536)),u=(r=u+o+65535)-65536*(o=Math.floor(r/65536)),l=(r=l+o+65535)-65536*(o=Math.floor(r/65536)),h=(r=h+o+65535)-65536*(o=Math.floor(r/65536)),f=(r=f+o+65535)-65536*(o=Math.floor(r/65536)),d=(r=d+o+65535)-65536*(o=Math.floor(r/65536)),g=(r=g+o+65535)-65536*(o=Math.floor(r/65536)),A=(r=A+o+65535)-65536*(o=Math.floor(r/65536)),p=(r=p+o+65535)-65536*(o=Math.floor(r/65536)),y=(r=y+o+65535)-65536*(o=Math.floor(r/65536)),m=(r=m+o+65535)-65536*(o=Math.floor(r/65536)),I=(r=I+o+65535)-65536*(o=Math.floor(r/65536)),b=(r=b+o+65535)-65536*(o=Math.floor(r/65536)),i+=o-1+37*(o-1),t[0]=i,t[1]=s,t[2]=a,t[3]=c,t[4]=u,t[5]=l,t[6]=h,t[7]=f,t[8]=d,t[9]=g,t[10]=A,t[11]=p,t[12]=y,t[13]=m,t[14]=I,t[15]=b}function Uo(t,e){Lo(t,e,e)}function Oo(t,e,n){for(var r,o=~(n-1),i=0;i<16;i++)r=o&(t[i]^e[i]),t[i]^=r,e[i]^=r}function Fo(t){var e,n,r=1;for(e=0;e<16;e++)n=t[e]+r+65535,r=Math.floor(n/65536),t[e]=n-65536*r;t[0]+=r-1+37*(r-1)}var No={gf:Bo,A:function(t,e,n){for(var r=0;r<16;r++)t[r]=e[r]+n[r]},Z:function(t,e,n){for(var r=0;r<16;r++)t[r]=e[r]-n[r]},M:Lo,S:Uo,sel25519:Oo,pack25519:function(t,e){var n,r,o,i=Bo(),s=Bo();for(n=0;n<16;n++)s[n]=e[n];for(Fo(s),Fo(s),Fo(s),r=0;r<2;r++){for(i[0]=s[0]-65517,n=1;n<15;n++)i[n]=s[n]-65535-(i[n-1]>>16&1),i[n-1]&=65535;i[15]=s[15]-32767-(i[14]>>16&1),o=i[15]>>16&1,i[14]&=65535,Oo(s,i,1-o)}for(n=0;n<16;n++)t[2*n]=255&s[n],t[2*n+1]=s[n]>>8},unpack25519:function(t,e){var n;for(n=0;n<16;n++)t[n]=e[2*n]+(e[2*n+1]<<8);t[15]&=32767},inv25519:function(t,e){var n,r=Bo();for(n=0;n<16;n++)r[n]=e[n];for(n=253;n>=0;n--)Uo(r,r),2!==n&&4!==n&&Lo(r,r,e);for(n=0;n<16;n++)t[n]=r[n]},gf0:ko,gf1:So,_9:_o,_121665:xo,D:Qo,D2:Mo,X:To,Y:Do,I:$o};const{_9:Po,_121665:Yo,gf:Ko,inv25519:Ro,pack25519:jo,unpack25519:Ho,sel25519:Vo,A:Go,M:qo,Z:zo,S:Jo}=No;var Wo={crypto_scalarmult:Xo,crypto_scalarmult_base:function(t,e){return Xo(t,e,Po)},crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32};function Xo(t,e,n){Zo(t,32),Zo(e,32),Zo(n,32);var r,o,i=new Uint8Array(32),s=new Float64Array(80),a=Ko(),c=Ko(),u=Ko(),l=Ko(),h=Ko(),f=Ko();for(o=0;o<31;o++)i[o]=e[o];for(i[31]=127&e[31]|64,i[0]&=248,Ho(s,n),o=0;o<16;o++)c[o]=s[o],l[o]=a[o]=u[o]=0;for(a[0]=l[0]=1,o=254;o>=0;--o)r=i[o>>>3]>>>(7&o)&1,Vo(a,c,r),Vo(u,l,r),Go(h,a,u),zo(a,a,u),Go(u,c,l),zo(c,c,l),Jo(l,h),Jo(f,a),qo(a,u,a),qo(u,c,h),Go(h,a,u),zo(a,a,u),Jo(c,a),zo(u,l,f),qo(a,u,Yo),Go(a,a,l),qo(u,u,a),qo(a,l,f),qo(l,c,s),Jo(c,h),Vo(a,c,r),Vo(u,l,r);for(o=0;o<16;o++)s[o+16]=a[o],s[o+32]=u[o],s[o+48]=c[o],s[o+64]=l[o];var d=s.subarray(32),g=s.subarray(16);return Ro(d,d),qo(g,g,d),jo(t,g),0}function Zo(t,e){if(!t||e&&t.length<e)throw new Error("Argument must be a buffer"+(e?" of length "+e:""))}var ti,ei,ni={exports:{}},ri={exports:{}},oi={exports:{}};var ii=cr,si=Pr,ai=null,ci="undefined"!=typeof WebAssembly&&function(){if(ei)return ti;ei=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./blake2b.wat"(e,n){n.exports=t("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")}}),n=e(),r=WebAssembly.compile(n);return ti=async t=>(await WebAssembly.instantiate(await r,t)).exports,ti}()().then((t=>{ai=t})),ui=64,li=[];oi.exports=yi;var hi=oi.exports.BYTES_MIN=16,fi=oi.exports.BYTES_MAX=64;oi.exports.BYTES=32;var di=oi.exports.KEYBYTES_MIN=16,gi=oi.exports.KEYBYTES_MAX=64;oi.exports.KEYBYTES=32;var Ai=oi.exports.SALTBYTES=16,pi=oi.exports.PERSONALBYTES=16;function yi(t,e,n,r,o){if(!(this instanceof yi))return new yi(t,e,n,r,o);if(!ai)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==o&&(ii(t>=hi,"digestLength must be at least "+hi+", was given "+t),ii(t<=fi,"digestLength must be at most "+fi+", was given "+t),null!=e&&(ii(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),ii(e.length>=di,"key must be at least "+di+", was given "+e.length),ii(e.length<=gi,"key must be at least "+gi+", was given "+e.length)),null!=n&&(ii(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),ii(n.length===Ai,"salt must be exactly "+Ai+", was given "+n.length)),null!=r&&(ii(r instanceof Uint8Array,"personal must be Uint8Array or Buffer"),ii(r.length===pi,"personal must be exactly "+pi+", was given "+r.length))),li.length||(li.push(ui),ui+=216),this.digestLength=t,this.finalized=!1,this.pointer=li.pop(),this._memory=new Uint8Array(ai.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=e?e.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),r&&this._memory.set(r,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),ai.blake2b_init(this.pointer,this.digestLength),e&&(this.update(e),this._memory.fill(0,ui,ui+e.length),this._memory[this.pointer+200]=128)}function mi(){}yi.prototype._realloc=function(t){ai.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(ai.memory.buffer)},yi.prototype.update=function(t){return ii(!1===this.finalized,"Hash instance finalized"),ii(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),ui+t.length>this._memory.length&&this._realloc(ui+t.length),this._memory.set(t,ui),ai.blake2b_update(this.pointer,ui,ui+t.length),this},yi.prototype.digest=function(t){if(ii(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,li.push(this.pointer),ai.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return si.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);ii(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var e=0;e<this.digestLength;e++)t[e]=this._memory[this.pointer+128+e];return t},yi.prototype.final=yi.prototype.digest,yi.WASM=ai,yi.SUPPORTED="undefined"!=typeof WebAssembly,yi.ready=function(t){return t||(t=mi),ci?ci.then((()=>t()),t):t(new Error("WebAssembly not supported"))},yi.prototype.ready=yi.ready,yi.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},yi.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)};var Ii=cr,bi=oi.exports;function Ei(t,e,n){var r=t[e]+t[n],o=t[e+1]+t[n+1];r>=4294967296&&o++,t[e]=r,t[e+1]=o}function wi(t,e,n,r){var o=t[e]+n;n<0&&(o+=4294967296);var i=t[e+1]+r;o>=4294967296&&i++,t[e]=o,t[e+1]=i}function Ci(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function vi(t,e,n,r,o,i){var s=Si[o],a=Si[o+1],c=Si[i],u=Si[i+1];Ei(ki,t,e),wi(ki,t,s,a);var l=ki[r]^ki[t],h=ki[r+1]^ki[t+1];ki[r]=h,ki[r+1]=l,Ei(ki,n,r),l=ki[e]^ki[n],h=ki[e+1]^ki[n+1],ki[e]=l>>>24^h<<8,ki[e+1]=h>>>24^l<<8,Ei(ki,t,e),wi(ki,t,c,u),l=ki[r]^ki[t],h=ki[r+1]^ki[t+1],ki[r]=l>>>16^h<<16,ki[r+1]=h>>>16^l<<16,Ei(ki,n,r),l=ki[e]^ki[n],h=ki[e+1]^ki[n+1],ki[e]=h>>>31^l<<1,ki[e+1]=l>>>31^h<<1}var Bi=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),_i=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((function(t){return 2*t}))),ki=new Uint32Array(32),Si=new Uint32Array(32);function xi(t,e){var n=0;for(n=0;n<16;n++)ki[n]=t.h[n],ki[n+16]=Bi[n];for(ki[24]=ki[24]^t.t,ki[25]=ki[25]^t.t/4294967296,e&&(ki[28]=~ki[28],ki[29]=~ki[29]),n=0;n<32;n++)Si[n]=Ci(t.b,4*n);for(n=0;n<12;n++)vi(0,8,16,24,_i[16*n+0],_i[16*n+1]),vi(2,10,18,26,_i[16*n+2],_i[16*n+3]),vi(4,12,20,28,_i[16*n+4],_i[16*n+5]),vi(6,14,22,30,_i[16*n+6],_i[16*n+7]),vi(0,10,20,30,_i[16*n+8],_i[16*n+9]),vi(2,12,22,24,_i[16*n+10],_i[16*n+11]),vi(4,14,16,26,_i[16*n+12],_i[16*n+13]),vi(6,8,18,28,_i[16*n+14],_i[16*n+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^ki[n]^ki[n+16]}var Qi=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function Mi(t,e,n,r){Qi.fill(0),this.b=new Uint8Array(128),this.h=new Uint32Array(16),this.t=0,this.c=0,this.outlen=t,Qi[0]=t,e&&(Qi[1]=e.length),Qi[2]=1,Qi[3]=1,n&&Qi.set(n,32),r&&Qi.set(r,48);for(var o=0;o<16;o++)this.h[o]=Bi[o]^Ci(Qi,4*o);e&&(Ti(this,e),this.c=128)}function Ti(t,e){for(var n=0;n<e.length;n++)128===t.c&&(t.t+=t.c,xi(t,!1),t.c=0),t.b[t.c++]=e[n]}function Di(t){return t<16?"0"+t.toString(16):t.toString(16)}Mi.prototype.update=function(t){return Ii(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),Ti(this,t),this},Mi.prototype.digest=function(t){var e=t&&"binary"!==t&&"hex"!==t?t:new Uint8Array(this.outlen);return Ii(e instanceof Uint8Array,'out must be "binary", "hex", Uint8Array, or Buffer'),Ii(e.length>=this.outlen,"out must have at least outlen bytes of space"),function(t,e){t.t+=t.c;for(;t.c<128;)t.b[t.c++]=0;xi(t,!0);for(var n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(3&n)}(this,e),"hex"===t?function(t){for(var e="",n=0;n<t.length;n++)e+=Di(t[n]);return e}(e):e},Mi.prototype.final=Mi.prototype.digest,Mi.ready=function(t){bi.ready((function(){t()}))};var $i=Mi;ri.exports=function(t,e,n,r,o){return!0!==o&&(Ii(t>=Li,"outlen must be at least "+Li+", was given "+t),Ii(t<=Ui,"outlen must be at most "+Ui+", was given "+t),null!=e&&(Ii(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),Ii(e.length>=Oi,"key must be at least "+Oi+", was given "+e.length),Ii(e.length<=Fi,"key must be at most "+Fi+", was given "+e.length)),null!=n&&(Ii(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Ii(n.length===Ni,"salt must be exactly "+Ni+", was given "+n.length)),null!=r&&(Ii(r instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Ii(r.length===Pi,"personal must be exactly "+Pi+", was given "+r.length))),new $i(t,e,n,r)},ri.exports.ready=function(t){bi.ready((function(){t()}))},ri.exports.WASM_SUPPORTED=bi.SUPPORTED,ri.exports.WASM_LOADED=!1;var Li=ri.exports.BYTES_MIN=16,Ui=ri.exports.BYTES_MAX=64;ri.exports.BYTES=32;var Oi=ri.exports.KEYBYTES_MIN=16,Fi=ri.exports.KEYBYTES_MAX=64;ri.exports.KEYBYTES=32;var Ni=ri.exports.SALTBYTES=16,Pi=ri.exports.PERSONALBYTES=16;bi.ready((function(t){t||(ri.exports.WASM_LOADED=!0,ri.exports=bi)})),function(t){var e=ri.exports;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");t.exports.crypto_generichash_PRIMITIVE="blake2b",t.exports.crypto_generichash_BYTES_MIN=e.BYTES_MIN,t.exports.crypto_generichash_BYTES_MAX=e.BYTES_MAX,t.exports.crypto_generichash_BYTES=e.BYTES,t.exports.crypto_generichash_KEYBYTES_MIN=e.KEYBYTES_MIN,t.exports.crypto_generichash_KEYBYTES_MAX=e.KEYBYTES_MAX,t.exports.crypto_generichash_KEYBYTES=e.KEYBYTES,t.exports.crypto_generichash_WASM_SUPPORTED=e.WASM_SUPPORTED,t.exports.crypto_generichash_WASM_LOADED=!1,t.exports.crypto_generichash=function(t,n,r){e(t.length,r).update(n).final(t)},t.exports.crypto_generichash_ready=e.ready,t.exports.crypto_generichash_batch=function(t,n,r){for(var o=e(t.length,r),i=0;i<n.length;i++)o.update(n[i]);o.final(t)},t.exports.crypto_generichash_instance=function(n,r){return null==r&&(r=t.exports.crypto_generichash_BYTES),e(r,n)},e.ready((function(n){t.exports.crypto_generichash_WASM_LOADED=e.WASM_LOADED}))}(ni);var Yi,Ki,Ri={};var ji="undefined"!=typeof WebAssembly&&function(){if(Ki)return Yi;Ki=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./xsalsa20.wat"(e,n){n.exports=t("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")}}),n=e(),r=new WebAssembly.Module(n);return Yi=t=>new WebAssembly.Instance(r,t).exports,Yi}()(),Hi=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]),Vi=144,Gi=Vi,qi=[],zi=Ji;function Ji(t,e){if(!(this instanceof Ji))return new Ji(t,e);if(!t||t.length<24)throw new Error("nonce must be at least 24 bytes");if(!e||e.length<32)throw new Error("key must be at least 32 bytes");this._xor=ji?new Wi(t,e):new Xi(t,e)}function Wi(t,e){qi.length||(qi.push(Vi),Vi+=64),this._pointer=qi.pop(),this._nonce=this._pointer+8,this._key=this._nonce+24,this._overflow=0,this._memory=new Uint8Array(ji.memory.buffer),this._memory.fill(0,this._pointer,this._pointer+8),this._memory.set(t,this._nonce),this._memory.set(e,this._key)}function Xi(t,e){this._s=new Uint8Array(32),this._z=new Uint8Array(16),this._overflow=0,ts(this._s,t,e,Hi);for(var n=0;n<8;n++)this._z[n]=t[n+16]}function Zi(t,e,n,r){for(var o,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,u=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,l=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,f=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,d=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,g=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,A=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,p=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,m=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,I=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,b=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,E=i,w=s,C=a,v=c,B=u,_=l,k=h,S=f,x=d,Q=g,M=A,T=p,D=y,$=m,L=I,U=b,O=0;O<20;O+=2)E^=(o=(D^=(o=(x^=(o=(B^=(o=E+D|0)<<7|o>>>25)+E|0)<<9|o>>>23)+B|0)<<13|o>>>19)+x|0)<<18|o>>>14,_^=(o=(w^=(o=($^=(o=(Q^=(o=_+w|0)<<7|o>>>25)+_|0)<<9|o>>>23)+Q|0)<<13|o>>>19)+$|0)<<18|o>>>14,M^=(o=(k^=(o=(C^=(o=(L^=(o=M+k|0)<<7|o>>>25)+M|0)<<9|o>>>23)+L|0)<<13|o>>>19)+C|0)<<18|o>>>14,U^=(o=(T^=(o=(S^=(o=(v^=(o=U+T|0)<<7|o>>>25)+U|0)<<9|o>>>23)+v|0)<<13|o>>>19)+S|0)<<18|o>>>14,E^=(o=(v^=(o=(C^=(o=(w^=(o=E+v|0)<<7|o>>>25)+E|0)<<9|o>>>23)+w|0)<<13|o>>>19)+C|0)<<18|o>>>14,_^=(o=(B^=(o=(S^=(o=(k^=(o=_+B|0)<<7|o>>>25)+_|0)<<9|o>>>23)+k|0)<<13|o>>>19)+S|0)<<18|o>>>14,M^=(o=(Q^=(o=(x^=(o=(T^=(o=M+Q|0)<<7|o>>>25)+M|0)<<9|o>>>23)+T|0)<<13|o>>>19)+x|0)<<18|o>>>14,U^=(o=(L^=(o=($^=(o=(D^=(o=U+L|0)<<7|o>>>25)+U|0)<<9|o>>>23)+D|0)<<13|o>>>19)+$|0)<<18|o>>>14;E=E+i|0,w=w+s|0,C=C+a|0,v=v+c|0,B=B+u|0,_=_+l|0,k=k+h|0,S=S+f|0,x=x+d|0,Q=Q+g|0,M=M+A|0,T=T+p|0,D=D+y|0,$=$+m|0,L=L+I|0,U=U+b|0,t[0]=E>>>0&255,t[1]=E>>>8&255,t[2]=E>>>16&255,t[3]=E>>>24&255,t[4]=w>>>0&255,t[5]=w>>>8&255,t[6]=w>>>16&255,t[7]=w>>>24&255,t[8]=C>>>0&255,t[9]=C>>>8&255,t[10]=C>>>16&255,t[11]=C>>>24&255,t[12]=v>>>0&255,t[13]=v>>>8&255,t[14]=v>>>16&255,t[15]=v>>>24&255,t[16]=B>>>0&255,t[17]=B>>>8&255,t[18]=B>>>16&255,t[19]=B>>>24&255,t[20]=_>>>0&255,t[21]=_>>>8&255,t[22]=_>>>16&255,t[23]=_>>>24&255,t[24]=k>>>0&255,t[25]=k>>>8&255,t[26]=k>>>16&255,t[27]=k>>>24&255,t[28]=S>>>0&255,t[29]=S>>>8&255,t[30]=S>>>16&255,t[31]=S>>>24&255,t[32]=x>>>0&255,t[33]=x>>>8&255,t[34]=x>>>16&255,t[35]=x>>>24&255,t[36]=Q>>>0&255,t[37]=Q>>>8&255,t[38]=Q>>>16&255,t[39]=Q>>>24&255,t[40]=M>>>0&255,t[41]=M>>>8&255,t[42]=M>>>16&255,t[43]=M>>>24&255,t[44]=T>>>0&255,t[45]=T>>>8&255,t[46]=T>>>16&255,t[47]=T>>>24&255,t[48]=D>>>0&255,t[49]=D>>>8&255,t[50]=D>>>16&255,t[51]=D>>>24&255,t[52]=$>>>0&255,t[53]=$>>>8&255,t[54]=$>>>16&255,t[55]=$>>>24&255,t[56]=L>>>0&255,t[57]=L>>>8&255,t[58]=L>>>16&255,t[59]=L>>>24&255,t[60]=U>>>0&255,t[61]=U>>>8&255,t[62]=U>>>16&255,t[63]=U>>>24&255}function ts(t,e,n,r){for(var o,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,u=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,l=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,f=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,d=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,g=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,A=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,p=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,m=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,I=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,b=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,E=0;E<20;E+=2)i^=(o=(y^=(o=(d^=(o=(u^=(o=i+y|0)<<7|o>>>25)+i|0)<<9|o>>>23)+u|0)<<13|o>>>19)+d|0)<<18|o>>>14,l^=(o=(s^=(o=(m^=(o=(g^=(o=l+s|0)<<7|o>>>25)+l|0)<<9|o>>>23)+g|0)<<13|o>>>19)+m|0)<<18|o>>>14,A^=(o=(h^=(o=(a^=(o=(I^=(o=A+h|0)<<7|o>>>25)+A|0)<<9|o>>>23)+I|0)<<13|o>>>19)+a|0)<<18|o>>>14,b^=(o=(p^=(o=(f^=(o=(c^=(o=b+p|0)<<7|o>>>25)+b|0)<<9|o>>>23)+c|0)<<13|o>>>19)+f|0)<<18|o>>>14,i^=(o=(c^=(o=(a^=(o=(s^=(o=i+c|0)<<7|o>>>25)+i|0)<<9|o>>>23)+s|0)<<13|o>>>19)+a|0)<<18|o>>>14,l^=(o=(u^=(o=(f^=(o=(h^=(o=l+u|0)<<7|o>>>25)+l|0)<<9|o>>>23)+h|0)<<13|o>>>19)+f|0)<<18|o>>>14,A^=(o=(g^=(o=(d^=(o=(p^=(o=A+g|0)<<7|o>>>25)+A|0)<<9|o>>>23)+p|0)<<13|o>>>19)+d|0)<<18|o>>>14,b^=(o=(I^=(o=(m^=(o=(y^=(o=b+I|0)<<7|o>>>25)+b|0)<<9|o>>>23)+y|0)<<13|o>>>19)+m|0)<<18|o>>>14;t[0]=i>>>0&255,t[1]=i>>>8&255,t[2]=i>>>16&255,t[3]=i>>>24&255,t[4]=l>>>0&255,t[5]=l>>>8&255,t[6]=l>>>16&255,t[7]=l>>>24&255,t[8]=A>>>0&255,t[9]=A>>>8&255,t[10]=A>>>16&255,t[11]=A>>>24&255,t[12]=b>>>0&255,t[13]=b>>>8&255,t[14]=b>>>16&255,t[15]=b>>>24&255,t[16]=h>>>0&255,t[17]=h>>>8&255,t[18]=h>>>16&255,t[19]=h>>>24&255,t[20]=f>>>0&255,t[21]=f>>>8&255,t[22]=f>>>16&255,t[23]=f>>>24&255,t[24]=d>>>0&255,t[25]=d>>>8&255,t[26]=d>>>16&255,t[27]=d>>>24&255,t[28]=g>>>0&255,t[29]=g>>>8&255,t[30]=g>>>16&255,t[31]=g>>>24&255}if(Ji.NONCEBYTES=24,Ji.KEYBYTES=32,Ji.core_hsalsa20=ts,Ji.SIGMA=Hi,Ji.prototype.update=function(t,e){if(!t)throw new Error("input must be Uint8Array or Buffer");return e||(e=new Uint8Array(t.length)),t.length&&this._xor.update(t,e),e},Ji.prototype.final=Ji.prototype.finalize=function(){this._xor.finalize(),this._xor=null},Wi.prototype.realloc=function(t){ji.memory.grow(Math.ceil(Math.abs(t-this._memory.length)/65536)),this._memory=new Uint8Array(ji.memory.buffer)},Wi.prototype.update=function(t,e){var n=this._overflow+t.length,r=Vi+this._overflow;(Gi=Vi+n)>=this._memory.length&&this.realloc(Gi),this._memory.set(t,r),ji.xsalsa20_xor(this._pointer,Vi,Vi,n,this._nonce,this._key),e.set(this._memory.subarray(r,Vi+n)),this._overflow=63&n},Wi.prototype.finalize=function(){this._memory.fill(0,this._pointer,this._key+32),Gi>Vi&&(this._memory.fill(0,Vi,Gi),Gi=0),qi.push(this._pointer)},Xi.prototype.update=function(t,e){for(var n=new Uint8Array(64),r=0,o=this._overflow,i=t.length+this._overflow,s=this._z,a=-this._overflow,c=-this._overflow;i>=64;){for(Zi(n,s,this._s,Hi);o<64;o++)e[c+o]=t[a+o]^n[o];for(r=1,o=8;o<16;o++)r+=255&s[o]|0,s[o]=255&r,r>>>=8;i-=64,c+=64,a+=64,o=0}if(i>0)for(Zi(n,s,this._s,Hi);o<i;o++)e[c+o]=t[a+o]^n[o];this._overflow=63&i},Xi.prototype.finalize=function(){this._s.fill(0),this._z.fill(0)},function(t){const e=zi;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");function n(t,n){this._instance=e(t,n)}t.crypto_stream_KEYBYTES=32,t.crypto_stream_NONCEBYTES=24,t.crypto_stream_PRIMITIVE="xsalsa20",t.crypto_stream_xsalsa20_MESSAGEBYTES_MAX=Number.MAX_SAFE_INTEGER,t.crypto_stream=function(e,n,r){e.fill(0),t.crypto_stream_xor(e,e,n,r)},t.crypto_stream_xor=function(t,n,r,o){const i=e(r,o);i.update(n,t),i.final()},t.crypto_stream_xor_instance=function(t,e){return new n(t,e)},n.prototype.update=function(t,e){this._instance.update(e,t)},n.prototype.final=function(){this._instance.finalize(),this._instance=null}}(Ri),1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var es=function(t){var e,n,r,o,i,s,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,e=255&t[0]|(255&t[1])<<8,this.r[0]=8191&e,n=255&t[2]|(255&t[3])<<8,this.r[1]=8191&(e>>>13|n<<3),r=255&t[4]|(255&t[5])<<8,this.r[2]=7939&(n>>>10|r<<6),o=255&t[6]|(255&t[7])<<8,this.r[3]=8191&(r>>>7|o<<9),i=255&t[8]|(255&t[9])<<8,this.r[4]=255&(o>>>4|i<<12),this.r[5]=i>>>1&8190,s=255&t[10]|(255&t[11])<<8,this.r[6]=8191&(i>>>14|s<<2),a=255&t[12]|(255&t[13])<<8,this.r[7]=8065&(s>>>11|a<<5),c=255&t[14]|(255&t[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&t[16]|(255&t[17])<<8,this.pad[1]=255&t[18]|(255&t[19])<<8,this.pad[2]=255&t[20]|(255&t[21])<<8,this.pad[3]=255&t[22]|(255&t[23])<<8,this.pad[4]=255&t[24]|(255&t[25])<<8,this.pad[5]=255&t[26]|(255&t[27])<<8,this.pad[6]=255&t[28]|(255&t[29])<<8,this.pad[7]=255&t[30]|(255&t[31])<<8};es.prototype.blocks=function(t,e,n){for(var r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w=this.fin?0:2048,C=this.h[0],v=this.h[1],B=this.h[2],_=this.h[3],k=this.h[4],S=this.h[5],x=this.h[6],Q=this.h[7],M=this.h[8],T=this.h[9],D=this.r[0],$=this.r[1],L=this.r[2],U=this.r[3],O=this.r[4],F=this.r[5],N=this.r[6],P=this.r[7],Y=this.r[8],K=this.r[9];n>=16;)f=h=0,f+=(C+=8191&(r=255&t[e+0]|(255&t[e+1])<<8))*D,f+=(v+=8191&(r>>>13|(o=255&t[e+2]|(255&t[e+3])<<8)<<3))*(5*K),f+=(B+=8191&(o>>>10|(i=255&t[e+4]|(255&t[e+5])<<8)<<6))*(5*Y),f+=(_+=8191&(i>>>7|(s=255&t[e+6]|(255&t[e+7])<<8)<<9))*(5*P),h=(f+=(k+=8191&(s>>>4|(a=255&t[e+8]|(255&t[e+9])<<8)<<12))*(5*N))>>>13,f&=8191,f+=(S+=a>>>1&8191)*(5*F),f+=(x+=8191&(a>>>14|(c=255&t[e+10]|(255&t[e+11])<<8)<<2))*(5*O),f+=(Q+=8191&(c>>>11|(u=255&t[e+12]|(255&t[e+13])<<8)<<5))*(5*U),f+=(M+=8191&(u>>>8|(l=255&t[e+14]|(255&t[e+15])<<8)<<8))*(5*L),d=h+=(f+=(T+=l>>>5|w)*(5*$))>>>13,d+=C*$,d+=v*D,d+=B*(5*K),d+=_*(5*Y),h=(d+=k*(5*P))>>>13,d&=8191,d+=S*(5*N),d+=x*(5*F),d+=Q*(5*O),d+=M*(5*U),h+=(d+=T*(5*L))>>>13,d&=8191,g=h,g+=C*L,g+=v*$,g+=B*D,g+=_*(5*K),h=(g+=k*(5*Y))>>>13,g&=8191,g+=S*(5*P),g+=x*(5*N),g+=Q*(5*F),g+=M*(5*O),A=h+=(g+=T*(5*U))>>>13,A+=C*U,A+=v*L,A+=B*$,A+=_*D,h=(A+=k*(5*K))>>>13,A&=8191,A+=S*(5*Y),A+=x*(5*P),A+=Q*(5*N),A+=M*(5*F),p=h+=(A+=T*(5*O))>>>13,p+=C*O,p+=v*U,p+=B*L,p+=_*$,h=(p+=k*D)>>>13,p&=8191,p+=S*(5*K),p+=x*(5*Y),p+=Q*(5*P),p+=M*(5*N),y=h+=(p+=T*(5*F))>>>13,y+=C*F,y+=v*O,y+=B*U,y+=_*L,h=(y+=k*$)>>>13,y&=8191,y+=S*D,y+=x*(5*K),y+=Q*(5*Y),y+=M*(5*P),m=h+=(y+=T*(5*N))>>>13,m+=C*N,m+=v*F,m+=B*O,m+=_*U,h=(m+=k*L)>>>13,m&=8191,m+=S*$,m+=x*D,m+=Q*(5*K),m+=M*(5*Y),I=h+=(m+=T*(5*P))>>>13,I+=C*P,I+=v*N,I+=B*F,I+=_*O,h=(I+=k*U)>>>13,I&=8191,I+=S*L,I+=x*$,I+=Q*D,I+=M*(5*K),b=h+=(I+=T*(5*Y))>>>13,b+=C*Y,b+=v*P,b+=B*N,b+=_*F,h=(b+=k*O)>>>13,b&=8191,b+=S*U,b+=x*L,b+=Q*$,b+=M*D,E=h+=(b+=T*(5*K))>>>13,E+=C*K,E+=v*Y,E+=B*P,E+=_*N,h=(E+=k*F)>>>13,E&=8191,E+=S*O,E+=x*U,E+=Q*L,E+=M*$,C=f=8191&(h=(h=((h+=(E+=T*D)>>>13)<<2)+h|0)+(f&=8191)|0),v=d+=h>>>=13,B=g&=8191,_=A&=8191,k=p&=8191,S=y&=8191,x=m&=8191,Q=I&=8191,M=b&=8191,T=E&=8191,e+=16,n-=16;this.h[0]=C,this.h[1]=v,this.h[2]=B,this.h[3]=_,this.h[4]=k,this.h[5]=S,this.h[6]=x,this.h[7]=Q,this.h[8]=M,this.h[9]=T},es.prototype.finish=function(t,e){var n,r,o,i,s=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=n,n=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,s[0]=this.h[0]+5,n=s[0]>>>13,s[0]&=8191,i=1;i<10;i++)s[i]=this.h[i]+n,n=s[i]>>>13,s[i]&=8191;for(s[9]-=8192,r=(1^n)-1,i=0;i<10;i++)s[i]&=r;for(r=~r,i=0;i<10;i++)this.h[i]=this.h[i]&r|s[i];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),o=this.h[0]+this.pad[0],this.h[0]=65535&o,i=1;i<8;i++)o=(this.h[i]+this.pad[i]|0)+(o>>>16)|0,this.h[i]=65535&o;t[e+0]=this.h[0]>>>0&255,t[e+1]=this.h[0]>>>8&255,t[e+2]=this.h[1]>>>0&255,t[e+3]=this.h[1]>>>8&255,t[e+4]=this.h[2]>>>0&255,t[e+5]=this.h[2]>>>8&255,t[e+6]=this.h[3]>>>0&255,t[e+7]=this.h[3]>>>8&255,t[e+8]=this.h[4]>>>0&255,t[e+9]=this.h[4]>>>8&255,t[e+10]=this.h[5]>>>0&255,t[e+11]=this.h[5]>>>8&255,t[e+12]=this.h[6]>>>0&255,t[e+13]=this.h[6]>>>8&255,t[e+14]=this.h[7]>>>0&255,t[e+15]=this.h[7]>>>8&255},es.prototype.update=function(t,e,n){var r,o;if(this.leftover){for((o=16-this.leftover)>n&&(o=n),r=0;r<o;r++)this.buffer[this.leftover+r]=t[e+r];if(n-=o,e+=o,this.leftover+=o,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(n>=16&&(o=n-n%16,this.blocks(t,e,o),e+=o,n-=o),n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=t[e+r];this.leftover+=n}};var ns=es;const rs=cr,os=ns,{crypto_verify_16:is}=fr.exports;var ss={crypto_onetimeauth:as,crypto_onetimeauth_verify:function(t,e,n){rs(16===t.byteLength,"mac must be 'crypto_onetimeauth_BYTES' bytes"),rs(null!=e.byteLength,"msg must be buffer"),rs(32===n.byteLength,"key must be 'crypto_onetimeauth_KEYBYTES' bytes");var r=new Uint8Array(16);return as(r,e,n),is(t,0,r,0)},crypto_onetimeauth_BYTES:16,crypto_onetimeauth_KEYBYTES:32,crypto_onetimeauth_PRIMITIVE:"poly1305"};function as(t,e,n){rs(16===t.byteLength,"mac must be 'crypto_onetimeauth_BYTES' bytes"),rs(null!=e.byteLength,"msg must be buffer"),rs(32===n.byteLength,"key must be 'crypto_onetimeauth_KEYBYTES' bytes");var r=new os(n);r.update(e,0,e.byteLength),r.finish(t,0)}const cs=cr,{crypto_stream:us,crypto_stream_xor:ls}=Ri,{crypto_onetimeauth:hs,crypto_onetimeauth_verify:fs,crypto_onetimeauth_BYTES:ds,crypto_onetimeauth_KEYBYTES:gs}=ss,As=32,ps=24,ys=32,ms=16;var Is={crypto_secretbox:bs,crypto_secretbox_open:Es,crypto_secretbox_detached:function(t,e,n,r,o){cs(t.byteLength===n.byteLength,"o must be 'msg.byteLength' bytes"),cs(16===e.byteLength,"mac must be 'crypto_secretbox_MACBYTES' bytes"),cs(r.byteLength===ps,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),cs(o.byteLength===As,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(n.byteLength+e.byteLength);return ws(i,n,r,o),e.set(i.subarray(0,e.byteLength)),t.set(i.subarray(e.byteLength)),!0},crypto_secretbox_open_detached:function(t,e,n,r,o){cs(e.byteLength===t.byteLength,"o must be 'msg.byteLength' bytes"),cs(16===n.byteLength,"mac must be 'crypto_secretbox_MACBYTES' bytes"),cs(r.byteLength===ps,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),cs(o.byteLength===As,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(e.byteLength+n.byteLength);return i.set(n),i.set(e,n.byteLength),Cs(t,i,r,o)},crypto_secretbox_easy:ws,crypto_secretbox_open_easy:Cs,crypto_secretbox_KEYBYTES:As,crypto_secretbox_NONCEBYTES:ps,crypto_secretbox_ZEROBYTES:ys,crypto_secretbox_BOXZEROBYTES:ms,crypto_secretbox_MACBYTES:16};function bs(t,e,n,r){cs(t.byteLength===e.byteLength,"c must be 'm.byteLength' bytes");const o=e.byteLength;cs(o>=ys,"mlen must be at least 'crypto_secretbox_ZEROBYTES'"),cs(n.byteLength===ps,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),cs(r.byteLength===As,"k must be 'crypto_secretbox_KEYBYTES' bytes"),ls(t,e,n,r),hs(t.subarray(ms,ms+ds),t.subarray(ms+ds,t.byteLength),t.subarray(0,gs)),t.fill(0,0,ms)}function Es(t,e,n,r){cs(e.byteLength===t.byteLength,"c must be 'm.byteLength' bytes");const o=t.byteLength;cs(o>=ys,"mlen must be at least 'crypto_secretbox_ZEROBYTES'"),cs(n.byteLength===ps,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),cs(r.byteLength===As,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(gs);us(i,n,r);return!1!==fs(e.subarray(ms,ms+ds),e.subarray(ms+ds,e.byteLength),i)&&(ls(t,e,n,r),t.fill(0,0,32),!0)}function ws(t,e,n,r){cs(t.byteLength===e.byteLength+16,"o must be 'msg.byteLength + crypto_secretbox_MACBYTES' bytes"),cs(n.byteLength===ps,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),cs(r.byteLength===As,"k must be 'crypto_secretbox_KEYBYTES' bytes");const o=new Uint8Array(ys+e.byteLength),i=new Uint8Array(o.byteLength);o.set(e,ys),bs(i,o,n,r),t.set(i.subarray(ms))}function Cs(t,e,n,r){cs(e.byteLength===t.byteLength+16,"box must be 'msg.byteLength + crypto_secretbox_MACBYTES' bytes"),cs(n.byteLength===ps,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),cs(r.byteLength===As,"k must be 'crypto_secretbox_KEYBYTES' bytes");const o=new Uint8Array(ms+e.byteLength),i=new Uint8Array(o.byteLength);return o.set(e,ms),!1!==Es(i,o,n,r)&&(t.set(i.subarray(ys)),!0)}const{crypto_hash_sha512:vs}=vo,{crypto_scalarmult:Bs,crypto_scalarmult_base:_s}=Wo,{randombytes:ks}=ar.exports,{crypto_generichash_batch:Ss}=ni.exports,{crypto_stream_xsalsa20_MESSAGEBYTES_MAX:xs}=Ri,{crypto_secretbox_open_easy:Qs,crypto_secretbox_easy:Ms,crypto_secretbox_detached:Ts,crypto_secretbox_open_detached:Ds}=Is,$s=zi,Ls=cr,Us=32,Os=32,Fs=16,Ns=xs-16;var Ps={crypto_box_easy:function(t,e,n,r,o){return Ls(t.length>=e.length+Fs,"c should be at least 'm.length + crypto_box_MACBYTES' bytes"),Ls(e.length<=Ns,"m should be at most 'crypto_box_MESSAGEBYTES_MAX' bytes"),Rs(t.subarray(Fs,e.length+Fs),t.subarray(0,Fs),e,n,r,o)},crypto_box_open_easy:function(t,e,n,r,o){return Ls(e.length>=t.length+Fs,"c should be at least 'm.length + crypto_box_MACBYTES' bytes"),js(t,e.subarray(Fs,t.length+Fs),e.subarray(0,Fs),n,r,o)},crypto_box_keypair:Ys,crypto_box_seed_keypair:function(t,e,n){Ls(t.byteLength===Us,"pk should be 'crypto_box_PUBLICKEYBYTES' bytes"),Ls(e.byteLength===Os,"sk should be 'crypto_box_SECRETKEYBYTES' bytes"),Ls(32===e.byteLength,"sk should be 'crypto_box_SEEDBYTES' bytes");const r=new Uint8Array(64);return vs(r,n,32),e.set(r.subarray(0,32)),r.fill(0),_s(t,e)},crypto_box_seal:function(t,e,n){Hs(t,48+e.length),Hs(n,Us);var r=t.subarray(0,Us),o=new Uint8Array(Os);Ys(r,o);var i=new Uint8Array(24);Ss(i,[r,n]);var s=new Uint8Array(Us);Bs(s,o,n);var a=new Uint8Array(32),c=new Uint8Array(16);$s.core_hsalsa20(a,c,s,$s.SIGMA),Ms(t.subarray(r.length),e,i,a),Vs(o)},crypto_box_seal_open:function(t,e,n,r){Hs(e,48),Hs(t,e.length-48),Hs(n,Us),Hs(r,Os);var o=e.subarray(0,Us),i=new Uint8Array(24);Ss(i,[o,n]);var s=new Uint8Array(Us);Bs(s,r,o);var a=new Uint8Array(32),c=new Uint8Array(16);return $s.core_hsalsa20(a,c,s,$s.SIGMA),Qs(t,e.subarray(o.length),i,a)},crypto_box_PUBLICKEYBYTES:Us,crypto_box_SECRETKEYBYTES:Os,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_box_SEALBYTES:48,crypto_box_SEEDBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_MACBYTES:Fs};function Ys(t,e){return Hs(t,Us),Hs(e,Os),ks(e,32),_s(t,e)}function Ks(t,e,n){const r=new Uint8Array(16),o=new Uint8Array(32);return Ls(0===Bs(o,n,e)),$s.core_hsalsa20(t,r,o,$s.SIGMA),!0}function Rs(t,e,n,r,o,i){Hs(e,Fs),Hs(r,24),Hs(o,Us),Hs(i,Os);const s=new Uint8Array(32);Ls(Ks(s,o,i));const a=function(t,e,n,r,o){return Ts(t,e,n,r,o)}(t,e,n,r,s);return Vs(s),a}function js(t,e,n,r,o,i){const s=new Uint8Array(32);Ls(Ks(s,o,i));const a=function(t,e,n,r,o){return Ds(t,e,n,r,o)}(t,e,n,r,s);return Vs(s),a}function Hs(t,e){if(!t||e&&t.length<e)throw new Error("Argument must be a buffer"+(e?" of length "+e:""))}function Vs(t){for(let e=0;e<t.length;e++)t[e]=0}var Gs={exports:{}},qs={exports:{}};const zs=cr,Js=Pr;qs.exports=ea;const Ws=qs.exports.SHA256_BYTES=32,Xs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Zs(t,e,n,r){return((t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+e+(((n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3)+r)<<0}function ta(t,e){var n,r,o,[i,s,a,c,u,l,h,f]=t;const d=new Uint32Array(64);for(let t=0;t<16;t++)d[t]=ra(e[t]);for(let t=16;t<64;t++)d[t]=Zs(d[t-2],d[t-7],d[t-15],d[t-16]);for(let t=0;t<64;t+=4)g(t);function g(t){n=i&s^i&a^s&a,r=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),o=f+(u&l^~u&h)+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+d[t]+Xs[t],f=c+o,n=(c=o+(r+n))&i^c&s^i&s,r=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),o=h+(f&u^~f&l)+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+d[t+1]+Xs[t+1],h=a+o,n=(a=o+(r+n))&c^a&i^c&i,r=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),o=l+(h&f^~h&u)+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+d[t+2]+Xs[t+2],l=s+o,n=(s=o+(r+n))&a^s&c^a&c,r=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),o=u+(l&h^~l&f)+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+d[t+3]+Xs[t+3],u=i+o,i=o+(r+n)}t[0]=t[0]+i,t[1]=t[1]+s,t[2]=t[2]+a,t[3]=t[3]+c,t[4]=t[4]+u,t[5]=t[5]+l,t[6]=t[6]+h,t[7]=t[7]+f}function ea(){return this instanceof ea?(this.buffer=new ArrayBuffer(64),this.bytesRead=0,this.pos=0,this.digestLength=Ws,this.finalised=!1,this.load=new Uint8Array(this.buffer),this.words=new Uint32Array(this.buffer),this.state=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),this):new ea}function na(t){if(!(this instanceof na))return new na(t);this.pad=Js.alloc(64),this.inner=ea(),this.outer=ea();const e=Js.alloc(32);t.byteLength>64&&(ea().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}function ra(t){return(16711935&t)>>>8|(16711935&t)<<24|((4278255360&t)<<8|(4278255360&t)>>>24)}ea.prototype.update=function(t,e){zs(!1===this.finalised,"Hash instance finalised");var[n,r]=function(t,e){var n=Js.from(t,e);return[n,n.byteLength]}(t,e),o=0;for(this.bytesRead+=r;r>0&&(this.load.set(n.subarray(o,o+64-this.pos),this.pos),o+=64-this.pos,!((r-=64-this.pos)<0));)this.pos=0,ta(this.state,this.words);return this.pos=63&this.bytesRead,this.load.fill(0,this.pos),this},ea.prototype.digest=function(t,e=0){zs(!1===this.finalised,"Hash instance finalised"),this.finalised=!0,this.load.fill(0,this.pos),this.load[this.pos]=128,this.pos>55&&(ta(this.state,this.words),this.words.fill(0),this.pos=0);const n=new DataView(this.buffer);n.setUint32(56,this.bytesRead/2**29),n.setUint32(60,this.bytesRead<<3),ta(this.state,this.words);const r=new Uint8Array(this.state.map(ra).buffer);if(!t)return new Uint8Array(r);if("string"==typeof t)return Js.toString(r,t);zs(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),zs(t.byteLength>=this.digestLength+e,"input not large enough for digest");for(let n=0;n<this.digestLength;n++)t[n+e]=r[n];return t},na.prototype.update=function(t,e){return this.inner.update(t,e),this},na.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},ea.HMAC=na;var oa,ia,sa={exports:{}};const aa=cr,ca=Pr,ua="undefined"!=typeof WebAssembly&&function(){if(ia)return oa;ia=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./sha256.wat"(e,n){n.exports=t("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")}}),n=e(),r=new WebAssembly.Module(n);return oa=t=>new WebAssembly.Instance(r,t).exports,oa}()({imports:{debug:{log(...t){console.log(...t.map((t=>(t>>>0).toString(16).padStart(8,"0"))))},log_tee:t=>(console.log((t>>>0).toString(16).padStart(8,"0")),t)}}});let la=0;const ha=[];sa.exports=da;const fa=sa.exports.SHA256_BYTES=32;function da(){if(!(this instanceof da))return new da;if(!ua)throw new Error("WASM not loaded. Wait for Sha256.ready(cb)");ha.length||(ha.push(la),la+=108),this.finalized=!1,this.digestLength=fa,this.pointer=ha.pop(),this.pos=0,this._memory=new Uint8Array(ua.memory.buffer),this._memory.fill(0,this.pointer,this.pointer+108),this.pointer+this.digestLength>this._memory.length&&this._realloc(this.pointer+108)}function ga(t){if(!(this instanceof ga))return new ga(t);this.pad=ca.alloc(64),this.inner=da(),this.outer=da();const e=ca.alloc(32);t.byteLength>64&&(da().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}function Aa(){}da.prototype._realloc=function(t){ua.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(ua.memory.buffer)},da.prototype.update=function(t,e){aa(!1===this.finalized,"Hash instance finalized"),la%4!=0&&(la+=4-la%4),aa(la%4==0,"input shoud be aligned for int32");const[n,r]=function(t,e){var n=ca.from(t,e);return[n,n.byteLength]}(t,e);return aa(n instanceof Uint8Array,"input must be Uint8Array or Buffer"),la+r>this._memory.length&&this._realloc(la+t.length),this._memory.fill(0,la,la+function(t,e){return t+e-1&-e}(r,64)-64),this._memory.set(n.subarray(0,64-this.pos),this.pointer+40+this.pos),this._memory.set(n.subarray(64-this.pos),la),this.pos=this.pos+r&63,ua.sha256(this.pointer,la,r,0),this},da.prototype.digest=function(t,e=0){aa(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,ha.push(this.pointer);const n=this.pointer+40+this.pos;this._memory.fill(0,n,this.pointer+40+64),ua.sha256(this.pointer,la,0,1);const r=this._memory.subarray(this.pointer,this.pointer+this.digestLength);if(!t)return r;if("string"==typeof t)return ca.toString(r,t);aa(t instanceof Uint8Array,"output must be Uint8Array or Buffer"),aa(t.byteLength>=this.digestLength+e,"output must have at least 'SHA256_BYTES' bytes remaining");for(let n=0;n<this.digestLength;n++)t[n+e]=r[n];return t},da.WASM=ua,da.WASM_SUPPORTED="undefined"!=typeof WebAssembly,da.ready=function(t){return t||(t=Aa),ua?(t(),Promise.resolve()):t(new Error("WebAssembly not supported"))},da.prototype.ready=da.ready,ga.prototype.update=function(t,e){return this.inner.update(t,e),this},ga.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},da.HMAC=ga;const pa=qs.exports,ya=sa.exports;var ma=pa;Gs.exports=function(){return new ma},Gs.exports.ready=function(t){ya.ready((function(){t()}))},Gs.exports.WASM_SUPPORTED=ya.WASM_SUPPORTED,Gs.exports.WASM_LOADED=!1,Gs.exports.SHA256_BYTES=32,ya.ready((function(t){t||(Gs.exports.WASM_LOADED=!0,Gs.exports=ma=ya)}));const Ia=Gs.exports,ba=cr;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var Ea={crypto_hash_sha256:function(t,e,n){return ba(32===t.byteLength,"out must be 'crypto_hash_sha256_BYTES' bytes long"),Ia().update(e.subarray(0,n)).digest(t),0},crypto_hash_sha256_BYTES:32},wa={exports:{}};!function(t){const e=cr,n=ar.exports.randombytes_buf,r=ri.exports;t.exports.crypto_kdf_PRIMITIVE="blake2b",t.exports.crypto_kdf_BYTES_MIN=16,t.exports.crypto_kdf_BYTES_MAX=64,t.exports.crypto_kdf_CONTEXTBYTES=8,t.exports.crypto_kdf_KEYBYTES=32,t.exports.crypto_kdf_derive_from_key=function(n,o,i,s){e(n.length>=t.exports.crypto_kdf_BYTES_MIN,"subkey must be at least crypto_kdf_BYTES_MIN"),e(o>=0&&o<=9007199254740991,"subkey_id must be safe integer"),e(i.length>=t.exports.crypto_kdf_CONTEXTBYTES,"context must be at least crypto_kdf_CONTEXTBYTES");var a=new Uint8Array(r.PERSONALBYTES),c=new Uint8Array(r.SALTBYTES);a.set(i,0,t.exports.crypto_kdf_CONTEXTBYTES),function(t,e){var n=1,r=0;for(t[0]=255&e;++r<8&&(n*=256);)t[r]=e/n&255}(c,o);var u=Math.min(n.length,t.exports.crypto_kdf_BYTES_MAX);r(u,s.subarray(0,t.exports.crypto_kdf_KEYBYTES),c,a,!0).final(n)},t.exports.crypto_kdf_keygen=function(r){e(r.length>=t.exports.crypto_kdf_KEYBYTES,"out.length must be crypto_kdf_KEYBYTES"),n(r.subarray(0,t.exports.crypto_kdf_KEYBYTES))}}(wa);const{crypto_scalarmult_base:Ca}=Wo,{crypto_generichash:va}=ni.exports,{randombytes_buf:Ba}=ar.exports,_a=cr;var ka={crypto_kx_keypair:function(t,e){return _a(32===t.byteLength,"pk must be 'crypto_kx_PUBLICKEYBYTES' bytes"),_a(32===e.byteLength,"sk must be 'crypto_kx_SECRETKEYBYTES' bytes"),Ba(e,32),Ca(t,e)},crypto_kx_seed_keypair:function(t,e,n){return _a(32===t.byteLength,"pk must be 'crypto_kx_PUBLICKEYBYTES' bytes"),_a(32===e.byteLength,"sk must be 'crypto_kx_SECRETKEYBYTES' bytes"),_a(32===n.byteLength,"seed must be 'crypto_kx_SEEDBYTES' bytes"),va(e,n),Ca(t,e)},crypto_kx_SEEDBYTES:32,crypto_kx_SECRETKEYBYTES:32,crypto_kx_PUBLICKEYBYTES:32},Sa={};const xa=cr;var Qa=Ta;const Ma=[1634760805,857760878,2036477234,1797285236];function Ta(t,e,n){xa(32===e.byteLength),xa(8===t.byteLength||12===t.byteLength);const r=new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4),o=new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4);n||(n=0),xa(n<Number.MAX_SAFE_INTEGER),this.finalized=!1,this.pos=0,this.state=new Uint32Array(16);for(let t=0;t<4;t++)this.state[t]=Ma[t];for(let t=0;t<8;t++)this.state[4+t]=o[t];return this.state[12]=4294967295&n,8===r.byteLength?(this.state[13]=(n&&0xffffffff00000000)>>32,this.state[14]=r[0],this.state[15]=r[1]):(this.state[13]=r[0],this.state[14]=r[1],this.state[15]=r[2]),this}function Da(t){const e=new Uint32Array(16);for(let n=16;n--;)e[n]=t[n];for(let t=0;t<20;t+=2)La(e,0,4,8,12),La(e,1,5,9,13),La(e,2,6,10,14),La(e,3,7,11,15),La(e,0,5,10,15),La(e,1,6,11,12),La(e,2,7,8,13),La(e,3,4,9,14);for(let n=0;n<16;n++)e[n]+=t[n];return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function $a(t,e){return t<<e|t>>>32-e}function La(t,e,n,r,o){t[e]+=t[n],t[o]^=t[e],t[o]=$a(t[o],16),t[r]+=t[o],t[n]^=t[r],t[n]=$a(t[n],12),t[e]+=t[n],t[o]^=t[e],t[o]=$a(t[o],8),t[r]+=t[o],t[n]^=t[r],t[n]=$a(t[n],7)}Ta.prototype.update=function(t,e){xa(!this.finalized,"cipher finalized."),xa(t.byteLength>=e.byteLength,"output cannot be shorter than input.");let n=e.length,r=this.pos%64;this.pos+=n;let o=0,i=Da(this.state);for(;r>0&&n>0;)t[o]=e[o++]^i[r],r=r+1&63,r||this.state[12]++,n--;for(;n>0;){if(i=Da(this.state),n<64){for(let s=0;s<n;s++)t[o]=e[o++]^i[r++],r&=63;return}for(;r<64;)t[o]=e[o++]^i[r++];this.state[12]++,r=0,n-=64}},Ta.prototype.final=function(){this.state.fill(0),this.pos=0,this.finalized=!0},function(t){const e=cr,n=Qa;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");t.crypto_stream_chacha20_KEYBYTES=32,t.crypto_stream_chacha20_NONCEBYTES=8,t.crypto_stream_chacha20_MESSAGEBYTES_MAX=Number.MAX_SAFE_INTEGER,t.crypto_stream_chacha20_ietf_KEYBYTES=32,t.crypto_stream_chacha20_ietf_NONCEBYTES=12,t.crypto_stream_chacha20_ietf_MESSAGEBYTES_MAX=2**32,t.crypto_stream_chacha20=function(e,n,r){e.fill(0),t.crypto_stream_chacha20_xor(e,e,n,r)},t.crypto_stream_chacha20_xor=function(r,o,i,s){e(i.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),e(s.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES");const a=new n(i,s);a.update(r,o),a.final()},t.crypto_stream_chacha20_xor_ic=function(r,o,i,s,a){e(i.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),e(a.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES");const c=new n(i,a,s);c.update(r,o),c.final()},t.crypto_stream_chacha20_xor_instance=function(r,o){return e(r.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),e(o.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES"),new n(r,o)},t.crypto_stream_chacha20_ietf=function(e,n,r){e.fill(0),t.crypto_stream_chacha20_ietf_xor(e,e,n,r)},t.crypto_stream_chacha20_ietf_xor=function(r,o,i,s){e(i.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),e(s.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES");const a=new n(i,s);a.update(r,o),a.final()},t.crypto_stream_chacha20_ietf_xor_ic=function(r,o,i,s,a){e(i.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),e(a.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES");const c=new n(i,a,s);c.update(r,o),c.final()},t.crypto_stream_chacha20_ietf_xor_instance=function(r,o){return e(r.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),e(o.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES"),new n(r,o)}}(Sa);const{crypto_stream_chacha20_ietf:Ua,crypto_stream_chacha20_ietf_xor_ic:Oa}=Sa,{crypto_verify_16:Fa}=fr.exports,Na=ns,Pa=cr,Ya=16,Ka=Number.MAX_SAFE_INTEGER,Ra=new Uint8Array(16);function ja(t,e,n,r,o,i,s){if(null===r)return ja(t,e,n,new Uint8Array(0),o,i,s);Pa(t.byteLength===n.byteLength,"ciphertext should be same length than message"),Pa(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Pa(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Pa(n.byteLength<=Ka,"message is too large"),Pa(e.byteLength<=Ya,"mac should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' long");const a=new Uint8Array(64);var c=new Uint8Array(8);Ua(a,i,s);const u=new Na(a);return a.fill(0),u.update(r,0,r.byteLength),u.update(Ra,0,16-r.byteLength&15),Oa(t,n,i,1,s),u.update(t,0,n.byteLength),u.update(Ra,0,16-n.byteLength&15),Va(c,0,r.byteLength),u.update(c,0,c.byteLength),Va(c,0,n.byteLength),u.update(c,0,c.byteLength),u.finish(e,0),c.fill(0),Ya}function Ha(t,e,n,r,o,i,s){if(null===o)return Ha(t,e,n,r,new Uint8Array(0),i,s);Pa(n.byteLength===t.byteLength,"message should be same length than ciphertext"),Pa(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Pa(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Pa(t.byteLength<=Ka,"message is too large"),Pa(r.byteLength<=Ya,"mac should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' long");const a=new Uint8Array(64),c=new Uint8Array(8),u=new Uint8Array(Ya);Ua(a,i,s);const l=new Na(a);a.fill(0),l.update(o,0,o.byteLength),l.update(Ra,0,16-o.byteLength&15);const h=n.byteLength;l.update(n,0,h),l.update(Ra,0,16-h&15),Va(c,0,o.byteLength),l.update(c,0,c.byteLength),Va(c,0,h),l.update(c,0,c.byteLength),l.finish(u,0),Pa(16===u.byteLength);const f=Fa(u,0,r,0);if(u.fill(0),c.fill(0),!f)throw t.fill(0),new Error("could not verify data");Oa(t,n,i,1,s)}function Va(t,e,n){t.fill(0,0,8);const r=new DataView(t.buffer,t.byteOffset,t.byteLength);r.setUint32(e,4294967295&n,!0),r.setUint32(e+4,n/2**32&4294967295,!0)}var Ga,qa,za={crypto_aead_chacha20poly1305_ietf_encrypt:function t(e,n,r,o,i,s){if(null===r)return t(e,n,new Uint8Array(0),o,i,s);Pa(e.byteLength===n.byteLength+Ya,"ciphertext should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' longer than message"),Pa(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Pa(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Pa(n.byteLength<=Ka,"message is too large");const a=ja(e.subarray(0,n.byteLength),e.subarray(n.byteLength),n,r,o,i,s);return n.byteLength+a},crypto_aead_chacha20poly1305_ietf_encrypt_detached:ja,crypto_aead_chacha20poly1305_ietf_decrypt:function t(e,n,r,o,i,s){if(null===o)return t(e,n,r,new Uint8Array(0),i,s);if(Pa(e.byteLength===r.byteLength-Ya,"message should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' shorter than ciphertext"),Pa(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Pa(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Pa(e.byteLength<=Ka,"message is too large"),r.byteLength<Ya)throw new Error("could not verify data");return Ha(e,n,r.subarray(0,r.byteLength-Ya),r.subarray(r.byteLength-Ya),o,i,s),r.byteLength-Ya},crypto_aead_chacha20poly1305_ietf_decrypt_detached:Ha,crypto_aead_chacha20poly1305_ietf_ABYTES:Ya,crypto_aead_chacha20poly1305_ietf_KEYBYTES:32,crypto_aead_chacha20poly1305_ietf_NPUBBYTES:12,crypto_aead_chacha20poly1305_ietf_NSECBYTES:0,crypto_aead_chacha20poly1305_ietf_MESSAGEBYTES_MAX:Ka},Ja={};var Wa=function(t,e,n){var r,o={h:rc(n,4),l:rc(n,0)},i={h:rc(n,12),l:rc(n,8)},s={h:o.h,l:o.l},a=o,c={h:i.h,l:i.l},u=i,l=0,h=e.length,f=h-7,d=new Uint8Array(new ArrayBuffer(8));Za(s,{h:1936682341,l:1886610805}),Za(c,{h:1685025377,l:1852075885}),Za(a,{h:1819895653,l:1852142177}),Za(u,{h:1952801890,l:2037671283});for(;l<f;)r={h:rc(e,l+4),l:rc(e,l)},Za(u,r),nc(s,c,a,u),nc(s,c,a,u),Za(s,r),l+=8;d[7]=h;var g=0;for(;l<h;)d[g++]=e[l++];for(;g<7;)d[g++]=0;r={h:d[7]<<24|d[6]<<16|d[5]<<8|d[4],l:d[3]<<24|d[2]<<16|d[1]<<8|d[0]},Za(u,r),nc(s,c,a,u),nc(s,c,a,u),Za(s,r),Za(a,{h:0,l:255}),nc(s,c,a,u),nc(s,c,a,u),nc(s,c,a,u),nc(s,c,a,u);var A=s;Za(A,c),Za(A,a),Za(A,u),t[0]=255&A.l,t[1]=A.l>>8&255,t[2]=A.l>>16&255,t[3]=A.l>>24&255,t[4]=255&A.h,t[5]=A.h>>8&255,t[6]=A.h>>16&255,t[7]=A.h>>24&255};function Xa(t,e){var n=t.l+e.l,r={h:t.h+e.h+(n/2>>>31)>>>0,l:n>>>0};t.h=r.h,t.l=r.l}function Za(t,e){t.h^=e.h,t.h>>>=0,t.l^=e.l,t.l>>>=0}function tc(t,e){var n={h:t.h<<e|t.l>>>32-e,l:t.l<<e|t.h>>>32-e};t.h=n.h,t.l=n.l}function ec(t){var e=t.l;t.l=t.h,t.h=e}function nc(t,e,n,r){Xa(t,e),Xa(n,r),tc(e,13),tc(r,16),Za(e,t),Za(r,n),ec(t),Xa(n,e),Xa(t,r),tc(e,17),tc(r,21),Za(e,n),Za(r,t),ec(n)}function rc(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}var oc=cr,ic="undefined"!=typeof WebAssembly&&function(){if(qa)return Ga;qa=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./siphash24.wat"(e,n){n.exports=t("AGFzbQEAAAABBgFgAn9/AAMCAQAFBQEBCpBOBxQCBm1lbW9yeQIAB3NpcGhhc2gAAArdCAHaCAIIfgJ/QvXKzYPXrNu38wAhAkLt3pHzlszct+QAIQNC4eSV89bs2bzsACEEQvPK0cunjNmy9AAhBUEIKQMAIQdBECkDACEIIAGtQjiGIQYgAUEHcSELIAAgAWogC2shCiAFIAiFIQUgBCAHhSEEIAMgCIUhAyACIAeFIQICQANAIAAgCkYNASAAKQMAIQkgBSAJhSEFIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAmFIQIgAEEIaiEADAALCwJAAkACQAJAAkACQAJAAkAgCw4HBwYFBAMCAQALIAYgADEABkIwhoQhBgsgBiAAMQAFQiiGhCEGCyAGIAAxAARCIIaEIQYLIAYgADEAA0IYhoQhBgsgBiAAMQACQhCGhCEGCyAGIAAxAAFCCIaEIQYLIAYgADEAAIQhBgsgBSAGhSEFIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAaFIQIgBEL/AYUhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEQQAgAiADIAQgBYWFhTcDAAs=")}}),n=e(),r=new WebAssembly.Module(n);return Ga=t=>new WebAssembly.Instance(r,t).exports,Ga}()(),sc=Wa,ac=hc,cc=hc.BYTES=8,uc=hc.KEYBYTES=16;hc.WASM_SUPPORTED=!!ic,hc.WASM_LOADED=!!ic;var lc=new Uint8Array(ic.memory.buffer);function hc(t,e,n,r){var o;return n||(n=new Uint8Array(8)),!0!==r&&(oc(n.length>=cc,"output must be at least "+cc),oc(e.length>=uc,"key must be at least "+uc)),ic?(t.length+24>lc.length&&(o=t.length+24,ic.memory.grow(Math.max(0,Math.ceil(Math.abs(o-lc.length)/65536))),lc=new Uint8Array(ic.memory.buffer)),lc.set(e,8),lc.set(t,24),ic.siphash(24,t.length),n.set(lc.subarray(0,8))):sc(n,t,e),n}var fc=ac;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");Ja.crypto_shorthash_PRIMITIVE="siphash24",Ja.crypto_shorthash_BYTES=fc.BYTES,Ja.crypto_shorthash_KEYBYTES=fc.KEYBYTES,Ja.crypto_shorthash_WASM_SUPPORTED=fc.WASM_SUPPORTED,Ja.crypto_shorthash_WASM_LOADED=fc.WASM_LOADED,Ja.crypto_shorthash=function(t,e,n,r){fc(e,n,t,r)};const{crypto_verify_32:dc}=fr.exports,{crypto_hash:gc}=vo,{gf:Ac,gf0:pc,gf1:yc,D:mc,D2:Ic,X:bc,Y:Ec,I:wc,A:Cc,Z:vc,M:Bc,S:_c,sel25519:kc,pack25519:Sc,inv25519:xc,unpack25519:Qc}=No,{randombytes:Mc}=ar.exports,{crypto_scalarmult_BYTES:Tc}=Wo,{crypto_hash_sha512_BYTES:Dc}=vo,$c=cr,Lc=64;var Uc={crypto_sign_keypair:Rc,crypto_sign_seed_keypair:function(t,e,n){return Xc(n,32),e.set(n),Rc(t,e,!0)},crypto_sign:Gc,crypto_sign_detached:function(t,e,n){var r=new Uint8Array(e.length+Lc);Gc(r,e,n);for(let e=0;e<Lc;e++)t[e]=r[e]},crypto_sign_open:zc,crypto_sign_verify_detached:function(t,e,n){Xc(t,Lc);var r=new Uint8Array(e.length+Lc),o=0;for(o=0;o<Lc;o++)r[o]=t[o];for(o=0;o<e.length;o++)r[o+Lc]=e[o];return zc(e,r,n)},crypto_sign_BYTES:Lc,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_sign_ed25519_PUBLICKEYBYTES:32,crypto_sign_ed25519_SECRETKEYBYTES:64,crypto_sign_ed25519_SEEDBYTES:32,crypto_sign_ed25519_BYTES:64,crypto_sign_ed25519_pk_to_curve25519:function(t,e){Xc(t,32),Xc(e,32);var n=[Ac(),Ac(),Ac(),Ac()],r=Ac([1]),o=Ac([1]);$c(function(t){var e,n=[Uint8Array.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uint8Array.from([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uint8Array.from([38,232,149,143,194,178,39,176,69,195,244,137,242,239,152,240,213,223,172,5,211,198,51,57,177,56,2,136,109,83,252,5]),Uint8Array.from([199,23,106,112,61,77,216,79,186,60,11,118,13,16,103,15,42,32,83,250,44,57,204,198,78,199,253,119,146,172,3,122]),Uint8Array.from([236,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127]),Uint8Array.from([237,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127]),Uint8Array.from([238,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127])],r=new Uint8Array(7);Xc(n,7);for(let o=0;o<n.length;o++)for(e=0;e<31;e++)r[o]|=t[e]^n[o][e];for(let o=0;o<n.length;o++)r[o]|=127&t[e]^n[o][e];var o=0;for(let t=0;t<n.length;t++)o|=r[t]-1;return 0==(o>>8&1)}(e)&&qc(n,e)&&function(t){var e=[Ac(),Ac(),Ac(),Ac()];!function(t,e){Yc(t,e,jc)}(e,t);var n=0;for(let t=0;t<16;t++)n|=65535&e[0][t];return 0===n}(n),"Cannot convert key: bad point");for(let e=0;e<n.length;e++)Sc(t,n[e]);return vc(o,o,n[1]),Cc(r,r,n[1]),xc(o,o),Bc(r,r,o),Sc(t,r),0},crypto_sign_ed25519_sk_to_curve25519:function(t,e){$c(t&&t.byteLength===Tc,"curveSk must be 'crypto_sign_SECRETKEYBYTES' long"),$c(e&&64===e.byteLength,"edSk must be 'crypto_sign_ed25519_SECRETKEYBYTES' long");var n=new Uint8Array(Dc);return gc(n,e,32),n[0]&=248,n[31]&=127,n[31]|=64,t.set(n.subarray(0,Tc)),n.fill(0),t},crypto_sign_ed25519_sk_to_pk:function(t,e){return Xc(t,32),t.set(e.subarray(32)),t},unpackneg:qc,pack:Pc};function Oc(t,e){for(let n=0;n<16;n++)t[n]=0|e[n]}function Fc(t,e){var n=Ac(),r=Ac(),o=Ac(),i=Ac(),s=Ac(),a=Ac(),c=Ac(),u=Ac(),l=Ac();vc(n,t[1],t[0]),vc(l,e[1],e[0]),Bc(n,n,l),Cc(r,t[0],t[1]),Cc(l,e[0],e[1]),Bc(r,r,l),Bc(o,t[3],e[3]),Bc(o,o,Ic),Bc(i,t[2],e[2]),Cc(i,i,i),vc(s,r,n),vc(a,i,o),Cc(c,i,o),Cc(u,r,n),Bc(t[0],s,a),Bc(t[1],u,c),Bc(t[2],c,a),Bc(t[3],s,u)}function Nc(t,e,n){var r;for(r=0;r<4;r++)kc(t[r],e[r],n)}function Pc(t,e){var n=Ac(),r=Ac(),o=Ac();xc(o,e[2]),Bc(n,e[0],o),Bc(r,e[1],o),Sc(t,r),t[31]^=Jc(n)<<7}function Yc(t,e,n){var r,o,i=[Ac(e[0]),Ac(e[1]),Ac(e[2]),Ac(e[3])];for(Oc(t[0],pc),Oc(t[1],yc),Oc(t[2],yc),Oc(t[3],pc),o=255;o>=0;--o)Nc(t,i,r=n[o/8|0]>>(7&o)&1),Fc(i,t),Fc(t,t),Nc(t,i,r)}function Kc(t,e){var n=[Ac(),Ac(),Ac(),Ac()];Oc(n[0],bc),Oc(n[1],Ec),Oc(n[2],yc),Bc(n[3],bc,Ec),Yc(t,n,e)}function Rc(t,e,n){Xc(t,32),Xc(e,64);var r,o=new Uint8Array(64),i=[Ac(),Ac(),Ac(),Ac()];for(n||Mc(e,32),gc(o,e,32),o[0]&=248,o[31]&=127,o[31]|=64,Kc(i,o),Pc(t,i),r=0;r<32;r++)e[r+32]=t[r]}var jc=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Hc(t,e){var n,r,o,i;for(r=63;r>=32;--r){for(n=0,o=r-32,i=r-12;o<i;++o)e[o]+=n-16*e[r]*jc[o-(r-32)],n=e[o]+128>>8,e[o]-=256*n;e[o]+=n,e[r]=0}for(n=0,o=0;o<32;o++)e[o]+=n-(e[31]>>4)*jc[o],n=e[o]>>8,e[o]&=255;for(o=0;o<32;o++)e[o]-=n*jc[o];for(r=0;r<32;r++)e[r+1]+=e[r]>>8,t[r]=255&e[r]}function Vc(t){var e=new Float64Array(64);for(let n=0;n<64;n++)e[n]=t[n];for(let e=0;e<64;e++)t[e]=0;Hc(t,e)}function Gc(t,e,n){Xc(t,Lc+e.length),Xc(e,0),Xc(n,64);var r,o,i=e.length,s=new Uint8Array(64),a=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),l=[Ac(),Ac(),Ac(),Ac()];gc(s,n,32),s[0]&=248,s[31]&=127,s[31]|=64;var h=i+64;for(r=0;r<i;r++)t[64+r]=e[r];for(r=0;r<32;r++)t[32+r]=s[32+r];for(gc(c,t.subarray(32),i+32),Vc(c),Kc(l,c),Pc(t,l),r=32;r<64;r++)t[r]=n[r];for(gc(a,t,i+64),Vc(a),r=0;r<64;r++)u[r]=0;for(r=0;r<32;r++)u[r]=c[r];for(r=0;r<32;r++)for(o=0;o<32;o++)u[r+o]+=a[r]*s[o];return Hc(t.subarray(32),u),h}function qc(t,e){var n=Ac(),r=Ac(),o=Ac(),i=Ac(),s=Ac(),a=Ac(),c=Ac();return Oc(t[2],yc),Qc(t[1],e),_c(o,t[1]),Bc(i,o,mc),vc(o,o,t[2]),Cc(i,t[2],i),_c(s,i),_c(a,s),Bc(c,a,s),Bc(n,c,o),Bc(n,n,i),function(t,e){var n,r=Ac();for(n=0;n<16;n++)r[n]=e[n];for(n=250;n>=0;n--)_c(r,r),1!==n&&Bc(r,r,e);for(n=0;n<16;n++)t[n]=r[n]}(n,n),Bc(n,n,o),Bc(n,n,i),Bc(n,n,i),Bc(t[0],n,i),_c(r,t[0]),Bc(r,r,i),Wc(r,o)||Bc(t[0],t[0],wc),_c(r,t[0]),Bc(r,r,i),!!Wc(r,o)&&(Jc(t[0])===e[31]>>7&&vc(t[0],Ac(),t[0]),Bc(t[3],t[0],t[1]),!0)}function zc(t,e,n){Xc(t,e.length-Lc),Xc(e,Lc),Xc(n,32);var r,o=e.length,i=new Uint8Array(e.length),s=new Uint8Array(32),a=new Uint8Array(64),c=[Ac(),Ac(),Ac(),Ac()],u=[Ac(),Ac(),Ac(),Ac()];if(o<64)return!1;if(!qc(u,n))return!1;for(r=0;r<o;r++)i[r]=e[r];for(r=0;r<32;r++)i[r+32]=n[r];if(gc(a,i,o),Vc(a),Yc(c,u,a),Kc(u,e.subarray(32)),Fc(c,u),Pc(s,c),o-=64,!dc(e,0,s,0)){for(r=0;r<o;r++)i[r]=0;return!1}for(r=0;r<o;r++)t[r]=e[r+64];return!0}function Jc(t){var e=new Uint8Array(32);return Sc(e,t),1&e[0]}function Wc(t,e){var n=new Uint8Array(32),r=new Uint8Array(32);return Sc(n,t),Sc(r,e),dc(n,0,r,0)}function Xc(t,e,n="Argument"){if(!t||e&&t.length<e)throw new Error(n+" must be a buffer"+(e?" of length "+e:""))}!function(t){function e(e){Object.keys(e).forEach((function(n){t.exports[n]=e[n]}))}e(ar.exports),e(hr),e(Ar),e(fr.exports),e(bo),e(Ps),e(ni.exports),e(vo),e(Ea),e(wa.exports),e(ka),e(za),e(ss),e(Wo),e(Is),e(Ja),e(Uc),e(Ri),e(Sa)}(or),rr.exports=or.exports;var Zc=Symbol.for("nodejs.util.inspect.custom");const{crypto_sign_BYTES:tu,crypto_sign_SECRETKEYBYTES:eu,crypto_sign_PUBLICKEYBYTES:nu,crypto_sign_detached:ru,crypto_sign_verify_detached:ou,crypto_sign_keypair:iu}=rr.exports,su=Zc,au=Symbol.for("Pico::block"),cu=Symbol.for("Pico::feed"),uu=r.Buffer.alloc(tu).fill(0);var lu=class t{static get MAX_FEED_SIZE(){return 65536}static get INITIAL_FEED_SIZE(){return 1024}static get PICKLE(){return r.Buffer.from("PIC0.")}static get KEY(){return r.Buffer.from("K0.")}static get BLOCK(){return r.Buffer.from("B0.")}static get KEY_SIZE(){return nu}static get SIGNATURE_SIZE(){return tu}static get COUNTER_SIZE(){return 4}static get META_SIZE(){return 2*t.SIGNATURE_SIZE+t.COUNTER_SIZE}static get BLOCK_SYMBOL(){return au}static get FEED_SYMBOL(){return cu}static get GENESIS(){return uu}constructor(e={}){this[cu]=!0,this.tail=0,this._hasGenisis=null,this._keychain=[],this._cache=[],this._MAX_FEED_SIZE=e.maxSize||t.MAX_FEED_SIZE,this.buf=r.Buffer.alloc(e.initialSize||t.INITIAL_FEED_SIZE)}get partial(){return!(null===this._hasGenisis&&!this.length)&&!this._hasGenisis}get free(){return this._MAX_FEED_SIZE-this.tail}get _isDirty(){if(!this.tail)return!1;if(!this._cache.length)return!0;const e=this._cache[this._cache.length-1];return t.mapBlock(this.buf,e.offset).end!==this.tail}get length(){return this._reIndex(),this._cache.length}get last(){return this.get(this.length-1)}get first(){return this.get(0)}get keys(){return this._reIndex(),[...this._keychain]}_reIndex(t=!1){if(!t&&!this._isDirty)return;const e=this._index(t);for(;!e.next().done;)continue}_appendKey(e){this._ensureMinimumCapacity(this.tail+t.KEY.length+e.length),this.tail+=t.KEY.copy(this.buf,this.tail),this.tail+=e.copy(this.buf,this.tail)}_appendBlock(t){this._ensureMinimumCapacity(this.tail+t.length),this.tail+=t.copy(this.buf,this.tail)}_ensureMinimumCapacity(t){if(this.buf.length<t){const e=r.Buffer.allocUnsafe(t+32);this.buf.copy(e),this.buf=e}}_ensureKey(t){for(const e of this.keys)if(t.equals(e))return;this._appendKey(t)}get(e){this._isDirty&&this._reIndex(),e<0&&(e=this.length+e);const n=this._cache[e];if(n)return t.mapBlock(this.buf,n.offset,this._keychain[n.keyId])}toArray(){const t=[];for(const e of this.blocks())t.push(e);return t}append(e,n,o){if(!n)throw new Error("Can't append without a signing secret");if(64!==n.length)throw new Error("Unknown signature secret key format");const i=n.slice(t.KEY_SIZE);this._ensureKey(i);const s=t.META_SIZE,a=this.last;r.Buffer.isBuffer(e)||(e=r.Buffer.from(e));const c=e.length,u=this.tail+c+s;if(this._MAX_FEED_SIZE<u){console.error(`MAX_FEED_SIZE reached, block won't fit: ${u} > ${this._MAX_FEED_SIZE}`);const t=new Error("FeedOverflowError");throw t.type=t.message,t.maxSize=this._MAX_FEED_SIZE,t.requestedSize=u,t.bytesOverflow=u-this._MAX_FEED_SIZE,t}this._ensureMinimumCapacity(u);const l=t.mapBlock(this.buf,this.tail);if(l.header.fill(0),l.size=c,e.copy(l.body),a&&a.sig.copy(l.parentSig),ru(l.sig,l.dat,n),!l.verify(i))throw new Error("newly stored block is invalid. something went wrong");return this.tail=u,"function"==typeof o&&o(null,this.length),this.length}*_index(e=!1){let n=0,o=0;e&&this._clearCache();const i=t.KEY,s=t.KEY_SIZE;let a=null;for(;;){if(n>=this.tail)return;if(n+i.length>this.buf.length)return;if(i.equals(this.buf.slice(n,n+i.length))){const t=this.buf.slice(n+i.length,n+i.length+s);let e=this._keychain.findIndex((e=>e.equals(t)));~e||(e=this._keychain.length,this._keychain.push(t)),yield{type:0,id:e,key:t,offset:n},n+=i.length+s}else if(this._cache[o]&&this._cache[o].offset===n){const e=o++,r=this._cache[e],i=this._keychain[r.keyId];if(!i)throw new Error("InternalError:KeyCacheBroken");const s=t.mapBlock(this.buf,r.offset,i);yield{type:1,seq:e,key:i,block:s,offset:r.offset},a=s.sig,n=s.end}else{const e=t.mapBlock(this.buf,n);if(0===e.size)return;if(n+e.size>this.buf.length)return;if(o){if(!a.equals(e.parentSig))return}else this._hasGenisis=e.parentSig.equals(r.Buffer.alloc(64));let i=!1;for(let t=this._keychain.length-1;t>=0;t--){if(i=e.verify(this._keychain[t]),!i)continue;const r=o++;e.key=this._keychain[t],this._cache[r]={offset:n,keyId:t},yield{type:1,seq:r,block:e,offset:n,key:this._keychain[t]},a=e.sig,n=e.end;break}if(!i)return}}}toString(){return this.pickle()}pickle(e=0){let n=encodeURIComponent(t.PICKLE.toString("utf8"));const r=t.KEY,o=t.BLOCK,i=(e?this.slice(e):this)._index();for(const t of i)n+=t.type?o+hu(t.block.buffer):r+hu(t.key);return n}slice(e=0,n,r=!1){const o=new t;for(const t of this.blocks(e,n))r||o._ensureKey(t.key),o._appendBlock(t.buffer);return o}_unpack(e){if(!e)throw new Error("Missing first argument");if("string"!=typeof e)throw new Error("url-friendly string expected");const n=encodeURIComponent(t.PICKLE),r=encodeURIComponent(t.KEY),o=encodeURIComponent(t.BLOCK),i=e.indexOf(n);if(-1===i)throw new Error("NotPickleError");let s=n.length+i,a=0,c=0,u=-1,l=-1;const h=()=>{if(-1!==u){const n=decodeURIComponent(e.substr(l,s-l-c-a+1));if(u)this._appendBlock(fu(n));else{const e=fu(n);if(e.length!==t.KEY_SIZE)throw new Error("PSIG key wrong size: ");this._ensureKey(e)}u=-1}l=s+1,u=a?0:1,a=c=0};for(;s<e.length;)e[s]===r[a]?++a===r.length&&h():a=0,e[s]===o[c]?++c===o.length&&h():c=0,s++;h()}truncate(t){if(0===t)return this.tail=0,this._cache=[],this._keychain=[],!0;const e=this.tail,n=this.get(t-1);if(this.tail=n.end,e===this.tail)return!1;let r=this._cache.length-t;for(;r--;)this._cache.pop();return!0}*blocks(t=0,e=0){for(t<0&&(t=this.length+t),e||(e=this.length),e<0&&(e=this.length+e+1);t<e;)yield this.get(t++)}_steal(t,e=!1){return e?(this.buf=r.Buffer.alloc(t.buf.length),t.buf.copy(this.buf),this._cache=t._cache.map((t=>({...t})))):(this.buf=t.buf,this._cache=[...t._cache]),this._keychain=[...t._keychain],this._hasGenisis=t._hasGenisis,this.tail=t.tail,t._robbed=!0,!0}_clearCache(){this._keychain=[],this._cache=[]}merge(e,n={},r=null){if("function"==typeof n)return this.merge(e,void 0,n);const o=n.forceCopy||!1;if(!e)throw new Error("First argument `source` expected by merge");const i=t.from(e),s="function"==typeof r,a=s?t=>{let e=!1;return r(t,(()=>{e=!0})),e}:()=>!1,c=t=>{let e=!1;for(const n of t){const t=n.key;if(s){if(a(n))return e}this._ensureKey(t),this._appendBlock(n.buffer),e=!0}return e};if(!this.length)return s?c(i.blocks()):this._steal(i,o);const u=()=>{if(this._reverseMergeFlag)return!1;const t=i.clone();t._reverseMergeFlag=!0;const e=t.length;if((!s||!a(t.get(0)))&&t.merge(this,n,r)){if(e===t.length)throw new Error("InternalError:NothingMerged");return this._steal(t)}return!1};try{const t=this._compare(i);return t<1||c(i.blocks(i.length-t))}catch(t){switch(t.type){case"BlockConflict":return!1;case"NoCommonParent":return!!this.partial&&u()}throw t}}clone(){const e=new t;return e._steal(this,!0),e}_compare(t){if(this===t)return 0;const e=[-1,-1],n=[this._index(),t._index()],r=[],o=[!1,!1],i=t=>{for(r[t]&&r[t].sig,r[t]=null;!r[t]&&!o[t];){const i=n[t].next();if(o[t]=o[t]||i.done,i.done&&void 0===i.value)break;i.value.type&&(e[t]++,r[t]=i.value.block)}},s=t=>{const n=e[t]-1;for(;r[t];)i(t);return e[t]-n},a=t=>{const n=new Error(t);return n.type=t,n.idxA=e[0],n.idxB=e[1],n};if(i(1),!r[1])return-s(0);const c=r[1].parentSig;for(;!o[0]&&(i(0),r[0])&&!r[0].parentSig.equals(c);)if(r[0].sig.equals(c)&&this.length===e[0]+1)return s(1);if(!r[0])throw a("NoCommonParent");if(!r[0].sig.equals(r[1].sig))throw a("BlockConflict");for(;;){if(i(0),i(1),!r[0]||!r[1])return r[0]||r[1]?r[0]?-s(0):s(1):0;if(!r[0].sig.equals(r[1].sig))throw a("BlockConflict")}}inspect(t=!1){const e=[["ID","KEY","SIG","PARENT","HEX","ASCII"]],n=[2];let r=0;for(const t of this.blocks()){const o=t.body.slice(0,12).toString("utf8"),i=[""+r++,t.key.slice(0,2).toString("hex"),t.sig.slice(0,4).toString("hex"),t.isGenesis?"_GENESIS":t.parentSig.slice(0,4).toString("hex"),t.body.slice(0,6).toString("hex").replace(/(.{2})/g,"$1 ").trimEnd(),o];for(let t=0;t<i.length;t++)n[t]=Math.max(n[t]||0,i[t].length);e.push(i)}const o=[];for(const t of e)o.push("│ "+t.map(((t,e)=>t.padEnd(n[e]))).join(" │ ")+" │");if(o.splice(1,0,"├".padEnd(o[0].length-1,"─")+"┤"),t)return o.join("\n");console.log(o.join("\n"))}static isFeed(t){return t&&t[cu]}static from(e,n={}){if(t.isFeed(e))return e;const o=new t(n);if(e[au])o._ensureKey(e.key),o._appendBlock(e.buffer);else if("string"==typeof e)o._unpack(e);else if("string"==typeof e.hash)o._unpack(e.hash);else{if(!r.Buffer.isBuffer(e))throw new Error("NotAFeed");o._unpack(e.toString("utf8"))}return o}static fromBlockArray(e){if(!Array.isArray(e))throw new Error("fromBlockArray() expects an Array of blocks");const n={};let o=0;for(const t of e)o+=t.size,n[t.key.toString("hex")]=1;const i=new t,s=Object.keys(n).length*(t.KEY_SIZE+t.KEY.length)+e.length*t.META_SIZE+o;i.buf=r.Buffer.alloc(s);for(const t of e)n[t.key.toString("hex")]<2&&i._appendKey(t.key),i._appendBlock(t.buffer);return i._reIndex(!0),i}static signPair(){const t=r.Buffer.allocUnsafe(eu),e=r.Buffer.allocUnsafe(nu);return iu(e,t),{sk:t,pk:e}}static mapBlock(e,n=0,r=null){const o=t.SIGNATURE_SIZE,i=t.COUNTER_SIZE,s=o+i,a={[au]:!0,get start(){return n},get sig(){return e.subarray(n,n+o)},get header(){return e.subarray(n+o,n+o+s)},get parentSig(){return e.subarray(n+o,n+o+o)},get size(){return e.readUInt32BE(n+2*o)},set size(t){if("number"!=typeof t||t<0||t+n+o+s>e.length)throw new Error("Invalid blob size");return e.writeUInt32BE(t,n+2*o)},get body(){return e.subarray(n+o+s,a.safeEnd)},get dat(){return e.subarray(n+o,a.safeEnd)},get end(){return n+o+s+a.size},get safeEnd(){const t=a.size;if(t<1)throw new Error("Invalid blob size: "+t);const r=n+o+s+t;if(r>e.length)throw new Error("Incomplete or invalid block: end overflows buffer length"+r);return r},get next(){return t.mapBlock(e,a.safeEnd)},verify:t=>ou(a.sig,a.dat,t),get buffer(){return e.subarray(n,a.safeEnd)},get key(){if(!r)throw new Error("InternalError:MissingKey");return r},set key(t){if(r)throw new Error("InternalError:KeyExists");r=t},get isGenesis(){return uu.equals(a.parentSig)},[su]:()=>`[BlockMapper] start: ${a.start}, blocksize: ${a.size}, id: ${a.sig.slice(0,6).toString("hex")}, parent: ${a.parentSig.slice(0,6).toString("hex")}`};return a}};function hu(t){return t.toString("base64").replace(/\+/,"-").replace(/\//g,"_").replace(/=+$/,"")}function fu(t){return t=(t=(t+"===").slice(0,t.length+t.length%4)).replace(/-/g,"+").replace(/_/g,"/"),r.Buffer.from(t,"base64")}const du=lu,gu=Symbol.for("PicoRepo");function Au(t,e){if(!r.Buffer.isBuffer(e))throw new Error("Expected key to be a Buffer");const n=r.Buffer.alloc(1+e.length);return e.copy(n,1),n[0]=t,n}var pu,yu,mu,Iu=class{static isRepo(t){return t&&t[gu]}constructor(t,e=[]){this[gu]=!0,this._db=t,this.allowDetached=!1,this._strategies=Array.isArray(e)?e:[e];for(const t of this._strategies)if("function"!=typeof t)throw new Error("ExpectedCallback")}get mkKey(){return Au}async _setHeadPtr(t,e){const n=Au(0,t);return await this._db.put(n,e),e}async _setLatestPtr(t,e){const n=Au(3,t);return await this._db.put(n,e),e}async _getTag(t,e){const n=Au(t,e);return await this._db.get(n).catch((t=>{if(!t.notFound)throw t}))}async _getHeadPtr(t){return this._getTag(0,t)}async _getTailPtr(t){return this._getTag(2,t)}async _getLatestPtr(t){return this._getTag(3,t)}async _getChainPtr(t){return this._getTag(5,t)}async writeBlock(t){const e=Au(1,t.sig),n=r.Buffer.alloc(32+t.buffer.length);t.key.copy(n,0),t.buffer.copy(n,32);const o=[];if(o.push({type:"put",key:e,value:n}),t.isGenesis)o.push({type:"put",key:Au(2,t.key),value:t.sig}),o.push({type:"put",key:Au(5,t.sig),value:t.sig}),o.push({type:"put",key:Au(6,t.sig),value:t.sig});else{const e=Au(5,t.parentSig),n=await this._db.get(e);o.push({type:"del",key:e}),o.push({type:"put",key:Au(5,t.sig),value:n}),o.push({type:"put",key:Au(6,n),value:t.sig})}return await this._db.batch(o),!0}async readBlock(t){const e=Au(1,t),n=await this._db.get(e).catch((t=>{if(!t.notFound)throw t}));if(n)return du.mapBlock(n,32,n.slice(0,32))}async _hasBlock(t){return!!await this.readBlock(t)}async _traceOwnerOf(t){let e=0;for await(const n of this._chainLoad(t)){if(n.isGenesis)return n.key;e++}if(e)throw new Error("Orphaned Chain")}async resolveFeed(t,e){let n=await this._getTag(5,t);if(n)return this.loadFeed(t,e);for await(const e of this._chainLoad(t))e.isGenesis&&(n=await this._getTag(6,e.sig));if(!n)throw new Error("Unknown feed");return this.loadFeed(n,e)}async merge(t,e){if(du.isFeed(t)||(t=du.from(t)),!t.length)return 0;let n=0,r=null;const o=t.first;if(r=o.isGenesis?o.key:await this._traceOwnerOf(o.parentSig),!r)throw new Error("CannotMerge: Unknown Chain");for(const o of t.blocks()){const t=o.key,i=o.sig;if(await this._hasBlock(i))continue;const s=async()=>{await this.writeBlock(o),await this._setHeadPtr(r,o.sig),await this._setLatestPtr(t,o.sig),n++},a=await this._getHeadPtr(r);if(!a){await s();continue}if(a.equals(o.parentSig)){await s();continue}if(this.allowDetached&&(o.isGenesis||await this._hasBlock(o.parentSig))){await s();continue}if(!await this._hasBlock(o.parentSig))break;let c=!1;for await(const t of this._chainLoad(o.parentSig))if(a.equals(t.sig)){c=!0;break}if(c)await s();else{if(!await this._queryUserStrategy(o,e))break;await s()}}return n}async _queryUserStrategy(t,e){for(const n of[e,...this._strategies]){if(!n)continue;const e=n(t,this);if("function"!=typeof e.then)throw new Error("PromiseExpected");if(await e)return!0}return!1}async loadHead(t,e){const n=await this._getHeadPtr(t);if(n)return this.loadFeed(n,e)}async loadLatest(t,e){const n=await this._getLatestPtr(t);if(n)return this.loadFeed(n,e)}async loadFeed(t,e){let n=0;Number.isInteger(e)&&e>0&&(n=e),n&&(e=(t,e)=>!--n&&e(!0));const r=[];for await(const n of this._chainLoad(t)){let t=!1,o=!1;if("function"==typeof e&&e(n,(e=>{e?o=!0:t=!0})),t||r.unshift(n),o||t)break}const o=du.fromBlockArray(r);if(o.length)return o}async*_chainLoad(t){let e=!0;for(;;){const n=await this.readBlock(t);if(!n&&e)break;if(e=!1,!n)throw new Error("ParentNotFound");if(yield n,n.isGenesis)break;t=n.parentSig}}async rollback(t,e){let n=!1;const r=await this.loadHead(t,((t,r)=>{e&&t.sig.equals(e)&&(n=!0,r())}));if(e&&!n)throw new Error("ReferenceNotFound");const o=[],i=[],s={};for(let t=r.length-1;t>=0;t--){const e=r.get(t),n=e.key.toString("hex");s[n]||(s[n]=await this._getLatestPtr(e.key)),s[n]?.equals(e.sig)&&i.push(e.key),o.push({type:"del",key:Au(1,e.sig)})}const a=r.first.isGenesis;a&&o.push({type:"del",key:Au(2,t)}),o.push({type:"del",key:Au(0,t)}),e?o.push({type:"put",key:Au(0,t),value:e}):a||o.push({type:"put",key:Au(0,t),value:r.first.parentSig}),o.push({type:"del",key:Au(5,r.last.sig)});const c=await this._getTag(5,r.last.sig);c&&o.push({type:"del",key:Au(6,c)}),c&&!a&&(o.push({type:"put",key:Au(5,r.first.parentSig),value:c}),o.push({type:"put",key:Au(6,c),value:r.first.parentSig}));for(const t of i)o.push({type:"del",key:Au(3,t)});return await this._db.batch(o),r}get headOf(){return this._getHeadPtr}get tailOf(){return this._getTailPtr}get latestOf(){return this._getLatestPtr}get chainload(){return this._chainLoad}get ownerOf(){return this._traceOwnerOf}async writeReg(t,e){const n=Au(4,r.Buffer.from(t));return await this._db.put(n,r.Buffer.from(e)),!0}async readReg(t){const e=Au(4,r.Buffer.from(t));return await this._db.get(e).catch((t=>{if(!t.notFound)throw t}))}async listHeads(){return this._listRange({gt:Au(0,r.Buffer.alloc(32).fill(0)),lt:Au(0,r.Buffer.alloc(32).fill(255))})}async listTails(){return this._listRange({gt:Au(2,r.Buffer.alloc(32).fill(0)),lt:Au(2,r.Buffer.alloc(32).fill(255))})}async listLatest(){return this._listRange({gt:Au(3,r.Buffer.alloc(32).fill(0)),lt:Au(3,r.Buffer.alloc(32).fill(255))})}async listFeeds(){return this._listRange({gt:Au(5,r.Buffer.alloc(32).fill(0)),lt:Au(5,r.Buffer.alloc(32).fill(255))})}async listFeedHeads(){return this._listRange({gt:Au(6,r.Buffer.alloc(32).fill(0)),lt:Au(6,r.Buffer.alloc(32).fill(255))})}async _listRange(t){const e=this._db.iterator(t),n=[];for(;;)try{const[t,r]=await new Promise(((t,n)=>{e.next(((e,r,o)=>{e?n(e):t([r,o])}))}));if(!t)break;n.push({key:t.slice(1),value:r})}catch(t){console.warn("Iterator died with an error",t);break}return await new Promise(((t,n)=>{e.close((e=>e?n(e):t()))})),n}};try{pu=new TextDecoder}catch(t){}var bu,Eu,wu,Cu,vu,Bu=0,_u={},ku=0,Su=0,xu=[],Qu={useRecords:!1,mapsAsObjects:!0};class Mu{}const Tu=new Mu;Tu.name="MessagePack 0xC1";var Du=!1,$u=2;try{new Function("")}catch(t){$u=1/0}class Lu{constructor(t){t&&(!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.sequential&&!1!==t.trusted&&(t.trusted=!0,t.structures||0==t.useRecords||(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(yu)return al((()=>(cl(),this?this.unpack(t,e):Lu.prototype.unpack.call(Qu,t,e))));"object"==typeof e?(mu=e.end||t.length,Bu=e.start||0):(Bu=0,mu=e>-1?e:t.length),Su=0,Eu=null,wu=null,yu=t;try{vu=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){if(yu=null,t instanceof Uint8Array)throw e;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof Lu){if(_u=this,this.structures)return bu=this.structures,Uu();(!bu||bu.length>0)&&(bu=[])}else _u=Qu,(!bu||bu.length>0)&&(bu=[]);return Uu()}unpackMultiple(t,e){let n,r=0;try{Du=!0;let o=t.length,i=this?this.unpack(t,o):hl.unpack(t,o);if(!e){for(n=[i];Bu<o;)r=Bu,n.push(Uu());return n}for(e(i);Bu<o;)if(r=Bu,!1===e(Uu()))return}catch(t){throw t.lastPosition=r,t.values=n,t}finally{Du=!1,cl()}}_mergeStructures(t,e){for(let e=0,n=(t=t||[]).length;e<n;e++){let n=t[e];n&&(n.isShared=!0,e>=32&&(n.highByte=e-32>>5))}t.sharedLength=t.length;for(let n in e||[])if(n>=0){let r=t[n],o=e[n];o&&(r&&((t.restoreStructures||(t.restoreStructures=[]))[n]=r),t[n]=o)}return this.structures=t}decode(t,e){return this.unpack(t,e)}}function Uu(){try{if(!_u.trusted&&!Du){let t=bu.sharedLength||0;t<bu.length&&(bu.length=t)}let t;if(_u.randomAccessStructure&&yu[Bu]<64&&yu[Bu],t=Fu(),wu&&(Bu=wu.postBundlePosition),Bu==mu)bu.restoreStructures&&Ou(),bu=null,yu=null,Cu&&(Cu=null);else{if(Bu>mu)throw new Error("Unexpected end of MessagePack data");if(!Du)throw new Error("Data read, but end of buffer not reached "+JSON.stringify(t).slice(0,100))}return t}catch(t){throw bu.restoreStructures&&Ou(),cl(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||Bu>mu)&&(t.incomplete=!0),t}}function Ou(){for(let t in bu.restoreStructures)bu[t]=bu.restoreStructures[t];bu.restoreStructures=null}function Fu(){let t=yu[Bu++];if(t<160){if(t<128){if(t<64)return t;{let e=bu[63&t]||_u.getStructures&&Ku()[63&t];return e?(e.read||(e.read=Pu(e,63&t)),e.read()):t}}if(t<144){if(t-=128,_u.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[rl()]=Fu();return e}{let e=new Map;for(let n=0;n<t;n++)e.set(Fu(),Fu());return e}}{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Fu();return _u.freezeData?Object.freeze(e):e}}if(t<192){let e=t-160;if(Su>=Bu)return Eu.slice(Bu-ku,(Bu+=e)-ku);if(0==Su&&mu<140){let t=e<16?Xu(e):Wu(e);if(null!=t)return t}return Ru(e)}{let e;switch(t){case 192:return null;case 193:return wu?(e=Fu(),e>0?wu[1].slice(wu.position1,wu.position1+=e):wu[0].slice(wu.position0,wu.position0-=e)):Tu;case 194:return!1;case 195:return!0;case 196:if(e=yu[Bu++],void 0===e)throw new Error("Unexpected end of buffer");return tl(e);case 197:return e=vu.getUint16(Bu),Bu+=2,tl(e);case 198:return e=vu.getUint32(Bu),Bu+=4,tl(e);case 199:return el(yu[Bu++]);case 200:return e=vu.getUint16(Bu),Bu+=2,el(e);case 201:return e=vu.getUint32(Bu),Bu+=4,el(e);case 202:if(e=vu.getFloat32(Bu),_u.useFloat32>2){let t=ul[(127&yu[Bu])<<1|yu[Bu+1]>>7];return Bu+=4,(t*e+(e>0?.5:-.5)>>0)/t}return Bu+=4,e;case 203:return e=vu.getFloat64(Bu),Bu+=8,e;case 204:return yu[Bu++];case 205:return e=vu.getUint16(Bu),Bu+=2,e;case 206:return e=vu.getUint32(Bu),Bu+=4,e;case 207:return _u.int64AsNumber?(e=4294967296*vu.getUint32(Bu),e+=vu.getUint32(Bu+4)):e=vu.getBigUint64(Bu),Bu+=8,e;case 208:return vu.getInt8(Bu++);case 209:return e=vu.getInt16(Bu),Bu+=2,e;case 210:return e=vu.getInt32(Bu),Bu+=4,e;case 211:return _u.int64AsNumber?(e=4294967296*vu.getInt32(Bu),e+=vu.getUint32(Bu+4)):e=vu.getBigInt64(Bu),Bu+=8,e;case 212:if(e=yu[Bu++],114==e)return ol(63&yu[Bu++]);{let t=xu[e];if(t)return t.read?(Bu++,t.read(Fu())):t.noBuffer?(Bu++,t()):t(yu.subarray(Bu,++Bu));throw new Error("Unknown extension "+e)}case 213:return e=yu[Bu],114==e?(Bu++,ol(63&yu[Bu++],yu[Bu++])):el(2);case 214:return el(4);case 215:return el(8);case 216:return el(16);case 217:return e=yu[Bu++],Su>=Bu?Eu.slice(Bu-ku,(Bu+=e)-ku):ju(e);case 218:return e=vu.getUint16(Bu),Su>=(Bu+=2)?Eu.slice(Bu-ku,(Bu+=e)-ku):Hu(e);case 219:return e=vu.getUint32(Bu),Su>=(Bu+=4)?Eu.slice(Bu-ku,(Bu+=e)-ku):Vu(e);case 220:return e=vu.getUint16(Bu),Bu+=2,qu(e);case 221:return e=vu.getUint32(Bu),Bu+=4,qu(e);case 222:return e=vu.getUint16(Bu),Bu+=2,zu(e);case 223:return e=vu.getUint32(Bu),Bu+=4,zu(e);default:if(t>=224)return t-256;if(void 0===t){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+t)}}}const Nu=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Pu(t,e){function n(){if(n.count++>$u){let n=t.read=new Function("r","return function(){return "+(_u.freezeData?"Object.freeze":"")+"({"+t.map((t=>Nu.test(t)?t+":r()":"["+JSON.stringify(t)+"]:r()")).join(",")+"})}")(Fu);return 0===t.highByte&&(t.read=Yu(e,t.read)),n()}let r={};for(let e=0,n=t.length;e<n;e++){r[t[e]]=Fu()}return _u.freezeData?Object.freeze(r):r}return n.count=0,0===t.highByte?Yu(e,n):n}const Yu=(t,e)=>function(){let n=yu[Bu++];if(0===n)return e();let r=t<32?-(t+(n<<5)):t+(n<<5),o=bu[r]||Ku()[r];if(!o)throw new Error("Record id is not defined for "+r);return o.read||(o.read=Pu(o,t)),o.read()};function Ku(){let t=al((()=>(yu=null,_u.getStructures())));return bu=_u._mergeStructures(t,bu)}var Ru=Gu,ju=Gu,Hu=Gu,Vu=Gu;function Gu(t){let e;if(t<16&&(e=Xu(t)))return e;if(t>64&&pu)return pu.decode(yu.subarray(Bu,Bu+=t));const n=Bu+t,r=[];for(e="";Bu<n;){const t=yu[Bu++];if(0==(128&t))r.push(t);else if(192==(224&t)){const e=63&yu[Bu++];r.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&yu[Bu++],n=63&yu[Bu++];r.push((31&t)<<12|e<<6|n)}else if(240==(248&t)){let e=(7&t)<<18|(63&yu[Bu++])<<12|(63&yu[Bu++])<<6|63&yu[Bu++];e>65535&&(e-=65536,r.push(e>>>10&1023|55296),e=56320|1023&e),r.push(e)}else r.push(t);r.length>=4096&&(e+=Ju.apply(String,r),r.length=0)}return r.length>0&&(e+=Ju.apply(String,r)),e}function qu(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Fu();return _u.freezeData?Object.freeze(e):e}function zu(t){if(_u.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[rl()]=Fu();return e}{let e=new Map;for(let n=0;n<t;n++)e.set(Fu(),Fu());return e}}var Ju=String.fromCharCode;function Wu(t){let e=Bu,n=new Array(t);for(let r=0;r<t;r++){const t=yu[Bu++];if((128&t)>0)return void(Bu=e);n[r]=t}return Ju.apply(String,n)}function Xu(t){if(t<4){if(t<2){if(0===t)return"";{let t=yu[Bu++];return(128&t)>1?void(Bu-=1):Ju(t)}}{let e=yu[Bu++],n=yu[Bu++];if((128&e)>0||(128&n)>0)return void(Bu-=2);if(t<3)return Ju(e,n);let r=yu[Bu++];return(128&r)>0?void(Bu-=3):Ju(e,n,r)}}{let e=yu[Bu++],n=yu[Bu++],r=yu[Bu++],o=yu[Bu++];if((128&e)>0||(128&n)>0||(128&r)>0||(128&o)>0)return void(Bu-=4);if(t<6){if(4===t)return Ju(e,n,r,o);{let t=yu[Bu++];return(128&t)>0?void(Bu-=5):Ju(e,n,r,o,t)}}if(t<8){let i=yu[Bu++],s=yu[Bu++];if((128&i)>0||(128&s)>0)return void(Bu-=6);if(t<7)return Ju(e,n,r,o,i,s);let a=yu[Bu++];return(128&a)>0?void(Bu-=7):Ju(e,n,r,o,i,s,a)}{let i=yu[Bu++],s=yu[Bu++],a=yu[Bu++],c=yu[Bu++];if((128&i)>0||(128&s)>0||(128&a)>0||(128&c)>0)return void(Bu-=8);if(t<10){if(8===t)return Ju(e,n,r,o,i,s,a,c);{let t=yu[Bu++];return(128&t)>0?void(Bu-=9):Ju(e,n,r,o,i,s,a,c,t)}}if(t<12){let u=yu[Bu++],l=yu[Bu++];if((128&u)>0||(128&l)>0)return void(Bu-=10);if(t<11)return Ju(e,n,r,o,i,s,a,c,u,l);let h=yu[Bu++];return(128&h)>0?void(Bu-=11):Ju(e,n,r,o,i,s,a,c,u,l,h)}{let u=yu[Bu++],l=yu[Bu++],h=yu[Bu++],f=yu[Bu++];if((128&u)>0||(128&l)>0||(128&h)>0||(128&f)>0)return void(Bu-=12);if(t<14){if(12===t)return Ju(e,n,r,o,i,s,a,c,u,l,h,f);{let t=yu[Bu++];return(128&t)>0?void(Bu-=13):Ju(e,n,r,o,i,s,a,c,u,l,h,f,t)}}{let d=yu[Bu++],g=yu[Bu++];if((128&d)>0||(128&g)>0)return void(Bu-=14);if(t<15)return Ju(e,n,r,o,i,s,a,c,u,l,h,f,d,g);let A=yu[Bu++];return(128&A)>0?void(Bu-=15):Ju(e,n,r,o,i,s,a,c,u,l,h,f,d,g,A)}}}}}function Zu(){let t,e=yu[Bu++];if(e<192)t=e-160;else switch(e){case 217:t=yu[Bu++];break;case 218:t=vu.getUint16(Bu),Bu+=2;break;case 219:t=vu.getUint32(Bu),Bu+=4;break;default:throw new Error("Expected string")}return Gu(t)}function tl(t){return _u.copyBuffers?Uint8Array.prototype.slice.call(yu,Bu,Bu+=t):yu.subarray(Bu,Bu+=t)}function el(t){let e=yu[Bu++];if(xu[e]){let n;return xu[e](yu.subarray(Bu,n=Bu+=t),(t=>{Bu=t;try{return Fu()}finally{Bu=n}}))}throw new Error("Unknown extension type "+e)}var nl=new Array(4096);function rl(){let t=yu[Bu++];if(!(t>=160&&t<192))return Bu--,Fu();if(t-=160,Su>=Bu)return Eu.slice(Bu-ku,(Bu+=t)-ku);if(!(0==Su&&mu<180))return Ru(t);let e,n=4095&(t<<5^(t>1?vu.getUint16(Bu):t>0?yu[Bu]:0)),r=nl[n],o=Bu,i=Bu+t-3,s=0;if(r&&r.bytes==t){for(;o<i;){if(e=vu.getUint32(o),e!=r[s++]){o=1879048192;break}o+=4}for(i+=3;o<i;)if(e=yu[o++],e!=r[s++]){o=1879048192;break}if(o===i)return Bu=o,r.string;i-=3,o=Bu}for(r=[],nl[n]=r,r.bytes=t;o<i;)e=vu.getUint32(o),r.push(e),o+=4;for(i+=3;o<i;)e=yu[o++],r.push(e);let a=t<16?Xu(t):Wu(t);return r.string=null!=a?a:Ru(t)}const ol=(t,e)=>{var n=Fu();let r=t;void 0!==e&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let o=bu[t];return o&&o.isShared&&((bu.restoreStructures||(bu.restoreStructures=[]))[t]=o),bu[t]=n,n.read=Pu(n,r),n.read()};xu[0]=()=>{},xu[0].noBuffer=!0,xu[101]=()=>{let t=Fu();return(globalThis[t[0]]||Error)(t[1])},xu[105]=t=>{let e=vu.getUint32(Bu-4);Cu||(Cu=new Map);let n,r=yu[Bu];n=r>=144&&r<160||220==r||221==r?[]:{};let o={target:n};Cu.set(e,o);let i=Fu();return o.used?Object.assign(n,i):(o.target=i,i)},xu[112]=t=>{let e=vu.getUint32(Bu-4),n=Cu.get(e);return n.used=!0,n.target},xu[115]=()=>new Set(Fu());const il=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((t=>t+"Array"));xu[116]=t=>{let e=t[0],n=il[e];if(!n)throw new Error("Could not find typed array for code "+e);return new globalThis[n](Uint8Array.prototype.slice.call(t,1).buffer)},xu[120]=()=>{let t=Fu();return new RegExp(t[0],t[1])};const sl=[];function al(t){let e=mu,n=Bu,r=ku,o=Su,i=Eu,s=Cu,a=wu,c=new Uint8Array(yu.slice(0,mu)),u=bu,l=bu.slice(0,bu.length),h=_u,f=Du,d=t();return mu=e,Bu=n,ku=r,Su=o,Eu=i,Cu=s,wu=a,yu=c,Du=f,(bu=u).splice(0,bu.length,...l),_u=h,vu=new DataView(yu.buffer,yu.byteOffset,yu.byteLength),d}function cl(){yu=null,Cu=null,bu=null}xu[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=Bu;return Bu+=e-t.length,wu=sl,(wu=[Zu(),Zu()]).position0=0,wu.position1=0,wu.postBundlePosition=Bu,Bu=n,Fu()},xu[255]=t=>4==t.length?new Date(1e3*(16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3])):8==t.length?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+1e3*(4294967296*(3&t[3])+16777216*t[4]+(t[5]<<16)+(t[6]<<8)+t[7])):12==t.length?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+1e3*((128&t[4]?-281474976710656:0)+1099511627776*t[6]+4294967296*t[7]+16777216*t[8]+(t[9]<<16)+(t[10]<<8)+t[11])):new Date("invalid");const ul=new Array(147);for(let t=0;t<256;t++)ul[t]=+("1e"+Math.floor(45.15-.30103*t));const ll=Lu;var hl=new Lu({useRecords:!1});const fl=hl.unpack,dl=hl.unpackMultiple,gl=hl.unpack,Al={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};let pl,yl,ml,Il=new Float32Array(1),bl=new Uint8Array(Il.buffer,0,4);try{pl=new TextEncoder}catch(t){}const El=void 0!==r.Buffer,wl=El?function(t){return r.Buffer.allocUnsafeSlow(t)}:Uint8Array,Cl=El?r.Buffer:Uint8Array,vl=El?4294967296:2144337920;let Bl,_l,kl,Sl,xl=0,Ql=null;const Ml=/[\u0080-\uFFFF]/,Tl=Symbol("record-id");class Dl extends Lu{constructor(t){let e,n,r,o;super(t),this.offset=0;let i=Cl.prototype.utf8Write?function(t,e){return Bl.utf8Write(t,e,4294967295)}:!(!pl||!pl.encodeInto)&&function(t,e){return pl.encodeInto(t,Bl.subarray(e)).written},s=this;t||(t={});let a=t&&t.sequential,c=t.structures||t.saveStructures,u=t.maxSharedStructures;if(null==u&&(u=c?32:0),u>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&null==t.moreTypes&&(t.moreTypes=!0);let l=t.maxOwnStructures;null==l&&(l=c?32:64),this.structures||0==t.useRecords||(this.structures=[]);let h=u>32||l+u>64,f=u+64,d=u+l+64;if(d>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let g=[],A=0,p=0;this.pack=this.encode=function(t,i){if(Bl||(Bl=new wl(8192),kl=Bl.dataView=new DataView(Bl.buffer,0,8192),xl=0),Sl=Bl.length-10,Sl-xl<2048?(Bl=new wl(Bl.length),kl=Bl.dataView=new DataView(Bl.buffer,0,Bl.length),Sl=Bl.length-10,xl=0):xl=xl+7&2147483640,e=xl,o=s.structuredClone?new Map:null,s.bundleStrings&&"string"!=typeof t?(Ql=[],Ql.size=1/0):Ql=null,r=s.structures,r){r.uninitialized&&(r=s._mergeStructures(s.getStructures()));let t=r.sharedLength||0;if(t>u)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let e=0;e<t;e++){let t=r[e];if(!t)continue;let n,o=r.transitions;for(let e=0,r=t.length;e<r;e++){let r=t[e];n=o[r],n||(n=o[r]=Object.create(null)),o=n}o[Tl]=e+64}this.lastNamedStructuresLength=t}a||(r.nextId=t+64)}n&&(n=!1);try{if(s.randomAccessStructure&&t.constructor&&t.constructor===Object?w(t):y(t),Ql&&Ol(e,y),s.offset=xl,o&&o.idsToInsert){xl+=6*o.idsToInsert.length,xl>Sl&&I(xl),s.offset=xl;let t=function(t,e){let n,r=6*e.length,o=t.length-r;e.sort(((t,e)=>t.offset>e.offset?1:-1));for(;n=e.pop();){let e=n.offset,i=n.id;t.copyWithin(e+r,e,o),r-=6;let s=e+r;t[s++]=214,t[s++]=105,t[s++]=i>>24,t[s++]=i>>16&255,t[s++]=i>>8&255,t[s++]=255&i,o=e}return t}(Bl.subarray(e,xl),o.idsToInsert);return o=null,t}return i&Vl?(Bl.start=e,Bl.end=xl,Bl):Bl.subarray(e,xl)}finally{if(r){p<10&&p++;let o=r.sharedLength||u;if(r.length>o&&(r.length=o),A>1e4)r.transitions=null,p=0,A=0,g.length>0&&(g=[]);else if(g.length>0&&!a){for(let t=0,e=g.length;t<e;t++)g[t][Tl]=0;g=[]}if(n&&s.saveStructures){let n=Bl.subarray(e,xl),i=r;return!1===s.saveStructures(i,i.isCompatible||s.lastNamedStructuresLength||0)?(s._mergeStructures(s.getStructures()),s.pack(t)):(s.lastNamedStructuresLength=o,n)}}i&Gl&&(xl=e)}};const y=t=>{xl>Sl&&(Bl=I(xl));var n,r=typeof t;if("string"===r){let r,o=t.length;if(Ql&&o>=4&&o<4096){if((Ql.size+=o)>61440){let t,n=(Ql[0]?3*Ql[0].length+Ql[1].length:0)+10;xl+n>Sl&&(Bl=I(xl+n)),Ql.position?(Bl[xl]=200,xl+=3,Bl[xl++]=98,t=xl-e,xl+=4,Ol(e,y),kl.setUint16(t+e-3,xl-e-t)):(Bl[xl++]=214,Bl[xl++]=98,t=xl-e,xl+=4),Ql=["",""],Ql.size=0,Ql.position=t}let n=Ml.test(t);return Ql[n?0:1]+=t,Bl[xl++]=193,void y(n?-o:o)}r=o<32?1:o<256?2:o<65536?3:5;let s=3*o;if(xl+s>Sl&&(Bl=I(xl+s)),o<64||!i){let e,i,s,a=xl+r;for(e=0;e<o;e++)i=t.charCodeAt(e),i<128?Bl[a++]=i:i<2048?(Bl[a++]=i>>6|192,Bl[a++]=63&i|128):55296==(64512&i)&&56320==(64512&(s=t.charCodeAt(e+1)))?(i=65536+((1023&i)<<10)+(1023&s),e++,Bl[a++]=i>>18|240,Bl[a++]=i>>12&63|128,Bl[a++]=i>>6&63|128,Bl[a++]=63&i|128):(Bl[a++]=i>>12|224,Bl[a++]=i>>6&63|128,Bl[a++]=63&i|128);n=a-xl-r}else n=i(t,xl+r);n<32?Bl[xl++]=160|n:n<256?(r<2&&Bl.copyWithin(xl+2,xl+1,xl+1+n),Bl[xl++]=217,Bl[xl++]=n):n<65536?(r<3&&Bl.copyWithin(xl+3,xl+2,xl+2+n),Bl[xl++]=218,Bl[xl++]=n>>8,Bl[xl++]=255&n):(r<5&&Bl.copyWithin(xl+5,xl+3,xl+3+n),Bl[xl++]=219,kl.setUint32(xl,n),xl+=4),xl+=n}else if("number"===r)if(t>>>0===t)t<32||t<128&&!1===this.useRecords||t<64&&!this.randomAccessStructure?Bl[xl++]=t:t<256?(Bl[xl++]=204,Bl[xl++]=t):t<65536?(Bl[xl++]=205,Bl[xl++]=t>>8,Bl[xl++]=255&t):(Bl[xl++]=206,kl.setUint32(xl,t),xl+=4);else if(t>>0===t)t>=-32?Bl[xl++]=256+t:t>=-128?(Bl[xl++]=208,Bl[xl++]=t+256):t>=-32768?(Bl[xl++]=209,kl.setInt16(xl,t),xl+=2):(Bl[xl++]=210,kl.setInt32(xl,t),xl+=4);else{let e;if((e=this.useFloat32)>0&&t<4294967296&&t>=-2147483648){let n;if(Bl[xl++]=202,kl.setFloat32(xl,t),e<4||(n=t*ul[(127&Bl[xl])<<1|Bl[xl+1]>>7])>>0===n)return void(xl+=4);xl--}Bl[xl++]=203,kl.setFloat64(xl,t),xl+=8}else if("object"===r)if(t){if(o){let n=o.get(t);if(n){if(!n.id){let t=o.idsToInsert||(o.idsToInsert=[]);n.id=t.push(n)}return Bl[xl++]=214,Bl[xl++]=112,kl.setUint32(xl,n.id),void(xl+=4)}o.set(t,{offset:xl-e})}let r=t.constructor;if(r===Object)m(t,!0);else if(r===Array){(n=t.length)<16?Bl[xl++]=144|n:n<65536?(Bl[xl++]=220,Bl[xl++]=n>>8,Bl[xl++]=255&n):(Bl[xl++]=221,kl.setUint32(xl,n),xl+=4);for(let e=0;e<n;e++)y(t[e])}else if(r===Map){(n=t.size)<16?Bl[xl++]=128|n:n<65536?(Bl[xl++]=222,Bl[xl++]=n>>8,Bl[xl++]=255&n):(Bl[xl++]=223,kl.setUint32(xl,n),xl+=4);for(let[e,n]of t)y(e),y(n)}else{for(let e=0,n=yl.length;e<n;e++){if(t instanceof ml[e]){let n=yl[e];if(n.write)return n.type&&(Bl[xl++]=212,Bl[xl++]=n.type,Bl[xl++]=0),void y(n.write.call(this,t));let r,o=Bl,i=kl,s=xl;Bl=null;try{r=n.pack.call(this,t,(t=>(Bl=o,o=null,xl+=t,xl>Sl&&I(xl),{target:Bl,targetView:kl,position:xl-t})),y)}finally{o&&(Bl=o,kl=i,xl=s,Sl=Bl.length-10)}return void(r&&(r.length+xl>Sl&&I(r.length+xl),xl=Ul(r,Bl,xl,n.type)))}}m(t,!t.hasOwnProperty)}}else Bl[xl++]=192;else if("boolean"===r)Bl[xl++]=t?195:194;else if("bigint"===r){if(t<BigInt(1)<<BigInt(63)&&t>=-(BigInt(1)<<BigInt(63)))Bl[xl++]=211,kl.setBigInt64(xl,t);else if(t<BigInt(1)<<BigInt(64)&&t>0)Bl[xl++]=207,kl.setBigUint64(xl,t);else{if(!this.largeBigIntToFloat)throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");Bl[xl++]=203,kl.setFloat64(xl,Number(t))}xl+=8}else if("undefined"===r)this.encodeUndefinedAsNil?Bl[xl++]=192:(Bl[xl++]=212,Bl[xl++]=0,Bl[xl++]=0);else{if("function"!==r)throw new Error("Unknown type: "+r);y(this.writeFunction&&this.writeFunction())}},m=!1===this.useRecords?this.variableMapSize?t=>{let e,n=Object.keys(t),r=n.length;r<16?Bl[xl++]=128|r:r<65536?(Bl[xl++]=222,Bl[xl++]=r>>8,Bl[xl++]=255&r):(Bl[xl++]=223,kl.setUint32(xl,r),xl+=4);for(let o=0;o<r;o++)y(e=n[o]),y(t[e])}:(t,n)=>{Bl[xl++]=222;let r=xl-e;xl+=2;let o=0;for(let e in t)(n||t.hasOwnProperty(e))&&(y(e),y(t[e]),o++);Bl[r+++e]=o>>8,Bl[r+e]=255&o}:t.progressiveRecords&&!h?(t,n)=>{let o,i,s=r.transitions||(r.transitions=Object.create(null)),a=xl++-e;for(let c in t)if(n||t.hasOwnProperty(c)){if(o=s[c],o)s=o;else{let n=Object.keys(t),u=s;s=r.transitions;let l=0;for(let t=0,e=n.length;t<e;t++){let e=n[t];o=s[e],o||(o=s[e]=Object.create(null),l++),s=o}a+e+1==xl?(xl--,b(s,n,l)):E(s,n,a,l),i=!0,s=u[c]}y(t[c])}if(!i){let n=s[Tl];n?Bl[a+e]=n:E(s,Object.keys(t),a,0)}}:(t,e)=>{let n,o=r.transitions||(r.transitions=Object.create(null)),i=0;for(let r in t)(e||t.hasOwnProperty(r))&&(n=o[r],n||(n=o[r]=Object.create(null),i++),o=n);let s=o[Tl];s?s>=96&&h?(Bl[xl++]=96+(31&(s-=96)),Bl[xl++]=s>>5):Bl[xl++]=s:b(o,o.__keys__||Object.keys(t),i);for(let n in t)(e||t.hasOwnProperty(n))&&y(t[n])},I=t=>{let n;if(t>16777216){if(t-e>vl)throw new Error("Packed buffer would be larger than maximum buffer size");n=Math.min(vl,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else n=1+(Math.max(t-e<<2,Bl.length-1)>>12)<<12;let r=new wl(n);return kl=r.dataView=new DataView(r.buffer,0,n),t=Math.min(t,Bl.length),Bl.copy?Bl.copy(r,0,e,t):r.set(Bl.slice(e,t)),xl-=e,e=0,Sl=r.length-10,Bl=r},b=(t,e,o)=>{let i=r.nextId;i||(i=64),i<f&&this.shouldShareStructure&&!this.shouldShareStructure(e)?(i=r.nextOwnId,i<d||(i=f),r.nextOwnId=i+1):(i>=d&&(i=f),r.nextId=i+1);let s=e.highByte=i>=96&&h?i-96>>5:-1;t[Tl]=i,t.__keys__=e,r[i-64]=e,i<f?(e.isShared=!0,r.sharedLength=i-63,n=!0,s>=0?(Bl[xl++]=96+(31&i),Bl[xl++]=s):Bl[xl++]=i):(s>=0?(Bl[xl++]=213,Bl[xl++]=114,Bl[xl++]=96+(31&i),Bl[xl++]=s):(Bl[xl++]=212,Bl[xl++]=114,Bl[xl++]=i),o&&(A+=p*o),g.length>=l&&(g.shift()[Tl]=0),g.push(t),y(e))},E=(t,n,r,o)=>{let i=Bl,s=xl,a=Sl,c=e;Bl=_l,xl=0,e=0,Bl||(_l=Bl=new wl(8192)),Sl=Bl.length-10,b(t,n,o),_l=Bl;let u=xl;if(Bl=i,xl=s,Sl=a,e=c,u>1){let t=xl+u-1;t>Sl&&I(t);let n=r+e;Bl.copyWithin(n+u,n+1,xl),Bl.set(_l.slice(0,u),n),xl=t}else Bl[r+e]=_l[0]},w=(t,o)=>{let i=undefined(t,Bl,xl,r,I,((t,r,o)=>{if(o&&(n=!0),xl=r,e>0){if(y(t),0==e)return{position:xl,targetView:kl,target:Bl}}else y(t);return xl}),this);if(0===i)return m(t,!0);xl=i}}useBuffer(t){Bl=t,kl=new DataView(Bl.buffer,Bl.byteOffset,Bl.byteLength),xl=0}clearSharedData(){this.structures&&(this.structures=[]),this.typedStructs&&(this.typedStructs=[])}}function $l(t,e,n,r){let o=t.byteLength;if(o+1<256){var{target:i,position:s}=n(4+o);i[s++]=199,i[s++]=o+1}else if(o+1<65536){var{target:i,position:s}=n(5+o);i[s++]=200,i[s++]=o+1>>8,i[s++]=o+1&255}else{var{target:i,position:s,targetView:a}=n(7+o);i[s++]=201,a.setUint32(s,o+1),s+=4}i[s++]=116,i[s++]=e,i.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),s)}function Ll(t,e){let n=t.byteLength;var r,o;if(n<256){var{target:r,position:o}=e(n+2);r[o++]=196,r[o++]=n}else if(n<65536){var{target:r,position:o}=e(n+3);r[o++]=197,r[o++]=n>>8,r[o++]=255&n}else{var{target:r,position:o,targetView:i}=e(n+5);r[o++]=198,i.setUint32(o,n),o+=4}r.set(t,o)}function Ul(t,e,n,r){let o=t.length;switch(o){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:o<256?(e[n++]=199,e[n++]=o):o<65536?(e[n++]=200,e[n++]=o>>8,e[n++]=255&o):(e[n++]=201,e[n++]=o>>24,e[n++]=o>>16&255,e[n++]=o>>8&255,e[n++]=255&o)}return e[n++]=r,e.set(t,n),n+=o}function Ol(t,e){if(Ql.length>0){kl.setUint32(Ql.position+t,xl-Ql.position-t);let n=Ql;Ql=null,e(n[0]),e(n[1])}}ml=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Mu],yl=[{pack(t,e,n){let r=t.getTime()/1e3;if((this.useTimestamp32||0===t.getMilliseconds())&&r>=0&&r<4294967296){let{target:t,targetView:n,position:o}=e(6);t[o++]=214,t[o++]=255,n.setUint32(o,r)}else if(r>0&&r<4294967296){let{target:n,targetView:o,position:i}=e(10);n[i++]=215,n[i++]=255,o.setUint32(i,4e6*t.getMilliseconds()+(r/1e3/4294967296>>0)),o.setUint32(i+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:t,targetView:r,position:o}=e(3);t[o++]=212,t[o++]=255,t[o++]=255}else{let{target:n,targetView:o,position:i}=e(15);n[i++]=199,n[i++]=12,n[i++]=255,o.setUint32(i,1e6*t.getMilliseconds()),o.setBigInt64(i+4,BigInt(Math.floor(r)))}}},{pack(t,e,n){let r=Array.from(t),{target:o,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(o[i++]=212,o[i++]=115,o[i++]=0),n(r)}},{pack(t,e,n){let{target:r,position:o}=e(this.moreTypes?3:0);this.moreTypes&&(r[o++]=212,r[o++]=101,r[o++]=0),n([t.name,t.message])}},{pack(t,e,n){let{target:r,position:o}=e(this.moreTypes?3:0);this.moreTypes&&(r[o++]=212,r[o++]=120,r[o++]=0),n([t.source,t.flags])}},{pack(t,e){this.moreTypes?$l(t,16,e):Ll(El?r.Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==Cl&&this.moreTypes?$l(t,il.indexOf(n.name),e):Ll(t,e)}},{pack(t,e){let{target:n,position:r}=e(1);n[r]=193}}];let Fl=new Dl({useRecords:!1});const Nl=Fl.pack,Pl=Fl.pack,Yl=Dl,{NEVER:Kl,ALWAYS:Rl,DECIMAL_ROUND:jl,DECIMAL_FIT:Hl}=Al,Vl=512,Gl=1024;const ql=function(t,e={}){if(!t||"object"!=typeof t)throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");const n=new Lu(e);let o;const i=t=>{let e;o&&(t=r.Buffer.concat([o,t]),o=void 0);try{e=n.unpackMultiple(t)}catch(n){if(!n.incomplete)throw n;o=t.slice(n.lastPosition),e=n.values}return e};return"function"==typeof t[Symbol.iterator]?function*(){for(const e of t)yield*i(e)}():"function"==typeof t[Symbol.asyncIterator]?async function*(){for await(const e of t)yield*i(e)}():void 0},zl=function(t,e={}){if(t&&"object"==typeof t){if("function"==typeof t[Symbol.iterator])return function*(t,e){const n=new Dl(e);for(const e of t)yield n.pack(e)}(t,e);if("function"==typeof t.then||"function"==typeof t[Symbol.asyncIterator])return async function*(t,e){const n=new Dl(e);for await(const e of t)yield n.pack(e)}(t,e);throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}throw new Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable")};var Jl=e(Object.freeze({__proto__:null,useRecords:!1,mapsAsObjects:!0,Packr:Dl,Encoder:Yl,addExtension:function(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");ml.unshift(t.Class),yl.unshift(t)}!function(t){t.unpack?xu[t.type]=t.unpack:xu[t.type]=t}(t)},pack:Nl,encode:Pl,NEVER:Kl,ALWAYS:Rl,DECIMAL_ROUND:jl,DECIMAL_FIT:Hl,REUSE_BUFFER_MODE:Vl,Unpackr:Lu,Decoder:ll,C1:Tu,unpack:fl,unpackMultiple:dl,decode:gl,FLOAT32_OPTIONS:Al,clearSource:cl,roundFloat32:function(t){Il[0]=t;let e=ul[(127&bl[3])<<1|bl[2]>>7];return(e*t+(t>0?.5:-.5)>>0)/e},isNativeAccelerationEnabled:!1,decodeIter:ql,encodeIter:zl}));const Wl=Iu,Xl=lu,{Packr:Zl,pack:th,unpack:eh}=Jl,nh="msgpackr::structs";var rh=class{constructor(t,e){this.repo=Wl.isRepo(t)?t:new Wl(t),this.cache=new oh(this.repo._db),this._strategy=e||(()=>{}),this._stores=[],this._loaded=!1,this._mutex=Promise.resolve(0),this._tap=null,this._packr=null,this.mutexTimeout=5e3}async _waitLock(){const t=this._mutex;let e,n;const r=new Promise(((t,r)=>{e=t,n=r}));this._mutex=r;let o=null;try{throw new Error("MutexTimeout")}catch(t){o=t}const i=setTimeout((()=>{console.error("MutexTimeout",o.stack),n(o)}),this.mutexTimeout);return await t,()=>{clearTimeout(i),e()}}register(t,e,n,r,o){if(this._loaded)throw new Error("register() must be invoked before load()");return"string"!=typeof t?this.register(t.name,t.initialValue,t.filter,t.reducer,t.trap):"function"==typeof e?this.register(t,void 0,e,n):void this._stores.push({name:t,validator:n,reducer:r,trap:o,version:0,head:void 0,value:e,initialValue:e,observers:new Set})}async load(){const t=await this._waitLock();if(this._loaded)throw new Error("Store already loaded");let e=await this.repo.readReg(nh);e=e?eh(e):[],this._packr=new Zl({structures:e,saveStructures:()=>this.repo.writeReg(nh,th(e)).catch(console.error.bind(null,"Failed saving msgpackr:structs"))});for(const t of this._stores){const e=await this.repo.readReg(`HEADS/${t.name}`);if(e){t.head=e,t.version=this._decodeValue(await this.repo.readReg(`VER/${t.name}`)),t.value=this._decodeValue(await this.repo.readReg(`STATES/${t.name}`));for(const e of t.observers)e(t.value)}}this._loaded=!0,t()}async dispatch(t,e){const n=await this._waitLock();try{const r=await this._dispatch(t,e);return n(),r}catch(t){throw n(),t}}async _dispatch(t,e=!1){if(!this._loaded)throw Error("Store not ready, call load()");t=Xl.from(t);let n=null;try{const e=t.first.isGenesis?t.first.sig:t.first.parentSig;n=await this.repo.resolveFeed(e)}catch(e){if("Unknown feed"!==e.message)throw e;if(!t.first.isGenesis)return await this.cache.push(t),[];n=new Xl}for(const e of t.blocks()){const[n,r]=await this.cache.pop(e.parentSig,e.sig);n&&sh(!t.merge(n),"Backward merge failed"),r&&sh(!t.merge(r),"Forwrad merge failed")}if(!n.clone().merge(t)){if(e)throw new Error("UnmergablePatch");return[]}const r={};n.first?.isGenesis?(r.HEAD=n.first.key,r.CHAIN=n.first.sig):!n.length&&t.first.isGenesis&&(r.HEAD=t.first.key,r.CHAIN=t.first.sig);const o=n.length?n._compare(t):t.length;if(o<1)return[];const i=new Set,s=this.state;let a=null;const c=t.get(-o);if(!c.isGenesis&&!n.length){if(e)throw new Error("NoCommonParent");return[]}if(!c.isGenesis&&n.length){const t=n.blocks();let e=t.next();for(;!a&&!e.done;)e.value.sig.equals(c.parentSig)&&(a=e.value),e=t.next();if(!a)throw new Error("ParentNotFound")}let u=0;for(const n of t.blocks(-o)){const t=[];for(const o of this._stores){if("function"!=typeof o.validator)continue;let i=o.validator({block:n,parentBlock:a,state:o.value,root:s,...r});if(i){if(!0===i);else if(e)throw"string"==typeof i&&(i=new Error(`InvalidBlock: ${i}`)),i}else t.push(o)}if(!t.length)break;const o=await this._mutateState(n,a,r,!1,e);for(const t of o)i.add(t);a=n,u++}this._notifyObservers(i);const l=Array.from(i);return Object.defineProperty(l,"patch",{enumerable:!1,get:()=>t.slice(-o,-o+u)}),l}async _mutateState(t,e,n,r=!1,o=!1){const i=[],s=[];for(const r of this._stores){if("function"!=typeof r.validator)continue;if("function"!=typeof r.reducer)continue;const o=this.state;r.validator({block:t,parentBlock:e,state:r.value,root:o,...n})||s.push(r)}if(s.length){const e=await this.repo.merge(t,this._strategy);if(!r&&!e)return o&&console.warn("RejectedByBucket: MergeStrategy failed"),i}const a=[],c=(t,e)=>a.push([t,e]);for(const r of s){const o=this.state,s=r.reducer({block:t,parentBlock:e,state:r.value,root:o,signal:c,...n});void 0===s&&console.warn("Reducer returned `undefined` state."),await this._commitHead(r,t.sig,s),i.push(r.name)}for(const[r,o]of a)for(const s of this._stores){if("function"!=typeof s.trap)continue;const a=this.state,c=s.trap({code:r,payload:o,block:t,parentBlock:e,state:s.value,root:a,...n});void 0!==c&&(await this._commitHead(s,t.sig,c),i.push(s.name))}if("function"==typeof this._tap)for(const[t,e]of a)this._tap(t,e);return i}_notifyObservers(t){for(const e of t){const t=this._stores.find((t=>t.name===e));for(const e of t.observers)e(t.value)}}async _commitHead(t,e,n){await this.repo.writeReg(`STATES/${t.name}`,this._encodeValue(n)),await this.repo.writeReg(`HEADS/${t.name}`,e),await this.repo.writeReg(`VER/${t.name}`,this._encodeValue(t.version++)),t.value=n,t.head=e}get state(){return this._stores.reduce(((t,e)=>(t[e.name]=e.value,t)),{})}async reload(){const t=await this._waitLock();try{const e=[],n=await this.repo.listFeeds();for(const t of this._stores){t.value=t.initialValue,t.version=0,t.head=void 0;for(const e of t.observers)e(t.value)}for(const{key:t,value:r}of n){const n=await this.repo.loadFeed(t),o={HEAD:n.first.key,CHAIN:r};let i=null;for(const t of n.blocks()){const n=await this._mutateState(t,i,o,!0);for(const t of n)~e.indexOf(t)||e.push(t);i=t}}return t(),this._notifyObservers(e),e}catch(e){throw t(),e}}on(t,e){const n=this._stores.find((e=>e.name===t));if(!n)throw new Error(`No such store: "${t}"`);if("function"!=typeof e)throw new Error("observer must be a function");return n.observers.add(e),e(n.value),()=>n.observers.delete(e)}hotswap(t){const e=this.repo;this.repo=t instanceof Wl?t:new Wl(t);return[this.reload(),e._db.clear()]}_decodeValue(t){return t?this._packr.unpack(t):t}_encodeValue(t){return this._packr.pack(t)}};class oh{constructor(t){this.blocks=t.sublevel("b",{keyEncoding:"buffer",valueEncoding:"buffer"}),this.refs=t.sublevel("r",{keyEncoding:"buffer",valueEncoding:"buffer"})}async push(t){if(t.first.isGenesis)throw new Error("GenesisRefused");for(const e of t.blocks())await this.refs.put(e.parentSig,e.sig),await this._writeBlock(e)}async pop(t,e){const n=[],r=[],o=[];let i=t,s=[];for(;;){const t=await this._readBlock(i);if(!t)break;n.push(t.parentSig),r.push(t.parentSig),s.push(t),i=t.parentSig}for(s.length&&o.push(Xl.fromBlockArray(s)),i=e,s=[];;){const t=await this.refs.get(i).catch(ih);if(!t)break;const e=await this._readBlock(t);n.push(t),r.push(e.sig),s.push(e),i=e.sig}return s.length&&o.push(Xl.fromBlockArray(s)),await Promise.all([this.blocks.batch(r.map((t=>({type:"del",key:t})))),this.refs.batch(n.map((t=>({type:"del",key:t}))))]),o}async _writeBlock(t){const e=t.sig,n=r.Buffer.alloc(32+t.buffer.length);t.key.copy(n,0),t.buffer.copy(n,32),await this.blocks.put(e,n)}async _readBlock(t){const e=await this.blocks.get(t).catch(ih);if(e)return Xl.mapBlock(e,32,e.slice(0,32))}async _hasBlock(t){return!!await this.readBlock(t)}}function ih(t){if(!t.notFound)throw t}function sh(t,e){if(t)throw new Error(e||"AssertionError")}var ah,ch,uh={exports:{}},lh={exports:{}},hh=lh.exports={};function fh(){throw new Error("setTimeout has not been defined")}function dh(){throw new Error("clearTimeout has not been defined")}function gh(t){if(ah===setTimeout)return setTimeout(t,0);if((ah===fh||!ah)&&setTimeout)return ah=setTimeout,setTimeout(t,0);try{return ah(t,0)}catch(e){try{return ah.call(null,t,0)}catch(e){return ah.call(this,t,0)}}}!function(){try{ah="function"==typeof setTimeout?setTimeout:fh}catch(t){ah=fh}try{ch="function"==typeof clearTimeout?clearTimeout:dh}catch(t){ch=dh}}();var Ah,ph=[],yh=!1,mh=-1;function Ih(){yh&&Ah&&(yh=!1,Ah.length?ph=Ah.concat(ph):mh=-1,ph.length&&bh())}function bh(){if(!yh){var t=gh(Ih);yh=!0;for(var e=ph.length;e;){for(Ah=ph,ph=[];++mh<e;)Ah&&Ah[mh].run();mh=-1,e=ph.length}Ah=null,yh=!1,function(t){if(ch===clearTimeout)return clearTimeout(t);if((ch===dh||!ch)&&clearTimeout)return ch=clearTimeout,clearTimeout(t);try{ch(t)}catch(e){try{return ch.call(null,t)}catch(e){return ch.call(this,t)}}}(t)}}function Eh(t,e){this.fun=t,this.array=e}function wh(){}hh.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];ph.push(new Eh(t,e)),1!==ph.length||yh||gh(bh)},Eh.prototype.run=function(){this.fun.apply(null,this.array)},hh.title="browser",hh.browser=!0,hh.env={},hh.argv=[],hh.version="",hh.versions={},hh.on=wh,hh.addListener=wh,hh.once=wh,hh.off=wh,hh.removeListener=wh,hh.removeAllListeners=wh,hh.emit=wh,hh.prependListener=wh,hh.prependOnceListener=wh,hh.listeners=function(t){return[]},hh.binding=function(t){throw new Error("process.binding is not supported")},hh.cwd=function(){return"/"},hh.chdir=function(t){throw new Error("process.chdir is not supported")},hh.umask=function(){return 0};var Ch,vh,Bh={exports:{}};function _h(){if(vh)return Ch;vh=1;var t=1e3,e=60*t,n=60*e,r=24*n,o=7*r,i=365.25*r;function s(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}return Ch=function(a,c){c=c||{};var u=typeof a;if("string"===u&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*i;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*e;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(a);if("number"===u&&isFinite(a))return c.long?function(o){var i=Math.abs(o);if(i>=r)return s(o,i,r,"day");if(i>=n)return s(o,i,n,"hour");if(i>=e)return s(o,i,e,"minute");if(i>=t)return s(o,i,t,"second");return o+" ms"}(a):function(o){var i=Math.abs(o);if(i>=r)return Math.round(o/r)+"d";if(i>=n)return Math.round(o/n)+"h";if(i>=e)return Math.round(o/e)+"m";if(i>=t)return Math.round(o/t)+"s";return o+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))},Ch}var kh=function(t){function e(t){let r,o,i,s=null;function a(...t){if(!a.enabled)return;const n=a,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=e.formatters[o];if("function"==typeof i){const e=t[s];r=i.call(n,e),t.splice(s,1),s--}return r})),e.formatArgs.call(n,t);(n.log||e.log).apply(n,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=n,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==e.namespaces&&(o=e.namespaces,i=e.enabled(t)),i),set:t=>{s=t}}),"function"==typeof e.init&&e.init(a),a}function n(t,n){const r=e(this.namespace+(void 0===n?":":n)+t);return r.log=this.log,r}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},e.disable=function(){const t=[...e.names.map(r),...e.skips.map(r).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=_h(),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e};!function(t,e){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))})),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==lh.exports&&"env"in lh.exports&&(t=lh.exports.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=kh(e);const{formatters:n}=t.exports;n.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}(Bh,Bh.exports);var Sh=Bh.exports;!function(t){const e=Bh.exports("pico-net"),n=Symbol.for("pico:plug");function o(o={}){const a=o?.timeout||3e4;let c=o?.id,l=!1,[h,f]=[!1,!1];const d=B(!0),g=B(!1),[A,p,y]=u(),[m,I,b]=u(),E=[!1,!1],[w,C]=u(),v=new Set;return[d,g];function B(t){const r={get name(){return`${c||"|"} ${t?"--\x3e":"<--"} `},get id(){return c},set id(t){if(c)throw new Error("ID has already been set");c=t},get onmessage(){return E[t?0:1]=!0,t?A:m},get opened(){return l?Promise.reject(new Error("Disconnected")):(E[t?1:0]=!0,(t?m:A).then((t=>!!t)))},get closed(){return w},set onmessage(e){if("function"!=typeof e)throw new Error("expected onmessage to be a function");if(t?h:f)throw new Error("Handler has already been set");t?(p(e),h=!0):(I(e),f=!0)},async postMessage(e,n){if(l)throw new Error("Disconnected");if(!r.isActive)throw new Error("Void");E[t?1:0]=!0;const o=await(t?m:A);return _(t,(t=>o(t)),e,n)},get isActive(){return(t?f:h)&&!l},get isClosed(){return l},open:t=>i(t)?s(r,t):(r.onmessage=t,r.opened.then((()=>[r.postMessage,r]))),close(n=null){!function(t,n=null){if(l)return!0;e("PipeClosed by: %s cause: %s pending: %d",t?"A":"B",n?.message,v.size),l=!0;for(const t of Array.from(v))v.delete(t),t.abort(n||new Error("Disconnected"));C(n),E[0]&&y(n||new Error("Disconnected"));E[1]&&b(n||new Error("Disconnected"))}(t,n)},get other(){return t?g:d}};return r[n]=!0,r}async function _(e,n,o,i){if(l)throw new Error("Disconnected");if("function"==typeof i)throw new Error("Callback API has been deprecated");const s=1&i||i,c=t.exports.V&&`${(e?d:g).name} = ${o.toString(r.Buffer.isBuffer(o)&&"hex").slice(0,14)}`,[h,f,A]=function(t,e=!1){const[n,r,o]=u(e),i=setTimeout(o.bind(null,new Error("Timeout")),t);return[n,(t,e)=>{clearTimeout(i),r(t,e)},function(t){clearTimeout(i),o(t||new Error("Aborted"))}]}(a,c);f.abort=A,s&&v.add(f),v.delete(n);const p=s?_.bind(null,!e,f):null;try{n([o,p,e?g:d]),s||f([])}catch(t){A(t),console.warn("Trap A: ",t.message)}return h.catch((t=>{throw console.warn("Trap B: ",t.message),t}))}}function i(t){return!(!t||!t[n])}function s(t,e){if(!i(t)||!i(e))throw new Error("Expected two pipe-ends");function n(t,e){if(!Array.isArray(e))throw new Error("DesignFlaw");const[r,o]=e;let i=t(r,!!o);return o&&(i=i.then(n.bind(null,o))),i.catch((t=>{console.warn("Trap S: ",t.message)}))}return t.onmessage=t=>n(e.postMessage,t),e.onmessage=e=>n(t.postMessage,e),t.closed.then(e.close).catch(e.close),e.closed.then(t.close).catch(t.close),t.close}let a=0;const c=[];function u(e=!1){if(e)return function(e="_"){const n=a++;let r=null;try{throw new Error}catch(t){r=t.stack}console.debug("[UNP]",n,e,"Promise Created\n",t.exports.V>1&&r);const[o,i,s]=u();return c[n]=s,[o.then((t=>(l("resolved",t),t))).catch((t=>{throw l("rejected",void 0,t),t})),t=>{l("set",t),i(t)},t=>{l("abort",void 0,t),s(t)}];function l(r,o,i){c[n]=void 0;const s=c.map(((t,e)=>t&&e)).filter((t=>t));if("set"!==r)console.debug("[UNP]",n,e,r,`P(${s.join(",")})`,i?i.message:Array.isArray(o)?`Arr[${o.length}]: ${o[0]||""}`:o);else{let r=null;try{throw new Error}catch(t){r=t.stack}t.exports.V>1&&console.debug("[UNP]",n,e,"SET at: \n",r)}}}(e);let n,r;return[new Promise(((t,e)=>{n=t,r=e})),n,r]}const l=3e4;function h(t,e){const n=(t,n,o,i)=>t(e.encode(n),o&&r.bind(null,o,i)),r=(t,r,o,i)=>t(e.decode(r),o&&n.bind(null,o,i));return e=>{const o=t(r.bind(null,e));return n.bind(null,o)}}t.exports=class{constructor(t,e){this._nodes=new Set,this._tap=null,"function"==typeof t&&(this._tap=t),"function"==typeof e&&(this._afterRemove=e)}createWire(t,e={}){const[n,r]=o(e);n.onmessage=([t,e])=>{if(!this._tap)return this.broadcast(t,e,n).catch((t=>console.error("_broadcast failed:",t)));this._tap(n,t,e).catch((t=>console.error("_tap failed:",t)))};const i=setTimeout((()=>n.close(new Error("NodeTimedout"))),3e4);return n.opened.then((e=>{if(!e)return console.warn("wire.opened resolved false?",e);clearTimeout(i),this._nodes.add(n),"function"==typeof t&&t(n)})).catch((t=>this.disconnect(n,t))),n.closed.then((t=>this.disconnect(n,t))),r}disconnect(t,e){if(!t)return!1;if(this._nodes.delete(t))return"function"==typeof this._afterRemove?this._afterRemove(t,e):e&&console.warn("NodeDisconnected",e),!0;for(const t of this._nodes)if(t.id===t&&this._nodes.delete(t))return"function"==typeof this._afterRemove?this._afterRemove(t,e):e&&console.warn("NodeDisconnected",e),!0}get count(){return this._nodes.size}async*survey(t,e,n){let r=!1;const o=new Set;for(const r of this._filterNodes(n)){const n=r.postMessage(t,e);o.add(n),n.catch((t=>{o.delete(n),console.warn("Survey node ignored:",t)}))}for(;!r&&o.size;){const t=await Promise.race(Array.from(o).map((t=>t.then((e=>({val:e,p:t}))))));if(!t)continue;o.delete(t.p);const e=()=>{r=!0};yield[...t.val,e]}}async broadcast(t,e,n){const r=this.survey(t,e,n),o=[];let i=await r.next();for(;!i.done;)o.push(i.value),i=await r.next();return o}_filterNodes(t){return t?(Array.isArray(t)||(t=[t]),Array.from(this._nodes).filter((e=>e.isActive&&!t.find((t=>i(t)?t===e:t===e.id))))):this._nodes}},t.exports.V=0,t.exports.picoWire=o,t.exports.simpleWire=function(t,e,n){const[r,i]=o();return r.closed.then(n).catch(n),r.opened.then(e).catch(e),r.onmessage=t,i},t.exports.streamWire=function(t,e){const n=new Map;let o=1,i=r.Buffer.alloc(256);const s=t(h.bind(null,0));e.on("data",u),e.once("close",c),e.once("error",c);const a=t=>t?e.end():e.destroy(t);return a;function c(t){e.off("data",u),e.off("error",c),e.off("close",c),s.close(t)}function u(t){const e=t.readUInt16BE(0),r=t.readUInt16BE(2);if(n.has(e)){const{replyTo:o,timer:i}=n.get(e);n.delete(e),clearTimeout(i),o(t.slice(6),((t,e)=>h(r,t,e)))}else 0===e?s(t.slice(6),((t,e)=>h(r,t,e))):console.warn("WARN: streamWire Message dropped",t[6])}function h(t,s,c){let u=0;"function"==typeof c&&(u=o++,function(t,e){const r=setTimeout((()=>{n.has(t)&&(n.delete(t),a(new Error("ResponseTimeout")))}),l);n.set(t,{replyTo:e,timer:r})}(u,c));const h=s.length+6;if(h>i.length){if(h>=262144)throw new Error("Message exceeds MTU");i=r.Buffer.alloc(h)}i.writeUInt16BE(t),i.writeUInt16BE(u,2),i.writeUInt16BE(h,4),s.copy(i,6),e.write(i.slice(0,h))}},t.exports.hyperWire=function(t,e,n,o=125){if(!i(t))throw new Error("Wire end expected");const s=new Map;let a=1;const c=e.open(n,{onextension:function(e,n){if(e!==o)return console.warn("Message dropped! multiple extensions on this channel??",o,e);const r=n.readUInt16BE(0),i=n.readUInt16BE(2),a=n[4],c=!!(1&a);if(s.has(r)){const{replyTo:t,timer:e}=s.get(r);s.delete(r),clearTimeout(e),t(n.slice(5),a).then(c&&h.bind(null,i)).catch((t=>console.error("Hyperwire writeerror",t)))}else 0===r?t.postMessage(n.slice(5),a).then(c&&h.bind(null,i)).catch((t=>console.error("Hyperwire writeerror",t))):console.warn("Hyperwire message dropped! unknown port",r,i)},onclose:t.close}),u=()=>{c.close()};return t.onmessage=t=>h(0,t),t.closed.then((()=>!c.closed&&u())).catch((t=>e.delete(t))),u;function h(t,e){const[n,i]=e;if(!r.Buffer.isBuffer(n))throw new Error("Binary message expected");let h=0,f=0;"function"==typeof i&&(h=a++,function(t,e){const n=setTimeout((()=>{s.has(t)&&(s.delete(t),u())}),l);s.set(t,{replyTo:e,timer:n})}(h,i),f|=1);const d=r.Buffer.alloc(n.length+5);d.writeUInt16BE(t),d.writeUInt16BE(h,2),d[4]=f,n.copy(d,5),c.extension(o,d)}},t.exports.spliceWires=s,t.exports.jsonTransformer=function(t){return h(t,{encode:t=>r.Buffer.from(JSON.stringify(t)),decode:t=>JSON.parse(t)})},t.exports.encodingTransformer=h,t.exports.messageIterator=async function*(t){const e=[],n=[];let r=!1;e.push(new Promise((t=>n.push(t))));const o=t(((t,i)=>{e.push(new Promise((t=>n.push(t)))),n.shift()([t,i,function(){o.close(),r=!0}])}));for(;!r;)yield await e.shift()},t.exports.unpromise=u}(uh);const xh=uh.exports,Qh=lu,{pack:Mh,unpack:Th}=Jl,{write:Dh}=n.exports;var $h=class{constructor(t){this.nodeId=(t=>r.Buffer.from(Array.from(new Array(t)).map((t=>Math.floor(256*Math.random())))))(8),this._controller=this._controller.bind(this),this.hub=new xh(((...t)=>this._controller(...t)),((...t)=>this._ondisconnect(...t))),this.handlers=t;const[e,n]=Dh([]);this._setConnections=n,this.$connections=e}spawnWire(){return this.hub.createWire((t=>{t.postMessage(Lh(3,this.nodeId),!0).then((([e,n])=>{if(0===Oh(e).type)return this._setConnections(Array.from(this.hub._nodes)),this.handlers.onconnect(t)})).catch((t=>console.error("Handshake failed",t)))}))}_ondisconnect(...t){this._setConnections(Array.from(this.hub._nodes)),this.handlers.ondisconnect(...t)}async _controller(t,e,n){try{const{type:o,data:i}=Oh(e);switch(o){case 2:for await(const r of this._downloadFeeds(e,n)){const e=await this.handlers.onblocks(r);e&&this.shareBlocks(e,t).catch((t=>console.error("Gossip failed",t)))}break;case 1:{const t=await this.handlers.onquery(i);this._uploadFeeds(n,t).catch((t=>console.error("Failed uploading blocks",t)))}break;case 3:for(const e of this.hub._nodes)if(r.Buffer.isBuffer(e.id)&&e.id.equals(i))return n(Lh(-1)),t.close(new Error("DuplicatePeer"));t.id=i,await n(Lh(0));break;default:throw new Error(`Unknown message type: ${o}`)}}catch(t){console.error("RPC:internal error",t)}}async shareBlocks(t,e){Qh.isFeed(t)&&(t=[t]);const n=(t=[...t]).shift(),r=this.hub.survey(Lh(2,n),!!t.length,e);for await(const[e,n]of r)t.length&&(0===Uh(e)&&n?this._uploadFeeds(n,t).catch((t=>console.error("Failed sending subsequent feeds",t))):console.warn("Remote rejected subsequent blocks",Uh(e)))}async query(t,e={}){const[n,r]=await t.postMessage(Lh(1,e),!0);0!==Oh(n).type&&this._controller(t,n,r)}_uploadFeeds(t,e){if(!e||!e.length)return t(Lh(0));const n=[...e];return t(Lh(2,n.shift()),!!n.length).then((([t,e])=>{if(n.length)return t?0!==Uh(t)?console.warn("Peer rejected subsequent blocks",Uh(t)):this._uploadFeeds(e,n):console.warn("Empty scope")}))}async*_downloadFeeds(t,e){let n=!1;for(;!n;){n=!0;const{type:r,data:o}=Oh(t);if(2===r)yield o;else if(e){console.warn("Expected BLOCKS but got",r),await e(Lh(-1),!1);continue}if(!e)continue;const i=await e(Lh(0),!0);t=i[0],e=i[1],n=!1}}};function Lh(t,e){let n=null;switch(t){case 2:if(!e)throw new Error("Feed expected");e=Qh.from(e),n=r.Buffer.alloc(e.tail+1),e.buf.copy(n,1,0,e.tail);break;case-1:case 0:n=r.Buffer.alloc(1);break;case 1:{const t=Mh(e);n=r.Buffer.alloc(t.length+1),t.copy(n,1)}break;case 3:n=r.Buffer.alloc(9),e.copy(n,1);break;default:throw new Error("UnknownMessageType: "+t)}return n[0]=t,n}function Uh(t){if(!r.Buffer.isBuffer(t))throw new Error("BufferExpected");return t[0]}function Oh(t){if(!r.Buffer.isBuffer(t))throw new Error("BufferExpected");const e=Uh(t);let n=null;switch(e){case 2:n=new Qh,n.buf=t.slice(1),n.tail=t.length-1;break;case 0:n="OK";break;case-1:n="ERROR";break;case 1:n=Th(t.slice(1));break;case 3:n=t.slice(1,9);break;default:throw new Error("UnknownMessageType: "+e)}return{type:e,data:n}}const Fh=Iu,Nh=rh,Ph=lu,{pack:Yh,unpack:Kh}=Jl,Rh=$h,jh="reg/sk";class Hh{constructor(t,e={}){this.db=t,this.repo=new Fh(t),this.store=new Nh(this.repo,this.mergeStrategy.bind(this)),this.ready=!1,this._secret=e.secret??null,this.rpc=new Rh({onconnect:t=>this.onconnect(t),ondisconnect:t=>this.ondisconnect(t),onquery:(t,e)=>this.onquery(t,e),onblocks:t=>this.onblocks(t)})}get pk(){return this._secret?.slice(32)}async boot(){return this.__loading||(this.__loading=(async()=>{if(!this._secret)try{this._secret=await this.repo.readReg(jh)}catch(t){if(!t.notFound)throw t}if(!this._secret){const{sk:t}=Ph.signPair();this._secret=t,await this.repo.writeReg(jh,t)}await this.store.load(),this.ready=!0})()),this.__loading}mergeStrategy(t,e){return!1}async feed(t){return this._checkReady(),this.repo.loadHead(this.pk)}_checkReady(){if(!this.ready)throw new Error("Kernel not ready, did you await kernel.boot()?")}async seq(){const t=await this.feed(1);return t?Hh.decodeBlock(t.last.body).seq:-1}async dispatch(t,e=!1){return this._checkReady(),await this.store.dispatch(t,e)}async createBlock(t,e,n){if("string"==typeof t)return this.createBlock(null,t,e);this._checkReady(),t=t||await this.feed()||new Ph;const r=await this.seq()+1,o=Hh.encodeBlock(e,r,n);t.append(o,this._secret);if(!(await this.dispatch(t,!0)).length)throw new Error("createBlock() failed: rejected by store");return this.rpc.shareBlocks(t.slice(-1)),t}spawnWire(){return this.rpc.spawnWire()}ondisconnect(t){}async onconnect(t){await this.rpc.query(t)}async onquery(t){const e=[],n=await this.repo.listHeads();for(const{key:t}of n){const n=await this.repo.loadHead(t);n&&e.push(n)}return e}async onblocks(t){return(await this.dispatch(t,!1)).patch}async _networkResolveFeed(t,e){}$connections(){return this.rpc.$connections}async close(){for(const t of this.rpc.hub._nodes)this.rpc.hub.disconnect(t);await this.db.close()}static encodeBlock(t,e,n){return Yh({...n,type:t,seq:e,date:(new Date).getTime()})}static decodeBlock(t){return Kh(t)}static typeOfBlock(t){return Hh.decodeBlock(t).type}}const Vh=lu,Gh=rh,qh=uh.exports,zh=Hh,Jh=$h,Wh=Iu,{decodeBlock:Xh,encodeBlock:Zh}=zh;var tf={Feed:Vh,SimpleKernel:zh,decodeBlock:Xh,encodeBlock:Zh,n:n.exports,Store:Gh,Hub:qh,SimpleRPC:Jh,Repo:Wh},ef=e(Object.freeze({__proto__:null,default:{}}));const nf="#bbbba9";async function rf(t,e={}){const n=await t.listHeads(),o=await t.listTails(),i=await t.listLatest(),s=await t.listFeeds(),a=await t.listFeedHeads(),c=e.colors||{},u=e.blockLabel||(t=>{const e=t.body.subarray(0,8).toString("hex");return`ID: ${m(t.sig)}\nKEY: ${m(t.key)}\nBDY: ${e}`});let l="// Nodes\n",h="// Edges\n";const f=[],d=[];for(const t of n){const e=m(t.key);l+=`"H${e}"\n      [\n        fontcolor="#cd94b0",\n        color="#cd94b0",\n        label="${`Author Head \n${m(t.key)}`}"\n      ];\n`,h+=`"H${e}" -> "B${m(t.value)}"[arrowhead=odot];\n`,f.push(t.value)}for(const t of o){const e=m(t.value);l+=`"T${e}"\n      [\n        fontcolor="#cd94b0",\n        color="#cd94b0",\n        label="${`Author Tail\n ${m(t.key)}`}"\n      ];\n`,h+=`"B${e}" -> "T${e}"[dir=back,arrowtail=odot];\n`}for(const t of i){const e=m(t.value);l+=`"L${e}"\n      [\n        fontcolor="#9ab278",\n        color="#9ab278",\n        label="${`Latest\n ${m(t.key)}`}"\n      ];\n`,h+=`"L${e}" -> "B${e}"[arrowhead=odot];\n`}for(const t of s){const e=m(t.key);l+=`"F${e}"\n      [\n        fontcolor="#db797b",\n        color="#db797b",\n        label="${`Chain Tail\n${m(t.value)}`}"\n      ];\n`,h+=`"B${m(t.value)}" -> "F${e}"[dir=back,arrowtail=odot];\n`,f.find((e=>e.equals(t.key)))||(f.push(t.key),d.push(t.key))}for(const t of a){const e=m(t.key);l+=`"FT${e}"\n      [\n        fontcolor="#db797b",\n        color="#db797b",\n        label="${`Chain Head\n${m(t.key)}`}"\n      ];\n`,h+=`"FT${e}" -> "B${m(t.value)}"[arrowhead=odot];\n`}let g=0,A=0,p=0,y=0;for(const e of f){const n=d.find((t=>t.equals(e)));g++;for await(const o of t._chainLoad(e)){A++,p+=o.buffer.length,y+=o.size;const t=m(o.sig),e=u(o,{link(e,n='style=dashed,weight=0.1,color="#d08c6d"'){if(!r.Buffer.isBuffer(e))throw new Error("link(id) expected id to be Buffer");h+=`"B${t}" -> "B${m(e)}"[${n}];\n`}}),i=n?c.orphanBlock||"#73a8a2":c.block||nf;l+=`"B${t}"\n        [\n          fontcolor="${i}",\n          color="${i}"\n          shape="square",\n          label="${e}"\n        ];\n`,o.isGenesis||(h+=`"B${t}" -> "B${m(o.parentSig)}"\n          [\n            color="#818e85",\n            fillcolor="#bbbba9",\n            weight=1.0\n          ];\n`)}}return`\n    digraph G {\n      graph [pad=0.2,labelloc="t",fontcolor="#bbbba9",bgcolor="#2f383e",fontname="fixed",overlap="false",center="1",ratio="compress",label="${e.label||`[PicoRepo] Authors: ${i.length} Feeds: ${g}, Blocks: ${A}, Bytes: ${sf(p)} (${sf(p-y)} ${(100*(p-y)/p).toFixed(2)}%)`}",rankdir=BT];\n      edge [color="black",fillcolor="#2c323d",weight=2.0];\n      node [style=filled,fillcolor="#2c323d",color="#818e85",shape="rect",fontcolor="#bbbba9",shape=box];\n    ${l}\n    ${h}\n    }\n  `;function m(t){return t.subarray(0,4).toString("hex")}}var of={inspect:rf,dump:async function(t,e="repo.dot",n={}){const r=await rf(t,n);ef.writeFileSync(e,r)}};function sf(t,e=!1){const n=t<0?-t:t;return n<1e3?r(t,"B"):n<1e6?r(t/1e3,"kB"):n<1e9?r(t/1e6,"MB"):r(t/1e9,"GB");function r(t,n){return(t=Math.round(10*t)/10)+(e?" ":"")+n}}var af={exports:{}};const{crypto_box_seal:cf,crypto_box_seal_open:uf,crypto_box_keypair:lf,crypto_box_SEALBYTES:hf,crypto_box_PUBLICKEYBYTES:ff,crypto_box_SECRETKEYBYTES:df}=rr.exports,gf=cr,Af=Bh.exports,{SimpleKernel:pf}=tf,yf=r.Buffer.from("💔"),mf=r.Buffer.from("😶"),{encodeBlock:If,decodeBlock:bf,typeOfBlock:Ef}=pf;Af.formatters.h=t=>r.Buffer.isBuffer(t)&&t?.length?t.slice(0,Math.min(8,t.length)).toString("hex"):t,Af.formatters.H=t=>r.Buffer.isBuffer(t)&&t?.length?t.toString("hex"):t;var wf={KEY_SK:"reg/sk",KEY_BOX_LIKES_PK:"reg/likes_pk",KEY_BOX_LIKES_SK:"reg/likes_sk",TYPE_PROFILE:"peer",TYPE_VIBE:"vibe",TYPE_VIBE_RESP:"vres",TYPE_MESSAGE:"msg",TYPE_BYE:"bye",TYPE_BYE_RESP:"byebye",TYPE_ITEMS:"bar",TYPE_ACTIVATE:"act",EV_CHAT_END:60,EV_BALANCE_DEBIT:71,EV_BALANCE_CREDIT:70,EV_ADD_SCORE:72,VIBE_REJECTED:yf,PASS_TURN:mf,PEACE:0,LOVE:2,UNDERSTANDING:1,G_M:0,G_F:1,G_NB:2,G_R:3,GEO_BITS:17,encodeBlock:If,decodeBlock:bf,typeOfBlock:Ef,fixJsonBuffers:function t(e){if("object"==typeof e&&"Buffer"===e.type)return r.Buffer.from(e.data);if(Array.isArray(e))return e.map(t);if("object"==typeof e)for(const n in e)e[n]=t(e[n]);return e},toBuffer:function(t){return t?r.Buffer.isBuffer(t)?t:"string"==typeof t&&/^[0-9A-f]+$/.test(t)?r.Buffer.from(t,"hex"):"string"==typeof t?r.Buffer.from(t):"object"==typeof t&&"Buffer"===t.type?r.Buffer.from(t.data):t:t},boxPair:function(){const t=r.Buffer.allocUnsafe(ff),e=r.Buffer.allocUnsafe(df);return lf(t,e),{pk:t,sk:e}},seal:function(t,e){const n=r.Buffer.allocUnsafe(hf+t.length);return cf(n,t,e),n},unseal:function(t,e,n){const o=r.Buffer.allocUnsafe(t.length-hf),i=uf(o,t,n,e);return gf(i,"DecryptionFailedError"),o},bufferReplacer:function(t,e){return e&&"object"==typeof e&&"Buffer"===e.type?r.Buffer.from(e.data):e},btok:function(t){return gf(r.Buffer.isBuffer(t),"Expected Buffer"),t.toString("hex")},ktob:function(t){return gf("string"==typeof t,"Expected string"),r.Buffer.from(t,"hex")}};const{typeOfBlock:Cf,TYPE_PROFILE:vf,TYPE_VIBE:Bf,TYPE_VIBE_RESP:_f,TYPE_MESSAGE:kf,TYPE_BYE:Sf,TYPE_BYE_RESP:xf,VIBE_REJECTED:Qf,PASS_TURN:Mf,PEACE:Tf,LOVE:Df,UNDERSTANDING:$f,decodeBlock:Lf}=wf;function Uf(t,e=!0){switch(Cf(t.body)){case vf:return"ᚹ";case Bf:return"ᚲ";case _f:return Qf.equals(Lf(t.body).box)?"ᛟ":"ᛃ";case kf:return Mf.equals(Lf(t.body).content)?e?"ᚦ":"ᚧ":e?"ᛖ":"ᛗ";case Sf:case xf:return e?"ᛒ":"ᛔ"}}function Of(t){const e=[[/ᚲᛃ/,"ᛄ"],[/(ᚦᚧᚦ|ᚧᚦᚧ)/,"ᚷ"],[/([ᛄᚴᚵᛆᚠᚯ])ᛖᛗ/,"$1ᚴ"],[/([ᛰᛐᛑᛅ])ᛗᛖ/,"$1ᛐ"],[/ᚴᚴ/,"ᚵ"],[/ᛐᛐ/,"ᛑ"],[/ᛒᛔ/,"ᛸ"],[/ᛔᛒ/,"ᛷ"],[/ᛖᚧ/,"ᛆ"],[/(ᚦᚧ|ᚧᚦ)/,"ᚺ"],[/ᚴᛆ/,"ᚠ"],[/ᚴᚦᛗ/,"ᛅ"],[/ᚵᚦᛗ/,"ᚯ"],[/ᚴᚺ/,"ᛰ"],[/ᛆᚦ/,"ᚢ"],[/ᛆᛆᚦᛷ/,"ᚤᛷ"],[/ᚴᛖᛷ/,"ᛈ"],[/ᚠᚠᛷ/,"ᚸᛷ"]];let n=null;for(;n!==t;){n=t;for(const[n,r]of e)t=t.replace(n,r)}return t}var Ff={feedToGraph:function(t){let e="",n=t.first.isGenesis?t.first.key:null;for(const r of t.blocks()){Cf(r.body)!==Bf||n||(n=r.key);const t=n&&r.key.equals(n);e+=Uf(r,t)}return e},scoreGraph:function(t){if(t=Of(t),/ᚷ/.test(t))return[0,0];const e={"ᛄ":[0,0],"ᛖ":[1,0],"ᛗ":[0,1],"ᛸ":[5,3],"ᛷ":[2,4],"ᚴ":[2,1],"ᛐ":[0,2],"ᚵ":[4,3],"ᛑ":[2,4],"ᛆ":[-1,2],"ᚠ":[-1,3],"ᛅ":[2,4],"ᚯ":[2,5],"ᛰ":[1,3],"ᛈ":[-1,0]};let n=0,r=0;for(const o of t.split(""))e[o]?(n+=e[o][0],r+=e[o][1]):console.warn("Unscored glyph: ",o);return[n,r]},blockToGlyph:Uf,rewrite:Of},Nf=Object.freeze({profile_timeout:108e5,vibe_timeout:3e5,vibe_response_timeout:18e4,chat_timeout:18e5,now:Date.now});const{TYPE_PROFILE:Pf,EV_CHAT_END:Yf,EV_BALANCE_CREDIT:Kf,EV_BALANCE_DEBIT:Rf,EV_ADD_SCORE:jf,decodeBlock:Hf,btok:Vf}=wf,Gf=cr,{scoreGraph:qf}=Ff,zf="active",Jf="pending",Wf="locked",Xf="expired",{profile_timeout:Zf}=Nf;function td(t){return{name:null,picture:null,pk:t,tagline:null,date:null,sex:2,sig:null,expiresAt:0,state:zf,balance:0,score:0}}function ed(t){if(!t.picture)return"Profile Picture missing";if(r.Buffer.isBuffer(t.picture)){if(t.picture.length>21e3)return"Picture should be less than 21kB"}else if("string"!=typeof t.picture||t.picture.length>10)return"Picture should be an emoji";return nd(t.tagline)?"URL in tagline not permitted":nd(t.name)?"Links in name is not permitted":t.name.match(/^\s/)?"Name must contain only letters or numbers":"number"!=typeof t.age?"Age must be a number":t.age<18?"Kids not allowed into bars":!~[0,1,2].indexOf(t.sex)&&"Sex should be 0: female, 1: male, 2: other"}function nd(t){return"string"==typeof t&&!!t.match("://")}af.exports=()=>({name:"peers",initialValue:{},filter:({block:t,state:e})=>{const n=Hf(t.body);return n.type!==Pf||ed(n)},reducer:({block:t,state:e,schedule:n})=>{const r=t.key.toString("hex");return e[r]=e[r]||td(r),Object.assign(e[r],Hf(t.body,1)),e[r].pk=t.key,e[r].sig=t.sig,e[r].expiresAt=e[r].date+Zf,n("peer",t.key,e[r].expiresAt),e},trap({code:t,payload:e,root:n,state:o}){switch(t){case Yf:{const t=Vf(e),i=n.chats.chats[t],s=qf(i.graph);o[Vf(i.a)].score+=s[0],o[Vf(i.b)].score+=s[1],o[Vf(i.a)].balance+=s[0],o[Vf(i.b)].balance+=s[1];const a=n.trs[t];if(!a?.length)return;for(const t of a)switch(t.type){case"debit":Gf(r.Buffer.isBuffer(t.target),"InvalidPeerId"),Gf(Number.isFinite(t.amount),"InvalidAmount"),o[Vf(t.target)].balance-=t.amount;break;case"credit":Gf(r.Buffer.isBuffer(t.target),"InvalidPeerId"),Gf(Number.isFinite(t.amount),"InvalidAmount"),o[Vf(t.target)].balance+=t.amount}}break;case Kf:{const{target:t,amount:n}=e;o[Vf(t)].balance+=n}break;case Rf:{const{target:t,amount:n}=e;o[Vf(t)].balance-=n}break;case jf:{const{target:t,amount:n}=e;o[Vf(t)].score+=n}break;default:return}return o}}),af.exports.ProfileCtrl=function(t){let e=null;return{name:"peer",initialValue:td(),filter({block:n}){if(e=e||t(),!e)return"Cannot process block without knowing own identity";if(!n.key.equals(e))return!0;const r=Hf(n.body);return r.type!==Pf||ed(r)},reducer:({block:t,state:n,root:r})=>({...r.peers[Vf(e)]}),trap({code:t,payload:n,root:r,state:o}){const i=r.peers[Vf(e)];let s=!1;switch(t){case Yf:{const t=Vf(n),o=r.chats.chats[t];s=e.equals(o.a)||e.equals(o.b)}break;case Kf:case Rf:case jf:s=e.equals(n.target)}if(s)return{...i}}}},af.exports.stateOfPeer=function(t,e,n){if(t.state===Xf)return Xf;if(t.state!==zf)throw new Error(`InvalidState: ${t.state}`);const r=t.pk.toString("hex"),o=e.seen[r]?.toString("hex");if(!o)return zf;const i=e.matches[o];if(!i)throw new Error("MentalError");if("rejected"===i.state)return zf;if("match"!==i.state)return Jf;const s=n.chats[o];return s&&"end"===s.state?zf:Wf},af.exports.ACTIVE=zf,af.exports.PENDING=Jf,af.exports.LOCKED=Wf,af.exports.EXPIRED=Xf;const{TYPE_VIBE:rd,TYPE_VIBE_RESP:od,TYPE_PROFILE:id,TYPE_BYE_RESP:sd,TYPE_ITEMS:ad,TYPE_ACTIVATE:cd,EV_CHAT_END:ud,VIBE_REJECTED:ld,decodeBlock:hd,unseal:fd}=wf,dd=Bh.exports("picochat:slices:vibes"),{vibe_timeout:gd,vibe_response_timeout:Ad}=Nf;const pd=()=>({chatId:null,response:null,updatedAt:0,a:null,b:null,remoteBox:null});var yd=class{constructor(t=gd){this._sk=null,this._pk=null,this._reduceHasRun=!1,this.ttl=t,this.reducer=this.reducer.bind(this)}setKeys(t,{sk:e,pk:n}){if(this._sk)throw new Error("VibeBox secret has already been set");if(this._reduceHasRun)throw new Error("Reducer has already run without box secret");this._sk=e,this._pk=n,this._peerId=t}get name(){return"vibes"}get initialValue(){return{seen:{},matches:{},own:[]}}filter({block:t,parentBlock:e,state:n}){const r=hd(t.body),{type:o}=r;if(o!==rd&&o!==od)return!0;const i=e&&hd(e.body).type;if(o===rd){if(i!==id&&i!==sd&&i!==ad&&i!==cd)return`InvalidParent: ${i}`;const e=t.key.toString("hex");if(r.date>(new Date).getTime())return"Vibe from the future";const o=n.seen[e];if(o){if(n.matches[o.toString("hex")].expiresAt>=Date.now())return"Only 1 active vibe allowed"}}return o===od&&i!==rd?`InvalidParent: ${i}`:(dd("Accepting Vibe %h",t.sig),!1)}reducer({block:t,state:e,parentBlock:n,root:r,schedule:o}){const i=hd(t.body,1),{type:s}=i,a=s===rd?t.sig:t.parentSig,c=a.toString("hex"),u=ld.equals(i.box);if(s===rd){if(dd("%s reducing vibe: %o %h",r.peer.name,!!e.matches[c],t.sig),e.matches[c])throw new Error("InternalError: Vibe already registered");e.seen[t.key.toString("hex")]=a;const n=e.matches[c]=pd();n.chatId=a,n.a=t.key,n.updatedAt=i.date,n.createdAt=i.date,n.expiresAt=i.date+gd,n.state="wait"}else{const n=e.matches[c];if(!n)throw new Error("InternalError: MatchNotFound");n.response=t.sig,n.b=t.key,n.updatedAt=i.date,n.expiresAt=n.createdAt+Ad,n.state=u?"rejected":"match"}const l=r.peer.pk,h=e.matches[c];s===rd&&l.equals(t.key)&&e.own.push(a);let f=null;if(!u&&!l.equals(t.key)&&this._sk)try{f=fd(i.box,this._sk,this._pk)}catch(t){if("DecryptionFailedError"!==t.message)throw t}return f&&(e.own.find((t=>t.equals(a)))||e.own.push(a),h.remoteBox=f),this._reduceHasRun=!0,o("chat",h.chatId,h.expiresAt),e}trap({code:t,payload:e,root:n,state:r}){if(t===ud){{const t=e.toString("hex"),o=n.chats.chats[t];delete r.seen[o.a.toString("hex")],dd("%s Peer Unseen %h => %h",n.peer.name,o.a.toString("hex"),e)}return r}}};const md=Bh.exports("picochat:slice:chat"),{TYPE_VIBE_RESP:Id,TYPE_MESSAGE:bd,TYPE_BYE:Ed,TYPE_BYE_RESP:wd,EV_CHAT_END:Cd,PASS_TURN:vd,decodeBlock:Bd}=wf,{blockToGlyph:_d}=Ff;var kd=function(t={}){const{ttl:e,blockReward:n,health:r,regenerate:o}={ttl:18e4,blockReward:6e4,health:3,regenerate:.3,...t},i=()=>(new Date).getTime();return{name:"chats",initialValue:{chats:{},heads:{},own:[],stats:{}},filter({block:t,parentBlock:e,state:n,root:r}){const o=Bd(t.body),{type:s}=o;if(!~[bd,Ed,wd].indexOf(s))return!0;const a=e&&Bd(e.body).type;if(md("[%s] FilterOP: %s %h <-- %s %h",r.peer.name,a,e.sig,s,t.sig),s===bd&&a!==bd&&a!==Id||s===Ed&&a!==bd||s===wd&&a!==Ed)return`Invalid parent type: ${a}`;const c=t.key;if(c.equals(e.key))return"MonologueNotAllowed";if(a===Id){const t=e.parentSig,n=r.vibes.matches[t.toString("hex")];if(!n)return!0;if("match"!==n.state)return"MessagingNotAllowed";if(![n.a,n.b].find((t=>c.equals(t))))return"NotYourConversation";if(n.expiresAt<i())return"ConversationTimeout"}else{const e=n.heads[t.parentSig.toString("hex")];if(!e)return"ConversationNotFound";const r=n.chats[e.toString("hex")],o=r.mLength%2?r.b:r.a;if(!c.equals(o))return"NotYourConversation";if(r.expiresAt<i())return"ConversationTimeout";if(s!==wd&&"active"!==r.state)return"ConversationEnded";if(s===wd&&"finalizing"!==r.state)return"InvalidState"}return!1},reducer({block:t,parentBlock:i,root:s,state:a,schedule:c,signal:u}){const l=Bd(t.body),{type:h}=l,f=Bd(i.body).type,d=s.peer.pk,g=t.key;let A=null;A=f===Id?i.parentSig:a.heads[t.parentSig.toString("hex")];const p=A.toString("hex");if(f===Id){const t=s.vibes.matches[p],e=(t=>({id:t,head:null,messages:[],expiresAt:0,updatedAt:0,state:"active",a:null,b:null,hp:r,aEnd:-1,bEnd:-1,graph:"ᚲᛃ"}))(A);e.a=t.a,e.b=t.b,e.remoteBox=t.remoteBox,e.createdAt=t.createdAt,e.mLength=0,a.chats[p]=e}const y=a.chats[p];y.updatedAt=l.date,y.mLength++,y.expiresAt=y.createdAt+e+y.mLength*n,y.graph+=_d(t,t.key.equals(y.a));const m=t.key.toString("hex");let I=a.stats[m];if(I||(I=a.stats[m]=(t=>({peerId:t,lastSeen:0,nMessages:0,nExhausted:0,nPassed:0,nEnded:0,nStarted:0,blocks:0,blockSize:0,hpRegenerated:0}))(t.key),I.nStarted++,md("[%s] Initating new stats for %h",s.peer.name,t.key)),I.lastSeen=Math.max(I.lastSeen,l.date),I.nMessages++,I.blocks++,I.blockSize+=t.body.length,bd===h){const e=vd.equals(l.content);if(e&&I.nPassed++,e&&--y.hp<1?(y.state="exhausted",I.nExhausted++):e||(y.hp=Math.min(o+y.hp,r),I.hpRegenerated+=o),y.own=!![y.a,y.b].find((t=>d.equals(t))),y.own){const n=d.equals(g);y.messages.push({type:n?"sent":"received",date:l.date,content:n?null:l.content,pass:e,sig:t.sig})}y.own&&!a.own.find((t=>t.equals(A)))&&a.own.push(A)}else y.state=Ed===h?"finalizing":"end",y.a.equals(g)?y.aEnd=l.gesture:y.bEnd=l.gesture,md("ENDING: ",s.peer.name,h,y.state,y.aEnd,y.bEnd);if("end"===y.state){const t=a.stats[y.b.toString("hex")],e=a.stats[y.a.toString("hex")];t.nEnded++,e.nEnded++,u(Cd,A)}return md("[%s] Conversation(%h) state: %s mLength: %d, head: %h => %h",s.peer.name,A,y.state,y.mLength,t.parentSig,t.sig),delete a.heads[t.parentSig.toString("hex")],a.heads[t.sig.toString("hex")]=A,y.head=t.sig,c("chat",y.id,y.expiresAt),a}}};const Sd=cr,xd={},Qd=[],Md={};function Td(t,e){if(!t)return()=>{};const n="Item#"+t.toString(16).toUpperCase();return Sd(void 0===Qd[t],`Duplicate ${n}`),(r,...o)=>{const i=r.join("").split("\n"),s={id:t};for(;i.length;){const t=i.shift().trim();if(!t.length)continue;const[e,n]=t.split(":").map((t=>t.trim()));if("desc"===e)break;switch(e){case"time":case"price":s[e]=parseInt(n);break;default:s[e]=n}}i.length&&(s.desc=i.map((t=>t.trim())).join("\n")),Sd(s.name?.length,`${n}: 'name' required`),Sd(s.short?.length,`${n}: 'short' required`),Sd(s.image?.length,`${n}: 'image' required`),Sd(s.desc?.length,`${n}: 'desc' required`);Sd(s.type?.length,`${n}: 'type' required`),Sd(~["consumable","active","passive","attachment"].indexOf(s.type),`${n}: Invalid 'type'`);Sd(s.type?.length,`${n}: 'group' required`),Sd(~["drinks","gear","misc"].indexOf(s.group),`${n}: Invalid 'group'`),s.time&&Sd(Number.isFinite(s.time),`${n}: 'time' Invalid`),s.price&&(Sd(Number.isFinite(s.price),`${n}: 'price' Invalid`),s.irlPrice=t<53760&&t>=53504),Qd[t]=s,xd[s.group]=xd[s.group]||[],xd[s.group].push(s),e&&(Md[e]=t)}}Td(55041,"WATER")`
name: Glass of Water
time: 60
price: 0
short: Stay hydrated
image: 🥛
group: drinks
type: consumable
desc: |-
  Disregarding the looks, it's a regular glass of
  water.
  Can be purchased once a Day
`,Td(53505)`
name: Lager
time: 20
short: Cold, quenching
price: 200
image: 🍺
type: consumable
group: drinks
desc: |-
  Freshly brewed from the finest grains.
  There's always more.
`,Td(53506)`
  name: Kosmo
  time: 18
  short: Sweet, intoxicating
  price: 300
  mod: Random perk
  image: 🍹
  type: consumable
group: drinks
  desc: |-
    Applies one random effect for the duration of the drink.

    - One part moonlight
    - Two parts autumn honey
    - An orange stolen from a dream
    - A leaf caught midair
    You can barely taste the vodka
`,Td(53507)`
name: White
time: 22
short: Dry refreshing
price: 320
image: 🍷
group: drinks
type: consumable
desc:
  slightly matured
`,Td(53508)`
name: Stout
time: 30
price: 500
mod: silence
short: Liquid darkness
image: 🍫
type: consumable
group: drinks
desc: |-
  Vibe disabled

  The bitterness is intense with aftertones of
  dark chocolate.
  Not a lager
`,Td(53509)`
name: Sparkly Wine
time: 15
mod: 1.5X Rewards
price: 600
short: Proof of Prestige
image: 🍾
type: consumable
group: drinks
desc:
  Bob liked to show off, it was deeply embedded in his psyche.
`,Td(53504)`
name: Tip
image: 🙏
price: 100
short: Boost feature development
type: passive
group: misc
desc: |-
  DecentLabs - Compressing the internet to fit in the palm of your hand.

  Thank you for playing.
`,Td(53249)`
time: 60
name: Verified Badge
short: Not a robot
type: passive
group: misc
soulbind: pickup
image: 🏅
desc: |-
  "Don't collect what you can't protect"

  We only store your email for a short while to keep track of your purchases.
`,Td(53250)`
time: 80
name: V.I.P. Ticket
short: Welcome to the Void
type: passive
group: misc
soulbind: pickup
image: 🎫
desc: |-
  Entrance-fee and complimentary drink included.
`,Td(55040)`
name: Search Water
time: 10
price: 0
short: The developers best friend
image: 🚰
group: misc
cooldown: 500
type: attachment
desc: |-
  Lorem ipsum dolor sit amet went on a long journey
  but lorem forgot to bring a snack. So amet said
  "Don't worry bruh, I got you, I brought enough chocolate to bring down the entire mountain!"
  And so the adventure continued.
`,Td(53760)`
name: B.A.B.
slot: head
price: 12
mod: 1.1X rewards
soulbind: pickup
short: Never leave home without it
image: ☮️
type: active
group: gear
desc: |-
  Consecutive wins increases rewards +0.3X stacks upto 3X.
  But lose and you'll lose your stacks and
  get no reward for that game.

  Life's a gamble trust Cosmos
`,Td(53761)`
name: Fades
slot: eyes
price: 38
soulbind: use
mod: Silenced, Timestrech 3X
short: Lean back and enjoy your stay
image: 🕶️
type: active
group: gear
desc: |-
  Vibe disabled and time flows 3X slower while active.
  Relax, listen to the music, you're not in a hurry.
`,Td(53763)`
name: Tic Tac Nano
price: 5
short: No talk, Play!
mod: minigame
image: ♟️
type: attachment
group: gear
desc: |-
  Attach to vibe to challenge someone to a round of tic-tac-toe.
`,Td(53764)`
name: Question Card
price: 7
short: Draw card, compare answers
mod: minigame
image: 🃏
type: attachment
group: gear
desc: |-
  Attach to vibe to answer a random question,
  answers revealed when both players have answered.
`,Td(53765)`
name: Twin Bed
image: 💤
price: 50
short: Just sleep, nothing else
type: attachment
mod: sleep 6H
group: gear
desc: |-
  Had enough for one day?
  Attach to vibe to put both players to sleep
  and save your profile for tomorrow.
`,Td(53762)`
name: Boom Deck 202
slot: hands
price: 2400
mod: DJ mode | TIMEFLOW 3X
short: Play the song of your people
image: 📻
type: active
group: gear
desc: |-
  Take the DJ seat and broadcast your tunes.
  But beware! Time flows 3X faster while active 😱
  Make sure to collect tips.
`,Td()`
name: Super POH Turbo II
short: Insert Coin
price: 12
image: 🎮
type: collectible
group: gear
desc: |-
  Play a nervewrecking arcade featuring unique characters and combos.
`,Td()`
name: Xorcery Offline
short: Crypts of Cryptography
image: ⚔️
price: 60
type: collectible
group: gear
desc: |-
  Rougelike dungeon crawler, form your party and
  explore the Crypts of Cryptography finding treasures
  and monsters.
`;var Dd={...Md,ITEMS:Qd,GROUPS:xd};const $d=cr,{ITEMS:Ld,WATER:Ud}=Dd;var Od=class t{static ACTION_OFFER=1;static ACTION_NETWORK_PURCHASE=2;static ACTION_ATTACHMENT=3;static validate(e){if(!e)throw new Error("Must be an object");const{t:n,p:r}=e;let o;switch(n){case t.ACTION_NETWORK_PURCHASE:{const{i:t,q:e}=r;$d(Nd(t),"p.i: ItemId missing"),$d(Ld[t],"p.i: UnknownItem"),$d(t>=53760,"NotPurchasable"),$d(Fd(e),"p.q: Quantity missing"),t===Ud&&$d(1===e,"p.q. One per customer"),o={i:t,q:e}}break;case t.ACTION_OFFER:{const{i:t,q:e}=r;$d(Nd(t),"p.i: ItemId missing"),$d(Ld[t],"p.i: UnknownItem"),$d(Fd(e),"p.q: Quantity missing"),o={i:t,q:e}}break;case t.ACTION_ATTACHMENT:$d(Nd(r),"p: ItemId missing"),$d(Ld[r],"p: UnknownItem"),$d(~["attachment","consumable"].indexOf(Ld[r].type),"p: ItemNotAttachable"),o=r;break;default:$d(!1,`UnknownTransaction: ${n}`)}return{t:n,p:o}}};function Fd(t){return Number.isInteger(t)}function Nd(t){return Number.isInteger(t)&&t>=0}const{btok:Pd,decodeBlock:Yd,EV_CHAT_END:Kd,EV_BALANCE_CREDIT:Rd,EV_BALANCE_DEBIT:jd,EV_ADD_SCORE:Hd,TYPE_VIBE_RESP:Vd,TYPE_ITEMS:Gd,TYPE_ACTIVATE:qd,VIBE_REJECTED:zd}=wf,{now:Jd}=Nf,Wd=Bh.exports("picochat:slices:inv"),{ACTIVE:Xd,stateOfPeer:Zd}=af.exports,{validate:tg,ACTION_OFFER:eg,ACTION_NETWORK_PURCHASE:ng,ACTION_ATTACHMENT:rg}=Od,og=r.Buffer.from("jWR6XgHjIeNA8xDtVtjOxdsUhgKzABQ75HHi30ab8X0=","base64"),{ITEMS:ig}=Dd;function sg(t,e){return t[e]=t[e]||{},t[e]}function ag(t,e){return t[e]=t[e]||{id:e,qty:0,activatedAt:-1,deactivatedAt:-1,expiresAt:-1},t[e]}function cg(t,e,n){if(53249===e){const e=ig[53249].time;n(Rd,{target:t,amount:e}),n(Hd,{target:t,amount:e})}}var ug={InventorySlice:function(){return{name:"inv",initialValue:{},filter({block:t,root:e,state:n,HEAD:r}){const o=Yd(t.body);if(o.type!==Gd&&o.type!==qd)return!0;const i=Pd(r),s=e.peers[i];if(Zd(s,e.vibes,e.chats)!==Xd)return"PeerBusy";if(o.type===Gd){const e=o.items.find((t=>t.id<53760));if(e&&!t.key.equals(og))return"StampNotTrusted";if(Jd()-o.date>=36e5)return"DeliveryTimeout"}else{if(!ig[o.i])return"UnknownItem";if(!~["consumable","active"].indexOf(ig[o.i].type))return"CannotBeActivated";const t=n[i];if(!t)return"InventoryEmpty";const e=t[o.i];if(!e)return"ItemNotHeld";if(e.qty<=0)return"OutOfStock"}return!1},reducer({block:t,state:e,schedule:n,signal:r,HEAD:o}){const i=Pd(o),s=Yd(t.body),a=sg(e,i);if(s.type===Gd)for(const t of s.items){const e=ag(a,t.id);e.qty++,e.expiresAt=t.expiresAt,cg(o,t.id,r),Wd("onPickup(%x, %x, %i)",o,t.id,e.qty)}else{const{i:t}=s,e=ig[t],n=ag(a,t);"consumable"===e.type?(n.qty--,n.activatedAt=Jd(),r(Hd,{target:o,amount:e.time}),r(Rd,{target:o,amount:e.time})):!function(t){return!(-1===t.activatedAt||t.activatedAt<t.deactivatedAt)}(n)?(n.activatedAt=Jd(),console.warn("Item activation effects not implemented")):(n.deactivatedAt=Jd(),console.warn("Item deactivation effects not implemented")),Wd("onActivate(%x, %x, %i)",o,e,n.qty)}return e},trap({code:t,payload:e,root:n,state:r}){if(t!==Kd)return;const o=Pd(e),i=n.trs[o];if(i?.length){for(const t of i){if("item"!==t.type)continue;const e=ag(sg(r,Pd(t.target)),t.item);e.qty+=t.qty;const o=n.peers[Pd(t.target)]?.name||t.target;Wd("[%s]onTrade(%h, %h, %i) => %i",n.peer.name,o,t.item,t.qty,e.qty)}return r}}}},TransactionsSlice:function(){return{name:"trs",initialValue:{},filter({block:t,parentBlock:e,root:n,state:r}){const{type:o,box:i}=Yd(t.body);if(o!==Vd)return!0;if(zd.equals(i))return!0;const{t:s}=Yd(e.body);try{for(const t of s){const{t:r,p:o}=tg(t);switch(r){case eg:{const t=Pd(e.key),r=n.inv[t];if(!r)return"InventoryEmpty";const i=r[o.i];if(!i)return"ItemNotHeld";if(i.qty-o.q<0)return"NegativeQuantity"}break;case ng:{const{i:t,q:r}=o,i=ig[t].price*r,s=Pd(e.key);if(n.peers[s].balance<i)return"InsufficientFunds"}}}}catch(t){return t.message}return!1},reducer({block:t,parentBlock:e,root:n,state:r}){const o=Pd(e.sig),{t:i}=Yd(e.body),s=r[o]=[];for(const{t:r,p:o}of i)switch(r){case rg:{const n=e.key,r=t.key,i=ig[o];i.consumable&&s.push({type:"item",item:o.i,qty:-o.q,target:n}),s.push({type:"credit",target:r,amount:i.time})}break;case eg:s.push({type:"item",item:o.i,qty:o.q,target:t.key}),s.push({type:"item",item:o.i,qty:-o.q,target:e.key});break;case ng:{const r=e.key,i=t.key,a=n.peers[Pd(r)]?.name||r;Wd("[%s]txBuy(%h, %h, %i) => %i",n.peer.name,a,o.i,o.q);const c=ig[o.i];s.push({type:"debit",target:r,amount:c.price}),s.push({type:"credit",target:i,amount:.02*c.price}),s.push({type:"item",item:o.i,qty:o.q,target:r})}}return r},trap({code:t,payload:e,root:n,state:r}){if(t!==Kd)return;return delete r[Pd(e)],r}}}};const lg=Bh.exports("picochat:mod:chat"),{TYPE_MESSAGE:hg,TYPE_BYE:fg,TYPE_BYE_RESP:dg,PASS_TURN:gg,PEACE:Ag,LOVE:pg,UNDERSTANDING:yg,seal:mg,unseal:Ig,toBuffer:bg}=wf,{feedToGraph:Eg}=Ff,{combine:wg,mute:Cg,init:vg,gate:Bg}=n.exports;const{SIGNATURE_SIZE:_g}=lu,{toBuffer:kg}=wf;const Sg=Bh.exports("picochat:mod:gc"),{EXPIRED:xg}=af.exports;function Qg(t){const e=r.Buffer.alloc(9);return e.writeBigUInt64BE(BigInt(t),1),e[0]=116,e}function Mg(t){const e=t[0];return{type:t.slice(e+1).toString(),id:t.slice(1,e+1)}}var Tg={exports:{}};const Dg=Bh.exports("picochat:mod:peers"),$g=lu,{toBuffer:Lg,boxPair:Ug,btok:Og,TYPE_PROFILE:Fg,KEY_SK:Ng,KEY_BOX_LIKES_PK:Pg,KEY_BOX_LIKES_SK:Yg}=wf,{mute:Kg,combine:Rg,init:jg,gate:Hg,when:Vg}=n.exports,{EXPIRED:Gg,stateOfPeer:qg}=af.exports,zg=Object.freeze({state:"error",errorMessage:"PeerNotFound"}),Jg=Object.freeze({state:"loading"});function Wg([t,e,n,r]){if(!t)return zg;if(null===t.date)return Jg;if("error"===t.state)return t;if(!t.pk)throw new Error("kernel.$peers invoked before kernel.load() finished?");const o=t.pk.toString("hex"),i=n.stats[o]||{nEnded:0,nStarted:0,nMessages:0,nPassed:0,nExhausted:0},s=60*t.score*1e3,a=t.expiresAt+s,c=Og(t.pk),u=Object.values(r[c]||{}),l=!(!r[c]||!r[c][53249]);return{...t,stats:i,expiresAt:a,hasBadge:l,state:a<Date.now()?Gg:qg(t,e,n),inventory:u}}function Xg(t){if(!t||!(r.Buffer.isBuffer(t)&&32===t.length||"string"!=typeof t&&64===t.length))throw new Error(`PublicKey expected got "${t}"`);return Lg(t)}Tg.exports=function(){let t=null;const e=new Promise((e=>{t=e}));return{__setHasProfile:t,hasProfile:e,async register(e,n){n=n||$g.signPair().sk,this._secret=n;const r=Ug();this._vibeBox=r,this._vibeController.setKeys(this.pk,this._vibeBox),await this.updateProfile(e),await this.repo.writeReg(Ng,n),await this.repo.writeReg(Pg,r.pk),await this.repo.writeReg(Yg,r.sk),t(!0)},async profileOf(t){t=Xg(t);const e=this.store.state.peers[t.toString("hex")];return e||(Dg("Peer does not exist in registry %h",t),zg)},async updateProfile(t){return await this.createBlock(Fg,{...t,box:this._vibeBox.pk})},$peer(t){return Hg(jg(Jg,this._peer(t)))},_peer(t){try{t=Xg(t)}catch(t){return jg({...zg,errorMessage:t.message})}if(this.pk.equals(t))return this.$profile();const e=Kg((t=>this.store.on("peers",t)),(e=>e[t.toString("hex")]||zg));return Kg(Rg(e,(t=>this.store.on("vibes",t)),(t=>this.store.on("chats",t)),(t=>this.store.on("inv",t))),Wg)},$peers(){const t=Kg(this.store.on.bind(this.store,"peers"),(t=>{const e=Object.values(t);return this.pk?e.filter((t=>!this.pk.equals(t.pk))):e})),e=this.store.on.bind(this.store,"chats");return Hg(jg([],Kg(Rg(t,(t=>this.store.on("vibes",t)),e,(t=>this.store.on("inv",t))),(([t,e,n,r])=>t.map((t=>Wg([t,e,n,r]))).filter((t=>t.state!==Gg))))))},$profile(){const t=Vg(this.boot());return Hg(jg(Jg,Kg(Rg(Kg((t=>this.store.on("peer",t)),(async t=>(await e,t))),(t=>this.store.on("vibes",t)),(t=>this.store.on("chats",t)),(t=>this.store.on("inv",t)),t),Wg)))}}},Tg.exports.PEER_PLACEHOLDER=Jg,Tg.exports.ERR_PEER_NOT_FOUND=zg;const Zg=lu,{TYPE_VIBE:tA,TYPE_VIBE_RESP:eA,VIBE_REJECTED:nA,toBuffer:rA,seal:oA,boxPair:iA}=wf,{mute:sA,combine:aA,gate:cA,init:uA,until:lA}=n.exports,{PEER_PLACEHOLDER:hA}=Tg.exports,fA=Od,dA=Bh.exports("picochat:mod:vibes");async function gA(t){try{if(!t.peerId&&t.initiator){const e=r.Buffer.allocUnsafe(Zg.SIGNATURE_SIZE+1);t.id.copy(e,1),e[0]=84;const n=await this._readReg(e);t.peerId=n}"loading"===t.peer.state&&(t.peer=await this.profileOf(t.peerId))}catch(e){console.warn("Failed resolving vibe.peer",e),t.peer={state:"error",errorMessage:e.message}}return t}function AA(t,e,n,r){const o={...function(t){return{id:t,head:null,peer:hA,peerId:null,box:null,state:"waiting",updatedAt:0,createdAt:1/0,expiresAt:0,remoteRejected:!1,localRejected:!1,a:null,b:null,myTurn:!1,health:-1}}(t),updatedAt:e.updatedAt,createdAt:e.createdAt,expiresAt:r?.expiresAt||e.expiresAt,box:e.remoteBox,initiator:n,localRejected:n&&"rejected"===e.state,remoteRejected:!n&&"rejected"===e.state,a:e.a,b:e.b,head:e.response};return n?e.b&&(o.peerId=o.b):o.peerId=o.a,"rejected"===e.state?o.state="rejected":e.a&&e.b?o.state="match":n||e.b?n&&!e.b?o.state="waiting_remote":o.state="mental_error":o.state="waiting_local",o.myTurn="match"===o.state?r?!(r.mLength%2^(n?0:1)):n:"waiting_local"===o.state,"end"===r?.state&&(o.myTurn=!1),o.health=r?Math.floor(r.hp):3,~["waiting_remote","waiting_local"].indexOf(o.state)&&o.expiresAt<Date.now()&&(o.state="expired"),o}const{mute:pA,combine:yA}=n.exports,{ACTIVE:mA}=af.exports,{btok:IA}=wf;const bA=cr,{TYPE_ACTIVATE:EA}=wf;const{SimpleKernel:wA}=tf,{inspect:CA}=of,vA=af.exports,BA=yd,_A=kd,{InventorySlice:kA,TransactionsSlice:SA}=ug,xA=function(){return{$chats(){return Cg(this.$vibes(),(t=>t.filter((t=>"match"===t.state))))},$chat(t){t=bg(t);let e=null;const n=async(e,n=!1)=>{if(!i.myTurn)throw new Error("NotYourTurn");if(!n&&"string"!=typeof e)throw new Error("Message should be a string");if(!n&&!e.length)throw new Error("EmptyMessage");const o=await this._getRemoteChatKey(t),s=await this.repo.loadFeed(i.head),a=n?gg:mg(r.Buffer.from(e),o);await this.createBlock(s,hg,{content:a}),n||await this._setMessageBody(s.last.sig,r.Buffer.from(e))},o={id:t,state:"loading",initiator:!1,myTurn:null,peerId:null,peer:null,mLength:0,messages:[],updatedAt:0,createdAt:0,expiresAt:0,health:-1,errorMessage:null,head:null,send:async t=>n(t),pass:async()=>{if(!i.myTurn)throw new Error("NotYourTurn");return n(0,!0)},bye:async e=>{if(!i.myTurn)throw new Error("NotYourTurn");if(!~[Ag,pg,yg].indexOf(e))throw new Error("InvalidGesture");if(!~["active","finalizing"].indexOf(i.state))throw new Error("InvalidState");const n=await this.loadChat(t);if(!n)return console.error("branch dissapeared, expected head sig:",i.head?.toString("hex"));await this.createBlock(n,"active"===i.state?fg:dg,{gesture:e})}};let i=o;return Bg(vg(o,Cg(wg(this._vibe(t),(t=>this.store.on("chats",t))),(async([n,r])=>{const s=r.chats[t.toString("hex")];if(!n||"error"===n.state)return o.state="error",o.errorMessage="ChatNotFound",o;if("loading"===n.state)return o;if(o.head=n.head,"match"===n.state?o.state="active":"rejected"===n.state&&(o.state="rejected"),o.createdAt=s?s.createdAt:n.createdAt,o.updatedAt=s?s.updatedAt:n.updatedAt,o.expiresAt=s?s.expiresAt:n.expiresAt,o.peerId=n.peerId,o.peer=n.peer,o.initiator=n.initiator,o.myTurn=n.myTurn,o.health=n.health,!s)return o;if(o.head=s.head,o.graph=s.graph,o.state=s.state,"active"===o.state&&o.expiresAt<Date.now()&&(o.state="expired"),o.mLength=s.mLength,o.messages.length===s.messages.length)return o;try{e||(e=await this._getLocalChatKey(t)),o.messages=[...o.messages];for(let t=o.messages.length;t<s.messages.length;t++){const n={...s.messages[t]};n.pass?n.content=gg.toString():"received"===n.type?n.content=Ig(n.content,e.sk,e.pk).toString():n.content=await this._getMessageBody(n.sig),o.messages[t]=n}}catch(t){console.error("Message decryption failed",t)}return i=o,o}))))},async loadChat(t){const e=(t=bg(t)).toString("hex");let n=null;const r=this.store.state.vibes.matches[e];n=r?.response||r?.chatId,r||lg("vibe does not exist for chatId:",e);const o=this.store.state.chats.chats[e];if(r||o||lg("conversation not found %h",t),n=o?.head||n,!n)return;return(await this._tracePath(n)).feed},async _inspectChat(t,e=!1){const n=await this.loadChat(t);console.log(Eg(n)),e&&n.inspect()}}},QA=function(){const t={};return{async _writeReg(e,n){if(await this.repo.writeReg(e,n),!t[e.toString()])return;const{set:r,timerId:o}=t[e.toString()];delete t[e.toString()],clearTimeout(o),r(n)},async _readReg(e){const n=await this.repo.readReg(e);if(n)return n;if(t[e.toString()])return t[e.toString()].promise;let r=null,o=null;const i=new Promise(((n,i)=>{r=n,o=setTimeout((()=>{delete t[e.toString()],i(new Error("BufferedReadTimedOut"))}),5e3)}));if(!r)throw new Error("ConcurrencyError");return t[e.toString()]={promise:i,set:r,timerId:o},i},async _storeLocalChatKey(t,e){const n=e.sk.length+e.pk.length;if(64!==n)throw new Error(`Expected box keypair to be 32bytes each, did algorithm change?: ${n}`);if((t=kg(t)).length!==_g)throw new Error("Expected chatId to be a block signature");const o=r.Buffer.allocUnsafe(e.sk.length+e.pk.length);e.sk.copy(o),e.pk.copy(o,e.sk.length);const i=r.Buffer.allocUnsafe(_g+1);return t.copy(i,1),i[0]=67,await this._writeReg(i,o)},async _getLocalChatKey(t){if("string"==typeof t&&(t=r.Buffer.from(t,"hex")),(t=kg(t)).length!==_g)throw new Error("Expected chatId to be a block signature");const e=r.Buffer.allocUnsafe(_g+1);t.copy(e,1),e[0]=67;const n=await this._readReg(e);if(!n)throw new Error("BoxPairNotFound");return{pk:n.slice(32),sk:n.slice(0,32)}},async _getRemoteChatKey(t){const e=t.toString("hex"),n=this.store.state.vibes.matches[e];if(!n)throw new Error("ConversationNotFound");if(!n.remoteBox)throw new Error("BoxPublicKeyNotAvailable");return n.remoteBox},async _setMessageBody(t,e){if(t=kg(t),!r.Buffer.isBuffer(t)||t.length!==_g)throw new Error("Expected chatId to be a block signature");const n=r.Buffer.allocUnsafe(_g+1);return t.copy(n,1),n[0]=77,await this._writeReg(n,kg(e))},async _getMessageBody(t){if(t=kg(t),!r.Buffer.isBuffer(t)||t.length!==_g)throw new Error("Expected chatId to be a block signature");const e=r.Buffer.allocUnsafe(_g+1);t.copy(e,1),e[0]=77;const n=await this._readReg(e);if(!n)throw new Error("MessageNotFound");return n.toString()}}},MA=function(t){const e=t.repo;let n=null;function o(t,n,o){const i=Qg(o);e._db.put(i,function(t,e){t=r.Buffer.from(t);const n=e.length,o=r.Buffer.alloc(1+n+t.length);return e.copy(o,1),t.copy(o,n+1),o[0]=n,o}(t,n)).catch((t=>console.error("Failed queing GC: ",t)))}for(const e of t._stores)e._originalReducer=e.reducer,e.reducer=t=>e._originalReducer({...t,schedule:o});return{async _collectGarbage(e){Sg("Locking store");const n=await t._waitLock();try{const t=await i.bind(this)(e);return n(),t}catch(t){throw n(),t}},startGC(t=3e3){this.ready&&!n&&(n=setInterval(this._collectGarbage.bind(this),t))},stopGC(){n&&(clearInterval(n),n=null)}};async function i(n=Date.now()){Sg("Starting collecting garbage...");const r=await async function(t,e){const n={gt:Qg(0),lt:Qg(e)},r=t.iterator(n),o=[];for(;;)try{const[t,e]=await new Promise(((t,e)=>{r.next(((n,r,o)=>{n?e(n):t([r,o])}))}));if(!t)break;o.push({key:t,value:e})}catch(t){console.warn("Iterator died with an error",t);break}return await new Promise(((t,e)=>{r.close((n=>n?e(n):t()))})),o}(e._db,n);Sg("Fetched pending from store:",r.length);let o=new Set;const i=[];for(const e of r){const{type:r,id:a}=Mg(e.value);if(!r)throw new Error("GC OP missing");await s({now:n,id:a,gcType:r,rootState:t.state,didMutate:t=>o.add(t),drop:t=>i.push([t,"chat"===r?a:null])})}const a=[];for(const[t,e]of i)try{const n=await this._tracePath(t);if(e){if(!e.equals(n.chatId))throw new Error("InternalError: Attempted to evict wrong segment");const t=await this.repo.rollback(n.keys[0],n.heads[0]);a.push(t)}else a.push(await this.repo.rollback(n.keys[0]))}catch(t){"FeedNotFound"===t.message?Sg("RollbackFailed, Feed already gone",t):console.error("Rollback failed",t)}return o=Array.from(o),t._notifyObservers(o),Sg("Stores mutated",o,"segments evicted",a.length),{mutated:o,evicted:a}}function s({now:t,rootState:e,drop:n,gcType:r,id:o,didMutate:i}){if("chat"===r){const r=e.vibes.matches[o.toString("hex")],s=e.chats.chats[o.toString("hex")],a=s?.head||r?.response||r?.chatId;let c=!1;if(!a)return;const u=s?.expiresAt||r?.expiresAt||0,l=u<t;if(Sg("Chat[%h] expired: %s, timeLeft: %d",o,l,u-t),!l)return;if(s){const{chats:t,heads:n,own:r}=e.chats;delete t[o.toString("hex")],delete n[a.toString("hex")];const s=r.findIndex((t=>t.equals(o)));~s&&r.splice(s,1),i("chats"),c=!0}if(r){const{seen:t,matches:n,own:s}=e.vibes;r.a&&t[r.a.toString("hex")]?.equals(o)&&delete t[r.a.toString("hex")],r.b&&t[r.b.toString("hex")]?.equals(o)&&delete t[r.b.toString("hex")],delete n[o.toString("hex")];const a=s.findIndex((t=>t.equals(o)));~a&&s.splice(a,1),i("vibes"),c=!0}c&&n(a,o)}else{if("peer"!==r)throw new Error(`Garbage collection for "${r}" not supported!`);{const{peers:r}=e,s=e.peer.pk?.equals(o);s&&e.peer.expiresAt<t&&(e.peer.state=xg,i("peer"));const a=r[o.toString("hex")];a&&a.expiresAt<t&&(a.state=xg,i("peers"),s||(delete r[o.toString("hex")],n(a.sig)))}}}},TA=Tg.exports,DA=function(){return{async sendVibe(t,e=[]){if(t=rA(t),this.pk.equals(t))throw new Error("SelfVibeNotAllowed");const{matches:n,own:o}=this.store.state.vibes;for(const e of o){const r=n[e.toString("hex")];if("wait"===r.state&&t.equals(r.a))return this.respondVibe(r.chatId)}Array.isArray(e)||(e=[e]),e=e.map((t=>fA.validate(t)));const i=await lA(this.$cooldowns(),(t=>"loading"!==t.state));if(console.log("MyState",i),!i.canVibe)throw new Error("VibeNotReady");const s=iA(),a=await this.profileOf(t);if("error"===a.state)throw new Error(a.errorMessage);const c=oA(s.pk,a.box),u=(await this.createBlock(tA,{box:c,t:e})).last.sig;await this._storeLocalChatKey(u,s);const l=r.Buffer.allocUnsafe(Zg.SIGNATURE_SIZE+1);return u.copy(l,1),l[0]=84,await this._writeReg(l,a.pk),u},async respondVibe(t,e=!0){t=rA(t);const n=iA(),{own:r,matches:o}=this.store.state.vibes;if(!r.find((e=>e.equals(t))))throw new Error("NotYourVibe");const i=o[t.toString("hex")];if(!i)throw new Error("VibeNotFound");if("wait"!==i.state)throw new Error("VibeResponseNotApplicable");const s=await this.profileOf(i.a);if(!s)throw new Error("PeerNotFound");const a=oA(n.pk,s.box),c=await this.repo.readBlock(t);if(!c)throw new Error("Vibe no longer exists");if(!await this.createBlock(Zg.from(c),eA,{box:e?a:nA,link:this.store.state.peer.sig}))throw new Error("Failed creating block");return e&&await this._storeLocalChatKey(i.chatId,n),t},$vibe(t){return cA(uA({state:"loading",type:"vibe"},this._vibe(t)))},_vibe(t){try{t=function(t){if(!t||!(r.Buffer.isBuffer(t)&&64===t.length||"string"!=typeof t&&128===t.length))throw new Error(`ChatID expected got "${t}"`);return rA(t)}(t)}catch(t){return uA({state:"error",errorMessage:t.message})}return sA(aA((t=>this.store.on("chats",t)),(t=>this.store.on("vibes",t))),(([e,{matches:n}])=>{const r=n[t.toString("hex")],o=e.chats[t.toString("hex")];if(!r)return{state:"error",errorMessage:"VibeNotFound"};const i=this.pk.equals(r.a),s=AA(t,r,i,o);return gA.bind(this)(s)}))},$vibes(){return cA(uA([],sA(this._vibes(),(async t=>{const e=[];for(let n=0;n<t.length;n++){const r={...t[n]};await gA.bind(this)(r),e.push(r)}return dA("emit $vibes async"),e}))))},_vibes(){return sA(aA((t=>this.store.on("chats",t)),(t=>this.store.on("vibes",t))),(([t,{sent:e,received:n,own:r,matches:o}],i)=>{const s=[];for(const e of r){const n=o[e.toString("hex")],r=t.chats[e.toString("hex")],i=AA(e,n,this.pk.equals(n.a),r);"expired"!==i.state&&(r&&"end"===r.state||s.push(i))}return dA("emit _vibes"),s}))}}},$A=function(){return{$cooldowns(){return pA(yA(this.$profile(),(t=>this.store.on("vibes",t)),(t=>this.store.on("chats",t))),(([t,e,n])=>{const r={canVibe:t.state===mA,vibe:-1};if("loading"===t.state)return{state:"loading",...r};const o=e.seen[IA(t.pk)];if(!o)return r.vibe=0,r;const i=e.matches[IA(o)];if(!i)throw new Error("MentalError");r.vibe=i.expiresAt;const s=n.chats[IA(o)];return s&&(r.vibe=s.expiresAt),r}))}}},LA=function(){return{async useItem(t){bA(Number.isInteger(t),"ItemID expected");return(await this.createBlock(EA,{i:t})).last.sig}}},{KEY_SK:UA,KEY_BOX_LIKES_PK:OA,KEY_BOX_LIKES_SK:FA,TYPE_VIBE:NA,TYPE_VIBE_RESP:PA,TYPE_MESSAGE:YA,TYPE_PROFILE:KA,TYPE_BYE:RA,TYPE_BYE_RESP:jA,VIBE_REJECTED:HA,decodeBlock:VA,typeOfBlock:GA}=wf,qA=Od,zA=(0,Bh.exports)("picochat:kernel");var JA=class extends wA{static Transactions=qA;constructor(t,e={}){super(t,e),this._vibeBox=e.box??null,this.store.register(vA()),this.store.register(vA.ProfileCtrl((()=>this.pk))),this._vibeController=new BA,this.store.register(this._vibeController),this.store.register(_A()),this.store.register(kA()),this.store.register(SA()),Object.assign(this,TA()),Object.assign(this,DA()),Object.assign(this,xA()),Object.assign(this,QA()),Object.assign(this,MA(this.store)),Object.assign(this,$A()),Object.assign(this,LA())}async boot(){return this.__loading||(this.__loading=(async()=>{if(!this._secret)try{this._secret=await this.repo.readReg(UA)}catch(t){if(!t.notFound)throw t}return this._secret&&(this._vibeBox={sk:await this.repo.readReg(FA),pk:await this.repo.readReg(OA)},this._vibeController.setKeys(this.pk,this._vibeBox)),await this.store.load(),this.ready=!0,!(!this._secret||!this.store.state.peer)&&(this.__setHasProfile(!0),!0)})()),this.__loading}async _tracePath(t){const e=[],n=[];let r=null,o=0;const i=await this.repo.loadFeed(t,((t,i)=>{switch(GA(t.body)){case PA:e[1]=t.key,n[1]=VA(t.body).link;break;case KA:case jA:e[0]=t.key,n[0]=t.sig,o&&i();break;case NA:r=t.sig}o++}));if(!i)throw new Error("FeedNotFound");return{keys:e,heads:n,feed:i,chatId:r}}async mergeStrategy(t,e){const n=VA(t.body),{type:r}=n,o=await e.readBlock(t.parentSig),i=GA(o.body);if(r===PA){const r=await e.readBlock(t.parentSig);return i===NA&&(HA.equals(n.box)?zA("Rejection detected: %h </3 %h",t.key,r.key):zA("Match detected: %h <3 %h",t.key,r.key),!0)}return r===YA&&i===YA||(r===RA&&i===YA||(r===jA&&i===RA||(console.warn("MergeStrategy rejected",i,"<--",r),!1)))}async inspect(){return await CA(this.repo,{blockLabel(t,{link:e}){const n=wA.decodeBlock(t.body),r=`${n.type.toUpperCase()}\nseq:${n.seq}\n`;switch(n.type){case KA:return r+n.name;case NA:return r+"T: "+n.transactions?.length||0;case PA:return e(n.link),r;default:return console.info("Unknown type",n.type,n),r}}})}async reload(){return this.store.reload()}},WA={binstr:function(t,e){e=e||8*t.length;let n="";for(let r=0;r<t.length;r++)for(let o=0;o<8;o++)e===8*r+o&&(n+="|"),n+=t[r]&1<<o?"1":"0";return n},roundByte:XA,shift:ZA,unshift:tp,countTrailingZeroes:function(t){let e=t.length,n=0;for(;e--;)for(let r=7;r>=0;r--){if(t[e]&1<<r)return n;n++}return n},countOnes:function(t){let e=0;for(let n=0;n<t.length;n++){let r=t[n];for(;r;)1&r&&e++,r>>=1}return e},proximityOf:function(t,e){let n=0;for(;n<t.length&&op(t,n)===op(e,n);n++);return n},mapOverlap:function(t,e){e=e||(()=>{});const n=t.map((()=>0)),r=t.map((()=>0)),o=t.map((()=>0));let i=!1;const s=[];let a=!1;for(;!a;){for(let e=0;e<t.length;e++){if(!i&&r[e])continue;const a=t[e],c=n[e]++,u=a.length-1-(c>>3);if(u<0)return s;const l=a[u]>>7-c%8&1;r[e]?o[e]=l:l&&(r[e]=!0)}if(!i){i=r.reduce(((t,e)=>t&&e),!0);continue}const c=e(o,(()=>{a=!0}));ZA(s,c)&&(s[s.length]=1)}return s},packGeo:function(t,e,n){e||(e=5*t.length);if(e<5)throw new Error("precision has to be at least 5");const o=XA(e);n||(n=r.Buffer.alloc(o));const i=t.split("").reverse().reduce(((t,e,n)=>t+np[e]*32**n),0).toString(2).slice(0,e).split("").reverse();for(const t of i)ZA(n,"0"===t?0:1);return n},unpackGeo:rp,gammaShift:function(t,e){const n=Math.ceil(Math.log2(e));for(let e=0;e<n;e++)tp(t,0);tp(t,1);for(let r=0;r<n;r++)tp(t,e>>r&1)},gammaUnshift:function(t){let e=0;const n=8*t.length;for(;e<n;e++){const r=tp(t);if(r)break;if(e===n-1&&!r)throw new Error("NBitNotFound: end of buffer reached")}let r=1<<e;for(;e--;)r|=tp(t)<<e;return r},dGapEncode:function(t,e){e||(e=8*t.length);const n=[op(t,0)];let r=0,o=n[0],i=0;for(;i<e;){const e=op(t,i);e!==o&&(o=e,n.push(r),r=0),r++,i++}return n.push(r),n},decodeSL:function(t,e=16){const n=e+1,r=[];for(let e=0;e<XA(n);e++)r[e]=t[e];const o=tp(r),i=rp(r,e);return{sex:o,geohash:i}},bitAt:op,setBit:function(t,e,n=1){t[e>>3]=n?(t[e>>3]||0)|1<<e%8:(t[e>>3]||0)&~(1<<e%8);return t}};function XA(t){return(t>>3)+(t%8?1:0)}function ZA(t,e=0){let n=e?1:0;for(let e=0;e<t.length;e++){const r=t[e]>>7&1;t[e]=t[e]<<1|n,n=r}return n}function tp(t,e=0){let n=t.length,r=(e?1:0)<<7;for(;n--;){const e=(1&t[n])<<7;t[n]=r|t[n]>>1,r=e}return r?1:0}const ep="0123456789bcdefghjkmnpqrstuvwxyz",np=ep.split("").reduce(((t,e,n)=>(t[e]=n,t)),{});function rp(t,e=16){const n=XA(e);if(t.length<n)throw new Error("BufferUnderflow, dst buffer too small");const r=[];for(let e=0;e<n;e++)r[e]=t[e];let o="",i=0;for(let t=0;t<e;t++){i|=tp(r)<<4-t%5,!t||t%5||(o+=ep.charAt(i),i=0)}return o+=ep.charAt(i),o.replace(/0+$/,"")}function op(t,e){return t[e>>3]>>e%8&1}const{crypto_sign_SECRETKEYBYTES:ip,crypto_sign_PUBLICKEYBYTES:sp,crypto_sign_keypair:ap}=rr.exports,{packGeo:cp,shift:up,binstr:lp,roundByte:hp,decodeSL:fp}=WA,{GEO_BITS:dp}=wf,{pack:gp,unpack:Ap}=Jl,pp="default_signpair",yp="default_profile";class mp{constructor(t){this.db=t}async readIdentity(t=pp){return this.db.get(t).catch((t=>{if(!t.notFound)throw t}))}async writeIdentity(t,e=pp){if(!r.Buffer.isBuffer(t)||t.length!==ip)throw new Error("Expected SigningSecret");return this.db.put(e,t)}async writeProfile(t,e=yp){return this.db.put(e,gp(t))}async readProfile(t=yp){const e=await this.db.get(t).catch((t=>{if(!t.notFound)throw t}));if(e)return Ap(e)}static generateAnonymous(){const t=r.Buffer.allocUnsafe(ip),e=r.Buffer.allocUnsafe(sp);return ap(e,t),{pk:e,sk:t}}static generate(t,e,n){if(console.info("generate(",t,e,n,")"),666===(t=t??666)&&!e)return mp.generateAnonymous();if(!e)return Ip(r.Buffer.from([t]),3,n);const o=dp+1,i=r.Buffer.allocUnsafe(hp(o)),s=cp(e,dp,i);up(s,1&t);const a=o%8?(1<<o%8)-1:255;return console.info("Searching for",o,s.toString("hex"),lp(s).length,"mask",a.toString(2)),Ip(s,a,n)}static decodePk(t){return fp(t,dp)}}function Ip(t,e=255,n=5e5){if(!r.Buffer.isBuffer(t)&&!Array.isArray(t))throw new Error("Array or Buffer Expected");const o=r.Buffer.allocUnsafe(sp),i=r.Buffer.allocUnsafe(ip),s=t.length;for(let r=0;r<n;r++){ap(o,i);let n=!0;for(let r=0;n&&r<s;r++)n=r+1===s?(o[r]&e)==(t[r]&e):n=o[r]===t[r];if(n)return{pk:o,sk:i}}}var bp=mp,Ep="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function wp(){}function Cp(t){return t()}function vp(){return Object.create(null)}function Bp(t){t.forEach(Cp)}function _p(t){return"function"==typeof t}function kp(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let Sp,xp;function Qp(t,e){return Sp||(Sp=document.createElement("a")),Sp.href=e,t===Sp.href}function Mp(t,...e){if(null==t)return wp;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function Tp(t){let e;return Mp(t,(t=>e=t))(),e}function Dp(t,e,n){t.$$.on_destroy.push(Mp(e,n))}function $p(t,e,n,r){if(t){const o=Lp(t,e,n,r);return t[0](o)}}function Lp(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function Up(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}function Op(t,e,n,r,o,i){if(o){const s=Lp(e,n,r,i);t.p(s,o)}}function Fp(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function Np(t){return null==t?"":t}function Pp(t,e,n){return t.set(n),e}function Yp(t,e){t.appendChild(e)}function Kp(t,e,n){t.insertBefore(e,n||null)}function Rp(t){t.parentNode.removeChild(t)}function jp(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function Hp(t){return document.createElement(t)}function Vp(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function Gp(t){return document.createTextNode(t)}function qp(){return Gp(" ")}function zp(){return Gp("")}function Jp(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function Wp(t){return function(e){return e.preventDefault(),t.call(this,e)}}function Xp(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function Zp(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function ty(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:Zp(t,e,n)}function ey(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function ny(t,e){t.value=null==e?"":e}function ry(t,e,n,r){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function oy(t,e,n){t.classList[n?"add":"remove"](e)}class iy{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.is_svg?this.e=Vp(e.nodeName):this.e=Hp(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)Kp(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(Rp)}}function sy(t){xp=t}function ay(){if(!xp)throw new Error("Function called outside component initialization");return xp}function cy(t){ay().$$.on_mount.push(t)}function uy(){const t=ay();return(e,n,{cancelable:r=!1}={})=>{const o=t.$$.callbacks[e];if(o){const i=function(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,r,e),o}(e,n,{cancelable:r});return o.slice().forEach((e=>{e.call(t,i)})),!i.defaultPrevented}return!0}}function ly(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const hy=[],fy=[],dy=[],gy=[],Ay=Promise.resolve();let py=!1;function yy(t){dy.push(t)}function my(t){gy.push(t)}const Iy=new Set;let by=0;function Ey(){const t=xp;do{for(;by<hy.length;){const t=hy[by];by++,sy(t),wy(t.$$)}for(sy(null),hy.length=0,by=0;fy.length;)fy.pop()();for(let t=0;t<dy.length;t+=1){const e=dy[t];Iy.has(e)||(Iy.add(e),e())}dy.length=0}while(hy.length);for(;gy.length;)gy.pop()();py=!1,Iy.clear(),sy(t)}function wy(t){if(null!==t.fragment){t.update(),Bp(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(yy)}}const Cy=new Set;let vy;function By(){vy={r:0,c:[],p:vy}}function _y(){vy.r||Bp(vy.c),vy=vy.p}function ky(t,e){t&&t.i&&(Cy.delete(t),t.i(e))}function Sy(t,e,n,r){if(t&&t.o){if(Cy.has(t))return;Cy.add(t),vy.c.push((()=>{Cy.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}function xy(t,e){const n=e.token={};function r(t,r,o,i){if(e.token!==n)return;e.resolved=i;let s=e.ctx;void 0!==o&&(s=s.slice(),s[o]=i);const a=t&&(e.current=t)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(By(),Sy(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),_y())})):e.block.d(1),a.c(),ky(a,1),a.m(e.mount(),e.anchor),c=!0),e.block=a,e.blocks&&(e.blocks[r]=a),c&&Ey()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=ay();if(t.then((t=>{sy(n),r(e.then,1,e.value,t),sy(null)}),(t=>{if(sy(n),r(e.catch,2,e.error,t),sy(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function Qy(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}const My="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:Ep;function Ty(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function Dy(t){t&&t.c()}function $y(t,e,n,r){const{fragment:o,on_mount:i,on_destroy:s,after_update:a}=t.$$;o&&o.m(e,n),r||yy((()=>{const e=i.map(Cp).filter(_p);s?s.push(...e):Bp(e),t.$$.on_mount=[]})),a.forEach(yy)}function Ly(t,e){const n=t.$$;null!==n.fragment&&(Bp(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function Uy(t,e){-1===t.$$.dirty[0]&&(hy.push(t),py||(py=!0,Ay.then(Ey)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function Oy(t,e,n,r,o,i,s,a=[-1]){const c=xp;sy(t);const u=t.$$={fragment:null,ctx:null,props:i,update:wp,not_equal:o,bound:vp(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:vp(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};s&&s(u.root);let l=!1;if(u.ctx=n?n(t,e.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return u.ctx&&o(u.ctx[e],u.ctx[e]=i)&&(!u.skip_bound&&u.bound[e]&&u.bound[e](i),l&&Uy(t,e)),n})):[],u.update(),l=!0,Bp(u.before_update),u.fragment=!!r&&r(u.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);u.fragment&&u.fragment.l(t),t.forEach(Rp)}else u.fragment&&u.fragment.c();e.intro&&ky(t.$$.fragment),$y(t,e.target,e.anchor,e.customElement),Ey()}sy(c)}class Fy{$destroy(){Ly(this,1),this.$destroy=wp}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const Ny=[];function Py(t,e){return{subscribe:Yy(t,e).subscribe}}function Yy(t,e=wp){let n;const r=new Set;function o(e){if(kp(t,e)&&(t=e,n)){const e=!Ny.length;for(const e of r)e[1](),Ny.push(e,t);if(e){for(let t=0;t<Ny.length;t+=2)Ny[t][0](Ny[t+1]);Ny.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(i,s=wp){const a=[i,s];return r.add(a),1===r.size&&(n=e(o)||wp),i(t),()=>{r.delete(a),0===r.size&&(n(),n=null)}}}}function Ky(t,e,n){const r=!Array.isArray(t),o=r?[t]:t,i=e.length<2;return Py(n,(t=>{let n=!1;const s=[];let a=0,c=wp;const u=()=>{if(a)return;c();const n=e(r?s[0]:s,t);i?t(n):c=_p(n)?n:wp},l=o.map(((t,e)=>Mp(t,(t=>{s[e]=t,a&=~(1<<e),n&&u()}),(()=>{a|=1<<e}))));return n=!0,u(),function(){Bp(l),c()}}))}const Ry=window.Modem56;function jy(t,e){return Py(null,(r=>e?n.exports.nfo(t,e)(r):t(r)))}const Hy=new tr("PicoChat"),Vy=new JA(Hy.sublevel("app",{keyEncoding:"buffer",valueEncoding:"buffer"})),Gy=new bp(Hy.sublevel("key",{keyEncoding:"buffer",valueEncoding:"buffer"})),qy=(t,e,n)=>bp.generate(t,e,n);function zy(t){const e=bp.decodePk(t),n=nr.decode(e.geohash);return{...e,...n}}function Jy(t){return jy(Vy.$profile(),t)}function Wy(t){return jy(Vy.$vibes(),t)}let Xy=null;const[Zy,tm]=n.exports.write("loading"),[em,nm]=n.exports.write(),[rm,om]=n.exports.write(!1),[im,sm]=n.exports.write(!1),[am,cm]=n.exports.write(!1),[um,lm]=n.exports.write(!1),[hm,fm]=n.exports.write(null),dm=n.exports.combine({state:Zy,error:em,hasKey:am,hasProfile:um,entered:rm,swarming:im}),gm=jy(dm),Am=jy(hm);function pm(){return Xy||(Xy=Gy.readIdentity().then((t=>(cm(!!t),Gy.readProfile()))).then((t=>(lm(!!t),t?.picture&&fm(t.picture),Vy.boot()))).then((t=>{om(t),Vy.startGC()})).catch((t=>{throw console.error("kernel boot failure",t),nm(t),tm("error"),t})).then((t=>{tm("running");const e=n.exports.get(dm);console.info("Final state",e);const r=JSON.parse(window.localStorage.getItem("auto_swarm"));if(e.error)window.location.hash="/error?message="+e.error.message;else if(e.hasKey){if(e.hasProfile)return r&&Im();L_("/profile")}else L_("/keygen")}))),Xy}function ym(t,e){return"mock"===t?jy(function(){const[t,e]=n.exports.write(!0),[r,o]=n.exports.write(!0),i=n.exports.init(["Hello","Hi","Weather's nice! 🔥","You're joking right?",void 0,"There's a thunderstorm going on!","No way! That's so cool!","The roof is gone 🥲","Is your pants still on?",void 0,"Please tell me you're not stroking yourself during a hurricane","Yup!"]);return n.exports.mute(n.exports.combine(t,r,i,hm),(([t,n,r,i])=>{let s="ᚲᛃ";const a=r.map(((e,n)=>{const r=n%2;return s+=e?r?"ᛗ":"ᛖ":r?"ᚧ":"ᚦ",{type:r^t?"sent":"received",content:e||"",pass:!e}}));return{peer:{name:t?"Blackie":"Whitemane",picture:i,tagline:"mock tag",date:Date.now(),sex:0,score:99,age:23},myTurn:n,initiator:t,state:"active",graph:s,health:2,expiresAt:Date.now()+864e5,async send(){},pass:async()=>(o(!1),new Promise((t=>{setTimeout((()=>{o(!0),t()}),1e3)}))),async bye(){e(!t)},mLength:a.length,messages:a}}))}()):jy(Vy.$chat(t),e)}let mm=null;async function Im(){if(!Ry)throw new Error("Modem not available, did you load it?");mm||(mm=new Ry(null,{}),mm.join("picochat-testnet",Vy.spawnWire.bind(Vy)),sm(!0))}function bm(t){return"data:image/jpeg;base64,"+t?.toString("base64")}async function Em(t=!1){const e=t?"You are about to burn your passport and everything with it... you sure about this?":"Permanently wipe ALL data, you sure?";window.confirm(e)&&(t&&await Gy.db.clear(),await Vy.db.clear(),window.location.reload())}async function wm(){const t=new(0,window.File)([(await Gy.readIdentity()).toString("hex")],"idsqr-insecure-backup.txt",{type:"application/text"}),e=URL.createObjectURL(t);window.open(e,"_blank")}function Cm(t){let e,n,r,o,i;const s=t[4].default,a=$p(s,t,t[3],null),c=a||function(t){let e;return{c(){e=Gp("Empty Modal")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}();return{c(){e=Hp("dialog"),c&&c.c()},m(s,a){var u;Kp(s,e,a),c&&c.m(e,null),t[5](e),r=!0,o||(i=[(u=n=Bm.call(null,e,["open",!!t[0]]),u&&_p(u.destroy)?u.destroy:wp),Jp(e,"click",t[2])],o=!0)},p(t,[e]){a&&a.p&&(!r||8&e)&&Op(a,s,t,t[3],r?Up(s,t[3],e,null):Fp(t[3]),null),n&&_p(n.update)&&1&e&&n.update.call(null,["open",!!t[0]])},i(t){r||(ky(c,t),r=!0)},o(t){Sy(c,t),r=!1},d(n){n&&Rp(e),c&&c.d(n),t[5](null),o=!1,Bp(i)}}}function vm(t,e,n){null===n||!1===n?t.removeAttribute(e):t.setAttribute(e,n+"")}function Bm(t,e){return e&&vm(t,e[0],e[1]),{update(e){e&&vm(t,e[0],e[1])}}}function _m(t,e,n){let{$$slots:r={},$$scope:o}=e,{open:i=!0}=e;const s=uy();let a;return t.$$set=t=>{"open"in t&&n(0,i=t.open),"$$scope"in t&&n(3,o=t.$$scope)},[i,a,function(t){t.target===a&&s("fade")},o,r,function(t){fy[t?"unshift":"push"]((()=>{a=t,n(1,a)}))}]}class km extends Fy{constructor(t){super(),Oy(this,t,_m,Cm,kp,{open:0})}}function Sm(t){let e,n;return{c(){var r,o,i;e=Vp("svg"),n=Vp("use"),r=n,o="xlink:href",i=t[1],r.setAttributeNS("http://www.w3.org/1999/xlink",o,i),Zp(n,"href",t[1]),Zp(e,"class",Np(t[2])+" svelte-16ydb8b"),oy(e,"nofill",t[0])},m(t,r){Kp(t,e,r),Yp(e,n)},p(t,[n]){1&n&&oy(e,"nofill",t[0])},i:wp,o:wp,d(t){t&&Rp(e)}}}function xm(t,e,n){let{id:r=""}=e,{tag:o=""}=e,{nofill:i=!1}=e;const s=`build/sprites.svg#${r}`,a=`icon ${o}`.trim();return t.$$set=t=>{"id"in t&&n(3,r=t.id),"tag"in t&&n(4,o=t.tag),"nofill"in t&&n(0,i=t.nofill)},[i,s,a,r,o]}class Qm extends Fy{constructor(t){super(),Oy(this,t,xm,Sm,kp,{id:3,tag:4,nofill:0})}}var Mm={exports:{}};!function(t,e){var n=function(){var t=function(t,e){var n=t,r=l[e],o=null,i=0,s=null,a=[],c={},u=function(t,e){o=function(t){for(var e=new Array(t),n=0;n<t;n+=1){e[n]=new Array(t);for(var r=0;r<t;r+=1)e[n][r]=null}return e}(i=4*n+17),h(0,0),h(i-7,0),h(0,i-7),d(),f(),A(t,e),n>=7&&g(t),null==s&&(s=y(n,r,a)),p(s,e)},h=function(t,e){for(var n=-1;n<=7;n+=1)if(!(t+n<=-1||i<=t+n))for(var r=-1;r<=7;r+=1)e+r<=-1||i<=e+r||(o[t+n][e+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},f=function(){for(var t=8;t<i-8;t+=1)null==o[t][6]&&(o[t][6]=t%2==0);for(var e=8;e<i-8;e+=1)null==o[6][e]&&(o[6][e]=e%2==0)},d=function(){for(var t=I.getPatternPosition(n),e=0;e<t.length;e+=1)for(var r=0;r<t.length;r+=1){var i=t[e],s=t[r];if(null==o[i][s])for(var a=-2;a<=2;a+=1)for(var c=-2;c<=2;c+=1)o[i+a][s+c]=-2==a||2==a||-2==c||2==c||0==a&&0==c}},g=function(t){for(var e=I.getBCHTypeNumber(n),r=0;r<18;r+=1){var s=!t&&1==(e>>r&1);o[Math.floor(r/3)][r%3+i-8-3]=s}for(r=0;r<18;r+=1){s=!t&&1==(e>>r&1);o[r%3+i-8-3][Math.floor(r/3)]=s}},A=function(t,e){for(var n=r<<3|e,s=I.getBCHTypeInfo(n),a=0;a<15;a+=1){var c=!t&&1==(s>>a&1);a<6?o[a][8]=c:a<8?o[a+1][8]=c:o[i-15+a][8]=c}for(a=0;a<15;a+=1){c=!t&&1==(s>>a&1);a<8?o[8][i-a-1]=c:a<9?o[8][15-a-1+1]=c:o[8][15-a-1]=c}o[i-8][8]=!t},p=function(t,e){for(var n=-1,r=i-1,s=7,a=0,c=I.getMaskFunction(e),u=i-1;u>0;u-=2)for(6==u&&(u-=1);;){for(var l=0;l<2;l+=1)if(null==o[r][u-l]){var h=!1;a<t.length&&(h=1==(t[a]>>>s&1)),c(r,u-l)&&(h=!h),o[r][u-l]=h,-1==(s-=1)&&(a+=1,s=7)}if((r+=n)<0||i<=r){r-=n,n=-n;break}}},y=function(t,e,n){for(var r=w.getRSBlocks(t,e),o=C(),i=0;i<n.length;i+=1){var s=n[i];o.put(s.getMode(),4),o.put(s.getLength(),I.getLengthInBits(s.getMode(),t)),s.write(o)}var a=0;for(i=0;i<r.length;i+=1)a+=r[i].dataCount;if(o.getLengthInBits()>8*a)throw"code length overflow. ("+o.getLengthInBits()+">"+8*a+")";for(o.getLengthInBits()+4<=8*a&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*a||(o.put(236,8),o.getLengthInBits()>=8*a));)o.put(17,8);return function(t,e){for(var n=0,r=0,o=0,i=new Array(e.length),s=new Array(e.length),a=0;a<e.length;a+=1){var c=e[a].dataCount,u=e[a].totalCount-c;r=Math.max(r,c),o=Math.max(o,u),i[a]=new Array(c);for(var l=0;l<i[a].length;l+=1)i[a][l]=255&t.getBuffer()[l+n];n+=c;var h=I.getErrorCorrectPolynomial(u),f=E(i[a],h.getLength()-1).mod(h);for(s[a]=new Array(h.getLength()-1),l=0;l<s[a].length;l+=1){var d=l+f.getLength()-s[a].length;s[a][l]=d>=0?f.getAt(d):0}}var g=0;for(l=0;l<e.length;l+=1)g+=e[l].totalCount;var A=new Array(g),p=0;for(l=0;l<r;l+=1)for(a=0;a<e.length;a+=1)l<i[a].length&&(A[p]=i[a][l],p+=1);for(l=0;l<o;l+=1)for(a=0;a<e.length;a+=1)l<s[a].length&&(A[p]=s[a][l],p+=1);return A}(o,r)};c.addData=function(t,e){var n=null;switch(e=e||"Byte"){case"Numeric":n=v(t);break;case"Alphanumeric":n=B(t);break;case"Byte":n=_(t);break;case"Kanji":n=k(t);break;default:throw"mode:"+e}a.push(n),s=null},c.isDark=function(t,e){if(t<0||i<=t||e<0||i<=e)throw t+","+e;return o[t][e]},c.getModuleCount=function(){return i},c.make=function(){if(n<1){for(var t=1;t<40;t++){for(var e=w.getRSBlocks(t,r),o=C(),i=0;i<a.length;i++){var s=a[i];o.put(s.getMode(),4),o.put(s.getLength(),I.getLengthInBits(s.getMode(),t)),s.write(o)}var l=0;for(i=0;i<e.length;i++)l+=e[i].dataCount;if(o.getLengthInBits()<=8*l)break}n=t}u(!1,function(){for(var t=0,e=0,n=0;n<8;n+=1){u(!0,n);var r=I.getLostPoint(c);(0==n||t>r)&&(t=r,e=n)}return e}())},c.createTableTag=function(t,e){t=t||2;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: "+(e=void 0===e?4*t:e)+"px;",n+='">',n+="<tbody>";for(var r=0;r<c.getModuleCount();r+=1){n+="<tr>";for(var o=0;o<c.getModuleCount();o+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+t+"px;",n+=" height: "+t+"px;",n+=" background-color: ",n+=c.isDark(r,o)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return n+="</tbody>",n+="</table>"},c.createSvgTag=function(t,e,n,r){var o={};"object"==typeof arguments[0]&&(t=(o=arguments[0]).cellSize,e=o.margin,n=o.alt,r=o.title),t=t||2,e=void 0===e?4*t:e,(n="string"==typeof n?{text:n}:n||{}).text=n.text||null,n.id=n.text?n.id||"qrcode-description":null,(r="string"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||"qrcode-title":null;var i,s,a,u,l=c.getModuleCount()*t+2*e,h="";for(u="l"+t+",0 0,"+t+" -"+t+",0 0,-"+t+"z ",h+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',h+=o.scalable?"":' width="'+l+'px" height="'+l+'px"',h+=' viewBox="0 0 '+l+" "+l+'" ',h+=' preserveAspectRatio="xMinYMin meet"',h+=r.text||n.text?' role="img" aria-labelledby="'+m([r.id,n.id].join(" ").trim())+'"':"",h+=">",h+=r.text?'<title id="'+m(r.id)+'">'+m(r.text)+"</title>":"",h+=n.text?'<description id="'+m(n.id)+'">'+m(n.text)+"</description>":"",h+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',h+='<path d="',s=0;s<c.getModuleCount();s+=1)for(a=s*t+e,i=0;i<c.getModuleCount();i+=1)c.isDark(s,i)&&(h+="M"+(i*t+e)+","+a+u);return h+='" stroke="transparent" fill="black"/>',h+="</svg>"},c.createDataURL=function(t,e){t=t||2,e=void 0===e?4*t:e;var n=c.getModuleCount()*t+2*e,r=e,o=n-e;return Q(n,n,(function(e,n){if(r<=e&&e<o&&r<=n&&n<o){var i=Math.floor((e-r)/t),s=Math.floor((n-r)/t);return c.isDark(s,i)?0:1}return 1}))},c.createImgTag=function(t,e,n){t=t||2,e=void 0===e?4*t:e;var r=c.getModuleCount()*t+2*e,o="";return o+="<img",o+=' src="',o+=c.createDataURL(t,e),o+='"',o+=' width="',o+=r,o+='"',o+=' height="',o+=r,o+='"',n&&(o+=' alt="',o+=m(n),o+='"'),o+="/>"};var m=function(t){for(var e="",n=0;n<t.length;n+=1){var r=t.charAt(n);switch(r){case"<":e+="&lt;";break;case">":e+="&gt;";break;case"&":e+="&amp;";break;case'"':e+="&quot;";break;default:e+=r}}return e};return c.createASCII=function(t,e){if((t=t||1)<2)return function(t){t=void 0===t?2:t;var e,n,r,o,i,s=1*c.getModuleCount()+2*t,a=t,u=s-t,l={"██":"█","█ ":"▀"," █":"▄","  ":" "},h={"██":"▀","█ ":"▀"," █":" ","  ":" "},f="";for(e=0;e<s;e+=2){for(r=Math.floor((e-a)/1),o=Math.floor((e+1-a)/1),n=0;n<s;n+=1)i="█",a<=n&&n<u&&a<=e&&e<u&&c.isDark(r,Math.floor((n-a)/1))&&(i=" "),a<=n&&n<u&&a<=e+1&&e+1<u&&c.isDark(o,Math.floor((n-a)/1))?i+=" ":i+="█",f+=t<1&&e+1>=u?h[i]:l[i];f+="\n"}return s%2&&t>0?f.substring(0,f.length-s-1)+Array(s+1).join("▀"):f.substring(0,f.length-1)}(e);t-=1,e=void 0===e?2*t:e;var n,r,o,i,s=c.getModuleCount()*t+2*e,a=e,u=s-e,l=Array(t+1).join("██"),h=Array(t+1).join("  "),f="",d="";for(n=0;n<s;n+=1){for(o=Math.floor((n-a)/t),d="",r=0;r<s;r+=1)i=1,a<=r&&r<u&&a<=n&&n<u&&c.isDark(o,Math.floor((r-a)/t))&&(i=0),d+=i?l:h;for(o=0;o<t;o+=1)f+=d+"\n"}return f.substring(0,f.length-1)},c.renderTo2dContext=function(t,e){e=e||2;for(var n=c.getModuleCount(),r=0;r<n;r++)for(var o=0;o<n;o++)t.fillStyle=c.isDark(r,o)?"black":"white",t.fillRect(r*e,o*e,e,e)},c};t.stringToBytes=(t.stringToBytesFuncs={default:function(t){for(var e=[],n=0;n<t.length;n+=1){var r=t.charCodeAt(n);e.push(255&r)}return e}}).default,t.createStringToBytes=function(t,e){var n=function(){for(var n=x(t),r=function(){var t=n.read();if(-1==t)throw"eof";return t},o=0,i={};;){var s=n.read();if(-1==s)break;var a=r(),c=r()<<8|r();i[String.fromCharCode(s<<8|a)]=c,o+=1}if(o!=e)throw o+" != "+e;return i}(),r="?".charCodeAt(0);return function(t){for(var e=[],o=0;o<t.length;o+=1){var i=t.charCodeAt(o);if(i<128)e.push(i);else{var s=n[t.charAt(o)];"number"==typeof s?(255&s)==s?e.push(s):(e.push(s>>>8),e.push(255&s)):e.push(r)}}return e}};var e,n,r,o,i,s=1,a=2,c=4,u=8,l={L:1,M:0,Q:3,H:2},h=0,f=1,d=2,g=3,A=4,p=5,y=6,m=7,I=(e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,r=7973,i=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},(o={}).getBCHTypeInfo=function(t){for(var e=t<<10;i(e)-i(n)>=0;)e^=n<<i(e)-i(n);return 21522^(t<<10|e)},o.getBCHTypeNumber=function(t){for(var e=t<<12;i(e)-i(r)>=0;)e^=r<<i(e)-i(r);return t<<12|e},o.getPatternPosition=function(t){return e[t-1]},o.getMaskFunction=function(t){switch(t){case h:return function(t,e){return(t+e)%2==0};case f:return function(t,e){return t%2==0};case d:return function(t,e){return e%3==0};case g:return function(t,e){return(t+e)%3==0};case A:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case p:return function(t,e){return t*e%2+t*e%3==0};case y:return function(t,e){return(t*e%2+t*e%3)%2==0};case m:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw"bad maskPattern:"+t}},o.getErrorCorrectPolynomial=function(t){for(var e=E([1],0),n=0;n<t;n+=1)e=e.multiply(E([1,b.gexp(n)],0));return e},o.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case s:return 10;case a:return 9;case c:case u:return 8;default:throw"mode:"+t}else if(e<27)switch(t){case s:return 12;case a:return 11;case c:return 16;case u:return 10;default:throw"mode:"+t}else{if(!(e<41))throw"type:"+e;switch(t){case s:return 14;case a:return 13;case c:return 16;case u:return 12;default:throw"mode:"+t}}},o.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r+=1)for(var o=0;o<e;o+=1){for(var i=0,s=t.isDark(r,o),a=-1;a<=1;a+=1)if(!(r+a<0||e<=r+a))for(var c=-1;c<=1;c+=1)o+c<0||e<=o+c||0==a&&0==c||s==t.isDark(r+a,o+c)&&(i+=1);i>5&&(n+=3+i-5)}for(r=0;r<e-1;r+=1)for(o=0;o<e-1;o+=1){var u=0;t.isDark(r,o)&&(u+=1),t.isDark(r+1,o)&&(u+=1),t.isDark(r,o+1)&&(u+=1),t.isDark(r+1,o+1)&&(u+=1),0!=u&&4!=u||(n+=3)}for(r=0;r<e;r+=1)for(o=0;o<e-6;o+=1)t.isDark(r,o)&&!t.isDark(r,o+1)&&t.isDark(r,o+2)&&t.isDark(r,o+3)&&t.isDark(r,o+4)&&!t.isDark(r,o+5)&&t.isDark(r,o+6)&&(n+=40);for(o=0;o<e;o+=1)for(r=0;r<e-6;r+=1)t.isDark(r,o)&&!t.isDark(r+1,o)&&t.isDark(r+2,o)&&t.isDark(r+3,o)&&t.isDark(r+4,o)&&!t.isDark(r+5,o)&&t.isDark(r+6,o)&&(n+=40);var l=0;for(o=0;o<e;o+=1)for(r=0;r<e;r+=1)t.isDark(r,o)&&(l+=1);return n+=Math.abs(100*l/e/e-50)/5*10},o),b=function(){for(var t=new Array(256),e=new Array(256),n=0;n<8;n+=1)t[n]=1<<n;for(n=8;n<256;n+=1)t[n]=t[n-4]^t[n-5]^t[n-6]^t[n-8];for(n=0;n<255;n+=1)e[t[n]]=n;var r={glog:function(t){if(t<1)throw"glog("+t+")";return e[t]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t[e]}};return r}();function E(t,e){if(void 0===t.length)throw t.length+"/"+e;var n=function(){for(var n=0;n<t.length&&0==t[n];)n+=1;for(var r=new Array(t.length-n+e),o=0;o<t.length-n;o+=1)r[o]=t[o+n];return r}(),r={getAt:function(t){return n[t]},getLength:function(){return n.length},multiply:function(t){for(var e=new Array(r.getLength()+t.getLength()-1),n=0;n<r.getLength();n+=1)for(var o=0;o<t.getLength();o+=1)e[n+o]^=b.gexp(b.glog(r.getAt(n))+b.glog(t.getAt(o)));return E(e,0)},mod:function(t){if(r.getLength()-t.getLength()<0)return r;for(var e=b.glog(r.getAt(0))-b.glog(t.getAt(0)),n=new Array(r.getLength()),o=0;o<r.getLength();o+=1)n[o]=r.getAt(o);for(o=0;o<t.getLength();o+=1)n[o]^=b.gexp(b.glog(t.getAt(o))+e);return E(n,0).mod(t)}};return r}var w=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var n={};return n.totalCount=t,n.dataCount=e,n},n={};return n.getRSBlocks=function(n,r){var o=function(e,n){switch(n){case l.L:return t[4*(e-1)+0];case l.M:return t[4*(e-1)+1];case l.Q:return t[4*(e-1)+2];case l.H:return t[4*(e-1)+3];default:return}}(n,r);if(void 0===o)throw"bad rs block @ typeNumber:"+n+"/errorCorrectionLevel:"+r;for(var i=o.length/3,s=[],a=0;a<i;a+=1)for(var c=o[3*a+0],u=o[3*a+1],h=o[3*a+2],f=0;f<c;f+=1)s.push(e(u,h));return s},n}(),C=function(){var t=[],e=0,n={getBuffer:function(){return t},getAt:function(e){var n=Math.floor(e/8);return 1==(t[n]>>>7-e%8&1)},put:function(t,e){for(var r=0;r<e;r+=1)n.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return e},putBit:function(n){var r=Math.floor(e/8);t.length<=r&&t.push(0),n&&(t[r]|=128>>>e%8),e+=1}};return n},v=function(t){var e=s,n=t,r={getMode:function(){return e},getLength:function(t){return n.length},write:function(t){for(var e=n,r=0;r+2<e.length;)t.put(o(e.substring(r,r+3)),10),r+=3;r<e.length&&(e.length-r==1?t.put(o(e.substring(r,r+1)),4):e.length-r==2&&t.put(o(e.substring(r,r+2)),7))}},o=function(t){for(var e=0,n=0;n<t.length;n+=1)e=10*e+i(t.charAt(n));return e},i=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+t};return r},B=function(t){var e=a,n=t,r={getMode:function(){return e},getLength:function(t){return n.length},write:function(t){for(var e=n,r=0;r+1<e.length;)t.put(45*o(e.charAt(r))+o(e.charAt(r+1)),11),r+=2;r<e.length&&t.put(o(e.charAt(r)),6)}},o=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("A"<=t&&t<="Z")return t.charCodeAt(0)-"A".charCodeAt(0)+10;switch(t){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+t}};return r},_=function(e){var n=c,r=t.stringToBytes(e),o={getMode:function(){return n},getLength:function(t){return r.length},write:function(t){for(var e=0;e<r.length;e+=1)t.put(r[e],8)}};return o},k=function(e){var n=u,r=t.stringToBytesFuncs.SJIS;if(!r)throw"sjis not supported.";!function(t,e){var n=r("友");if(2!=n.length||38726!=(n[0]<<8|n[1]))throw"sjis not supported."}();var o=r(e),i={getMode:function(){return n},getLength:function(t){return~~(o.length/2)},write:function(t){for(var e=o,n=0;n+1<e.length;){var r=(255&e[n])<<8|255&e[n+1];if(33088<=r&&r<=40956)r-=33088;else{if(!(57408<=r&&r<=60351))throw"illegal char at "+(n+1)+"/"+r;r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13),n+=2}if(n<e.length)throw"illegal char at "+(n+1)}};return i},S=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,n,r){n=n||0,r=r||t.length;for(var o=0;o<r;o+=1)e.writeByte(t[o+n])},writeString:function(t){for(var n=0;n<t.length;n+=1)e.writeByte(t.charCodeAt(n))},toByteArray:function(){return t},toString:function(){var e="";e+="[";for(var n=0;n<t.length;n+=1)n>0&&(e+=","),e+=t[n];return e+="]"}};return e},x=function(t){var e=t,n=0,r=0,o=0,i={read:function(){for(;o<8;){if(n>=e.length){if(0==o)return-1;throw"unexpected end of file./"+o}var t=e.charAt(n);if(n+=1,"="==t)return o=0,-1;t.match(/^\s$/)||(r=r<<6|s(t.charCodeAt(0)),o+=6)}var i=r>>>o-8&255;return o-=8,i}},s=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw"c:"+t};return i},Q=function(t,e,n){for(var r=function(t,e){var n=t,r=e,o=new Array(t*e),i={setPixel:function(t,e,r){o[e*n+t]=r},write:function(t){t.writeString("GIF87a"),t.writeShort(n),t.writeShort(r),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(n),t.writeShort(r),t.writeByte(0);var e=s(2);t.writeByte(2);for(var o=0;e.length-o>255;)t.writeByte(255),t.writeBytes(e,o,255),o+=255;t.writeByte(e.length-o),t.writeBytes(e,o,e.length-o),t.writeByte(0),t.writeString(";")}},s=function(t){for(var e=1<<t,n=1+(1<<t),r=t+1,i=a(),s=0;s<e;s+=1)i.add(String.fromCharCode(s));i.add(String.fromCharCode(e)),i.add(String.fromCharCode(n));var c,u,l,h=S(),f=(c=h,u=0,l=0,{write:function(t,e){if(t>>>e!=0)throw"length over";for(;u+e>=8;)c.writeByte(255&(t<<u|l)),e-=8-u,t>>>=8-u,l=0,u=0;l|=t<<u,u+=e},flush:function(){u>0&&c.writeByte(l)}});f.write(e,r);var d=0,g=String.fromCharCode(o[d]);for(d+=1;d<o.length;){var A=String.fromCharCode(o[d]);d+=1,i.contains(g+A)?g+=A:(f.write(i.indexOf(g),r),i.size()<4095&&(i.size()==1<<r&&(r+=1),i.add(g+A)),g=A)}return f.write(i.indexOf(g),r),f.write(n,r),f.flush(),h.toByteArray()},a=function(){var t={},e=0,n={add:function(r){if(n.contains(r))throw"dup key:"+r;t[r]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return void 0!==t[e]}};return n};return i}(t,e),o=0;o<e;o+=1)for(var i=0;i<t;i+=1)r.setPixel(i,o,n(i,o));var s=S();r.write(s);for(var a=function(){var t=0,e=0,n=0,r="",o={},i=function(t){r+=String.fromCharCode(s(63&t))},s=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw"n:"+t};return o.writeByte=function(r){for(t=t<<8|255&r,e+=8,n+=1;e>=6;)i(t>>>e-6),e-=6},o.flush=function(){if(e>0&&(i(t<<6-e),t=0,e=0),n%3!=0)for(var o=3-n%3,s=0;s<o;s+=1)r+="="},o.toString=function(){return r},o}(),c=s.toByteArray(),u=0;u<c.length;u+=1)a.writeByte(c[u]);return a.flush(),"data:image/gif;base64,"+a};return t}();n.stringToBytesFuncs["UTF-8"]=function(t){return function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}(t)},t.exports=n}(Mm);var Tm=Mm.exports;function Dm(t){let e,n;return{c(){e=Hp("pico-qr"),n=Hp("img"),ty(e,"class","svelte-1qaazc0")},m(r,o){Kp(r,e,o),Yp(e,n),t[5](n)},p:wp,i:wp,o:wp,d(n){n&&Rp(e),t[5](null)}}}function $m(t,e,n){let o,{data:i=null}=e,{size:s=2}=e,{margin:a=0}=e,{level:c="L"}=e;function u(t){if(!t)return;r.Buffer.isBuffer(t)&&(t=t.toString("base64"));const e=new Tm(0,c);e.addData(t),e.make();const i=e.createDataURL(s,a);n(0,o.src=i,o)}return cy((()=>{if("function"==typeof i?.subscribe)return i.subscribe(u);i&&u(i)})),t.$$set=t=>{"data"in t&&n(1,i=t.data),"size"in t&&n(2,s=t.size),"margin"in t&&n(3,a=t.margin),"level"in t&&n(4,c=t.level)},[o,i,s,a,c,function(t){fy[t?"unshift":"push"]((()=>{o=t,n(0,o)}))}]}class Lm extends Fy{constructor(t){super(),Oy(this,t,$m,Dm,kp,{data:1,size:2,margin:3,level:4})}}function Um(t){let e,n,r,o,i,s=t[38].message+"";return{c(){e=Hp("div"),n=Hp("h5"),n.textContent="Error:",r=qp(),o=Hp("danger"),i=Gp(s),Zp(o,"class","svelte-1rqfs0r")},m(t,s){Kp(t,e,s),Yp(e,n),Yp(e,r),Yp(e,o),Yp(o,i)},p:wp,i:wp,o:wp,d(t){t&&Rp(e)}}}function Om(t){let e,n,r,o;const i=[Nm,Fm],s=[];function a(t,e){return t[3]?1:0}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=zp()},m(t,n){s[e].m(t,n),Kp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e===c?s[e].p(t,o):(By(),Sy(s[c],1,1,(()=>{s[c]=null})),_y(),n=s[e],n?n.p(t,o):(n=s[e]=i[e](t),n.c()),ky(n,1),n.m(r.parentNode,r))},i(t){o||(ky(n),o=!0)},o(t){Sy(n),o=!1},d(t){s[e].d(t),t&&Rp(r)}}}function Fm(t){let e,n;return e=new Lm({props:{data:t[3].slice(32),size:10}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};8&n[0]&&(r.data=t[3].slice(32)),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function Nm(t){let e,n,r,o,i,s,a,c,u,l,h;function f(t,e){return 100===t[0]?Ym:Pm}let d=f(t),g=d(t),A=t[1]>1&&Km(t),p=t[2]&&Rm();return{c(){e=Hp("div"),g.c(),n=qp(),r=Hp("div"),o=Hp("div"),A&&A.c(),i=qp(),s=Hp("button"),a=Gp("Create"),u=qp(),p&&p.c(),s.disabled=c=100!==t[0]||t[3],Zp(o,"class","row space-between xcenter")},m(c,f){Kp(c,e,f),g.m(e,null),Kp(c,n,f),Kp(c,r,f),Yp(r,o),A&&A.m(o,null),Yp(o,i),Yp(o,s),Yp(s,a),Yp(r,u),p&&p.m(r,null),l||(h=Jp(s,"click",t[25]),l=!0)},p(t,n){d===(d=f(t))&&g?g.p(t,n):(g.d(1),g=d(t),g&&(g.c(),g.m(e,null))),t[1]>1?A?A.p(t,n):(A=Km(t),A.c(),A.m(o,i)):A&&(A.d(1),A=null),9&n[0]&&c!==(c=100!==t[0]||t[3])&&(s.disabled=c),t[2]?p||(p=Rm(),p.c(),p.m(r,null)):p&&(p.d(1),p=null)},i:wp,o:wp,d(t){t&&Rp(e),g.d(),t&&Rp(n),t&&Rp(r),A&&A.d(),p&&p.d(),l=!1,h()}}}function Pm(t){let e;return{c(){e=Hp("progress"),Zp(e,"min","0"),Zp(e,"max","100"),e.value=t[0]},m(t,n){Kp(t,e,n)},p(t,n){1&n[0]&&(e.value=t[0])},d(t){t&&Rp(e)}}}function Ym(t){let e;return{c(){e=Hp("p"),e.textContent="Press the button to generate your own unique passport",Zp(e,"class","text-center")},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function Km(t){let e,n,r,o,i;return{c(){e=Hp("button"),n=Gp("Give up"),e.disabled=r=100!==t[0]},m(r,s){Kp(r,e,s),Yp(e,n),o||(i=Jp(e,"click",t[24]),o=!0)},p(t,n){1&n[0]&&r!==(r=100!==t[0])&&(e.disabled=r)},d(t){t&&Rp(e),o=!1,i()}}}function Rm(t){let e;return{c(){e=Hp("danger"),e.textContent="Sorry.. RNG0D ignored your prayers, please try again",Zp(e,"class","svelte-1rqfs0r")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function jm(t){let e;return{c(){e=Hp("h1"),e.textContent="%nbsp;",Zp(e,"aria-busy","true")},m(t,n){Kp(t,e,n)},p:wp,i:wp,o:wp,d(t){t&&Rp(e)}}}function Hm(t){let e,n,r,o,i;return{c(){e=Hp("a"),e.textContent="Anonkey",n=Gp(" |\n        "),r=Hp("a"),r.textContent="Import"},m(s,a){Kp(s,e,a),Kp(s,n,a),Kp(s,r,a),o||(i=[Jp(e,"click",t[27]),Jp(r,"click",t[28])],o=!0)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),o=!1,Bp(i)}}}function Vm(t){let e,n,r,o,i;return{c(){e=Hp("a"),e.textContent="Destroy",n=Gp(" |\n        "),r=Hp("a"),r.textContent="Backup"},m(s,a){Kp(s,e,a),Kp(s,n,a),Kp(s,r,a),o||(i=[Jp(e,"click",t[26]),Jp(r,"click",wm)],o=!0)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),o=!1,Bp(i)}}}function Gm(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[qm]},$$scope:{ctx:t}}}),e.$on("fade",t[32]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};192&n[0]|256&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function qm(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g;return{c(){e=Hp("article"),n=Hp("header"),n.innerHTML="<h5>Import Secret</h5>",r=qp(),o=Hp("p"),o.textContent="Paste the secret as a hex-string",i=qp(),s=Hp("textarea"),a=qp(),c=Hp("footer"),u=Hp("div"),l=Hp("a"),l.textContent="Cancel",h=qp(),f=Hp("a"),f.textContent="Import",Zp(l,"role","button"),Zp(f,"role","button"),Zp(u,"class","row space-between")},m(A,p){Kp(A,e,p),Yp(e,n),Yp(e,r),Yp(e,o),Yp(e,i),Yp(e,s),ny(s,t[7]),Yp(e,a),Yp(e,c),Yp(c,u),Yp(u,l),Yp(u,h),Yp(u,f),d||(g=[Jp(s,"input",t[30]),Jp(l,"click",t[31]),Jp(f,"click",Xm)],d=!0)},p(t,e){128&e[0]&&ny(s,t[7])},d(t){t&&Rp(e),d=!1,Bp(g)}}}function zm(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[Jm]},$$scope:{ctx:t}}}),e.$on("fade",t[34]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};32&n[0]|256&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function Jm(t){let e,n,r,o,i,s,a,c,u;return{c(){e=Hp("article"),n=Hp("h3"),n.textContent="Welcome to True Decentralization",r=qp(),o=Hp("div"),o.innerHTML="<p>Picochat is a <strong>coinless blockchain</strong>, there\n            are no super-nodes and everything is slightly different from\n            what you&#39;re used to.<br/>\n            But don&#39;t worry, it&#39;s all good.</p> \n          <p>First of all, you have to generate your own key.<br/>\n            It takes about a minute or two on a handheld device.<br/>\n            Once you&#39;ve found a one, keep it safe, it&#39;s your passport to hyperspace.\n            ✨</p> \n          <p>If you don&#39;t care about location nor gender, then\n            feel free to use an <i>anonymous</i> key.<br/>\n            Trees say &quot;Thanks!&quot; 🌱</p> \n          <p>Please don&#39;t generate more keys than you need, mining of any form is a pointless waste of world-resources.\n            Hate to say it; but don&#39;t ever trade a key, it is <strong>insecure and dangerous</strong>.</p> \n          <p><i>The hyperspace is vast.<br/>\n            It&#39;s real-estate, just like air -\n            worth nothing while there&#39;s enough for everyone.<br/>\n            Let&#39;s keep it that way</i> 🙂</p>",i=qp(),s=Hp("footer"),a=Hp("button"),a.textContent="gotcha",Zp(o,"class","about svelte-1rqfs0r")},m(l,h){Kp(l,e,h),Yp(e,n),Yp(e,r),Yp(e,o),Yp(e,i),Yp(e,s),Yp(s,a),c||(u=Jp(a,"click",t[33]),c=!0)},p:wp,d(t){t&&Rp(e),c=!1,u()}}}function Wm(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B,_,k,S,x,Q,M,T,D,$,L,U,O,F,N,P;o=new Qm({props:{id:"icon-info"}});let Y={ctx:t,current:null,token:null,hasCatch:!0,pending:jm,then:Om,catch:Um,error:38,blocks:[,,,]};function K(t,e){return t[3]?Vm:Hm}xy(t[17](),Y);let R=K(t),j=R(t),H=t[6]&&Gm(t),V=t[5]&&zm(t);return{c(){e=Hp("keygen-view"),n=Hp("h1"),r=Gp("Setup\n    "),Dy(o.$$.fragment),i=qp(),s=Hp("h5"),s.textContent="Gender",a=qp(),c=Hp("fieldset"),u=Hp("input"),l=qp(),h=Hp("label"),h.textContent="M",f=qp(),d=Hp("input"),g=qp(),A=Hp("label"),A.textContent="F",p=qp(),y=Hp("input"),m=qp(),I=Hp("label"),I.textContent="NB",b=qp(),E=Hp("br"),w=qp(),C=Hp("h5"),C.textContent="IDSQR",v=qp(),B=Hp("div"),_=Hp("idsqr"),Y.block.c(),k=qp(),S=Hp("div"),x=Hp("small"),j.c(),Q=qp(),M=Hp("br"),T=qp(),D=Hp("button"),$=Gp("next"),U=qp(),H&&H.c(),O=qp(),V&&V.c(),Zp(u,"type","radio"),u.__value=1,u.value=u.__value,Zp(u,"id","M"),Zp(u,"name","gender"),t[21][0].push(u),Zp(h,"for","M"),Zp(d,"type","radio"),d.__value=0,d.value=d.__value,Zp(d,"id","F"),Zp(d,"name","gender"),t[21][0].push(d),Zp(A,"for","F"),Zp(y,"type","radio"),y.__value=2,y.value=y.__value,Zp(y,"id","NB"),Zp(y,"name","gender"),t[21][0].push(y),Zp(I,"for","NB"),Zp(_,"data-theme","dark"),Zp(_,"class","flex column space-around"),Zp(B,"class","flex column xcenter"),Zp(S,"class","row end hpad"),D.disabled=L=!t[3],ty(e,"class","block container")},m(L,K){Kp(L,e,K),Yp(e,n),Yp(n,r),$y(o,n,null),Yp(e,i),Yp(e,s),Yp(e,a),Yp(e,c),Yp(c,u),u.checked=u.__value===t[4],Yp(c,l),Yp(c,h),Yp(c,f),Yp(c,d),d.checked=d.__value===t[4],Yp(c,g),Yp(c,A),Yp(c,p),Yp(c,y),y.checked=y.__value===t[4],Yp(c,m),Yp(c,I),Yp(e,b),Yp(e,E),Yp(e,w),Yp(e,C),Yp(e,v),Yp(e,B),Yp(B,_),Y.block.m(_,Y.anchor=null),Y.mount=()=>_,Y.anchor=null,Yp(e,k),Yp(e,S),Yp(S,x),j.m(x,null),Yp(e,Q),Yp(e,M),Yp(e,T),Yp(e,D),Yp(D,$),Yp(e,U),H&&H.m(e,null),Yp(e,O),V&&V.m(e,null),F=!0,N||(P=[Jp(n,"click",t[19]),Jp(u,"change",t[20]),Jp(d,"change",t[22]),Jp(y,"change",t[23]),Jp(D,"click",t[29])],N=!0)},p(n,r){t=n,16&r[0]&&(u.checked=u.__value===t[4]),16&r[0]&&(d.checked=d.__value===t[4]),16&r[0]&&(y.checked=y.__value===t[4]),Qy(Y,t,r),R===(R=K(t))&&j?j.p(t,r):(j.d(1),j=R(t),j&&(j.c(),j.m(x,null))),(!F||8&r[0]&&L!==(L=!t[3]))&&(D.disabled=L),t[6]?H?(H.p(t,r),64&r[0]&&ky(H,1)):(H=Gm(t),H.c(),ky(H,1),H.m(e,O)):H&&(By(),Sy(H,1,1,(()=>{H=null})),_y()),t[5]?V?(V.p(t,r),32&r[0]&&ky(V,1)):(V=zm(t),V.c(),ky(V,1),V.m(e,null)):V&&(By(),Sy(V,1,1,(()=>{V=null})),_y())},i(t){F||(ky(o.$$.fragment,t),ky(Y.block),ky(H),ky(V),F=!0)},o(t){Sy(o.$$.fragment,t);for(let t=0;t<3;t+=1){Sy(Y.blocks[t])}Sy(H),Sy(V),F=!1},d(n){n&&Rp(e),Ly(o),t[21][0].splice(t[21][0].indexOf(u),1),t[21][0].splice(t[21][0].indexOf(d),1),t[21][0].splice(t[21][0].indexOf(y),1),Y.block.d(),Y.token=null,Y=null,j.d(),H&&H.d(),V&&V.d(),N=!1,Bp(P)}}}async function Xm(){console.error("TODO: not yet implemented")}function Zm(t,e,n){let r,o,i,s,a,c,u,l,h;const f=Yy(100);Dp(t,f,(t=>n(0,o=t)));const d=Yy();Dp(t,d,(t=>n(3,a=t)));const g=Yy(null);Dp(t,g,(t=>n(35,r=t)));const A=Yy(0);Dp(t,A,(t=>n(4,c=t)));const p=Yy(!1);Dp(t,p,(t=>n(2,s=t)));const y=Yy(0);Dp(t,y,(t=>n(1,i=t)));const m=Yy(!1);Dp(t,m,(t=>n(6,l=t)));const I=Yy("");Dp(t,I,(t=>n(7,h=t)));const b=Yy(!1);async function E(t=0){if(a)return;console.info(`roll(${t})`),Pp(f,o=0,o),Pp(p,s=!1,s);let e=null;for(let n=0;n<100&&(Pp(f,o++,o),e=qy(t<2?c:null,t<1?r:null,500),!e);n++)await new Promise((t=>setTimeout(t,100)));e?(await async function(t){await Gy.writeIdentity(t),cm(!0)}(e.sk),Pp(d,a=e.sk,a)):(Pp(p,s=!0,s),Pp(y,i++,i)),Pp(f,o=100,o)}Dp(t,b,(t=>n(5,u=t)));return[o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,async function(){try{const t=await Gy.readIdentity();if(!t)return;Pp(d,a=t,a);const e=zy(t.slice(32));Pp(A,c=e.sex,c),Pp(g,r=e.geohash,r)}catch(t){throw console.error("loadKeychain() failed:",t),t}},E,()=>Pp(b,u=!0,u),function(){c=this.__value,A.set(c)},[[]],function(){c=this.__value,A.set(c)},function(){c=this.__value,A.set(c)},()=>E(1),()=>E(1),()=>Em(!0),()=>E(2),()=>Pp(m,l=!0,l),()=>L_("/profile"),function(){h=this.value,I.set(h)},()=>Pp(m,l=!1,l),()=>Pp(m,l=!1,l),()=>Pp(b,u=!1,u),()=>Pp(b,u=!1,u)]}class tI extends Fy{constructor(t){super(),Oy(this,t,Zm,Wm,kp,{},null,[-1,-1])}}const eI=Yy([]),nI=Ky(eI,(t=>t.reduce(((t,e)=>t+Dd.ITEMS[e.id].price*e.qty),0))),rI=Ky(eI,(t=>t.reduce(((t,e)=>t+e.qty),0)));function oI(t){const e=Tp(eI).find((e=>e.id===t))?.qty||0;sI(t,e+1)}function iI(t){const e=Tp(eI).find((e=>e.id===t))?.qty||0;sI(t,e-1)}function sI(t,e=0){const n=Tp(eI);let r=n.find((e=>e.id===t));r||(r={id:t,qty:0},n.push(r)),r.qty=Math.max(e,0),eI.set(n)}var aI={exports:{}};!function(t,e){t.exports=function(){var t=1e3,e=6e4,n=36e5,r="millisecond",o="second",i="minute",s="hour",a="day",c="week",u="month",l="quarter",h="year",f="date",d="Invalid Date",g=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},y=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},m={s:y,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),o=n%60;return(e<=0?"+":"-")+y(r,2,"0")+":"+y(o,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),o=e.clone().add(r,u),i=n-o<0,s=e.clone().add(r+(i?-1:1),u);return+(-(r+(n-o)/(i?o-s:s-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:h,w:c,d:a,D:f,h:s,m:i,s:o,ms:r,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},I="en",b={};b[I]=p;var E=function(t){return t instanceof B},w=function t(e,n,r){var o;if(!e)return I;if("string"==typeof e){var i=e.toLowerCase();b[i]&&(o=i),n&&(b[i]=n,o=i);var s=e.split("-");if(!o&&s.length>1)return t(s[0])}else{var a=e.name;b[a]=e,o=a}return!r&&o&&(I=o),o||!r&&I},C=function(t,e){if(E(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new B(n)},v=m;v.l=w,v.i=E,v.w=function(t,e){return C(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var B=function(){function p(t){this.$L=w(t.locale,null,!0),this.parse(t)}var y=p.prototype;return y.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(v.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(g);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},y.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},y.$utils=function(){return v},y.isValid=function(){return!(this.$d.toString()===d)},y.isSame=function(t,e){var n=C(t);return this.startOf(e)<=n&&n<=this.endOf(e)},y.isAfter=function(t,e){return C(t)<this.startOf(e)},y.isBefore=function(t,e){return this.endOf(e)<C(t)},y.$g=function(t,e,n){return v.u(t)?this[e]:this.set(n,t)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(t,e){var n=this,r=!!v.u(e)||e,l=v.p(t),d=function(t,e){var o=v.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?o:o.endOf(a)},g=function(t,e){return v.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},A=this.$W,p=this.$M,y=this.$D,m="set"+(this.$u?"UTC":"");switch(l){case h:return r?d(1,0):d(31,11);case u:return r?d(1,p):d(0,p+1);case c:var I=this.$locale().weekStart||0,b=(A<I?A+7:A)-I;return d(r?y-b:y+(6-b),p);case a:case f:return g(m+"Hours",0);case s:return g(m+"Minutes",1);case i:return g(m+"Seconds",2);case o:return g(m+"Milliseconds",3);default:return this.clone()}},y.endOf=function(t){return this.startOf(t,!1)},y.$set=function(t,e){var n,c=v.p(t),l="set"+(this.$u?"UTC":""),d=(n={},n[a]=l+"Date",n[f]=l+"Date",n[u]=l+"Month",n[h]=l+"FullYear",n[s]=l+"Hours",n[i]=l+"Minutes",n[o]=l+"Seconds",n[r]=l+"Milliseconds",n)[c],g=c===a?this.$D+(e-this.$W):e;if(c===u||c===h){var A=this.clone().set(f,1);A.$d[d](g),A.init(),this.$d=A.set(f,Math.min(this.$D,A.daysInMonth())).$d}else d&&this.$d[d](g);return this.init(),this},y.set=function(t,e){return this.clone().$set(t,e)},y.get=function(t){return this[v.p(t)]()},y.add=function(r,l){var f,d=this;r=Number(r);var g=v.p(l),A=function(t){var e=C(d);return v.w(e.date(e.date()+Math.round(t*r)),d)};if(g===u)return this.set(u,this.$M+r);if(g===h)return this.set(h,this.$y+r);if(g===a)return A(1);if(g===c)return A(7);var p=(f={},f[i]=e,f[s]=n,f[o]=t,f)[g]||1,y=this.$d.getTime()+r*p;return v.w(y,this)},y.subtract=function(t,e){return this.add(-1*t,e)},y.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||d;var r=t||"YYYY-MM-DDTHH:mm:ssZ",o=v.z(this),i=this.$H,s=this.$m,a=this.$M,c=n.weekdays,u=n.months,l=function(t,n,o,i){return t&&(t[n]||t(e,r))||o[n].slice(0,i)},h=function(t){return v.s(i%12||12,t,"0")},f=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},g={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:v.s(a+1,2,"0"),MMM:l(n.monthsShort,a,u,3),MMMM:l(u,a),D:this.$D,DD:v.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,c,2),ddd:l(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:v.s(i,2,"0"),h:h(1),hh:h(2),a:f(i,s,!0),A:f(i,s,!1),m:String(s),mm:v.s(s,2,"0"),s:String(this.$s),ss:v.s(this.$s,2,"0"),SSS:v.s(this.$ms,3,"0"),Z:o};return r.replace(A,(function(t,e){return e||g[t]||o.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(r,f,d){var g,A=v.p(f),p=C(r),y=(p.utcOffset()-this.utcOffset())*e,m=this-p,I=v.m(this,p);return I=(g={},g[h]=I/12,g[u]=I,g[l]=I/3,g[c]=(m-y)/6048e5,g[a]=(m-y)/864e5,g[s]=m/n,g[i]=m/e,g[o]=m/t,g)[A]||m,d?I:v.a(I)},y.daysInMonth=function(){return this.endOf(u).$D},y.$locale=function(){return b[this.$L]},y.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=w(t,e,!0);return r&&(n.$L=r),n},y.clone=function(){return v.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},p}(),_=B.prototype;return C.prototype=_,[["$ms",r],["$s",o],["$m",i],["$H",s],["$W",a],["$M",u],["$y",h],["$D",f]].forEach((function(t){_[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),C.extend=function(t,e){return t.$i||(t(e,B,C),t.$i=!0),C},C.locale=w,C.isDayjs=E,C.unix=function(t){return C(1e3*t)},C.en=b[I],C.Ls=b,C.p={},C}()}(aI);var cI=aI.exports;function uI(t){let e,n=cI.duration(t[1]>0?t[1]:0).format(t[0])+"";return{c(){e=Gp(n)},m(t,n){Kp(t,e,n)},p(t,r){3&r&&n!==(n=cI.duration(t[1]>0?t[1]:0).format(t[0])+"")&&ey(e,n)},d(t){t&&Rp(e)}}}function lI(t){let e,n,r=t[3](t[1]>0?t[1]:0)+"";return{c(){e=new iy(!1),n=zp(),e.a=n},m(t,o){e.m(r,t,o),Kp(t,n,o)},p(t,n){2&n&&r!==(r=t[3](t[1]>0?t[1]:0)+"")&&e.p(r)},d(t){t&&Rp(n),t&&e.d()}}}function hI(t){let e,n;function r(t,e){return 1&e&&(n=null),null==n&&(n=!!/^¤+$/.test(t[0])),n?lI:uI}let o=r(t,-1),i=o(t);return{c(){e=Hp("timer"),i.c()},m(t,n){Kp(t,e,n),i.m(e,null)},p(t,[n]){o===(o=r(t,n))&&i?i.p(t,n):(i.d(1),i=o(t),i&&(i.c(),i.m(e,null)))},i:wp,o:wp,d(t){t&&Rp(e),i.d()}}}function fI(t,e,n){let r,{expiresAt:o}=e,{format:i="HH:mm"}=e,s=null;const a=Yy(o-Date.now());return Dp(t,a,(t=>n(1,r=t))),cy((()=>(s&&(clearInterval(s),s=null),s=setInterval((()=>{Pp(a,r=o-Date.now(),r),r<=0&&clearInterval(s)}),200),()=>{clearInterval(s)}))),t.$$set=t=>{"expiresAt"in t&&n(4,o=t.expiresAt),"format"in t&&n(0,i=t.format)},[i,r,a,function(t){const e=t/1e3/60;switch(i){case"¤":return Math.floor(e);case"¤¤":return`${Math.floor(e)}<small>${(e-Math.floor(e)).toFixed(1).substr(1)}</small>`;case"¤¤¤":return`${Math.floor(e)}<small>${(e-Math.floor(e)).toFixed(2).substr(1)}</small>`}},o]}class dI extends Fy{constructor(t){super(),Oy(this,t,fI,hI,kp,{expiresAt:4,format:0})}}var gI={},AI={},pI={};Object.defineProperty(pI,"__esModule",{value:!0}),pI.areaConversion=pI.timeConversion=pI.distanceConversion=pI.altitudeKeys=pI.latitudeKeys=pI.longitudeKeys=pI.MAXLON=pI.MINLON=pI.MAXLAT=pI.MINLAT=pI.earthRadius=pI.sexagesimalPattern=void 0;pI.sexagesimalPattern=/^([0-9]{1,3})°\s*([0-9]{1,3}(?:\.(?:[0-9]{1,}))?)['′]\s*(([0-9]{1,3}(\.([0-9]{1,}))?)["″]\s*)?([NEOSW]?)$/;pI.earthRadius=6378137;pI.MINLAT=-90;pI.MAXLAT=90;pI.MINLON=-180;pI.MAXLON=180;pI.longitudeKeys=["lng","lon","longitude",0];pI.latitudeKeys=["lat","latitude",1];pI.altitudeKeys=["alt","altitude","elevation","elev",2];pI.distanceConversion={m:1,km:.001,cm:100,mm:1e3,mi:1/1609.344,sm:1/1852.216,ft:100/30.48,in:100/2.54,yd:1/.9144};pI.timeConversion={m:60,h:3600,d:86400};var yI={m2:1,km2:1e-6,ha:1e-4,a:.01,ft2:10.763911,yd2:1.19599,in2:1550.0031};pI.areaConversion=yI,yI.sqm=yI.m2,yI.sqkm=yI.km2,yI.sqft=yI.ft2,yI.sqyd=yI.yd2,yI.sqin=yI.in2;var mI={};Object.defineProperty(mI,"__esModule",{value:!0}),mI.default=void 0;var II=function(t,e){return e.reduce((function(e,n){if(null==t)throw new Error("'".concat(t,"' is no valid coordinate."));return Object.prototype.hasOwnProperty.call(t,n)&&void 0!==n&&void 0===e?(e=n,n):e}),void 0)};mI.default=II;var bI={},EI={};Object.defineProperty(EI,"__esModule",{value:!0}),EI.default=void 0;var wI=function(t){var e=t.toString().trim();return!isNaN(parseFloat(e))&&parseFloat(e)===Number(e)};EI.default=wI;var CI={};Object.defineProperty(CI,"__esModule",{value:!0}),CI.default=void 0;var vI=pI,BI=function(t){return vI.sexagesimalPattern.test(t.toString().trim())};CI.default=BI;var _I={};Object.defineProperty(_I,"__esModule",{value:!0}),_I.default=void 0;var kI=pI,SI=function(t){var e=new RegExp(kI.sexagesimalPattern).exec(t.toString().trim());if(null==e)throw new Error("Given value is not in sexagesimal format");var n=Number(e[2])/60||0,r=Number(e[4])/3600||0,o=parseFloat(e[1])+n+r;return["S","W"].includes(e[7])?-o:o};_I.default=SI;var xI={},QI={};Object.defineProperty(QI,"__esModule",{value:!0}),QI.default=void 0;var MI,TI=pI,DI=(MI=mI)&&MI.__esModule?MI:{default:MI};function $I(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function LI(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$I(Object(n),!0).forEach((function(e){UI(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$I(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function UI(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var OI=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{longitude:TI.longitudeKeys,latitude:TI.latitudeKeys,altitude:TI.altitudeKeys},n=(0,DI.default)(t,e.longitude),r=(0,DI.default)(t,e.latitude),o=(0,DI.default)(t,e.altitude);return LI({latitude:r,longitude:n},o?{altitude:o}:{})};QI.default=OI;var FI={};Object.defineProperty(FI,"__esModule",{value:!0}),FI.default=void 0;var NI=RI(EI),PI=RI(CI),YI=RI(_I),KI=pI;function RI(t){return t&&t.__esModule?t:{default:t}}var jI=function t(e){return(0,NI.default)(e)?!(parseFloat(e)>KI.MAXLAT||e<KI.MINLAT):!!(0,PI.default)(e)&&t((0,YI.default)(e))};FI.default=jI;var HI={};Object.defineProperty(HI,"__esModule",{value:!0}),HI.default=void 0;var VI=JI(EI),GI=JI(CI),qI=JI(_I),zI=pI;function JI(t){return t&&t.__esModule?t:{default:t}}var WI=function t(e){return(0,VI.default)(e)?!(parseFloat(e)>zI.MAXLON||e<zI.MINLON):!!(0,GI.default)(e)&&t((0,qI.default)(e))};HI.default=WI,Object.defineProperty(xI,"__esModule",{value:!0}),xI.default=void 0;var XI=eb(QI),ZI=eb(FI),tb=eb(HI);function eb(t){return t&&t.__esModule?t:{default:t}}var nb=function(t){var e=(0,XI.default)(t),n=e.latitude,r=e.longitude;if(Array.isArray(t)&&t.length>=2)return(0,tb.default)(t[0])&&(0,ZI.default)(t[1]);if(void 0===n||void 0===r)return!1;var o=t[r],i=t[n];return void 0!==i&&void 0!==o&&(!1!==(0,ZI.default)(i)&&!1!==(0,tb.default)(o))};xI.default=nb,Object.defineProperty(bI,"__esModule",{value:!0}),bI.default=void 0;var rb=cb(EI),ob=cb(CI),ib=cb(_I),sb=cb(xI),ab=cb(QI);function cb(t){return t&&t.__esModule?t:{default:t}}function ub(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function lb(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ub(Object(n),!0).forEach((function(e){hb(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ub(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function hb(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var fb=function t(e){if((0,rb.default)(e))return Number(e);if((0,ob.default)(e))return(0,ib.default)(e);if((0,sb.default)(e)){var n=(0,ab.default)(e);return Array.isArray(e)?e.map((function(e,n){return[0,1].includes(n)?t(e):e})):lb(lb(lb({},e),n.latitude&&hb({},n.latitude,t(e[n.latitude]))),n.longitude&&hb({},n.longitude,t(e[n.longitude])))}return Array.isArray(e)?e.map((function(e){return(0,sb.default)(e)?t(e):e})):e};bI.default=fb,Object.defineProperty(AI,"__esModule",{value:!0}),AI.default=void 0;var db=pI,gb=pb(mI),Ab=pb(bI);function pb(t){return t&&t.__esModule?t:{default:t}}var yb=function(t,e){var n=(0,gb.default)(t,db.latitudeKeys);if(null!=n){var r=t[n];return!0===e?r:(0,Ab.default)(r)}};AI.default=yb;var mb={};Object.defineProperty(mb,"__esModule",{value:!0}),mb.default=void 0;var Ib=pI,bb=wb(mI),Eb=wb(bI);function wb(t){return t&&t.__esModule?t:{default:t}}var Cb=function(t,e){var n=(0,bb.default)(t,Ib.longitudeKeys);if(null!=n){var r=t[n];return!0===e?r:(0,Eb.default)(r)}};mb.default=Cb;var vb={};Object.defineProperty(vb,"__esModule",{value:!0}),vb.default=void 0;var Bb=function(t){return t*Math.PI/180};vb.default=Bb;var _b={};Object.defineProperty(_b,"__esModule",{value:!0}),_b.default=void 0;var kb=function(t){return 180*t/Math.PI};_b.default=kb,Object.defineProperty(gI,"__esModule",{value:!0}),gI.default=void 0;var Sb=Db(AI),xb=Db(mb),Qb=Db(vb),Mb=Db(_b),Tb=pI;function Db(t){return t&&t.__esModule?t:{default:t}}var $b=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6371e3,o=(0,Sb.default)(t),i=(0,xb.default)(t),s=e/r,a=(0,Qb.default)(n),c=(0,Qb.default)(o),u=(0,Qb.default)(i),l=Math.asin(Math.sin(c)*Math.cos(s)+Math.cos(c)*Math.sin(s)*Math.cos(a)),h=u+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(c),Math.cos(s)-Math.sin(c)*Math.sin(l)),f=(0,Mb.default)(h);return(f<Tb.MINLON||f>Tb.MAXLON)&&(h=(h+3*Math.PI)%(2*Math.PI)-Math.PI,f=(0,Mb.default)(h)),{latitude:(0,Mb.default)(l),longitude:f}};gI.default=$b;var Lb={};Object.defineProperty(Lb,"__esModule",{value:!0}),Lb.default=void 0;var Ub=pI,Ob=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",n=Ub.areaConversion[e];if(n)return t*n;throw new Error("Invalid unit used for area conversion.")};Lb.default=Ob;var Fb={};Object.defineProperty(Fb,"__esModule",{value:!0}),Fb.default=void 0;var Nb=pI,Pb=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",n=Nb.distanceConversion[e];if(n)return t*n;throw new Error("Invalid unit used for distance conversion.")};Fb.default=Pb;var Yb={};Object.defineProperty(Yb,"__esModule",{value:!0}),Yb.default=void 0;var Kb=pI,Rb=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"kmh";switch(e){case"kmh":return t*Kb.timeConversion.h*Kb.distanceConversion.km;case"mph":return t*Kb.timeConversion.h*Kb.distanceConversion.mi;default:return t}};Yb.default=Rb;var jb={};function Hb(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Vb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Vb(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Vb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(jb,"__esModule",{value:!0}),jb.default=void 0;var Gb=function(t){var e=Hb(t.toString().split("."),2),n=e[0],r=e[1],o=Math.abs(Number(n)),i=60*Number("0."+(r||0)),s=i.toString().split("."),a=Math.floor(i),c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=Math.pow(10,e);return Math.round(t*n)/n}(60*Number("0."+(s[1]||0))).toString(),u=Hb(c.split("."),2),l=u[0],h=u[1],f=void 0===h?"0":h;return o+"° "+a.toString().padStart(2,"0")+"' "+l.padStart(2,"0")+"."+f.padEnd(1,"0")+'"'};jb.default=Gb;var qb={},zb={},Jb={},Wb={};Object.defineProperty(Wb,"__esModule",{value:!0}),Wb.default=void 0;var Xb=function(t){return t>1?1:t<-1?-1:t};Wb.default=Xb,Object.defineProperty(Jb,"__esModule",{value:!0}),Jb.default=void 0;var Zb=oE(AI),tE=oE(mb),eE=oE(vb),nE=oE(Wb),rE=pI;function oE(t){return t&&t.__esModule?t:{default:t}}var iE=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;n=void 0===n||isNaN(n)?1:n;var r=(0,Zb.default)(t),o=(0,tE.default)(t),i=(0,Zb.default)(e),s=(0,tE.default)(e),a=Math.acos((0,nE.default)(Math.sin((0,eE.default)(i))*Math.sin((0,eE.default)(r))+Math.cos((0,eE.default)(i))*Math.cos((0,eE.default)(r))*Math.cos((0,eE.default)(o)-(0,eE.default)(s))))*rE.earthRadius;return Math.round(a/n)*n};Jb.default=iE,Object.defineProperty(zb,"__esModule",{value:!0}),zb.default=void 0;var sE=function(t){return t&&t.__esModule?t:{default:t}}(Jb);var aE=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:sE.default;return n="function"==typeof n?n:sE.default,e.slice().sort((function(e,r){return n(t,e)-n(t,r)}))};zb.default=aE,Object.defineProperty(qb,"__esModule",{value:!0}),qb.default=void 0;var cE=function(t){return t&&t.__esModule?t:{default:t}}(zb);var uE=function(t,e){return(0,cE.default)(t,e)[0]};qb.default=uE;var lE={};Object.defineProperty(lE,"__esModule",{value:!0}),lE.default=void 0;var hE=AE(vb),fE=AE(AI),dE=AE(mb),gE=pI;function AE(t){return t&&t.__esModule?t:{default:t}}var pE=function(t){var e=0;if(t.length>2){for(var n,r,o,i=0;i<t.length;i++){i===t.length-2?(n=t.length-2,r=t.length-1,o=0):i===t.length-1?(n=t.length-1,r=0,o=1):(n=i,r=i+1,o=i+2);var s=(0,dE.default)(t[n]),a=(0,fE.default)(t[r]),c=(0,dE.default)(t[o]);e+=((0,hE.default)(c)-(0,hE.default)(s))*Math.sin((0,hE.default)(a))}e=e*gE.earthRadius*gE.earthRadius/2}return Math.abs(e)};lE.default=pE;var yE={};Object.defineProperty(yE,"__esModule",{value:!0}),yE.default=void 0;var mE=bE(AI),IE=bE(mb);function bE(t){return t&&t.__esModule?t:{default:t}}var EE=function(t){if(!1===Array.isArray(t)||0===t.length)throw new Error("No points were given.");return t.reduce((function(t,e){var n=(0,mE.default)(e),r=(0,IE.default)(e);return{maxLat:Math.max(n,t.maxLat),minLat:Math.min(n,t.minLat),maxLng:Math.max(r,t.maxLng),minLng:Math.min(r,t.minLng)}}),{maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0})};yE.default=EE;var wE={};Object.defineProperty(wE,"__esModule",{value:!0}),wE.default=void 0;var CE=SE(AI),vE=SE(mb),BE=SE(vb),_E=SE(_b),kE=pI;function SE(t){return t&&t.__esModule?t:{default:t}}var xE=function(t,e){var n,r,o=(0,CE.default)(t),i=(0,vE.default)(t),s=(0,BE.default)(o),a=(0,BE.default)(i),c=e/kE.earthRadius,u=s-c,l=s+c,h=(0,BE.default)(kE.MAXLAT),f=(0,BE.default)(kE.MINLAT),d=(0,BE.default)(kE.MAXLON),g=(0,BE.default)(kE.MINLON);if(u>f&&l<h){var A=Math.asin(Math.sin(c)/Math.cos(s));(n=a-A)<g&&(n+=2*Math.PI),(r=a+A)>d&&(r-=2*Math.PI)}else u=Math.max(u,f),l=Math.min(l,h),n=g,r=d;return[{latitude:(0,_E.default)(u),longitude:(0,_E.default)(n)},{latitude:(0,_E.default)(l),longitude:(0,_E.default)(r)}]};wE.default=xE;var QE={};Object.defineProperty(QE,"__esModule",{value:!0}),QE.default=void 0;var ME=LE(AI),TE=LE(mb),DE=LE(vb),$E=LE(_b);function LE(t){return t&&t.__esModule?t:{default:t}}var UE=function(t){if(!1===Array.isArray(t)||0===t.length)return!1;var e=t.length,n=t.reduce((function(t,e){var n=(0,DE.default)((0,ME.default)(e)),r=(0,DE.default)((0,TE.default)(e));return{X:t.X+Math.cos(n)*Math.cos(r),Y:t.Y+Math.cos(n)*Math.sin(r),Z:t.Z+Math.sin(n)}}),{X:0,Y:0,Z:0}),r=n.X/e,o=n.Y/e,i=n.Z/e;return{longitude:(0,$E.default)(Math.atan2(o,r)),latitude:(0,$E.default)(Math.atan2(i,Math.sqrt(r*r+o*o)))}};QE.default=UE;var OE={};Object.defineProperty(OE,"__esModule",{value:!0}),OE.default=void 0;var FE=function(t){return t&&t.__esModule?t:{default:t}}(yE);var NE=function(t){var e=(0,FE.default)(t),n=e.minLat+(e.maxLat-e.minLat)/2,r=e.minLng+(e.maxLng-e.minLng)/2;return{latitude:parseFloat(n.toFixed(6)),longitude:parseFloat(r.toFixed(6))}};OE.default=NE;var PE={},YE={};Object.defineProperty(YE,"__esModule",{value:!0}),YE.default=void 0;var KE=VE(AI),RE=VE(mb),jE=VE(vb),HE=VE(_b);function VE(t){return t&&t.__esModule?t:{default:t}}var GE=function(t,e){var n=(0,jE.default)((0,RE.default)(e))-(0,jE.default)((0,RE.default)(t)),r=Math.log(Math.tan((0,jE.default)((0,KE.default)(e))/2+Math.PI/4)/Math.tan((0,jE.default)((0,KE.default)(t))/2+Math.PI/4));return Math.abs(n)>Math.PI&&(n=n>0?-1*(2*Math.PI-n):2*Math.PI+n),((0,HE.default)(Math.atan2(n,r))+360)%360};YE.default=GE,Object.defineProperty(PE,"__esModule",{value:!0}),PE.default=void 0;var qE=function(t){return t&&t.__esModule?t:{default:t}}(YE);var zE=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:qE.default,r="function"==typeof n?n(t,e):(0,qE.default)(t,e);if(isNaN(r))throw new Error("Could not calculate bearing for given points. Check your bearing function");switch(Math.round(r/22.5)){case 1:return"NNE";case 2:return"NE";case 3:return"ENE";case 4:return"E";case 5:return"ESE";case 6:return"SE";case 7:return"SSE";case 8:return"S";case 9:return"SSW";case 10:return"SW";case 11:return"WSW";case 12:return"W";case 13:return"WNW";case 14:return"NW";case 15:return"NNW";default:return"N"}};PE.default=zE;var JE={};Object.defineProperty(JE,"__esModule",{value:!0}),JE.default=void 0;var WE=ZE(Jb),XE=ZE(Wb);function ZE(t){return t&&t.__esModule?t:{default:t}}var tw=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=(0,WE.default)(e,t,r),i=(0,WE.default)(t,n,r),s=(0,WE.default)(e,n,r),a=Math.acos((0,XE.default)((o*o+s*s-i*i)/(2*o*s))),c=Math.acos((0,XE.default)((i*i+s*s-o*o)/(2*i*s)));return a>Math.PI/2?o:c>Math.PI/2?i:Math.sin(a)*o};JE.default=tw;var ew={};Object.defineProperty(ew,"__esModule",{value:!0}),ew.default=void 0;var nw=sw(AI),rw=sw(mb),ow=sw(vb),iw=sw(_b);function sw(t){return t&&t.__esModule?t:{default:t}}var aw=function(t,e){var n=(0,nw.default)(e),r=(0,rw.default)(e),o=(0,nw.default)(t),i=(0,rw.default)(t);return((0,iw.default)(Math.atan2(Math.sin((0,ow.default)(r)-(0,ow.default)(i))*Math.cos((0,ow.default)(n)),Math.cos((0,ow.default)(o))*Math.sin((0,ow.default)(n))-Math.sin((0,ow.default)(o))*Math.cos((0,ow.default)(n))*Math.cos((0,ow.default)(r)-(0,ow.default)(i))))+360)%360};ew.default=aw;var cw={};Object.defineProperty(cw,"__esModule",{value:!0}),cw.default=void 0;var uw=function(t){return t&&t.__esModule?t:{default:t}}(Jb);function lw(t){return lw="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lw(t)}var hw=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:uw.default;return t.reduce((function(t,n){return"object"===lw(t)&&null!==t.last&&(t.distance+=e(n,t.last)),t.last=n,t}),{last:null,distance:0}).distance};cw.default=hw;var fw={};Object.defineProperty(fw,"__esModule",{value:!0}),fw.default=void 0;var dw=yw(AI),gw=yw(mb),Aw=yw(vb),pw=pI;function yw(t){return t&&t.__esModule?t:{default:t}}var mw=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;n=void 0===n||isNaN(n)?1:n;var r,o,i,s,a,c,u,l=(0,dw.default)(t),h=(0,gw.default)(t),f=(0,dw.default)(e),d=(0,gw.default)(e),g=6356752.314245,A=1/298.257223563,p=(0,Aw.default)(d-h),y=Math.atan((1-A)*Math.tan((0,Aw.default)(parseFloat(l)))),m=Math.atan((1-A)*Math.tan((0,Aw.default)(parseFloat(f)))),I=Math.sin(y),b=Math.cos(y),E=Math.sin(m),w=Math.cos(m),C=p,v=100;do{var B=Math.sin(C),_=Math.cos(C);if(0===(c=Math.sqrt(w*B*(w*B)+(b*E-I*w*_)*(b*E-I*w*_))))return 0;r=I*E+b*w*_,o=Math.atan2(c,r),a=r-2*I*E/(s=1-(i=b*w*B/c)*i),isNaN(a)&&(a=0);var k=A/16*s*(4+A*(4-3*s));u=C,C=p+(1-k)*A*i*(o+k*c*(a+k*r*(2*a*a-1)))}while(Math.abs(C-u)>1e-12&&--v>0);if(0===v)return NaN;var S=s*(pw.earthRadius*pw.earthRadius-g*g)/(g*g),x=1+S/16384*(4096+S*(S*(320-175*S)-768)),Q=S/1024*(256+S*(S*(74-47*S)-128)),M=Q*c*(a+Q/4*(r*(2*a*a-1)-Q/6*a*(4*c*c-3)*(4*a*a-3))),T=g*x*(o-M);return Math.round(T/n)*n};fw.default=mw;var Iw={};Object.defineProperty(Iw,"__esModule",{value:!0}),Iw.default=void 0;var bw=function(t){return/^NNE|NE|NNW|N$/.test(t)?"N":/^ENE|E|ESE|SE$/.test(t)?"E":/^SSE|S|SSW|SW$/.test(t)?"S":/^WSW|W|WNW|NW$/.test(t)?"W":void 0};Iw.default=bw;var Ew={};Object.defineProperty(Ew,"__esModule",{value:!0}),Ew.default=void 0;var ww=function(t){return t&&t.__esModule?t:{default:t}}(Jb);var Cw=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ww.default,r=n(t,e),o=Number(e.time)-Number(t.time),i=r/o*1e3;return i};Ew.default=Cw;var vw={};Object.defineProperty(vw,"__esModule",{value:!0}),vw.default=void 0;var Bw=function(t){return t&&t.__esModule?t:{default:t}}(Jb);var _w=function(t,e,n){return(0,Bw.default)(e,t)+(0,Bw.default)(t,n)===(0,Bw.default)(e,n)};vw.default=_w;var kw={};Object.defineProperty(kw,"__esModule",{value:!0}),kw.default=void 0;var Sw=Qw(AI),xw=Qw(mb);function Qw(t){return t&&t.__esModule?t:{default:t}}var Mw=function(t,e){for(var n=!1,r=e.length,o=-1,i=r-1;++o<r;i=o)((0,xw.default)(e[o])<=(0,xw.default)(t)&&(0,xw.default)(t)<(0,xw.default)(e[i])||(0,xw.default)(e[i])<=(0,xw.default)(t)&&(0,xw.default)(t)<(0,xw.default)(e[o]))&&(0,Sw.default)(t)<((0,Sw.default)(e[i])-(0,Sw.default)(e[o]))*((0,xw.default)(t)-(0,xw.default)(e[o]))/((0,xw.default)(e[i])-(0,xw.default)(e[o]))+(0,Sw.default)(e[o])&&(n=!n);return n};kw.default=Mw;var Tw={};Object.defineProperty(Tw,"__esModule",{value:!0}),Tw.default=void 0;var Dw=function(t){return t&&t.__esModule?t:{default:t}}(JE);var $w=function(t,e,n,r){return(0,Dw.default)(t,e,n)<r};Tw.default=$w;var Lw={};Object.defineProperty(Lw,"__esModule",{value:!0}),Lw.default=void 0;var Uw=function(t){return t&&t.__esModule?t:{default:t}}(Jb);var Ow=function(t,e,n){return(0,Uw.default)(t,e)<n};Lw.default=Ow;var Fw={};function Nw(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return Pw(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pw(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Pw(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(Fw,"__esModule",{value:!0}),Fw.default=void 0;var Yw=function(t){if(!t.startsWith("POLYGON"))throw new Error("Invalid wkt.");return t.slice(t.indexOf("(")+2,t.indexOf(")")).split(", ").map((function(t){var e=Nw(t.split(" "),2),n=e[0],r=e[1];return{longitude:parseFloat(n),latitude:parseFloat(r)}}))};function Kw(t){let e,n;return{c(){e=Hp("img"),Zp(e,"class","bimg"),Zp(e,"style",t[1]),Qp(e.src,n=bm(t[0]))||Zp(e,"src",n)},m(t,n){Kp(t,e,n)},p(t,[r]){1&r&&!Qp(e.src,n=bm(t[0]))&&Zp(e,"src",n)},i:wp,o:wp,d(t){t&&Rp(e)}}}function Rw(t,e,n){let{src:r=null}=e,{size:o=null}=e;const i=o?`width: ${o}; height: ${o}`:"";return t.$$set=t=>{"src"in t&&n(0,r=t.src),"size"in t&&n(2,o=t.size)},[r,i,o]}Fw.default=Yw,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e={computeDestinationPoint:!0,convertArea:!0,convertDistance:!0,convertSpeed:!0,decimalToSexagesimal:!0,findNearest:!0,getAreaOfPolygon:!0,getBounds:!0,getBoundsOfDistance:!0,getCenter:!0,getCenterOfBounds:!0,getCompassDirection:!0,getCoordinateKey:!0,getCoordinateKeys:!0,getDistance:!0,getDistanceFromLine:!0,getGreatCircleBearing:!0,getLatitude:!0,getLongitude:!0,getPathLength:!0,getPreciseDistance:!0,getRhumbLineBearing:!0,getRoughCompassDirection:!0,getSpeed:!0,isDecimal:!0,isPointInLine:!0,isPointInPolygon:!0,isPointNearLine:!0,isPointWithinRadius:!0,isSexagesimal:!0,isValidCoordinate:!0,isValidLatitude:!0,isValidLongitude:!0,orderByDistance:!0,sexagesimalToDecimal:!0,toDecimal:!0,toRad:!0,toDeg:!0,wktToPolygon:!0};Object.defineProperty(t,"computeDestinationPoint",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"convertArea",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"convertDistance",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"convertSpeed",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"decimalToSexagesimal",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"findNearest",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"getAreaOfPolygon",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"getBounds",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"getBoundsOfDistance",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"getCenter",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"getCenterOfBounds",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"getCompassDirection",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"getCoordinateKey",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"getCoordinateKeys",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(t,"getDistance",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"getDistanceFromLine",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"getGreatCircleBearing",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"getLatitude",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(t,"getLongitude",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"getPathLength",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(t,"getPreciseDistance",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"getRhumbLineBearing",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(t,"getRoughCompassDirection",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"getSpeed",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(t,"isDecimal",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"isPointInLine",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"isPointInPolygon",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(t,"isPointNearLine",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(t,"isPointWithinRadius",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(t,"isSexagesimal",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(t,"isValidCoordinate",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(t,"isValidLatitude",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(t,"isValidLongitude",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(t,"orderByDistance",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(t,"sexagesimalToDecimal",{enumerable:!0,get:function(){return U.default}}),Object.defineProperty(t,"toDecimal",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"toRad",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(t,"toDeg",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(t,"wktToPolygon",{enumerable:!0,get:function(){return P.default}});var n=K(gI),r=K(Lb),o=K(Fb),i=K(Yb),s=K(jb),a=K(qb),c=K(lE),u=K(yE),l=K(wE),h=K(QE),f=K(OE),d=K(PE),g=K(mI),A=K(QI),p=K(Jb),y=K(JE),m=K(ew),I=K(AI),b=K(mb),E=K(cw),w=K(fw),C=K(YE),v=K(Iw),B=K(Ew),_=K(EI),k=K(vw),S=K(kw),x=K(Tw),Q=K(Lw),M=K(CI),T=K(xI),D=K(FI),$=K(HI),L=K(zb),U=K(_I),O=K(bI),F=K(vb),N=K(_b),P=K(Fw),Y=pI;function K(t){return t&&t.__esModule?t:{default:t}}Object.keys(Y).forEach((function(n){"default"!==n&&"__esModule"!==n&&(Object.prototype.hasOwnProperty.call(e,n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return Y[n]}}))}))}({});class jw extends Fy{constructor(t){super(),Oy(this,t,Rw,Kw,kp,{src:0,size:2})}}const Hw=t=>({}),Vw=t=>({});function Gw(t,e,n){const r=t.slice();return r[5]=e[n],r}const qw=t=>({}),zw=t=>({});function Jw(t){let e,n=Dd.ITEMS[t[5].id].image+"";return{c(){e=Gp(n)},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function Ww(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y=t[0].name+"";const m=t[4].nw,I=$p(m,t,t[3],zw),b=I||function(t){let e,n,r,o,i,s,a,c=t[0].score+"";return{c(){e=Hp("h3"),n=Hp("dot"),r=Gp(" "),s=qp(),a=Gp(c),Zp(n,"class",o=t[0].state),Zp(n,"data-tooltip",i=t[0].state)},m(t,o){Kp(t,e,o),Yp(e,n),Yp(n,r),Yp(e,s),Yp(e,a)},p(t,e){1&e&&o!==(o=t[0].state)&&Zp(n,"class",o),1&e&&i!==(i=t[0].state)&&Zp(n,"data-tooltip",i),1&e&&c!==(c=t[0].score+"")&&ey(a,c)},d(t){t&&Rp(e)}}}(t);let E=t[1],w=[];for(let e=0;e<E.length;e+=1)w[e]=Jw(Gw(t,E,e));d=new jw({props:{src:t[0].picture}});const C=t[4].genderloc,v=$p(C,t,t[3],Vw),B=t[4].default,_=$p(B,t,t[3],null);return{c(){e=Hp("article"),n=Hp("legend"),r=Hp("overlay"),o=Hp("div"),b&&b.c(),i=qp(),s=Hp("div"),a=Hp("h2"),c=Gp(y),u=qp(),l=Hp("div"),h=Hp("h2");for(let t=0;t<w.length;t+=1)w[t].c();f=qp(),Dy(d.$$.fragment),g=qp(),v&&v.c(),A=qp(),_&&_.c(),ry(o,"grid-area","nw"),Zp(o,"class","hpad"),ry(s,"grid-area","sw"),ry(s,"align-self","end"),Zp(s,"class","hpad"),ry(l,"grid-area","se"),ry(l,"align-self","end"),ry(l,"justify-self","end"),Zp(l,"class","end"),Zp(e,"class","peer")},m(t,y){Kp(t,e,y),Yp(e,n),Yp(n,r),Yp(r,o),b&&b.m(o,null),Yp(r,i),Yp(r,s),Yp(s,a),Yp(a,c),Yp(r,u),Yp(r,l),Yp(l,h);for(let t=0;t<w.length;t+=1)w[t].m(h,null);Yp(n,f),$y(d,n,null),Yp(e,g),v&&v.m(e,null),Yp(e,A),_&&_.m(e,null),p=!0},p(t,[e]){if(I?I.p&&(!p||8&e)&&Op(I,m,t,t[3],p?Up(m,t[3],e,qw):Fp(t[3]),zw):b&&b.p&&(!p||1&e)&&b.p(t,p?e:-1),(!p||1&e)&&y!==(y=t[0].name+"")&&ey(c,y),2&e){let n;for(E=t[1],n=0;n<E.length;n+=1){const r=Gw(t,E,n);w[n]?w[n].p(r,e):(w[n]=Jw(r),w[n].c(),w[n].m(h,null))}for(;n<w.length;n+=1)w[n].d(1);w.length=E.length}const n={};1&e&&(n.src=t[0].picture),d.$set(n),v&&v.p&&(!p||8&e)&&Op(v,C,t,t[3],p?Up(C,t[3],e,Hw):Fp(t[3]),Vw),_&&_.p&&(!p||8&e)&&Op(_,B,t,t[3],p?Up(B,t[3],e,null):Fp(t[3]),null)},i(t){p||(ky(b,t),ky(d.$$.fragment,t),ky(v,t),ky(_,t),p=!0)},o(t){Sy(b,t),Sy(d.$$.fragment,t),Sy(v,t),Sy(_,t),p=!1},d(t){t&&Rp(e),b&&b.d(t),jp(w,t),Ly(d),v&&v.d(t),_&&_.d(t)}}}function Xw(t,e,n){let{$$slots:r={},$$scope:o}=e,{peer:i}=e,{size:s="normal"}=e;const a=i.inventory||[];return t.$$set=t=>{"peer"in t&&n(0,i=t.peer),"size"in t&&n(2,s=t.size),"$$scope"in t&&n(3,o=t.$$scope)},[i,a,s,o,r]}class Zw extends Fy{constructor(t){super(),Oy(this,t,Xw,Ww,kp,{peer:0,size:2})}}function tC(t,e,n){const r=t.slice();return r[11]=e[n],r}function eC(t){let e,n;return e=new km({props:{$$slots:{default:[iC]},$$scope:{ctx:t}}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};1030&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function nC(t){let e,n,r,o,i,s,a;const c=t[5].default,u=$p(c,t,t[10],null),l=u||function(t){let e;return{c(){e=Gp("No items")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}();return{c(){e=Hp("article"),l&&l.c(),n=qp(),r=Hp("footer"),o=Hp("button"),o.textContent="ok"},m(c,u){Kp(c,e,u),l&&l.m(e,null),Yp(e,n),Yp(e,r),Yp(r,o),i=!0,s||(a=Jp(o,"click",t[8]),s=!0)},p(t,e){u&&u.p&&(!i||1024&e)&&Op(u,c,t,t[10],i?Up(c,t[10],e,null):Fp(t[10]),null)},i(t){i||(ky(l,t),i=!0)},o(t){Sy(l,t),i=!1},d(t){t&&Rp(e),l&&l.d(t),s=!1,a()}}}function rC(t){let e,n,r,o,i=t[1],s=[];for(let e=0;e<i.length;e+=1)s[e]=oC(tC(t,i,e));return{c(){e=Hp("inventory"),n=Hp("item"),n.innerHTML="<emo>❌</emo> \n          ";for(let t=0;t<s.length;t+=1)s[t].c();Zp(n,"role","button"),Zp(e,"role","listbox"),Zp(e,"class","svelte-1j5rcms")},m(i,a){Kp(i,e,a),Yp(e,n);for(let t=0;t<s.length;t+=1)s[t].m(e,null);r||(o=Jp(n,"click",t[6]),r=!0)},p(t,n){if(18&n){let r;for(i=t[1],r=0;r<i.length;r+=1){const o=tC(t,i,r);s[r]?s[r].p(o,n):(s[r]=oC(o),s[r].c(),s[r].m(e,null))}for(;r<s.length;r+=1)s[r].d(1);s.length=i.length}},i:wp,o:wp,d(t){t&&Rp(e),jp(s,t),r=!1,o()}}}function oC(t){let e,n,r,o,i,s,a,c=Dd.ITEMS[t[11]].image+"";function u(){return t[7](t[11])}return{c(){e=Hp("item"),n=Hp("emo"),r=Gp(c),o=qp(),Zp(e,"role","button"),Zp(e,"class",i=Dd.ITEMS[t[11]].category)},m(t,i){Kp(t,e,i),Yp(e,n),Yp(n,r),Yp(e,o),s||(a=Jp(e,"click",u),s=!0)},p(n,o){t=n,2&o&&c!==(c=Dd.ITEMS[t[11]].image+"")&&ey(r,c),2&o&&i!==(i=Dd.ITEMS[t[11]].category)&&Zp(e,"class",i)},d(t){t&&Rp(e),s=!1,a()}}}function iC(t){let e,n,r,o;const i=[rC,nC],s=[];function a(t,e){return t[1]?.length?0:1}return n=a(t),r=s[n]=i[n](t),{c(){e=Hp("backdrop"),r.c(),Zp(e,"class","svelte-1j5rcms")},m(t,r){Kp(t,e,r),s[n].m(e,null),o=!0},p(t,o){let c=n;n=a(t),n===c?s[n].p(t,o):(By(),Sy(s[c],1,1,(()=>{s[c]=null})),_y(),r=s[n],r?r.p(t,o):(r=s[n]=i[n](t),r.c()),ky(r,1),r.m(e,null))},i(t){o||(ky(r),o=!0)},o(t){Sy(r),o=!1},d(t){t&&Rp(e),s[n].d()}}}function sC(t){let e,n,r,o,i=Dd.ITEMS[t[0]].image+"";return{c(){e=Hp("item"),n=Hp("emo"),r=Gp(i),Zp(e,"role","button"),Zp(e,"class",o=Dd.ITEMS[t[0]].category)},m(t,o){Kp(t,e,o),Yp(e,n),Yp(n,r)},p(t,n){1&n&&i!==(i=Dd.ITEMS[t[0]].image+"")&&ey(r,i),1&n&&o!==(o=Dd.ITEMS[t[0]].category)&&Zp(e,"class",o)},d(t){t&&Rp(e)}}}function aC(t){let e,n,r,o,i,s,a=t[2]&&eC(t),c=t[0]&&sC(t);return{c(){e=Hp("item-input"),a&&a.c(),n=qp(),r=Hp("inventory"),c&&c.c(),ty(e,"role","list")},m(u,l){Kp(u,e,l),a&&a.m(e,null),Yp(e,n),Yp(e,r),c&&c.m(r,null),o=!0,i||(s=Jp(r,"click",t[9]),i=!0)},p(t,[o]){t[2]?a?(a.p(t,o),4&o&&ky(a,1)):(a=eC(t),a.c(),ky(a,1),a.m(e,n)):a&&(By(),Sy(a,1,1,(()=>{a=null})),_y()),t[0]?c?c.p(t,o):(c=sC(t),c.c(),c.m(r,null)):c&&(c.d(1),c=null)},i(t){o||(ky(a),o=!0)},o(t){Sy(a),o=!1},d(t){t&&Rp(e),a&&a.d(),c&&c.d(),i=!1,s()}}}function cC(t,e,n){let r,{$$slots:o={},$$scope:i}=e,{item:s}=e,{items:a=[]}=e;const c=Yy(!1);function u(t){Pp(c,r=!1,r),n(0,s=t)}Dp(t,c,(t=>n(2,r=t))),console.log("ItemInput",a);return t.$$set=t=>{"item"in t&&n(0,s=t.item),"items"in t&&n(1,a=t.items),"$$scope"in t&&n(10,i=t.$$scope)},[s,a,r,c,u,o,()=>u(null),t=>u(t),()=>Pp(c,r=!1,r),()=>Pp(c,r=!r,r),i]}class uC extends Fy{constructor(t){super(),Oy(this,t,cC,aC,kp,{item:0,items:1})}}function lC(t,e,n){const r=t.slice();return r[28]=e[n],r}function hC(t,e,n){const r=t.slice();return r[31]=e[n],r}function fC(t){let e,n,r;return n=new dI({props:{expiresAt:t[3].vibe,format:"mm:ss"}}),{c(){e=Gp("Vibe available in again "),Dy(n.$$.fragment)},m(t,o){Kp(t,e,o),$y(n,t,o),r=!0},p(t,e){const r={};8&e[0]&&(r.expiresAt=t[3].vibe),n.$set(r)},i(t){r||(ky(n.$$.fragment,t),r=!0)},o(t){Sy(n.$$.fragment,t),r=!1},d(t){t&&Rp(e),Ly(n,t)}}}function dC(t){let e,n,r,o;return{c(){e=Gp("Your\n        "),n=Hp("strong"),n.innerHTML="<purple>vibe</purple>",r=Gp("\n      is primed and loaded.\n      "),o=Hp("sup"),o.textContent="Pow pow! 〰️🔫",Zp(n,"data-tooltip","Initiate a conversation, cooldown 5min"),Zp(n,"data-placement","right")},m(t,i){Kp(t,e,i),Kp(t,n,i),Kp(t,r,i),Kp(t,o,i)},p:wp,i:wp,o:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),t&&Rp(o)}}}function gC(t){let e,n,r;return{c(){e=Gp("Press the "),n=Hp("strong"),n.textContent="START",r=Gp(" button to play.")},m(t,o){Kp(t,e,o),Kp(t,n,o),Kp(t,r,o)},p:wp,i:wp,o:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r)}}}function AC(t){let e,n,r,o=t[31].tagline+"";return{c(){e=Hp("div"),n=Hp("p"),r=Gp(o),Zp(n,"class","nogap"),Zp(e,"class","flex row space-between pad")},m(t,o){Kp(t,e,o),Yp(e,n),Yp(n,r)},p(t,e){16&e[0]&&o!==(o=t[31].tagline+"")&&ey(r,o)},d(t){t&&Rp(e)}}}function pC(t){let e,n,r,o,i,s;function a(){return t[18](t[31])}return n=new Zw({props:{peer:t[31],$$slots:{default:[AC]},$$scope:{ctx:t}}}),{c(){e=Hp("div"),Dy(n.$$.fragment),r=qp()},m(t,c){Kp(t,e,c),$y(n,e,null),Yp(e,r),o=!0,i||(s=Jp(e,"click",a),i=!0)},p(e,r){t=e;const o={};16&r[0]&&(o.peer=t[31]),16&r[0]|8&r[1]&&(o.$$scope={dirty:r,ctx:t}),n.$set(o)},i(t){o||(ky(n.$$.fragment,t),o=!0)},o(t){Sy(n.$$.fragment,t),o=!1},d(t){t&&Rp(e),Ly(n),i=!1,s()}}}function yC(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[mC]},$$scope:{ctx:t}}}),e.$on("fade",t[20]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};32&n[0]|8&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function mC(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I;return{c(){e=Hp("article"),n=Hp("h6"),n.textContent="Genders",r=qp(),o=Hp("fieldset"),o.innerHTML='<label for="m"><input type="checkbox" id="m" name="m" role="switch"/>\n            M</label>',i=qp(),s=Hp("fieldset"),s.innerHTML='<label for="f"><input type="checkbox" id="f" name="f" role="switch"/>\n            F</label>',a=qp(),c=Hp("fieldset"),c.innerHTML='<label for="nb"><input type="checkbox" id="nb" name="nb" role="switch"/>\n            NB</label>',u=qp(),l=Hp("h6"),l.textContent="Distance",h=qp(),f=Hp("label"),f.innerHTML='GLOBAL\n          <input type="range" min="0" max="100" value="100" id="distance" name="distance"/>',d=qp(),g=Hp("footer"),A=Hp("b"),A.textContent="reset",p=qp(),y=Hp("b"),y.textContent="filter",Zp(f,"for","distance"),Zp(A,"role","button"),Zp(y,"role","button")},m(b,E){Kp(b,e,E),Yp(e,n),Yp(e,r),Yp(e,o),Yp(e,i),Yp(e,s),Yp(e,a),Yp(e,c),Yp(e,u),Yp(e,l),Yp(e,h),Yp(e,f),Yp(e,d),Yp(e,g),Yp(g,A),Yp(g,p),Yp(g,y),m||(I=Jp(y,"click",t[19]),m=!0)},p:wp,d(t){t&&Rp(e),m=!1,I()}}}function IC(t){let e,n;return e=new km({props:{$$slots:{default:[xC]},$$scope:{ctx:t}}}),e.$on("fade",t[25]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};463&n[0]|8&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function bC(t){let e;return{c(){e=Hp("span"),Zp(e,"slot","nw")},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function EC(t){let e;return{c(){e=Hp("p"),e.innerHTML='You don&#39;t have anything to offer.<br/> \n                  <a href="#/shop">Visit the bar to get items</a>'},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function wC(t){let e,n,r=t[0],o=[];for(let e=0;e<r.length;e+=1)o[e]=CC(lC(t,r,e));return{c(){e=Hp("div"),n=Gp("Delivery: ");for(let t=0;t<o.length;t+=1)o[t].c();Zp(e,"class","text-right")},m(t,r){Kp(t,e,r),Yp(e,n);for(let t=0;t<o.length;t+=1)o[t].m(e,null)},p(t,n){if(1&n[0]){let i;for(r=t[0],i=0;i<r.length;i+=1){const s=lC(t,r,i);o[i]?o[i].p(s,n):(o[i]=CC(s),o[i].c(),o[i].m(e,null))}for(;i<o.length;i+=1)o[i].d(1);o.length=r.length}},d(t){t&&Rp(e),jp(o,t)}}}function CC(t){let e,n=Dd.ITEMS[t[28].id].image+"";return{c(){e=Gp(n)},m(t,n){Kp(t,e,n)},p(t,r){1&r[0]&&n!==(n=Dd.ITEMS[t[28].id].image+"")&&ey(e,n)},d(t){t&&Rp(e)}}}function vC(t){let e;return{c(){e=Hp("div"),e.innerHTML='<sup class="hpad">Press START to play</sup>',Zp(e,"class","text-right")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function BC(t){let e,n,r;return n=new dI({props:{expiresAt:t[3].vibe,format:"mm:ss"}}),{c(){e=Hp("button"),Dy(n.$$.fragment),Zp(e,"class","hgap red"),e.disabled=!0},m(t,o){Kp(t,e,o),$y(n,e,null),r=!0},p(t,e){const r={};8&e[0]&&(r.expiresAt=t[3].vibe),n.$set(r)},i(t){r||(ky(n.$$.fragment,t),r=!0)},o(t){Sy(n.$$.fragment,t),r=!1},d(t){t&&Rp(e),Ly(n)}}}function _C(t){let e,n,r;return{c(){e=Hp("button"),e.textContent="chat",Zp(e,"class","hgap green")},m(o,i){Kp(o,e,i),n||(r=Jp(e,"click",t[24]),n=!0)},p:wp,i:wp,o:wp,d(t){t&&Rp(e),n=!1,r()}}}function kC(t){let e,n,r;return{c(){e=Hp("button"),e.textContent="vibe",Zp(e,"class","hgap purple")},m(o,i){Kp(o,e,i),n||(r=Jp(e,"click",t[23]),n=!0)},p:wp,i:wp,o:wp,d(t){t&&Rp(e),n=!1,r()}}}function SC(t){let e;return{c(){e=Hp("button"),e.textContent="vibe",Zp(e,"class","hgap purple"),e.disabled=!0},m(t,n){Kp(t,e,n)},p:wp,i:wp,o:wp,d(t){t&&Rp(e)}}}function xC(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B,_,k,S,x,Q,M,T,D,$,L,U,O,F,N=t[6].score+"",P=t[6].balance+"",Y=t[6].tagline+"";function K(e){t[21](e)}n=new Zw({props:{peer:t[6],$$slots:{nw:[bC]},$$scope:{ctx:t}}}),A=new dI({props:{expiresAt:t[6].expiresAt,format:"HH:mm:ss"}});let R={items:t[7],$$slots:{default:[EC]},$$scope:{ctx:t}};void 0!==t[1]&&(R.item=t[1]),B=new uC({props:R}),fy.push((()=>Ty(B,"item",K)));let j=t[0].length&&wC(t),H=!t[2].entered&&vC();const V=[SC,kC,_C,BC],G=[];function q(t,e){return t[2].entered?t[2].entered&&!t[3].vibe?1:"match"===t[8]?.state?2:3:0}return $=q(t),L=G[$]=V[$](t),{c(){e=Hp("div"),Dy(n.$$.fragment),r=qp(),o=Hp("article"),i=Hp("div"),s=Hp("h6"),a=Gp("Score "),c=Gp(N),u=Gp("\n              | ¤"),l=Gp(P),h=qp(),f=Hp("h6"),d=Gp("💀 "),g=Hp("code"),Dy(A.$$.fragment),p=qp(),y=Hp("p"),m=Gp(Y),I=qp(),b=Hp("br"),E=qp(),w=Hp("div"),C=Hp("h6"),C.textContent="Attachments",v=qp(),Dy(B.$$.fragment),k=qp(),j&&j.c(),S=qp(),x=Hp("footer"),H&&H.c(),Q=qp(),M=Hp("div"),T=Hp("button"),T.textContent="ok",D=qp(),L.c(),Zp(s,"class","nogap"),Zp(f,"class","nogap"),Zp(i,"class","row space-between xcenter"),Zp(C,"class","nogap"),Zp(w,"class","column end xcenter"),Zp(T,"class","hgap"),Zp(M,"class","row space-between"),Zp(o,"class","nogap")},m(_,L){Kp(_,e,L),$y(n,e,null),Yp(e,r),Yp(e,o),Yp(o,i),Yp(i,s),Yp(s,a),Yp(s,c),Yp(s,u),Yp(s,l),Yp(i,h),Yp(i,f),Yp(f,d),Yp(f,g),$y(A,g,null),Yp(o,p),Yp(o,y),Yp(y,m),Yp(o,I),Yp(o,b),Yp(o,E),Yp(o,w),Yp(w,C),Yp(w,v),$y(B,w,null),Yp(o,k),j&&j.m(o,null),Yp(o,S),Yp(o,x),H&&H.m(x,null),Yp(x,Q),Yp(x,M),Yp(M,T),Yp(M,D),G[$].m(M,null),U=!0,O||(F=Jp(T,"click",t[22]),O=!0)},p(t,e){const r={};64&e[0]&&(r.peer=t[6]),8&e[1]&&(r.$$scope={dirty:e,ctx:t}),n.$set(r),(!U||64&e[0])&&N!==(N=t[6].score+"")&&ey(c,N),(!U||64&e[0])&&P!==(P=t[6].balance+"")&&ey(l,P);const i={};64&e[0]&&(i.expiresAt=t[6].expiresAt),A.$set(i),(!U||64&e[0])&&Y!==(Y=t[6].tagline+"")&&ey(m,Y);const s={};128&e[0]&&(s.items=t[7]),8&e[1]&&(s.$$scope={dirty:e,ctx:t}),!_&&2&e[0]&&(_=!0,s.item=t[1],my((()=>_=!1))),B.$set(s),t[0].length?j?j.p(t,e):(j=wC(t),j.c(),j.m(o,S)):j&&(j.d(1),j=null),t[2].entered?H&&(H.d(1),H=null):H||(H=vC(),H.c(),H.m(x,Q));let a=$;$=q(t),$===a?G[$].p(t,e):(By(),Sy(G[a],1,1,(()=>{G[a]=null})),_y(),L=G[$],L?L.p(t,e):(L=G[$]=V[$](t),L.c()),ky(L,1),L.m(M,null))},i(t){U||(ky(n.$$.fragment,t),ky(A.$$.fragment,t),ky(B.$$.fragment,t),ky(L),U=!0)},o(t){Sy(n.$$.fragment,t),Sy(A.$$.fragment,t),Sy(B.$$.fragment,t),Sy(L),U=!1},d(t){t&&Rp(e),Ly(n),Ly(A),Ly(B),j&&j.d(),H&&H.d(),G[$].d(),O=!1,F()}}}function QC(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C=t[4].length+"";const v=[gC,dC,fC],B=[];function _(t,e){return t[2].entered?t[3].canVibe?1:2:0}a=_(t),c=B[a]=v[a](t);let k=t[4],S=[];for(let e=0;e<k.length;e+=1)S[e]=pC(hC(t,k,e));const x=t=>Sy(S[t],1,1,(()=>{S[t]=null}));let Q=t[5]&&yC(t),M=t[6]&&IC(t);return{c(){e=Hp("pub-view"),n=Hp("h1"),n.textContent="Club Room",r=qp(),o=Hp("p"),o.innerHTML="This is the common room, see someone interesting?<br/>\n    Shoot!",i=qp(),s=Hp("p"),c.c(),u=qp(),l=Hp("div"),h=Hp("h6"),f=Gp("Patrons "),d=Gp(C),g=qp(),A=Hp("b"),A.textContent="Filter",p=qp(),y=Hp("peers");for(let t=0;t<S.length;t+=1)S[t].c();m=qp(),Q&&Q.c(),I=qp(),M&&M.c(),Zp(n,"class","view-header"),Zp(h,"class","nogap"),Zp(A,"role","button"),Zp(A,"class","outline hpad vgap"),Zp(l,"class","row space-between xcenter"),Zp(y,"class","row wrap center"),ty(e,"class","block container")},m(c,C){Kp(c,e,C),Yp(e,n),Yp(e,r),Yp(e,o),Yp(e,i),Yp(e,s),B[a].m(s,null),Yp(e,u),Yp(e,l),Yp(l,h),Yp(h,f),Yp(h,d),Yp(l,g),Yp(l,A),Yp(e,p),Yp(e,y);for(let t=0;t<S.length;t+=1)S[t].m(y,null);Yp(e,m),Q&&Q.m(e,null),Yp(e,I),M&&M.m(e,null),b=!0,E||(w=Jp(A,"click",t[17]),E=!0)},p(t,n){let r=a;if(a=_(t),a===r?B[a].p(t,n):(By(),Sy(B[r],1,1,(()=>{B[r]=null})),_y(),c=B[a],c?c.p(t,n):(c=B[a]=v[a](t),c.c()),ky(c,1),c.m(s,null)),(!b||16&n[0])&&C!==(C=t[4].length+"")&&ey(d,C),80&n[0]){let e;for(k=t[4],e=0;e<k.length;e+=1){const r=hC(t,k,e);S[e]?(S[e].p(r,n),ky(S[e],1)):(S[e]=pC(r),S[e].c(),ky(S[e],1),S[e].m(y,null))}for(By(),e=k.length;e<S.length;e+=1)x(e);_y()}t[5]?Q?(Q.p(t,n),32&n[0]&&ky(Q,1)):(Q=yC(t),Q.c(),ky(Q,1),Q.m(e,I)):Q&&(By(),Sy(Q,1,1,(()=>{Q=null})),_y()),t[6]?M?(M.p(t,n),64&n[0]&&ky(M,1)):(M=IC(t),M.c(),ky(M,1),M.m(e,null)):M&&(By(),Sy(M,1,1,(()=>{M=null})),_y())},i(t){if(!b){ky(c);for(let t=0;t<k.length;t+=1)ky(S[t]);ky(Q),ky(M),b=!0}},o(t){Sy(c),S=S.filter(Boolean);for(let t=0;t<S.length;t+=1)Sy(S[t]);Sy(Q),Sy(M),b=!1},d(t){t&&Rp(e),B[a].d(),jp(S,t),Q&&Q.d(),M&&M.d(),E=!1,w()}}}function MC(t,e,n){let r,o,i,s,a,c,u,l,h;Dp(t,eI,(t=>n(0,r=t))),Dp(t,gm,(t=>n(2,i=t)));const f=Jy("profile"),d=jy(Vy.$cooldowns());Dp(t,d,(t=>n(3,s=t)));const g=jy(Vy.$peers(),A);var A;Dp(t,g,(t=>n(4,a=t)));const p=Wy(),y=Yy(!1);Dp(t,y,(t=>n(5,c=t)));const m=Yy(!1);Dp(t,m,(t=>n(6,u=t)));const I=Ky([p,m],(([t,e])=>{const n={state:"none"};return e&&t.find((t=>t.peerId?.equals(e.pk)))||n}));Dp(t,I,(t=>n(8,h=t))),i.swarming||pm().catch(console.error.bind(null,"Auto-connect failed"));const b=Yy(null);Dp(t,b,(t=>n(1,o=t)));const E=Ky(f,(t=>{if(!t.inventory)return[];const e=t.inventory.filter((t=>!Dd.ITEMS[t.id].soulbound&&t.qty)).map((t=>t.id));return e}));function w(t){const e=[];for(const t of r)e.push({t:Od.ACTION_NETWORK_PURCHASE,p:{i:t.id,q:t.qty}});o&&e.push({t:Od.ACTION_OFFER,p:{i:o,q:1}}),Vy.sendVibe(t,e).then((()=>Pp(eI,r=[],r))).catch((t=>console.error("Failed sending vibe",t)))}Dp(t,E,(t=>n(7,l=t)));return[r,o,i,s,a,c,u,l,h,d,g,y,m,I,b,E,w,()=>Pp(y,c=!0,c),t=>Pp(m,u=t,u),()=>Pp(y,c=!1,c),()=>Pp(y,c=!1,c),function(t){o=t,b.set(o)},()=>Pp(m,u=!1,u),()=>w(u.pk),()=>L_(`chat/${wf.btok(h.id)}`),()=>Pp(m,u=!1,u)]}class TC extends Fy{constructor(t){super(),Oy(this,t,MC,QC,kp,{},null,[-1,-1])}}function DC(t,e,n){return t>=e*n?{width:e*n,height:e}:{width:t,height:t/n}}function $C(t,e,n,r){return{x:LC(t.x,e.width,n.width,r),y:LC(t.y,e.height,n.height,r)}}function LC(t,e,n,r){const o=e*r/2-n/2;return Math.min(o,Math.max(t,-o))}function UC(t,e){return Math.sqrt(Math.pow(t.y-e.y,2)+Math.pow(t.x-e.x,2))}function OC(t,e,n=!1){const r=n?Math.round(e):e;return Math.min(t,Math.max(0,r))}function FC(t,e){return e}function NC(t,e){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}const{window:PC}=My;function YC(t){let e;return{c(){e=Hp("div"),Zp(e,"class","cropperArea svelte-12kodkg"),ry(e,"width",t[7].width+"px"),ry(e,"height",t[7].height+"px"),Zp(e,"data-testid","cropper"),oy(e,"round","round"===t[3]),oy(e,"grid",t[4])},m(t,n){Kp(t,e,n)},p(t,n){128&n[0]&&ry(e,"width",t[7].width+"px"),128&n[0]&&ry(e,"height",t[7].height+"px"),8&n[0]&&oy(e,"round","round"===t[3]),16&n[0]&&oy(e,"grid",t[4])},d(t){t&&Rp(e)}}}function KC(t){let e,n,r,o,i,s,a=t[7]&&YC(t);return{c(){e=Hp("div"),n=Hp("img"),o=qp(),a&&a.c(),Zp(n,"class","image svelte-12kodkg"),Qp(n.src,r=t[2])||Zp(n,"src",r),Zp(n,"alt",""),ry(n,"transform","translate("+t[1].x+"px, "+t[1].y+"px) scale("+t[0]+")"),Zp(n,"crossorigin",t[5]),Zp(e,"class","container svelte-12kodkg"),Zp(e,"data-testid","container")},m(r,c){Kp(r,e,c),Yp(e,n),t[22](n),Yp(e,o),a&&a.m(e,null),t[23](e),i||(s=[Jp(PC,"resize",t[10]),Jp(n,"load",t[9]),Jp(e,"mousedown",Wp(t[11])),Jp(e,"touchstart",Wp(t[12])),Jp(e,"wheel",Wp(t[13])),Jp(e,"gesturestart",Wp(t[20])),Jp(e,"gesturechange",Wp(t[21]))],i=!0)},p(t,o){4&o[0]&&!Qp(n.src,r=t[2])&&Zp(n,"src",r),3&o[0]&&ry(n,"transform","translate("+t[1].x+"px, "+t[1].y+"px) scale("+t[0]+")"),32&o[0]&&Zp(n,"crossorigin",t[5]),t[7]?a?a.p(t,o):(a=YC(t),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:wp,o:wp,d(n){n&&Rp(e),t[22](null),a&&a.d(),t[23](null),i=!1,Bp(s)}}}function RC(t,e,n){let{image:r}=e,{crop:o={x:0,y:0}}=e,{zoom:i=1}=e,{aspect:s=4/3}=e,{minZoom:a=1}=e,{maxZoom:c=3}=e,{cropSize:u=null}=e,{cropShape:l="rect"}=e,{showGrid:h=!0}=e,{zoomSpeed:f=1}=e,{crossOrigin:d=null}=e,{restrictPosition:g=!0}=e,A=null,p={width:0,height:0,naturalWidth:0,naturalHeight:0},y=null,m=null,I=null,b={x:0,y:0},E={x:0,y:0},w=0,C=null,v=null;const B=uy();var _;cy((()=>{I&&I.complete&&S()})),_=()=>{k()},ay().$$.on_destroy.push(_);const k=()=>{document.removeEventListener("mousemove",T),document.removeEventListener("mouseup",U),document.removeEventListener("touchmove",D),document.removeEventListener("touchend",U)},S=()=>{x(),P()},x=()=>{I&&(p={width:I.width,height:I.height,naturalWidth:I.naturalWidth,naturalHeight:I.naturalHeight},n(7,A=u||DC(I.width,I.height,s))),y&&(m=y.getBoundingClientRect())},Q=t=>({x:Number(t.clientX),y:Number(t.clientY)}),M=t=>({x:Number(t.clientX),y:Number(t.clientY)}),T=t=>L(Q(t)),D=t=>{t.preventDefault(),2===t.touches.length?F(t):1===t.touches.length&&L(M(t.touches[0]))},$=({x:t,y:e})=>{b={x:t,y:e},E={x:o.x,y:o.y}},L=({x:t,y:e})=>{C&&window.cancelAnimationFrame(C),C=window.requestAnimationFrame((()=>{if(void 0===t||void 0===e)return;const r=t-b.x,s=e-b.y,a={x:E.x+r,y:E.y+s};n(1,o=g?$C(a,p,A,i):a)}))},U=()=>{k(),P()},O=t=>{const e=M(t.touches[0]),n=M(t.touches[1]);w=UC(e,n),$(NC(e,n))},F=t=>{const e=M(t.touches[0]),n=M(t.touches[1]),r=NC(e,n);L(r),v&&window.cancelAnimationFrame(v),v=window.requestAnimationFrame((()=>{const t=UC(e,n);N(i*(t/w),r),w=t}))},N=(t,e)=>{const r=(({x:t,y:e})=>{if(!m)throw new Error("The Cropper is not mounted");return{x:m.width/2-(t-m.left),y:m.height/2-(e-m.top)}})(e),s=(({x:t,y:e})=>({x:(t+o.x)/i,y:(e+o.y)/i}))(r);n(0,i=Math.min(c,Math.max(t,a)));const u={x:s.x*i-r.x,y:s.y*i-r.y};n(1,o=g?$C(u,p,A,i):u)},P=()=>{if(!A||0===A.width)return;const t=g?$C(o,p,A,i):o,{croppedAreaPercentages:e,croppedAreaPixels:n}=function(t,e,n,r,o,i=!0){const s=i?OC:FC,a={x:s(100,((e.width-n.width/o)/2-t.x/o)/e.width*100),y:s(100,((e.height-n.height/o)/2-t.y/o)/e.height*100),width:s(100,n.width/e.width*100/o),height:s(100,n.height/e.height*100/o)},c=s(e.naturalWidth,a.width*e.naturalWidth/100,!0),u=s(e.naturalHeight,a.height*e.naturalHeight/100,!0),l=e.naturalWidth>=e.naturalHeight*r?{width:Math.round(u*r),height:u}:{width:c,height:Math.round(c/r)};return{croppedAreaPercentages:a,croppedAreaPixels:{...l,x:s(e.naturalWidth-l.width,a.x*e.naturalWidth/100,!0),y:s(e.naturalHeight-l.height,a.y*e.naturalHeight/100,!0)}}}(t,p,A,u?u.width/u.height:s,i,g);B("cropcomplete",{percent:e,pixels:n})};return t.$$set=t=>{"image"in t&&n(2,r=t.image),"crop"in t&&n(1,o=t.crop),"zoom"in t&&n(0,i=t.zoom),"aspect"in t&&n(14,s=t.aspect),"minZoom"in t&&n(15,a=t.minZoom),"maxZoom"in t&&n(16,c=t.maxZoom),"cropSize"in t&&n(17,u=t.cropSize),"cropShape"in t&&n(3,l=t.cropShape),"showGrid"in t&&n(4,h=t.showGrid),"zoomSpeed"in t&&n(18,f=t.zoomSpeed),"crossOrigin"in t&&n(5,d=t.crossOrigin),"restrictPosition"in t&&n(19,g=t.restrictPosition)},t.$$.update=()=>{147520&t.$$.dirty[0]&&I&&n(7,A=u||DC(I.width,I.height,s)),1&t.$$.dirty[0]&&i&&P()},[i,o,r,l,h,d,I,A,y,S,x,t=>{document.addEventListener("mousemove",T),document.addEventListener("mouseup",U),$(Q(t))},t=>{document.addEventListener("touchmove",D,{passive:!1}),document.addEventListener("touchend",U),2===t.touches.length?O(t):1===t.touches.length&&$(M(t.touches[0]))},t=>{const e=Q(t),n=i-t.deltaY*f/200;N(n,e)},s,a,c,u,f,g,function(e){ly.call(this,t,e)},function(e){ly.call(this,t,e)},function(t){fy[t?"unshift":"push"]((()=>{I=t,n(6,I)}))},function(t){fy[t?"unshift":"push"]((()=>{y=t,n(8,y)}))}]}class jC extends Fy{constructor(t){super(),Oy(this,t,RC,KC,kp,{image:2,crop:1,zoom:0,aspect:14,minZoom:15,maxZoom:16,cropSize:17,cropShape:3,showGrid:4,zoomSpeed:18,crossOrigin:5,restrictPosition:19},null,[-1,-1])}}function HC(t){let e,n,r,o;return{c(){e=Hp("div"),n=Hp("canvas"),r=qp(),o=Hp("img"),Zp(n,"width","300"),Zp(n,"height","300"),Zp(e,"class","row center"),Zp(o,"alt","preview"),Zp(o,"id","preview"),ry(o,"display","none"),Zp(o,"class","svelte-7zl4gf")},m(i,s){Kp(i,e,s),Yp(e,n),t[12](n),Kp(i,r,s),Kp(i,o,s),t[13](o)},p:wp,i:wp,o:wp,d(n){n&&Rp(e),t[12](null),n&&Rp(r),n&&Rp(o),t[13](null)}}}function VC(t){let e,n,r,o,i,s;function a(e){t[10](e)}function c(e){t[11](e)}let u={image:t[6],aspect:1,showGrid:!1};return void 0!==t[4]&&(u.crop=t[4]),void 0!==t[5]&&(u.zoom=t[5]),r=new jC({props:u}),fy.push((()=>Ty(r,"crop",a))),fy.push((()=>Ty(r,"zoom",c))),r.$on("cropcomplete",t[8]),{c(){e=Hp("button"),e.textContent="done",n=qp(),Dy(r.$$.fragment)},m(t,o){Kp(t,e,o),Kp(t,n,o),$y(r,t,o),s=!0},p(t,e){const n={};64&e&&(n.image=t[6]),!o&&16&e&&(o=!0,n.crop=t[4],my((()=>o=!1))),!i&&32&e&&(i=!0,n.zoom=t[5],my((()=>i=!1))),r.$set(n)},i(t){s||(ky(r.$$.fragment,t),s=!0)},o(t){Sy(r.$$.fragment,t),s=!1},d(t){t&&Rp(e),t&&Rp(n),Ly(r,t)}}}function GC(t){let e,n,r,o,i,s,a,c;const u=[VC,HC],l=[];return o=1,i=l[1]=u[1](t),{c(){e=Hp("image-loader"),n=Hp("input"),r=qp(),i.c(),Zp(n,"type","file"),Zp(n,"accept","image/*"),Zp(n,"id","picture"),Zp(n,"name","picture")},m(o,i){Kp(o,e,i),Yp(e,n),Yp(e,r),l[1].m(e,null),s=!0,a||(c=Jp(n,"change",t[9]),a=!0)},p(t,[e]){i.p(t,e)},i(t){s||(ky(i),s=!0)},o(t){Sy(i),s=!1},d(t){t&&Rp(e),l[1].d(),a=!1,c()}}}function qC(t,e,n){let o,i,s=wp,a=()=>(s(),s=Mp(h,(t=>n(15,o=t))),h);t.$$.on_destroy.push((()=>s()));let c,u,l,{output:h}=e;a();const f=Yy();let d;Dp(t,f,(t=>n(6,i=t)));let g={x:0,y:0},A=1;async function p(t){return new Promise((e=>{n(3,l.onload=()=>{if(""===l.src)return;console.info(l.width,l.height);const t=Math.min(l.height,l.width);u.drawImage(l,(l.width-t)/2,(l.height-t)/2,t,t,0,0,300,300),n(3,l.src="",l),e()},l),n(3,l.src=t,l)}))}async function y(t){let e;try{e=URL.createObjectURL(t),await p(e),URL.revokeObjectURL(e);const n=c.toDataURL("image/jpeg",.35),i=function(t){const e=/^data:([^;]+);base64,/,n=t.match(e);if("image/jpeg"!==n[1])throw new Error("CanvasExportedUnexpectedFiletype: "+n[1]);return r.Buffer.from(t.replace(e,""),"base64")}(n);console.info(`DataURL: ${n.length}, Binary: ${i.length}, compression: ${i.length/n.length}`),Pp(h,o=i,o)}catch(t){throw t}}return cy((()=>{u=c.getContext("2d"),u.fillStyle="gray",u.fillRect(0,0,300,300);const t=h?.subscribe((t=>{if(console.info("Redrawing preview due to change",t?.length),t){p(bm(o))}}));return()=>{t&&t()}})),t.$$set=t=>{"output"in t&&a(n(0,h=t.output))},t.$$.update=()=>{if(2&t.$$.dirty&&d){y(d[0]).catch(console.error.bind(null,"Preprocess failed"))}},[h,d,c,l,g,A,i,f,function(t){const{percent:e,pixels:n}=t.detail;console.info("CropComplete",e,n),console.info("Crop",g,"Zoom",A),Pp(h,o=!1,o)},function(){d=this.files,n(1,d)},function(t){g=t,n(4,g)},function(t){A=t,n(5,A)},function(t){fy[t?"unshift":"push"]((()=>{c=t,n(2,c)}))},function(t){fy[t?"unshift":"push"]((()=>{l=t,n(3,l)}))}]}class zC extends Fy{constructor(t){super(),Oy(this,t,qC,GC,kp,{output:0})}}function JC(t){let e,n,r,o=t[2]?.length+"";return{c(){e=Hp("small"),n=Gp(o),r=Gp(" B"),Zp(e,"class","block text-center")},m(t,o){Kp(t,e,o),Yp(e,n),Yp(e,r)},p(t,e){4&e[0]&&o!==(o=t[2]?.length+"")&&ey(n,o)},d(t){t&&Rp(e)}}}function WC(t){let e,n,r,o,i,s,a=t[35].message+"",c=t[35].stack+"";return{c(){e=Hp("danger"),n=Gp("Loading profile failed "),r=Gp(a),o=qp(),i=Hp("pre"),s=Gp(c)},m(t,a){Kp(t,e,a),Yp(e,n),Yp(e,r),Kp(t,o,a),Kp(t,i,a),Yp(i,s)},p(t,e){1&e[0]&&a!==(a=t[35].message+"")&&ey(r,a),1&e[0]&&c!==(c=t[35].stack+"")&&ey(s,c)},d(t){t&&Rp(e),t&&Rp(o),t&&Rp(i)}}}function XC(t){let e,n,r,o,i;return{c(){e=Hp("button"),n=Gp("save"),e.disabled=r=!t[5]},m(r,s){Kp(r,e,s),Yp(e,n),o||(i=Jp(e,"click",t[25]),o=!0)},p(t,n){32&n[0]&&r!==(r=!t[5])&&(e.disabled=r)},d(t){t&&Rp(e),o=!1,i()}}}function ZC(t){let e;return{c(){e=Gp("Loading...")},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function tv(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[nv]},$$scope:{ctx:t}}}),e.$on("fade",t[28]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};130&n[0]|32&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function ev(t){let e,n,r,o,i,s,a,c,u=["F","M","NB"][zy(t[1]).sex]+"",l=zy(t[1]).geohash+"";return{c(){e=Hp("ul"),n=Hp("li"),r=Gp("Gender: "),o=Gp(u),i=qp(),s=Hp("li"),a=Gp("Location: "),c=Gp(l)},m(t,u){Kp(t,e,u),Yp(e,n),Yp(n,r),Yp(n,o),Yp(e,i),Yp(e,s),Yp(s,a),Yp(s,c)},p(t,e){2&e[0]&&u!==(u=["F","M","NB"][zy(t[1]).sex]+"")&&ey(o,u),2&e[0]&&l!==(l=zy(t[1]).geohash+"")&&ey(c,l)},d(t){t&&Rp(e)}}}function nv(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E=t[1]&&ev(t);return a=new Lm({props:{data:t[13],size:6}}),{c(){e=Hp("article"),n=Hp("header"),n.innerHTML="<h5>IDSQR</h5>",r=qp(),o=Hp("div"),E&&E.c(),i=qp(),s=Hp("div"),Dy(a.$$.fragment),c=qp(),u=Hp("p"),u.innerHTML="This is your cryptographic identity.\n            <br/>\n            Let your friends scan your code\n            but keep the backed up image safe.",l=qp(),h=Hp("footer"),f=Hp("div"),d=Hp("b"),d.textContent="purge",g=qp(),A=Hp("b"),A.textContent="backup",p=qp(),y=Hp("b"),y.textContent="close",Zp(s,"class","vpad"),Zp(o,"class","column xcenter"),Zp(d,"role","button"),Zp(A,"role","button"),Zp(y,"role","button"),Zp(f,"class","row space-between")},m(w,C){Kp(w,e,C),Yp(e,n),Yp(e,r),Yp(e,o),E&&E.m(o,null),Yp(o,i),Yp(o,s),$y(a,s,null),Yp(o,c),Yp(o,u),Yp(e,l),Yp(e,h),Yp(h,f),Yp(f,d),Yp(f,g),Yp(f,A),Yp(f,p),Yp(f,y),m=!0,I||(b=[Jp(d,"click",t[26]),Jp(A,"click",wm),Jp(y,"click",t[27])],I=!0)},p(t,e){t[1]?E?E.p(t,e):(E=ev(t),E.c(),E.m(o,i)):E&&(E.d(1),E=null)},i(t){m||(ky(a.$$.fragment,t),m=!0)},o(t){Sy(a.$$.fragment,t),m=!1},d(t){t&&Rp(e),E&&E.d(),Ly(a),I=!1,Bp(b)}}}function rv(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[ov]},$$scope:{ctx:t}}}),e.$on("fade",t[30]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};320&n[0]|32&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function ov(t){let e,n,r,o,i,s,a,c,u,l;return o=new Zw({props:{peer:t[8]}}),{c(){e=Hp("article"),n=Hp("header"),n.innerHTML="<h5>Preview</h5>",r=qp(),Dy(o.$$.fragment),i=qp(),s=Hp("footer"),a=Hp("button"),a.textContent="close"},m(h,f){Kp(h,e,f),Yp(e,n),Yp(e,r),$y(o,e,null),Yp(e,i),Yp(e,s),Yp(s,a),c=!0,u||(l=Jp(a,"click",t[29]),u=!0)},p(t,e){const n={};256&e[0]&&(n.peer=t[8]),o.$set(n)},i(t){c||(ky(o.$$.fragment,t),c=!0)},o(t){Sy(o.$$.fragment,t),c=!1},d(t){t&&Rp(e),Ly(o),u=!1,l()}}}function iv(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B,_,k,S,x,Q,M,T,D;a=new Qm({props:{id:"icon-qr"}}),l=new Qm({props:{id:"icon-info"}}),A=new zC({props:{output:t[11]}});let $=t[2]?.length&&JC(t),L={ctx:t,current:null,token:null,hasCatch:!0,pending:ZC,then:XC,catch:WC,error:35};xy(S=t[0],L);let U=t[7]&&tv(t),O=t[6]&&rv(t);return{c(){e=Hp("profile-view"),n=Hp("div"),r=Hp("h1"),r.textContent="🕶️ Profile",o=qp(),i=Hp("div"),s=Hp("h2"),Dy(a.$$.fragment),c=qp(),u=Hp("h2"),Dy(l.$$.fragment),h=qp(),f=Hp("label"),d=Hp("h5"),d.textContent="picture",g=qp(),Dy(A.$$.fragment),p=qp(),$&&$.c(),y=qp(),m=Hp("label"),I=Hp("h5"),I.textContent="name",b=qp(),E=Hp("input"),w=qp(),C=Hp("label"),v=Hp("h5"),v.textContent="spark",B=qp(),_=Hp("input"),k=qp(),L.block.c(),x=qp(),U&&U.c(),Q=qp(),O&&O.c(),Zp(i,"class","row"),Zp(n,"class","row space-between xstart"),Zp(f,"for","file"),Zp(E,"type","text"),Zp(E,"placeholder","You got a street name?"),Zp(E,"id","name"),Zp(E,"name","name"),Zp(m,"for","name"),Zp(_,"type","text"),Zp(_,"placeholder","what's on your mind?"),Zp(_,"id","tagline"),Zp(_,"name","tagline"),Zp(C,"for","tagline"),ty(e,"class","block container")},m(S,F){Kp(S,e,F),Yp(e,n),Yp(n,r),Yp(n,o),Yp(n,i),Yp(i,s),$y(a,s,null),Yp(i,c),Yp(i,u),$y(l,u,null),Yp(e,h),Yp(e,f),Yp(f,d),Yp(f,g),$y(A,f,null),Yp(f,p),$&&$.m(f,null),Yp(e,y),Yp(e,m),Yp(m,I),Yp(m,b),Yp(m,E),ny(E,t[4]),Yp(e,w),Yp(e,C),Yp(C,v),Yp(C,B),Yp(C,_),ny(_,t[3]),Yp(e,k),L.block.m(e,L.anchor=null),L.mount=()=>e,L.anchor=x,Yp(e,x),U&&U.m(e,null),Yp(e,Q),O&&O.m(e,null),M=!0,T||(D=[Jp(r,"click",t[20]),Jp(s,"click",t[21]),Jp(u,"click",t[22]),Jp(E,"input",t[23]),Jp(_,"input",t[24])],T=!0)},p(n,r){(t=n)[2]?.length?$?$.p(t,r):($=JC(t),$.c(),$.m(f,null)):$&&($.d(1),$=null),16&r[0]&&E.value!==t[4]&&ny(E,t[4]),8&r[0]&&_.value!==t[3]&&ny(_,t[3]),L.ctx=t,1&r[0]&&S!==(S=t[0])&&xy(S,L)||Qy(L,t,r),t[7]?U?(U.p(t,r),128&r[0]&&ky(U,1)):(U=tv(t),U.c(),ky(U,1),U.m(e,Q)):U&&(By(),Sy(U,1,1,(()=>{U=null})),_y()),t[6]?O?(O.p(t,r),64&r[0]&&ky(O,1)):(O=rv(t),O.c(),ky(O,1),O.m(e,null)):O&&(By(),Sy(O,1,1,(()=>{O=null})),_y())},i(t){M||(ky(a.$$.fragment,t),ky(l.$$.fragment,t),ky(A.$$.fragment,t),ky(U),ky(O),M=!0)},o(t){Sy(a.$$.fragment,t),Sy(l.$$.fragment,t),Sy(A.$$.fragment,t),Sy(U),Sy(O),M=!1},d(t){t&&Rp(e),Ly(a),Ly(l),Ly(A),$&&$.d(),L.block.d(),L.token=null,L=null,U&&U.d(),O&&O.d(),T=!1,Bp(D)}}}function sv(t,e,r){let o,i,s,a,c,u,l,h,f,d;const g=Yy();Dp(t,g,(t=>r(4,u=t)));const A=Yy();Dp(t,A,(t=>r(3,c=t)));const p=Yy();Dp(t,p,(t=>r(2,a=t)));const y=Yy();Dp(t,y,(t=>r(31,o=t)));const m=Yy();Dp(t,m,(t=>r(1,s=t)));const I=Yy();Dp(t,I,(t=>r(32,i=t)));const b=Yy(!1);Dp(t,b,(t=>r(7,f=t)));const E=Yy(!0);Dp(t,E,(t=>r(5,l=t)));const w=Jy(!0);Dp(t,w,(t=>r(8,d=t)));const C=Yy(!1);async function v(){await async function(t){await Gy.writeProfile(t),lm(!0),t.picture&&fm(t.picture),n.exports.get(am)&&!n.exports.get(im)&&(await Im(),L_("/pub"))}({name:u,tagline:c,age:99,sex:0,picture:a,geohash:o}),Pp(E,l=!1,l)}Dp(t,C,(t=>r(6,h=t)));let B=async function(){const t=await Gy.readProfile();if(t)return Pp(g,u=t.name,u),Pp(A,c=t.tagline,c),Pp(p,a=t.picture,a),Pp(I,i=await Gy.readIdentity(),i),Pp(m,s=i.slice(32),s),Pp(y,o=t.geohash,o),t}();return[B,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,()=>Pp(C,h=!0,h),()=>Pp(b,f=!0,f),()=>L_("/about"),function(){u=this.value,g.set(u)},function(){c=this.value,A.set(c)},()=>r(0,B=v()),()=>Em(!0),()=>Pp(b,f=!1,f),()=>Pp(b,f=!1,f),()=>Pp(C,h=!1,h),()=>Pp(C,h=!1,h)]}class av extends Fy{constructor(t){super(),Oy(this,t,sv,iv,kp,{},null,[-1,-1])}}const cv="http://localhost:4000";async function uv(t,e,n={}){const r=new window.Headers,o={"Content-Type":"pico/feed",...n?.headers||{}};for(const t in o)r.append(t,o[t]);const i=await fetch(t,{method:"POST",headers:r,body:e.buf.slice(0,e.tail)}),s=await i.json();if(!i.ok)throw s.error||console.error(s),new Error(`[${i.status}] ${s.error}`);return s}async function lv(t,e){const n=await async function(t,e={}){const n=new window.Headers,r={...e?.headers||{}};for(const t in r)n.append(t,r[t]);const o=await fetch(t,{method:"GET",headers:n}),i=o.headers.get("Content-Type");let s;if(/application\/json/.test(i)&&(s=await o.json()),!o.ok)throw new Error(`[${o.status}] ${s?.error||""}`);if(!s?.feed)throw new Error("Feed missing");return lu.from(s.feed)}(cv+"/v0/checkout/redeem/"+t);if(!(await Vy.dispatch(n,!0)).length)throw new Error("Merge Failed");return"Enjoy!"}function hv(t){let e,n,r,o,i,s,a,c,u,l,h,f,d=t[2].time&&function(t){let e,n,r=t[2].time+"";return{c(){e=Gp("| ¤"),n=Gp(r)},m(t,r){Kp(t,e,r),Kp(t,n,r)},p:wp,d(t){t&&Rp(e),t&&Rp(n)}}}(t),g=t[2].mod&&function(t){let e,n,r=t[2].mod+"";return{c(){e=Gp("| "),n=Gp(r)},m(t,r){Kp(t,e,r),Kp(t,n,r)},p:wp,d(t){t&&Rp(e),t&&Rp(n)}}}(t),A=!t[1]&&dv(t);return{c(){e=Hp("h3"),e.textContent=`${t[2].name}`,n=qp(),r=Hp("i"),r.textContent=`${t[2].short}`,o=qp(),i=Hp("emo"),i.textContent=`${t[2].image}`,s=qp(),a=Hp("h6"),c=Hp("small"),c.textContent=`${t[2].type}`,u=qp(),d&&d.c(),l=qp(),g&&g.c(),h=qp(),A&&A.c(),f=zp(),Zp(e,"class","nogap"),Zp(i,"class","svelte-mp8u49")},m(t,p){Kp(t,e,p),Kp(t,n,p),Kp(t,r,p),Kp(t,o,p),Kp(t,i,p),Kp(t,s,p),Kp(t,a,p),Yp(a,c),Yp(a,u),d&&d.m(a,null),Yp(a,l),g&&g.m(a,null),Kp(t,h,p),A&&A.m(t,p),Kp(t,f,p)},p(t,e){t[2].time&&d.p(t,e),t[2].mod&&g.p(t,e),t[1]?A&&(A.d(1),A=null):A?A.p(t,e):(A=dv(t),A.c(),A.m(f.parentNode,f))},d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),t&&Rp(o),t&&Rp(i),t&&Rp(s),t&&Rp(a),d&&d.d(),g&&g.d(),t&&Rp(h),A&&A.d(t),t&&Rp(f)}}}function fv(t){let e,n,r,o,i,s,a,c,u;return{c(){e=Hp("h3"),e.innerHTML="<error>Item Not Found!</error>",n=qp(),r=Hp("emo"),r.textContent="😥",o=qp(),i=Hp("div"),s=Hp("p"),a=Gp("Unknown item ["),c=Gp(t[0]),u=Gp("]"),Zp(e,"class","nogap"),Zp(r,"class","svelte-mp8u49")},m(t,l){Kp(t,e,l),Kp(t,n,l),Kp(t,r,l),Kp(t,o,l),Kp(t,i,l),Yp(i,s),Yp(s,a),Yp(s,c),Yp(s,u)},p(t,e){1&e&&ey(c,t[0])},d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),t&&Rp(o),t&&Rp(i)}}}function dv(t){let e,n;let r=function(t,e){return t[2].desc?gv:Av}(t),o=r(t);return{c(){e=Hp("div"),n=Hp("p"),o.c()},m(t,r){Kp(t,e,r),Yp(e,n),o.m(n,null)},p(t,e){o.p(t,e)},d(t){t&&Rp(e),o.d()}}}function gv(t){let e,n,r=t[2].desc.replace(/\n/g,"<br/>\n")+"";return{c(){e=new iy(!1),n=zp(),e.a=n},m(t,o){e.m(r,t,o),Kp(t,n,o)},p:wp,d(t){t&&Rp(n),t&&e.d()}}}function Av(t){let e;return{c(){e=Hp("error"),e.textContent="The description for this item seems to be missing"},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function pv(t){let e;let n=function(t,e){return t[2]?hv:fv}(t),r=n(t);return{c(){e=Hp("item-description"),r.c(),ty(e,"class","flex column xcenter start")},m(t,n){Kp(t,e,n),r.m(e,null)},p(t,[e]){r.p(t,e)},i:wp,o:wp,d(t){t&&Rp(e),r.d()}}}function yv(t,e,n){let{id:r=-1}=e,{noDescription:o=!1}=e;const i=Dd.ITEMS[r];return t.$$set=t=>{"id"in t&&n(0,r=t.id),"noDescription"in t&&n(1,o=t.noDescription)},[r,o,i]}class mv extends Fy{constructor(t){super(),Oy(this,t,yv,pv,kp,{id:0,noDescription:1})}}function Iv(t,e,n){const r=t.slice();return r[72]=e[n],r}function bv(t,e,n){const r=t.slice();return r[72]=e[n],r}function Ev(t,e,n){const r=t.slice();return r[72]=e[n],r}function wv(t,e,n){const r=t.slice();return r[82]=e[n],r}function Cv(t){let e,n,r,o,i;return{c(){e=Hp("green"),e.innerHTML="<div>Verify your profile to buy drinks</div>",n=qp(),r=Hp("br"),Zp(e,"class","row xcenter center")},m(s,a){Kp(s,e,a),Kp(s,n,a),Kp(s,r,a),o||(i=Jp(e,"click",t[42]),o=!0)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),o=!1,i()}}}function vv(t){let e,n,r,o,i,s=t[82].price+"";function a(){return t[44](t[82])}return{c(){e=Hp("button"),n=Gp("¤ "),r=Gp(s),Zp(e,"class","svelte-1wlnrci")},m(t,s){Kp(t,e,s),Yp(e,n),Yp(e,r),o||(i=Jp(e,"click",Xp(a)),o=!0)},p(e,n){t=e},d(t){t&&Rp(e),o=!1,i()}}}function Bv(t){let e,n,r,o,i,s,a=t[82].price/100+"";function c(){return t[43](t[82])}return{c(){e=Hp("button"),n=Gp("€ "),r=Gp(a),Zp(e,"class","blue svelte-1wlnrci"),e.disabled=o=!t[7]},m(t,o){Kp(t,e,o),Yp(e,n),Yp(e,r),i||(s=Jp(e,"click",Xp(c)),i=!0)},p(n,r){t=n,128&r[0]&&o!==(o=!t[7])&&(e.disabled=o)},d(t){t&&Rp(e),i=!1,s()}}}function _v(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E=t[82].image+"",w=t[82].name+"",C=t[82].time+"",v=t[82].short+"",B=t[82].mod&&function(t){let e,n,r=t[82].mod+"";return{c(){e=Gp("| "),n=Gp(r)},m(t,r){Kp(t,e,r),Kp(t,n,r)},p:wp,d(t){t&&Rp(e),t&&Rp(n)}}}(t);let _=function(t,e){return t[82].irlPrice?Bv:vv}(t),k=_(t);function S(){return t[45](t[82])}return{c(){e=Hp("item"),n=Hp("iimage"),r=Gp(E),o=qp(),i=Hp("description"),s=Hp("h3"),a=Gp(w),c=qp(),u=Hp("h6"),l=Gp("¤ "),h=Gp(C),f=qp(),B&&B.c(),d=qp(),g=Hp("short"),A=Gp(v),p=qp(),y=Hp("buy"),k.c(),m=qp(),Zp(n,"class","svelte-1wlnrci"),Zp(s,"class","svelte-1wlnrci"),Zp(u,"class","svelte-1wlnrci"),Zp(g,"class","svelte-1wlnrci"),Zp(i,"class","column xstart grow2 space-between svelte-1wlnrci"),Zp(y,"class","column center"),Zp(e,"class","drink row xcenter svelte-1wlnrci")},m(t,E){Kp(t,e,E),Yp(e,n),Yp(n,r),Yp(e,o),Yp(e,i),Yp(i,s),Yp(s,a),Yp(i,c),Yp(i,u),Yp(u,l),Yp(u,h),Yp(u,f),B&&B.m(u,null),Yp(i,d),Yp(i,g),Yp(g,A),Yp(e,p),Yp(e,y),k.m(y,null),Yp(e,m),I||(b=Jp(e,"click",S),I=!0)},p(e,n){(t=e)[82].mod&&B.p(t,n),k.p(t,n)},d(t){t&&Rp(e),B&&B.d(),k.d(),I=!1,b()}}}function kv(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w=t[72].image+"",C=t[72].name+"",v=t[72].short+"",B=t[72].price+"",_=t[72].mod&&function(t){let e,n=t[72].mod+"";return{c(){e=Gp(n)},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}(t);function k(){return t[46](t[72])}function S(){return t[47](t[72])}return{c(){e=Hp("item"),n=Hp("iimage"),r=Gp(w),o=qp(),i=Hp("description"),s=Hp("h3"),a=Gp(C),c=qp(),u=Hp("h6"),_&&_.c(),l=qp(),h=Hp("short"),f=Gp(v),d=qp(),g=Hp("buy"),A=Hp("button"),p=Gp("¤ "),y=Gp(B),I=qp(),Zp(n,"class","svelte-1wlnrci"),Zp(s,"class","svelte-1wlnrci"),Zp(u,"class","svelte-1wlnrci"),Zp(h,"class","svelte-1wlnrci"),Zp(i,"class","column xstart grow2 space-between svelte-1wlnrci"),A.disabled=m=t[9]<t[72].price||null,Zp(A,"class","svelte-1wlnrci"),Zp(g,"class","column center"),Zp(e,"class","item row xcenter svelte-1wlnrci")},m(t,m){Kp(t,e,m),Yp(e,n),Yp(n,r),Yp(e,o),Yp(e,i),Yp(i,s),Yp(s,a),Yp(i,c),Yp(i,u),_&&_.m(u,null),Yp(i,l),Yp(i,h),Yp(h,f),Yp(e,d),Yp(e,g),Yp(g,A),Yp(A,p),Yp(A,y),Yp(e,I),b||(E=[Jp(A,"click",Xp(k)),Jp(e,"click",S)],b=!0)},p(e,n){(t=e)[72].mod&&_.p(t,n),512&n[0]&&m!==(m=t[9]<t[72].price||null)&&(A.disabled=m)},d(t){t&&Rp(e),_&&_.d(),b=!1,Bp(E)}}}function Sv(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[$v]},$$scope:{ctx:t}}}),e.$on("fade",t[51]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};248&n[0]|8388608&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function xv(t){let e,n,r,o,i,s,a,c,u,l,h={ctx:t,current:null,token:null,hasCatch:!0,pending:Dv,then:Tv,catch:Mv,value:75,error:76};return xy(c=t[5],h),{c(){e=Hp("label"),n=Hp("div"),n.textContent="Verify your email to buy drinks",r=qp(),o=Hp("input"),s=qp(),a=Hp("div"),h.block.c(),Zp(o,"type","email"),Zp(o,"placeholder","name@host.tld"),o.disabled=i=t[3]?"true":null,Zp(e,"for","email"),Zp(a,"class","row center xcenter")},m(i,c){Kp(i,e,c),Yp(e,n),Yp(e,r),Yp(e,o),ny(o,t[4]),Kp(i,s,c),Kp(i,a,c),h.block.m(a,h.anchor=null),h.mount=()=>a,h.anchor=null,u||(l=[Jp(o,"input",t[48]),Jp(o,"keypress",t[49])],u=!0)},p(e,n){t=e,8&n[0]&&i!==(i=t[3]?"true":null)&&(o.disabled=i),16&n[0]&&o.value!==t[4]&&ny(o,t[4]),h.ctx=t,32&n[0]&&c!==(c=t[5])&&xy(c,h)||Qy(h,t,n)},d(t){t&&Rp(e),t&&Rp(s),t&&Rp(a),h.block.d(),h.token=null,h=null,u=!1,Bp(l)}}}function Qv(t){let e,n,r;return{c(){e=Hp("br"),n=qp(),r=Hp("p"),r.innerHTML="<blue>Your email is verified</blue>",Zp(r,"class","text-center")},m(t,o){Kp(t,e,o),Kp(t,n,o),Kp(t,r,o)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r)}}}function Mv(t){let e,n,r=t[76].message+"";return{c(){e=Hp("error"),n=Gp(r)},m(t,r){Kp(t,e,r),Yp(e,n)},p(t,e){32&e[0]&&r!==(r=t[76].message+"")&&ey(n,r)},d(t){t&&Rp(e)}}}function Tv(t){let e,n,r=t[75]+"";return{c(){e=Hp("p"),n=Gp(r)},m(t,r){Kp(t,e,r),Yp(e,n)},p(t,e){32&e[0]&&r!==(r=t[75]+"")&&ey(n,r)},d(t){t&&Rp(e)}}}function Dv(t){let e;return{c(){e=Hp("p"),e.textContent="Requesting badge",Zp(e,"aria-busy","true")},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function $v(t){let e,n,r,o,i,s,a,c,u,l,h,f,d;function g(t,e){return t[7]?Qv:xv}n=new mv({props:{id:aB,noDescription:!t[7]}});let A=g(t),p=A(t);return{c(){e=Hp("article"),Dy(n.$$.fragment),r=qp(),p.c(),o=qp(),i=Hp("footer"),s=Hp("button"),s.textContent="ok",a=qp(),c=Hp("button"),u=Gp("verify"),Zp(s,"class","hgap"),Zp(c,"class","hgap green"),c.disabled=l=t[3]||t[7]?"true":null,Zp(i,"class","row space-between")},m(l,g){Kp(l,e,g),$y(n,e,null),Yp(e,r),p.m(e,null),Yp(e,o),Yp(e,i),Yp(i,s),Yp(i,a),Yp(i,c),Yp(c,u),h=!0,f||(d=[Jp(s,"click",t[50]),Jp(c,"click",t[24])],f=!0)},p(t,r){const i={};128&r[0]&&(i.noDescription=!t[7]),n.$set(i),A===(A=g(t))&&p?p.p(t,r):(p.d(1),p=A(t),p&&(p.c(),p.m(e,o))),(!h||136&r[0]&&l!==(l=t[3]||t[7]?"true":null))&&(c.disabled=l)},i(t){h||(ky(n.$$.fragment,t),h=!0)},o(t){Sy(n.$$.fragment,t),h=!1},d(t){t&&Rp(e),Ly(n),p.d(),f=!1,Bp(d)}}}function Lv(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[Kv]},$$scope:{ctx:t}}}),e.$on("fade",t[56]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};3078&n[0]|8388608&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function Uv(t){let e;return{c(){e=Hp("h3"),e.textContent="Your cart is empty"},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function Ov(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E=Dd.ITEMS[t[72].id].image+"",w=Dd.ITEMS[t[72].id].name+"",C=Dd.ITEMS[t[72].id].short+"",v=t[72].qty+"";function B(){return t[52](t[72])}function _(){return t[53](t[72])}return{c(){e=Hp("item"),n=Hp("iimage"),r=Gp(E),o=qp(),i=Hp("description"),s=Hp("h3"),a=Gp(w),c=qp(),u=Hp("short"),l=Gp(C),h=qp(),f=Hp("buy"),d=Hp("b"),d.textContent="-",g=qp(),A=Hp("h3"),p=Gp(v),y=qp(),m=Hp("b"),m.textContent="+",Zp(n,"class","svelte-1wlnrci"),Zp(s,"class","svelte-1wlnrci"),Zp(u,"class","svelte-1wlnrci"),Zp(i,"class","column xstart grow2 space-between svelte-1wlnrci"),Zp(d,"role","button"),Zp(d,"class","blue"),Zp(A,"class","nogap nopad hpad svelte-1wlnrci"),Zp(m,"role","button"),Zp(m,"class","blue"),Zp(f,"class","row center xcenter"),Zp(e,"class","item row xcenter svelte-1wlnrci")},m(t,E){Kp(t,e,E),Yp(e,n),Yp(n,r),Yp(e,o),Yp(e,i),Yp(i,s),Yp(s,a),Yp(i,c),Yp(i,u),Yp(u,l),Yp(e,h),Yp(e,f),Yp(f,d),Yp(f,g),Yp(f,A),Yp(A,p),Yp(f,y),Yp(f,m),I||(b=[Jp(d,"click",B),Jp(m,"click",_)],I=!0)},p(e,n){t=e,2&n[0]&&E!==(E=Dd.ITEMS[t[72].id].image+"")&&ey(r,E),2&n[0]&&w!==(w=Dd.ITEMS[t[72].id].name+"")&&ey(a,w),2&n[0]&&C!==(C=Dd.ITEMS[t[72].id].short+"")&&ey(l,C),2&n[0]&&v!==(v=t[72].qty+"")&&ey(p,v)},d(t){t&&Rp(e),I=!1,Bp(b)}}}function Fv(t){let e,n,r=t[76].message+"";return{c(){e=Hp("p"),n=Gp(r),Zp(e,"class","error text-center")},m(t,r){Kp(t,e,r),Yp(e,n)},p(t,e){4&e[0]&&r!==(r=t[76].message+"")&&ey(n,r)},d(t){t&&Rp(e)}}}function Nv(t){let e,n=t[77]?.length&&Pv(t);return{c(){n&&n.c(),e=zp()},m(t,r){n&&n.m(t,r),Kp(t,e,r)},p(t,r){t[77]?.length?n?n.p(t,r):(n=Pv(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&Rp(e)}}}function Pv(t){let e,n,r,o;return{c(){e=Hp("h3"),n=Hp("a"),r=Gp("Proceed to checkout"),Zp(n,"href",o=t[77]),Zp(e,"class","nogap text-center")},m(t,o){Kp(t,e,o),Yp(e,n),Yp(n,r)},p(t,e){4&e[0]&&o!==(o=t[77])&&Zp(n,"href",o)},d(t){t&&Rp(e)}}}function Yv(t){let e;return{c(){e=Hp("h2"),e.textContent="Loading...",Zp(e,"aria-busy","true"),Zp(e,"class","nogap text-center")},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function Kv(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v=(t[11]/100).toFixed(2)+"",B=!t[1].length&&Uv(),_=t[1],k=[];for(let e=0;e<_.length;e+=1)k[e]=Ov(bv(t,_,e));let S={ctx:t,current:null,token:null,hasCatch:!0,pending:Yv,then:Nv,catch:Fv,value:77,error:76};return xy(f=t[2],S),{c(){e=Hp("article"),n=Hp("header"),n.innerHTML="<h5>Cart</h5>",r=qp(),B&&B.c(),o=qp();for(let t=0;t<k.length;t+=1)k[t].c();i=qp(),s=Hp("h3"),a=Gp("Sum € "),c=Gp(v),u=qp(),l=Hp("b"),l.textContent="Add tip",h=qp(),S.block.c(),d=qp(),g=Hp("footer"),A=Hp("button"),A.textContent="hide",p=qp(),y=Hp("div"),y.textContent=" ",m=qp(),I=Hp("button"),b=Gp("checkout"),Zp(s,"class","text-right"),Zp(l,"role","button"),Zp(I,"class","green"),I.disabled=E=!t[1].length,Zp(g,"class","flex row space-between xcenter")},m(f,E){Kp(f,e,E),Yp(e,n),Yp(e,r),B&&B.m(e,null),Yp(e,o);for(let t=0;t<k.length;t+=1)k[t].m(e,null);Yp(e,i),Yp(e,s),Yp(s,a),Yp(s,c),Yp(e,u),Yp(e,l),Yp(e,h),S.block.m(e,S.anchor=null),S.mount=()=>e,S.anchor=d,Yp(e,d),Yp(e,g),Yp(g,A),Yp(g,p),Yp(g,y),Yp(g,m),Yp(g,I),Yp(I,b),w||(C=[Jp(l,"click",t[54]),Jp(A,"click",t[55]),Jp(I,"click",t[32])],w=!0)},p(n,r){if((t=n)[1].length?B&&(B.d(1),B=null):B||(B=Uv(),B.c(),B.m(e,o)),1610612738&r[0]){let n;for(_=t[1],n=0;n<_.length;n+=1){const o=bv(t,_,n);k[n]?k[n].p(o,r):(k[n]=Ov(o),k[n].c(),k[n].m(e,i))}for(;n<k.length;n+=1)k[n].d(1);k.length=_.length}2048&r[0]&&v!==(v=(t[11]/100).toFixed(2)+"")&&ey(c,v),S.ctx=t,4&r[0]&&f!==(f=t[2])&&xy(f,S)||Qy(S,t,r),2&r[0]&&E!==(E=!t[1].length)&&(I.disabled=E)},d(t){t&&Rp(e),B&&B.d(),jp(k,t),S.block.d(),S.token=null,S=null,w=!1,Bp(C)}}}function Rv(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[Jv]},$$scope:{ctx:t}}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};1&n[0]|8388608&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function jv(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p=t[76].message+"",y=window.location+"",m=t[76].message+"",I=t[76].stack+"";return{c(){e=Hp("emo"),e.textContent="😥",n=qp(),r=Hp("error"),o=Gp(p),i=qp(),s=Hp("p"),s.innerHTML="Something went wrong, please contact support\n            tony@decentlabs.se and include error report\n            below in the message<br/>\n            We&#39;re very sorry to be us right now.",a=qp(),c=Hp("pre"),u=Gp(""),l=Gp(y),h=Gp("\n"),f=Gp(m),d=Gp("\n"),g=Gp(I),A=Gp("\n"),Zp(e,"class","svelte-1wlnrci"),Zp(c,"class","error-report vgap svelte-1wlnrci")},m(t,p){Kp(t,e,p),Kp(t,n,p),Kp(t,r,p),Yp(r,o),Kp(t,i,p),Kp(t,s,p),Kp(t,a,p),Kp(t,c,p),Yp(c,u),Yp(c,l),Yp(c,h),Yp(c,f),Yp(c,d),Yp(c,g),Yp(c,A)},p(t,e){1&e[0]&&p!==(p=t[76].message+"")&&ey(o,p),1&e[0]&&m!==(m=t[76].message+"")&&ey(f,m),1&e[0]&&I!==(I=t[76].stack+"")&&ey(g,I)},d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),t&&Rp(i),t&&Rp(s),t&&Rp(a),t&&Rp(c)}}}function Hv(t){let e,n,r,o,i=t[75]+"";return{c(){e=Hp("emo"),e.textContent="🥂",n=qp(),r=Hp("p"),o=Gp(i),Zp(e,"class","svelte-1wlnrci")},m(t,i){Kp(t,e,i),Kp(t,n,i),Kp(t,r,i),Yp(r,o)},p(t,e){1&e[0]&&i!==(i=t[75]+"")&&ey(o,i)},d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r)}}}function Vv(t){let e;return{c(){e=Hp("emo"),e.textContent="📦",Zp(e,"aria-busy","true"),Zp(e,"class","svelte-1wlnrci")},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function Gv(t){let e,n,r;return{c(){e=Hp("button"),e.textContent="Retry",Zp(e,"class","red")},m(o,i){Kp(o,e,i),n||(r=Jp(e,"click",t[37]),n=!0)},p:wp,d(t){t&&Rp(e),n=!1,r()}}}function qv(t){let e,n,r;return{c(){e=Hp("button"),e.textContent="Ok",Zp(e,"class","green")},m(o,i){Kp(o,e,i),n||(r=Jp(e,"click",t[57]),n=!0)},p:wp,d(t){t&&Rp(e),n=!1,r()}}}function zv(t){let e;return{c(){e=Hp("button"),e.textContent="Ok",Zp(e,"class","green"),e.disabled="true"},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function Jv(t){let e,n,r,o,i,s,a,c,u={ctx:t,current:null,token:null,hasCatch:!0,pending:Vv,then:Hv,catch:jv,value:75,error:76};xy(i=t[0],u);let l={ctx:t,current:null,token:null,hasCatch:!0,pending:zv,then:qv,catch:Gv};return xy(c=t[0],l),{c(){e=Hp("article"),n=Hp("header"),n.innerHTML="<h5>Redeeming order</h5>",r=qp(),o=Hp("div"),u.block.c(),s=qp(),a=Hp("footer"),l.block.c(),Zp(o,"class","flex column xcenter"),Zp(a,"class","flex row space-between xcenter")},m(t,i){Kp(t,e,i),Yp(e,n),Yp(e,r),Yp(e,o),u.block.m(o,u.anchor=null),u.mount=()=>o,u.anchor=null,Yp(e,s),Yp(e,a),l.block.m(a,l.anchor=null),l.mount=()=>a,l.anchor=null},p(e,n){t=e,u.ctx=t,1&n[0]&&i!==(i=t[0])&&xy(i,u)||Qy(u,t,n),l.ctx=t,1&n[0]&&c!==(c=t[0])&&xy(c,l)||Qy(l,t,n)},d(t){t&&Rp(e),u.block.d(),u.token=null,u=null,l.block.d(),l.token=null,l=null}}}function Wv(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[tB]},$$scope:{ctx:t}}}),e.$on("fade",t[61]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};896&n[0]|8388608&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function Xv(t){let e,n,r,o,i,s,a=t[8].price+"";return{c(){e=Hp("button"),n=Gp("¤ "),r=Gp(a),Zp(e,"class","hgap red"),e.disabled=o=t[9]<t[8].price||null},m(o,a){Kp(o,e,a),Yp(e,n),Yp(e,r),i||(s=Jp(e,"click",t[60]),i=!0)},p(t,n){256&n[0]&&a!==(a=t[8].price+"")&&ey(r,a),768&n[0]&&o!==(o=t[9]<t[8].price||null)&&(e.disabled=o)},d(t){t&&Rp(e),i=!1,s()}}}function Zv(t){let e,n,r,o,i,s,a=t[8].price/100+"";return{c(){e=Hp("button"),n=Gp("€ "),r=Gp(a),Zp(e,"class","hgap blue"),e.disabled=o=!t[7]},m(o,a){Kp(o,e,a),Yp(e,n),Yp(e,r),i||(s=Jp(e,"click",t[59]),i=!0)},p(t,n){256&n[0]&&a!==(a=t[8].price/100+"")&&ey(r,a),128&n[0]&&o!==(o=!t[7])&&(e.disabled=o)},d(t){t&&Rp(e),i=!1,s()}}}function tB(t){let e,n,r,o,i,s,a,c,u;function l(t,e){return t[8].irlPrice?Zv:!t[8].irlPrice&&t[8].price>-1?Xv:void 0}n=new mv({props:{id:t[8].id}});let h=l(t),f=h&&h(t);return{c(){e=Hp("article"),Dy(n.$$.fragment),r=qp(),o=Hp("footer"),i=Hp("button"),i.textContent="ok",s=qp(),f&&f.c(),Zp(i,"class","hgap"),Zp(o,"class","row space-between")},m(l,h){Kp(l,e,h),$y(n,e,null),Yp(e,r),Yp(e,o),Yp(o,i),Yp(o,s),f&&f.m(o,null),a=!0,c||(u=Jp(i,"click",t[58]),c=!0)},p(t,e){const r={};256&e[0]&&(r.id=t[8].id),n.$set(r),h===(h=l(t))&&f?f.p(t,e):(f&&f.d(1),f=h&&h(t),f&&(f.c(),f.m(o,null)))},i(t){a||(ky(n.$$.fragment,t),a=!0)},o(t){Sy(n.$$.fragment,t),a=!1},d(t){t&&Rp(e),Ly(n),f&&f.d(),c=!1,u()}}}function eB(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[oB]},$$scope:{ctx:t}}}),e.$on("fade",t[66]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};57856&n[0]|8388608&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function nB(t){let e;return{c(){e=Hp("h3"),e.textContent="Your cart is empty"},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function rB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C=Dd.ITEMS[t[72].id].image+"",v=Dd.ITEMS[t[72].id].name+"",B=Dd.ITEMS[t[72].id].short+"",_=t[72].qty+"";function k(){return t[62](t[72])}function S(){return t[63](t[72])}return{c(){e=Hp("item"),n=Hp("iimage"),r=Gp(C),o=qp(),i=Hp("description"),s=Hp("h3"),a=Gp(v),c=qp(),u=Hp("short"),l=Gp(B),h=qp(),f=Hp("buy"),d=Hp("b"),d.textContent="-",g=qp(),A=Hp("h3"),p=Gp(_),y=qp(),m=Hp("b"),I=Gp("+"),Zp(n,"class","svelte-1wlnrci"),Zp(s,"class","svelte-1wlnrci"),Zp(u,"class","svelte-1wlnrci"),Zp(i,"class","column xstart grow2 space-between svelte-1wlnrci"),Zp(d,"role","button"),Zp(d,"class","blue"),Zp(A,"class","nogap nopad hpad svelte-1wlnrci"),Zp(m,"role","button"),Zp(m,"class","blue"),Zp(m,"disabled",b=t[9]-Dd.ITEMS[t[72].id].price<0||null),Zp(f,"class","row center xcenter"),Zp(e,"class","item row xcenter svelte-1wlnrci")},m(t,b){Kp(t,e,b),Yp(e,n),Yp(n,r),Yp(e,o),Yp(e,i),Yp(i,s),Yp(s,a),Yp(i,c),Yp(i,u),Yp(u,l),Yp(e,h),Yp(e,f),Yp(f,d),Yp(f,g),Yp(f,A),Yp(A,p),Yp(f,y),Yp(f,m),Yp(m,I),E||(w=[Jp(d,"click",k),Jp(m,"click",S)],E=!0)},p(e,n){t=e,16384&n[0]&&C!==(C=Dd.ITEMS[t[72].id].image+"")&&ey(r,C),16384&n[0]&&v!==(v=Dd.ITEMS[t[72].id].name+"")&&ey(a,v),16384&n[0]&&B!==(B=Dd.ITEMS[t[72].id].short+"")&&ey(l,B),16384&n[0]&&_!==(_=t[72].qty+"")&&ey(p,_),16896&n[0]&&b!==(b=t[9]-Dd.ITEMS[t[72].id].price<0||null)&&Zp(m,"disabled",b)},d(t){t&&Rp(e),E=!1,Bp(w)}}}function oB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b=!t[14].length&&nB(),E=t[14],w=[];for(let e=0;e<E.length;e+=1)w[e]=rB(Iv(t,E,e));return{c(){e=Hp("article"),n=Hp("header"),n.innerHTML="<h5>Decentral Cart</h5>",r=qp(),b&&b.c(),o=qp();for(let t=0;t<w.length;t+=1)w[t].c();i=qp(),s=Hp("h3"),a=Gp("Sum ¤ "),c=Gp(t[15]),u=qp(),l=Hp("p"),l.textContent="Items will be delivered after next vibe",h=qp(),f=Hp("footer"),d=Hp("button"),d.textContent="ok",g=qp(),A=Hp("div"),A.textContent=" ",p=qp(),y=Hp("button"),y.textContent="socialize",Zp(s,"class","text-right"),Zp(l,"class","text-center"),Zp(y,"class","blue"),Zp(f,"class","flex row space-between xcenter")},m(E,C){Kp(E,e,C),Yp(e,n),Yp(e,r),b&&b.m(e,null),Yp(e,o);for(let t=0;t<w.length;t+=1)w[t].m(e,null);Yp(e,i),Yp(e,s),Yp(s,a),Yp(s,c),Yp(e,u),Yp(e,l),Yp(e,h),Yp(e,f),Yp(f,d),Yp(f,g),Yp(f,A),Yp(f,p),Yp(f,y),m||(I=[Jp(d,"click",t[64]),Jp(y,"click",t[65])],m=!0)},p(t,n){if(t[14].length?b&&(b.d(1),b=null):b||(b=nB(),b.c(),b.m(e,o)),16896&n[0]){let r;for(E=t[14],r=0;r<E.length;r+=1){const o=Iv(t,E,r);w[r]?w[r].p(o,n):(w[r]=rB(o),w[r].c(),w[r].m(e,i))}for(;r<w.length;r+=1)w[r].d(1);w.length=E.length}32768&n[0]&&ey(c,t[15])},d(t){t&&Rp(e),b&&b.d(),jp(w,t),m=!1,Bp(I)}}}function iB(t){let e,n,r,o,i;return{c(){e=Hp("small"),n=Hp("blue"),r=Gp("(¤"),o=Gp(t[15]),i=Gp(")")},m(t,s){Kp(t,e,s),Yp(e,n),Yp(n,r),Yp(n,o),Yp(n,i)},p(t,e){32768&e[0]&&ey(o,t[15])},d(t){t&&Rp(e)}}}function sB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B,_,k,S,x,Q,M,T,D,$,L,U,O,F,N,P,Y,K,R,j,H,V,G,q,z,J=!t[7]&&Cv(t),W=Dd.GROUPS.drinks,X=[];for(let e=0;e<W.length;e+=1)X[e]=_v(wv(t,W,e));let Z=Dd.GROUPS.gear,tt=[];for(let e=0;e<Z.length;e+=1)tt[e]=kv(Ev(t,Z,e));let et=t[6]&&Sv(t),nt=t[10]&&Lv(t),rt=t[12]&&Rv(t),ot=t[8]&&Wv(t),it=t[13]&&eB(t),st=t[16]&&iB(t);return{c(){e=Hp("shop-view"),n=Hp("splash"),n.innerHTML='<img src="/gfx/shop.jpg" alt="The Bar"/>',r=qp(),o=Hp("section"),i=Hp("h1"),i.textContent="Bar",s=qp(),a=Hp("drinks"),c=Hp("item"),u=Hp("iimage"),u.textContent=`${t[19].image}`,l=qp(),h=Hp("description"),f=Hp("h3"),f.textContent=`${t[19].name}`,d=qp(),g=Hp("h6"),g.textContent=`¤ ${t[19].time} | ONE TIME`,A=qp(),p=Hp("short"),p.textContent=`${t[19].short}`,y=qp(),m=Hp("buy"),I=Hp("button"),b=Gp("free"),E=qp(),w=Hp("h2"),w.textContent="Drinks",C=qp(),J&&J.c(),v=qp();for(let t=0;t<X.length;t+=1)X[t].c();B=qp(),_=Hp("h2"),_.textContent="Gear",k=qp(),S=Hp("gear");for(let t=0;t<tt.length;t+=1)tt[t].c();x=qp(),et&&et.c(),Q=qp(),nt&&nt.c(),M=qp(),rt&&rt.c(),T=qp(),ot&&ot.c(),D=qp(),it&&it.c(),$=qp(),L=Hp("bar"),U=Hp("div"),O=Hp("button"),O.textContent="back",F=qp(),N=Hp("h3"),P=Gp("¤"),Y=Gp(t[9]),K=qp(),st&&st.c(),R=qp(),j=Hp("h3"),H=Gp("🛒 "),V=Gp(t[17]),Zp(n,"class","column xcenter svelte-1wlnrci"),Zp(i,"class","text-center"),Zp(u,"class","svelte-1wlnrci"),Zp(f,"class","svelte-1wlnrci"),Zp(g,"class","svelte-1wlnrci"),Zp(p,"class","svelte-1wlnrci"),Zp(h,"class","column xstart grow2 space-between svelte-1wlnrci"),I.disabled=t[7],Zp(I,"class","green svelte-1wlnrci"),Zp(m,"class","column center"),Zp(c,"class","drink row xcenter svelte-1wlnrci"),Zp(w,"class","text-center nogap"),Zp(a,"class","svelte-1wlnrci"),Zp(_,"class","text-center nogap"),Zp(S,"class","svelte-1wlnrci"),Zp(o,"class","block container"),Zp(O,"class","nogap"),Zp(N,"class","stat nopad nogap"),Zp(j,"class","nopad nogap"),Zp(L,"class","flex row space-between xcenter svelte-1wlnrci"),ty(e,"data-theme","dark")},m(W,Z){Kp(W,e,Z),Yp(e,n),Yp(e,r),Yp(e,o),Yp(o,i),Yp(o,s),Yp(o,a),Yp(a,c),Yp(c,u),Yp(c,l),Yp(c,h),Yp(h,f),Yp(h,d),Yp(h,g),Yp(h,A),Yp(h,p),Yp(c,y),Yp(c,m),Yp(m,I),Yp(I,b),Yp(a,E),Yp(a,w),Yp(a,C),J&&J.m(a,null),Yp(a,v);for(let t=0;t<X.length;t+=1)X[t].m(a,null);Yp(o,B),Yp(o,_),Yp(o,k),Yp(o,S);for(let t=0;t<tt.length;t+=1)tt[t].m(S,null);Yp(e,x),et&&et.m(e,null),Yp(e,Q),nt&&nt.m(e,null),Yp(e,M),rt&&rt.m(e,null),Yp(e,T),ot&&ot.m(e,null),Yp(e,D),it&&it.m(e,null),Yp(e,$),Yp(e,L),Yp(L,U),Yp(U,O),Yp(L,F),Yp(L,N),Yp(N,P),Yp(N,Y),Yp(N,K),st&&st.m(N,null),Yp(L,R),Yp(L,j),Yp(j,H),Yp(j,V),G=!0,q||(z=[Jp(I,"click",Xp(t[40])),Jp(c,"click",t[41]),Jp(O,"click",t[67]),Jp(N,"click",t[68]),Jp(j,"click",t[69])],q=!0)},p(t,n){if((!G||128&n[0])&&(I.disabled=t[7]),t[7]?J&&(J.d(1),J=null):J?J.p(t,n):(J=Cv(t),J.c(),J.m(a,v)),536871296&n[0]){let e;for(W=Dd.GROUPS.drinks,e=0;e<W.length;e+=1){const r=wv(t,W,e);X[e]?X[e].p(r,n):(X[e]=_v(r),X[e].c(),X[e].m(a,null))}for(;e<X.length;e+=1)X[e].d(1);X.length=W.length}if(768&n[0]){let e;for(Z=Dd.GROUPS.gear,e=0;e<Z.length;e+=1){const r=Ev(t,Z,e);tt[e]?tt[e].p(r,n):(tt[e]=kv(r),tt[e].c(),tt[e].m(S,null))}for(;e<tt.length;e+=1)tt[e].d(1);tt.length=Z.length}t[6]?et?(et.p(t,n),64&n[0]&&ky(et,1)):(et=Sv(t),et.c(),ky(et,1),et.m(e,Q)):et&&(By(),Sy(et,1,1,(()=>{et=null})),_y()),t[10]?nt?(nt.p(t,n),1024&n[0]&&ky(nt,1)):(nt=Lv(t),nt.c(),ky(nt,1),nt.m(e,M)):nt&&(By(),Sy(nt,1,1,(()=>{nt=null})),_y()),t[12]?rt?(rt.p(t,n),4096&n[0]&&ky(rt,1)):(rt=Rv(t),rt.c(),ky(rt,1),rt.m(e,T)):rt&&(By(),Sy(rt,1,1,(()=>{rt=null})),_y()),t[8]?ot?(ot.p(t,n),256&n[0]&&ky(ot,1)):(ot=Wv(t),ot.c(),ky(ot,1),ot.m(e,D)):ot&&(By(),Sy(ot,1,1,(()=>{ot=null})),_y()),t[13]?it?(it.p(t,n),8192&n[0]&&ky(it,1)):(it=eB(t),it.c(),ky(it,1),it.m(e,$)):it&&(By(),Sy(it,1,1,(()=>{it=null})),_y()),(!G||512&n[0])&&ey(Y,t[9]),t[16]?st?st.p(t,n):(st=iB(t),st.c(),st.m(N,null)):st&&(st.d(1),st=null),(!G||131072&n[0])&&ey(V,t[17])},i(t){G||(ky(et),ky(nt),ky(rt),ky(ot),ky(it),G=!0)},o(t){Sy(et),Sy(nt),Sy(rt),Sy(ot),Sy(it),G=!1},d(t){t&&Rp(e),J&&J.d(),jp(X,t),jp(tt,t),et&&et.d(),nt&&nt.d(),rt&&rt.d(),ot&&ot.d(),it&&it.d(),st&&st.d(),q=!1,Bp(z)}}}const aB=53249;function cB(t,e,r){let o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E;Dp(t,eI,(t=>r(14,m=t))),Dp(t,nI,(t=>r(15,I=t))),Dp(t,rI,(t=>r(16,b=t)));let{q:w={}}=e;const C=Jy(),v=Ky(C,(t=>t?.hasBadge));Dp(t,v,(t=>r(7,h=t)));const B=Dd.ITEMS[aB],_=Yy(!1);Dp(t,_,(t=>r(8,f=t)));const k=Yy(!1);Dp(t,k,(t=>r(6,l=t)));const S=Yy("");Dp(t,S,(t=>r(4,c=t)));const x=Yy(!1);function Q(){Pp(x,a=!0,a),Pp(M,u=async function(t){const e=await Vy.feed();return e.append(Vy.constructor.encodeBlock("badge-plz",await Vy.seq(),{email:t}),Vy._secret),(await uv(cv+"/v0/verify",e)).message}(c).catch((t=>{throw Pp(x,a=!1,a),console.error(t),t})),u)}Dp(t,x,(t=>r(3,a=t)));let M=Yy(Promise.resolve(""));Dp(t,M,(t=>r(5,u=t)));const T=Yy([]);Dp(t,T,(t=>r(1,i=t)));const D=Ky(T,(t=>t.reduce(((t,e)=>t+Dd.ITEMS[e.id].price*e.qty),0)));Dp(t,D,(t=>r(11,A=t)));const $=Ky(T,(t=>t.reduce(((t,e)=>t+e.qty),0)));function L(t){const e=i.find((e=>e.id===t))?.qty||0;O(t,e+1)}function U(t){const e=i.find((e=>e.id===t))?.qty||0;O(t,e-1)}function O(t,e=0){let n=i.find((e=>e.id===t));n||(n={id:t,qty:0},i.push(n)),n.qty=Math.max(e,0),T.set(i)}Dp(t,$,(t=>r(17,E=t)));const F=Yy(Promise.resolve());Dp(t,F,(t=>r(2,s=t)));const N=Yy(!1);Dp(t,N,(t=>r(10,g=t)));const P=Yy(!1);Dp(t,P,(t=>r(13,y=t)));const Y=Yy(w.redeem);Dp(t,Y,(t=>r(12,p=t)));const K=Yy(Promise.resolve());function R(){w.redeem;const t=w.session;Pp(K,o=lv(t),o)}Dp(t,K,(t=>r(0,o=t))),w.redeem&&R();const j=Ky([nI,C],(([t,e])=>e.balance-t));Dp(t,j,(t=>r(9,d=t)));return t.$$set=t=>{"q"in t&&r(39,w=t.q)},[o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,v,B,_,k,S,x,Q,M,T,D,$,L,U,F,function(){Pp(F,s=async function(t){if(console.log("checkout cart",t),"active"!==(await n.exports.until(Vy.$profile(),(t=>"loading"!==t.state))).state)throw new Error("Feed busy");const e=await Vy.feed(),r=await Vy.seq()+1;t=t.map((t=>53504!==t.id?{id:t.id,q:t.qty}:{id:t.id,q:1,a:100*t.qty})),e.append(Vy.constructor.encodeBlock("cart",r,{items:t}),Vy._secret);const o=await uv(cv+"/v0/checkout",e);return window.location=o.url,o.url}(i),s)},N,P,Y,K,R,j,w,()=>Pp(k,l=!0,l),()=>Pp(k,l=!0,l),()=>Pp(k,l=!0,l),t=>L(t.id),t=>oI(t.id),t=>Pp(_,f=t,f),t=>oI(t.id),t=>Pp(_,f=t,f),function(){c=this.value,S.set(c)},t=>13===t.charCode&&Q(),()=>Pp(k,l=!1,l),()=>Pp(k,l=!1,l),t=>U(t.id),t=>L(t.id),()=>L(53504),()=>Pp(N,g=!1,g),()=>Pp(N,g=!1,g),()=>L_("/wallet"),()=>Pp(_,f=!1,f),()=>{L(f.id),Pp(_,f=!1,f)},()=>{oI(f.id),Pp(_,f=!1,f)},()=>Pp(_,f=!1,f),t=>iI(t.id),t=>oI(t.id),()=>Pp(P,y=!1,y),()=>L_("/"),()=>Pp(P,y=!1,y),()=>L_("/"),()=>Pp(P,y=!y,y),()=>Pp(N,g=!g,g)]}class uB extends Fy{constructor(t){super(),Oy(this,t,cB,sB,kp,{q:39},null,[-1,-1,-1])}}function lB(t){let e,n,r,o,i,s,a,c;return a=new jw({props:{src:t[0].peer.picture}}),{c(){e=Hp("vibe"),n=Vp("mask"),r=Vp("tint"),i=qp(),s=Hp("portrait"),Dy(a.$$.fragment),Zp(r,"style",o=`width: ${100*t[1]}px;`),Zp(r,"class","svelte-ns996z"),Zp(n,"class","svelte-ns996z"),Zp(s,"class","svelte-ns996z"),Zp(e,"class","svelte-ns996z")},m(t,o){Kp(t,e,o),Yp(e,n),Yp(n,r),Yp(e,i),Yp(e,s),$y(a,s,null),c=!0},p(t,[e]){(!c||2&e&&o!==(o=`width: ${100*t[1]}px;`))&&Zp(r,"style",o);const n={};1&e&&(n.src=t[0].peer.picture),a.$set(n)},i(t){c||(ky(a.$$.fragment,t),c=!0)},o(t){Sy(a.$$.fragment,t),c=!1},d(t){t&&Rp(e),Ly(a)}}}function hB(t,e,n){let r,{vibe:o}=e;const i=o.expiresAt-o.createdAt,s=Py(1,(t=>{const e=setInterval((()=>{const n=o.expiresAt-Date.now();n<=0?(t(0),clearInterval(e)):t(n/i)}),1e3);return()=>clearInterval(e)}));return Dp(t,s,(t=>n(1,r=t))),t.$$set=t=>{"vibe"in t&&n(0,o=t.vibe)},[o,r,s]}class fB extends Fy{constructor(t){super(),Oy(this,t,hB,lB,kp,{vibe:0})}}function dB(t,e,n){const r=t.slice();return r[13]=e[n],r}function gB(t,e,n){const r=t.slice();return r[16]=e[n],r}function AB(t,e,n){const r=t.slice();return r[19]=e[n],r}function pB(t){let e,n,r,o,i,s;function a(){return t[7](t[19])}return n=new fB({props:{vibe:t[19]}}),{c(){e=Hp("div"),Dy(n.$$.fragment),r=qp()},m(t,c){Kp(t,e,c),$y(n,e,null),Yp(e,r),o=!0,i||(s=Jp(e,"click",a),i=!0)},p(e,r){t=e;const o={};2&r&&(o.vibe=t[19]),n.$set(o)},i(t){o||(ky(n.$$.fragment,t),o=!0)},o(t){Sy(n.$$.fragment,t),o=!1},d(t){t&&Rp(e),Ly(n),i=!1,s()}}}function yB(t){let e,n,r="match"!==t[19].state&&pB(t);return{c(){r&&r.c(),e=zp()},m(t,o){r&&r.m(t,o),Kp(t,e,o),n=!0},p(t,n){"match"!==t[19].state?r?(r.p(t,n),2&n&&ky(r,1)):(r=pB(t),r.c(),ky(r,1),r.m(e.parentNode,e)):r&&(By(),Sy(r,1,1,(()=>{r=null})),_y())},i(t){n||(ky(r),n=!0)},o(t){Sy(r),n=!1},d(t){r&&r.d(t),t&&Rp(e)}}}function mB(t){let e,n;return e=new Qm({props:{id:"heal_resp",tag:"empty"}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function IB(t){let e,n;return e=new Qm({props:{id:"heal_resp",tag:"full"}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function bB(t){let e,n,r,o;const i=[IB,mB],s=[];function a(t,e){return t[16]<t[13].health?0:1}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=zp()},m(t,n){s[e].m(t,n),Kp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e!==c&&(By(),Sy(s[c],1,1,(()=>{s[c]=null})),_y(),n=s[e],n||(n=s[e]=i[e](t),n.c()),ky(n,1),n.m(r.parentNode,r))},i(t){o||(ky(n),o=!0)},o(t){Sy(n),o=!1},d(t){s[e].d(t),t&&Rp(r)}}}function EB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E=t[13].peer.name+"",w=t[13].myTurn?"your turn":"waiting";r=new jw({props:{src:t[13].peer.picture,size:"80px"}});let C=[0,1,2],v=[];for(let e=0;e<3;e+=1)v[e]=bB(gB(t,C,e));const B=t=>Sy(v[t],1,1,(()=>{v[t]=null}));function _(){return t[8](t[13])}return p=new dI({props:{expiresAt:t[13].expiresAt,format:"mm:ss"}}),{c(){e=Hp("div"),n=Hp("div"),Dy(r.$$.fragment),o=qp(),i=Hp("div"),s=Hp("h3"),a=Gp(E),c=qp(),u=Hp("h6"),l=Gp(w),h=qp(),f=Hp("div"),d=Hp("health");for(let t=0;t<3;t+=1)v[t].c();g=qp(),A=Hp("h3"),Dy(p.$$.fragment),y=qp(),Zp(s,"class","no-margin"),Zp(u,"class","no-margin"),Zp(i,"class","columns space-between gap"),Zp(n,"class","row xcenter"),Zp(A,"class","no-margin"),Zp(f,"class","columns xcenter gap"),Zp(e,"class","row space-between")},m(t,E){Kp(t,e,E),Yp(e,n),$y(r,n,null),Yp(n,o),Yp(n,i),Yp(i,s),Yp(s,a),Yp(i,c),Yp(i,u),Yp(u,l),Yp(e,h),Yp(e,f),Yp(f,d);for(let t=0;t<3;t+=1)v[t].m(d,null);Yp(f,g),Yp(f,A),$y(p,A,null),Yp(e,y),m=!0,I||(b=Jp(e,"click",_),I=!0)},p(e,n){t=e;const o={};if(4&n&&(o.src=t[13].peer.picture),r.$set(o),(!m||4&n)&&E!==(E=t[13].peer.name+"")&&ey(a,E),(!m||4&n)&&w!==(w=t[13].myTurn?"your turn":"waiting")&&ey(l,w),4&n){let e;for(C=[0,1,2],e=0;e<3;e+=1){const r=gB(t,C,e);v[e]?(v[e].p(r,n),ky(v[e],1)):(v[e]=bB(r),v[e].c(),ky(v[e],1),v[e].m(d,null))}for(By(),e=3;e<3;e+=1)B(e);_y()}const i={};4&n&&(i.expiresAt=t[13].expiresAt),p.$set(i)},i(t){if(!m){ky(r.$$.fragment,t);for(let t=0;t<3;t+=1)ky(v[t]);ky(p.$$.fragment,t),m=!0}},o(t){Sy(r.$$.fragment,t),v=v.filter(Boolean);for(let t=0;t<3;t+=1)Sy(v[t]);Sy(p.$$.fragment,t),m=!1},d(t){t&&Rp(e),Ly(r),jp(v,t),Ly(p),I=!1,b()}}}function wB(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[BB]},$$scope:{ctx:t}}}),e.$on("fade",t[12]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};4194305&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function CB(t){let e,n,r,o,i;return{c(){e=Hp("button"),e.textContent="hide",n=qp(),r=Hp("div"),r.textContent="Waiting for player2",Zp(e,"class","hgap"),Zp(r,"class","text-center")},m(s,a){Kp(s,e,a),Kp(s,n,a),Kp(s,r,a),o||(i=Jp(e,"click",t[11]),o=!0)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),o=!1,i()}}}function vB(t){let e,n,r,o,i;return{c(){e=Hp("button"),e.textContent="reject",n=qp(),r=Hp("button"),r.textContent="accept",Zp(e,"class","hgap reject svelte-wwtn89"),Zp(r,"class","hgap accept svelte-wwtn89")},m(s,a){Kp(s,e,a),Kp(s,n,a),Kp(s,r,a),o||(i=[Jp(e,"click",t[9]),Jp(r,"click",t[10])],o=!0)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),o=!1,Bp(i)}}}function BB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p=t[0].peer.tagline+"";function y(t,e){return t[0].initiator?CB:vB}n=new jw({props:{src:t[0]?.peer.picture}}),f=new dI({props:{expiresAt:t[0].expiresAt,format:"mm:ss"}});let m=y(t),I=m(t);return{c(){e=Hp("article"),Dy(n.$$.fragment),r=qp(),o=Hp("p"),i=Gp(p),s=qp(),a=Hp("p"),a.textContent="TODO: transaction details",c=qp(),u=Hp("h6"),u.textContent="Vibe Expires in",l=qp(),h=Hp("h2"),Dy(f.$$.fragment),d=qp(),g=Hp("footer"),I.c(),Zp(u,"class","text-center no-margin"),Zp(h,"class","text-center timer svelte-wwtn89"),Zp(g,"class","row space-between")},m(t,p){Kp(t,e,p),$y(n,e,null),Yp(e,r),Yp(e,o),Yp(o,i),Yp(e,s),Yp(e,a),Yp(e,c),Yp(e,u),Yp(e,l),Yp(e,h),$y(f,h,null),Yp(e,d),Yp(e,g),I.m(g,null),A=!0},p(t,e){const r={};1&e&&(r.src=t[0]?.peer.picture),n.$set(r),(!A||1&e)&&p!==(p=t[0].peer.tagline+"")&&ey(i,p);const o={};1&e&&(o.expiresAt=t[0].expiresAt),f.$set(o),m===(m=y(t))&&I?I.p(t,e):(I.d(1),I=m(t),I&&(I.c(),I.m(g,null)))},i(t){A||(ky(n.$$.fragment,t),ky(f.$$.fragment,t),A=!0)},o(t){Sy(n.$$.fragment,t),Sy(f.$$.fragment,t),A=!1},d(t){t&&Rp(e),Ly(n),Ly(f),I.d()}}}function _B(t){let e,n,r,o,i,s,a,c,u,l,h,f,d=t[1],g=[];for(let e=0;e<d.length;e+=1)g[e]=yB(AB(t,d,e));const A=t=>Sy(g[t],1,1,(()=>{g[t]=null}));let p=t[2],y=[];for(let e=0;e<p.length;e+=1)y[e]=EB(dB(t,p,e));const m=t=>Sy(y[t],1,1,(()=>{y[t]=null}));let I=t[0]&&wB(t);return{c(){e=Hp("messages-view"),n=Hp("h1"),n.textContent="💌 Messages",r=qp(),o=Hp("h5"),o.textContent="Vibes",i=qp(),s=Hp("vibes");for(let t=0;t<g.length;t+=1)g[t].c();a=qp(),c=Hp("h5"),c.textContent="Conversations",u=qp(),l=Hp("conversations");for(let t=0;t<y.length;t+=1)y[t].c();h=qp(),I&&I.c(),Zp(s,"class","row xcenter"),ty(e,"class","block container")},m(t,d){Kp(t,e,d),Yp(e,n),Yp(e,r),Yp(e,o),Yp(e,i),Yp(e,s);for(let t=0;t<g.length;t+=1)g[t].m(s,null);Yp(e,a),Yp(e,c),Yp(e,u),Yp(e,l);for(let t=0;t<y.length;t+=1)y[t].m(l,null);Yp(e,h),I&&I.m(e,null),f=!0},p(t,[n]){if(3&n){let e;for(d=t[1],e=0;e<d.length;e+=1){const r=AB(t,d,e);g[e]?(g[e].p(r,n),ky(g[e],1)):(g[e]=yB(r),g[e].c(),ky(g[e],1),g[e].m(s,null))}for(By(),e=d.length;e<g.length;e+=1)A(e);_y()}if(4&n){let e;for(p=t[2],e=0;e<p.length;e+=1){const r=dB(t,p,e);y[e]?(y[e].p(r,n),ky(y[e],1)):(y[e]=EB(r),y[e].c(),ky(y[e],1),y[e].m(l,null))}for(By(),e=p.length;e<y.length;e+=1)m(e);_y()}t[0]?I?(I.p(t,n),1&n&&ky(I,1)):(I=wB(t),I.c(),ky(I,1),I.m(e,null)):I&&(By(),Sy(I,1,1,(()=>{I=null})),_y())},i(t){if(!f){for(let t=0;t<d.length;t+=1)ky(g[t]);for(let t=0;t<p.length;t+=1)ky(y[t]);ky(I),f=!0}},o(t){g=g.filter(Boolean);for(let t=0;t<g.length;t+=1)Sy(g[t]);y=y.filter(Boolean);for(let t=0;t<y.length;t+=1)Sy(y[t]);Sy(I),f=!1},d(t){t&&Rp(e),jp(g,t),jp(y,t),I&&I.d()}}}function kB(t,e,n){let r,o,i;const s=jy(Vy.$chats());Dp(t,s,(t=>n(2,i=t)));const a=Wy();Dp(t,a,(t=>n(1,o=t)));const c=Yy(null);function u(t,e){Vy.respondVibe(t,e).then((()=>{Pp(c,r=null,r)})).catch((t=>console.error("Vibe response failed",t)))}Dp(t,c,(t=>n(0,r=t)));return[r,o,i,s,a,c,u,t=>Pp(c,r=t,r),t=>L_("/chat/"+t.id.toString("hex")),()=>u(r.id,!0),()=>u(r.id),()=>Pp(c,r=null,r),()=>Pp(c,r=null,r)]}class SB extends Fy{constructor(t){super(),Oy(this,t,kB,_B,kp,{})}}function xB(t,e,n){const r=t.slice();return r[25]=e[n],r}function QB(t,e,n){const r=t.slice();return r[28]=e[n],r}function MB(t){let e;return{c(){e=Hp("placeholder"),e.textContent=" ",Zp(e,"aria-busy","true")},m(t,n){Kp(t,e,n)},p:wp,i:wp,o:wp,d(t){t&&Rp(e)}}}function TB(t){let e,n,r,o,i,s,a,c,u,l=t[0].peer.name+"";return n=new jw({props:{src:t[0].peer.picture,size:"70px"}}),{c(){e=Hp("portrait"),Dy(n.$$.fragment),r=qp(),o=Hp("div"),i=Hp("h1"),s=Gp(l),a=qp(),c=Hp("div"),Zp(e,"class","svelte-1secqat"),Zp(i,"class","hgap svelte-1secqat"),Zp(c,"class","hgap"),Zp(o,"class","column")},m(t,l){Kp(t,e,l),$y(n,e,null),Kp(t,r,l),Kp(t,o,l),Yp(o,i),Yp(i,s),Yp(o,a),Yp(o,c),u=!0},p(t,e){const r={};1&e&&(r.src=t[0].peer.picture),n.$set(r),(!u||1&e)&&l!==(l=t[0].peer.name+"")&&ey(s,l)},i(t){u||(ky(n.$$.fragment,t),u=!0)},o(t){Sy(n.$$.fragment,t),u=!1},d(t){t&&Rp(e),Ly(n),t&&Rp(r),t&&Rp(o)}}}function DB(t){let e,n;return e=new Qm({props:{id:"heal_resp",tag:"empty"}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function $B(t){let e,n;return e=new Qm({props:{id:"heal_resp",tag:"full"}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function LB(t){let e,n,r,o;const i=[$B,DB],s=[];function a(t,e){return t[28]?0:1}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=zp()},m(t,n){s[e].m(t,n),Kp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e!==c&&(By(),Sy(s[c],1,1,(()=>{s[c]=null})),_y(),n=s[e],n||(n=s[e]=i[e](t),n.c()),ky(n,1),n.m(r.parentNode,r))},i(t){o||(ky(n),o=!0)},o(t){Sy(n),o=!1},d(t){s[e].d(t),t&&Rp(r)}}}function UB(t){let e,n,r=t[25].content+"";return{c(){e=Hp("txt"),n=Gp(r),Zp(e,"class","svelte-1secqat")},m(t,r){Kp(t,e,r),Yp(e,n)},p(t,e){1&e&&r!==(r=t[25].content+"")&&ey(n,r)},d(t){t&&Rp(e)}}}function OB(t){let e;function n(t,e){return t[0].initiator&&"sent"===t[25].type||!t[0].initiator&&"received"===t[25].type?NB:FB}let r=n(t),o=r(t);return{c(){e=Hp("sym"),o.c(),Zp(e,"class","hgap svelte-1secqat")},m(t,n){Kp(t,e,n),o.m(e,null)},p(t,i){r!==(r=n(t))&&(o.d(1),o=r(t),o&&(o.c(),o.m(e,null)))},d(t){t&&Rp(e),o.d()}}}function FB(t){let e;return{c(){e=Gp("ᚧ")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function NB(t){let e;return{c(){e=Gp("ᚦ")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function PB(t){let e;function n(t,e){return t[25].pass?OB:UB}let r=n(t),o=r(t);return{c(){e=Hp("msg"),o.c(),Zp(e,"class","row xcenter svelte-1secqat"),oy(e,"start","received"===t[25].type),oy(e,"remote","received"===t[25].type),oy(e,"local","sent"===t[25].type),oy(e,"end","sent"===t[25].type)},m(t,n){Kp(t,e,n),o.m(e,null)},p(t,i){r===(r=n(t))&&o?o.p(t,i):(o.d(1),o=r(t),o&&(o.c(),o.m(e,null))),1&i&&oy(e,"start","received"===t[25].type),1&i&&oy(e,"remote","received"===t[25].type),1&i&&oy(e,"local","sent"===t[25].type),1&i&&oy(e,"end","sent"===t[25].type)},d(t){t&&Rp(e),o.d()}}}function YB(t){let e,n,r,o,i,s=t[6][0]+"",a=t[6][1]+"";return{c(){e=Hp("white"),n=Gp(s),r=qp(),o=Hp("black"),i=Gp(a)},m(t,s){Kp(t,e,s),Yp(e,n),Kp(t,r,s),Kp(t,o,s),Yp(o,i)},p(t,e){64&e&&s!==(s=t[6][0]+"")&&ey(n,s),64&e&&a!==(a=t[6][1]+"")&&ey(i,a)},d(t){t&&Rp(e),t&&Rp(r),t&&Rp(o)}}}function KB(t){let e,n,r,o,i,s=t[6][1]+"",a=t[6][0]+"";return{c(){e=Hp("black"),n=Gp(s),r=qp(),o=Hp("white"),i=Gp(a)},m(t,s){Kp(t,e,s),Yp(e,n),Kp(t,r,s),Kp(t,o,s),Yp(o,i)},p(t,e){64&e&&s!==(s=t[6][1]+"")&&ey(n,s),64&e&&a!==(a=t[6][0]+"")&&ey(i,a)},d(t){t&&Rp(e),t&&Rp(r),t&&Rp(o)}}}function RB(t){let e,n,r=t[0].state+"";return{c(){e=Hp("h2"),n=Gp(r),Zp(e,"class","text-center nogap svelte-1secqat")},m(t,r){Kp(t,e,r),Yp(e,n)},p(t,e){1&e&&r!==(r=t[0].state+"")&&ey(n,r)},d(t){t&&Rp(e)}}}function jB(t){let e;return{c(){e=Hp("h2"),e.textContent="Conversion ended",Zp(e,"class","text-center nogap svelte-1secqat")},m(t,n){Kp(t,e,n)},p:wp,d(t){t&&Rp(e)}}}function HB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g=t[7][0].join("/")+"",A=t[7][1].join("/")+"",p=t[7][2].join("/")+"";function y(t,e){return t[0].myTurn?GB:VB}let m=y(t),I=m(t);function b(t,e){return t[3]?qB:zB}let E=b(t),w=E(t);return{c(){e=Hp("h2"),I.c(),n=qp(),r=Hp("div"),w.c(),o=qp(),i=Hp("div"),s=Hp("samp"),a=Gp(g),c=qp(),u=Hp("samp"),l=Gp(A),h=qp(),f=Hp("samp"),d=Gp(p),Zp(e,"class","text-center nogap svelte-1secqat"),Zp(r,"class","row space-between"),Zp(i,"class","row space-between")},m(t,g){Kp(t,e,g),I.m(e,null),Kp(t,n,g),Kp(t,r,g),w.m(r,null),Kp(t,o,g),Kp(t,i,g),Yp(i,s),Yp(s,a),Yp(i,c),Yp(i,u),Yp(u,l),Yp(i,h),Yp(i,f),Yp(f,d)},p(t,n){m!==(m=y(t))&&(I.d(1),I=m(t),I&&(I.c(),I.m(e,null))),E===(E=b(t))&&w?w.p(t,n):(w.d(1),w=E(t),w&&(w.c(),w.m(r,null))),128&n&&g!==(g=t[7][0].join("/")+"")&&ey(a,g),128&n&&A!==(A=t[7][1].join("/")+"")&&ey(l,A),128&n&&p!==(p=t[7][2].join("/")+"")&&ey(d,p)},d(t){t&&Rp(e),I.d(),t&&Rp(n),t&&Rp(r),w.d(),t&&Rp(o),t&&Rp(i)}}}function VB(t){let e;return{c(){e=Gp("Waiting")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function GB(t){let e;return{c(){e=Gp("Your turn")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function qB(t){let e,n,r;return{c(){e=Hp("input"),Zp(e,"class","line")},m(o,i){Kp(o,e,i),t[21](e),ny(e,t[4]),n||(r=[Jp(e,"input",t[22]),Jp(e,"keypress",t[16]),Jp(e,"blur",t[23])],n=!0)},p(t,n){16&n&&e.value!==t[4]&&ny(e,t[4])},d(o){o&&Rp(e),t[21](null),n=!1,Bp(r)}}}function zB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d;return{c(){e=Hp("button"),n=Gp("end"),o=qp(),i=Hp("button"),s=Gp("msg"),c=qp(),u=Hp("button"),l=Gp("pass"),Zp(e,"class","hgap"),e.disabled=r=!t[0].myTurn,Zp(i,"class","hgap"),i.disabled=a=!t[0].myTurn,Zp(u,"class","hgap"),u.disabled=h=!t[0].myTurn},m(r,a){Kp(r,e,a),Yp(e,n),Kp(r,o,a),Kp(r,i,a),Yp(i,s),Kp(r,c,a),Kp(r,u,a),Yp(u,l),f||(d=[Jp(e,"click",t[19]),Jp(i,"click",t[20]),Jp(u,"click",t[15])],f=!0)},p(t,n){1&n&&r!==(r=!t[0].myTurn)&&(e.disabled=r),1&n&&a!==(a=!t[0].myTurn)&&(i.disabled=a),1&n&&h!==(h=!t[0].myTurn)&&(u.disabled=h)},d(t){t&&Rp(e),t&&Rp(o),t&&Rp(i),t&&Rp(c),t&&Rp(u),f=!1,Bp(d)}}}function JB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C=Ff.rewrite(t[0].graph||"")+"";const v=[TB,MB],B=[];function _(t,e){return t[0].peer?0:1}o=_(t),i=B[o]=v[o](t);let k=t[5],S=[];for(let e=0;e<k.length;e+=1)S[e]=LB(QB(t,k,e));const x=t=>Sy(S[t],1,1,(()=>{S[t]=null}));h=new dI({props:{expiresAt:t[0].expiresAt,format:"mm:ss"}});let Q=t[0].messages,M=[];for(let e=0;e<Q.length;e+=1)M[e]=PB(xB(t,Q,e));function T(t,e){return t[0].initiator?KB:YB}let D=T(t),$=D(t);function L(t,e){return"active"===t[0].state?HB:"end"===t[0].state?jB:RB}let U=L(t),O=U(t);return{c(){e=Hp("chat"),n=Hp("header"),r=Hp("div"),i.c(),s=qp(),a=Hp("div"),c=Hp("health");for(let t=0;t<S.length;t+=1)S[t].c();u=qp(),l=Hp("h3"),Dy(h.$$.fragment),f=qp(),d=Hp("messages"),g=Hp("p"),A=Gp(C),p=qp();for(let t=0;t<M.length;t+=1)M[t].c();y=qp(),m=Hp("msg"),I=Hp("balance"),$.c(),b=qp(),E=Hp("ctrls"),O.c(),Zp(r,"class","row xcenter"),Zp(l,"class","svelte-1secqat"),Zp(a,"class","column xend"),Zp(n,"class","container row space-between svelte-1secqat"),Zp(g,"class","text-center"),oy(I,"inv",!t[0].initiator),Zp(m,"class","row xcenter center svelte-1secqat"),Zp(d,"class","container svelte-1secqat"),Zp(e,"class","svelte-1secqat"),oy(e,"white",t[0].initiator),oy(e,"black",!t[0].initiator)},m(i,C){Kp(i,e,C),Yp(e,n),Yp(n,r),B[o].m(r,null),Yp(n,s),Yp(n,a),Yp(a,c);for(let t=0;t<S.length;t+=1)S[t].m(c,null);Yp(a,u),Yp(a,l),$y(h,l,null),Yp(e,f),Yp(e,d),Yp(d,g),Yp(g,A),Yp(d,p);for(let t=0;t<M.length;t+=1)M[t].m(d,null);Yp(d,y),Yp(d,m),Yp(m,I),$.m(I,null),t[18](d),Yp(e,b),Yp(e,E),O.m(E,null),w=!0},p(t,[n]){let s=o;if(o=_(t),o===s?B[o].p(t,n):(By(),Sy(B[s],1,1,(()=>{B[s]=null})),_y(),i=B[o],i?i.p(t,n):(i=B[o]=v[o](t),i.c()),ky(i,1),i.m(r,null)),32&n){let e;for(k=t[5],e=0;e<k.length;e+=1){const r=QB(t,k,e);S[e]?(S[e].p(r,n),ky(S[e],1)):(S[e]=LB(r),S[e].c(),ky(S[e],1),S[e].m(c,null))}for(By(),e=k.length;e<S.length;e+=1)x(e);_y()}const a={};if(1&n&&(a.expiresAt=t[0].expiresAt),h.$set(a),(!w||1&n)&&C!==(C=Ff.rewrite(t[0].graph||"")+"")&&ey(A,C),1&n){let e;for(Q=t[0].messages,e=0;e<Q.length;e+=1){const r=xB(t,Q,e);M[e]?M[e].p(r,n):(M[e]=PB(r),M[e].c(),M[e].m(d,y))}for(;e<M.length;e+=1)M[e].d(1);M.length=Q.length}D===(D=T(t))&&$?$.p(t,n):($.d(1),$=D(t),$&&($.c(),$.m(I,null))),1&n&&oy(I,"inv",!t[0].initiator),U===(U=L(t))&&O?O.p(t,n):(O.d(1),O=U(t),O&&(O.c(),O.m(E,null))),1&n&&oy(e,"white",t[0].initiator),1&n&&oy(e,"black",!t[0].initiator)},i(t){if(!w){ky(i);for(let t=0;t<k.length;t+=1)ky(S[t]);ky(h.$$.fragment,t),w=!0}},o(t){Sy(i),S=S.filter(Boolean);for(let t=0;t<S.length;t+=1)Sy(S[t]);Sy(h.$$.fragment,t),w=!1},d(n){n&&Rp(e),B[o].d(),jp(S,n),Ly(h),jp(M,n),$.d(),t[18](null),O.d()}}}function WB(t,e,n){let r,o,i,s,a,c,u,l,{id:h}=e;const f=ym(h,"Chat");Dp(t,f,(t=>n(0,r=t)));const d=Yy(!1);Dp(t,d,(t=>n(3,o=t)));const g=Yy("");Dp(t,g,(t=>n(4,i=t)));const A=Ky(f,(t=>Array.from(new Array(3)).map(((e,n)=>n<t.health))));Dp(t,A,(t=>n(5,s=t)));const p=Ky(f,(t=>t.graph?t.initiator?Ff.scoreGraph(t.graph):Ff.scoreGraph(t.graph).reverse():[0,0]));Dp(t,p,(t=>n(6,a=t)));const y=Ky([f,p],(([t,e])=>t.graph?(t.initiator||(e=e.reverse()),[t.initiator?"ᛒᛔ":"ᛔᛒ",t.initiator?"ᛖ":"ᛗ",t.initiator?"ᚦ":"ᚧ"].map((n=>{const r=Ff.scoreGraph(t.graph+n).map(((t,n)=>t-e[n])).map((t=>function(t){return t>0?`+${t}`:t}(t)));return t.initiator?r:r.reverse()}))):[[0,0],[0,0],[0,0]]));var m;function I(t=0){console.log("Bye button pressed"),r.bye(t).then((()=>console.info("Bye published"))).catch((t=>console.error("Failed publishing Bye",t)))}Dp(t,y,(t=>n(7,c=t))),m=()=>{u.scrollTo({top:u.scrollHeight,left:0,behaviour:"smooth"}),o&&l.focus()},ay().$$.after_update.push(m);return t.$$set=t=>{"id"in t&&n(17,h=t.id)},t.$$.update=()=>{1&t.$$.dirty&&"finalizing"===r.state&&r.myTurn&&I()},[r,u,l,o,i,s,a,c,f,d,g,A,p,y,I,function(){r.pass().then((()=>console.info("Pass published"))).catch((t=>console.error("Failed publishing Pass",t)))},function({charCode:t}){if(13===t)r.send(i.trim()).then((()=>{console.info("Message published"),Pp(g,i="",i),Pp(d,o=!1,o)})).catch((t=>console.error("Failed publishing Message",t)))},h,function(t){fy[t?"unshift":"push"]((()=>{u=t,n(1,u)}))},()=>I(0),()=>Pp(d,o=!0,o),function(t){fy[t?"unshift":"push"]((()=>{l=t,n(2,l)}))},function(){i=this.value,g.set(i)},()=>Pp(d,o=!!i.length,o)]}class XB extends Fy{constructor(t){super(),Oy(this,t,WB,JB,kp,{id:17})}}function ZB(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B,_,k,S,x,Q,M,T;return o=new Qm({props:{id:"dl-logo-red"}}),{c(){e=Hp("about"),n=Hp("div"),r=Hp("logo"),Dy(o.$$.fragment),i=qp(),s=Hp("h1"),a=Gp("Picochat\n    "),c=Hp("samp"),c.textContent=`${"3.0.0".replace(/^(\d+).+/,"$1")}`,u=qp(),l=Hp("p"),l.textContent="Where ever we're going, we'll get there eventually.\n    Meanwhile, come say hi!\n  ",h=Hp("ul"),h.innerHTML='<li class="svelte-1eldk8a"><a href="https://discord.gg/K5XjmZx" class="svelte-1eldk8a">Discord (community chat)</a></li> \n    <li class="svelte-1eldk8a"><a href="https://github.com/telamon/picochat/issues" class="svelte-1eldk8a">Questions &amp; Support</a></li> \n    <li class="svelte-1eldk8a"><a href="https://github.com/telamon/picochat" class="svelte-1eldk8a">Source code</a></li>',f=qp(),d=Hp("h5"),d.textContent="Legalities",g=qp(),A=Hp("table"),p=Hp("tdata"),y=Hp("tr"),m=Hp("td"),m.textContent="build",I=Hp("td"),I.textContent=`production-3.0.0-${"a1861d56116a8389466f11d725a63d254c8b6593".substr(0,8)}`,b=qp(),E=Hp("tr"),E.innerHTML="<td>Cookies</td><td>none, zilch, zero</td>",w=qp(),C=Hp("tr"),C.innerHTML="<td>GDPR</td><td>All blocks are automatically erased when timers hit <code>00:00</code></td>",v=qp(),B=Hp("tr"),B.innerHTML="<td>User</td><td>We have absolutley no control over p2p interactions, apply common sense, be polite</td>",_=qp(),k=Hp("tr"),k.innerHTML="<td>License</td><td>GNU AGPL version 3</td>",S=qp(),x=Hp("tr"),x.innerHTML="<td>Motto</td><td>No servers, no supernodes, liberate humans and machines alike</td>",Q=qp(),M=Hp("p"),M.innerHTML="<sub>Bottom line</sub><br/> \n    <samp>This software is presented to you as is,\n      Decent Labs AB takes no responsibility for how this software is used or distributed.\n      <br/>\n      Refer to the contents of the aforementioned license for more details.</samp>",Zp(n,"class","column xcenter vgap"),Zp(h,"class","svelte-1eldk8a"),Zp(e,"class","block container")},m(t,D){Kp(t,e,D),Yp(e,n),Yp(n,r),$y(o,r,null),Yp(e,i),Yp(e,s),Yp(s,a),Yp(s,c),Yp(e,u),Yp(e,l),Yp(e,h),Yp(e,f),Yp(e,d),Yp(e,g),Yp(e,A),Yp(A,p),Yp(p,y),Yp(y,m),Yp(y,I),Yp(p,b),Yp(p,E),Yp(p,w),Yp(p,C),Yp(p,v),Yp(p,B),Yp(p,_),Yp(p,k),Yp(p,S),Yp(p,x),Yp(e,Q),Yp(e,M),T=!0},p:wp,i(t){T||(ky(o.$$.fragment,t),T=!0)},o(t){Sy(o.$$.fragment,t),T=!1},d(t){t&&Rp(e),Ly(o)}}}class t_ extends Fy{constructor(t){super(),Oy(this,t,null,ZB,kp,{})}}function e_(t){let e,n,r,o,i;return{c(){e=Hp("h3"),e.textContent="Done!",n=qp(),r=Hp("button"),r.textContent="done"},m(s,a){Kp(s,e,a),Kp(s,n,a),Kp(s,r,a),o||(i=Jp(r,"click",t[3]),o=!0)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r),o=!1,i()}}}function n_(t){let e,n,r,o,i=t[0].error+"";return{c(){e=Hp("h3"),e.textContent="Not imported",n=qp(),r=Hp("danger"),o=Gp(i)},m(t,i){Kp(t,e,i),Kp(t,n,i),Kp(t,r,i),Yp(r,o)},p(t,e){1&e&&i!==(i=t[0].error+"")&&ey(o,i)},d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r)}}}function r_(t){let e,n,r;return{c(){e=Hp("h3"),e.textContent="Reading blocks...",n=qp(),r=Hp("h1"),Zp(r,"aria-busy","true")},m(t,o){Kp(t,e,o),Kp(t,n,o),Kp(t,r,o)},p:wp,d(t){t&&Rp(e),t&&Rp(n),t&&Rp(r)}}}function o_(t){let e,n,r,o;function i(t,e){return t[0].loading?r_:t[0].imported?e_:n_}let s=i(t),a=s(t);return{c(){e=Hp("append"),n=Hp("div"),r=Hp("h1"),r.textContent=" ",o=qp(),a.c(),Zp(n,"class","flex column xcenter center"),Zp(e,"class","block container")},m(t,i){Kp(t,e,i),Yp(e,n),Yp(n,r),Yp(n,o),a.m(n,null)},p(t,[e]){s===(s=i(t))&&a?a.p(t,e):(a.d(1),a=s(t),a&&(a.c(),a.m(n,null)))},i:wp,o:wp,d(t){t&&Rp(e),a.d()}}}function i_(t,e,r){let o,{id:i}=e;const s=jy(n.exports.init({loading:!0},n.exports.mute(M_,(async t=>{if(!t)return{loading:!0};const e=tf.Feed.from(t),n=tf.SimpleKernel.decodeBlock(e.last.body).type;let r=null,o=!1;if(!!await Vy.repo.readBlock(e.last.sig))r="Already merged","items"===n&&L_("shop");else try{if(!(await Vy.dispatch(e,!0)).length)throw new Error("Rejected by kernel");o=!0,"items"===n&&L_("shop")}catch(t){console.error(t),r=t.message}return{loading:!1,imported:o,error:r,feed:e}}))));Dp(t,s,(t=>r(0,o=t)));return t.$$set=t=>{"id"in t&&r(2,i=t.id)},[o,s,i,()=>L_("/")]}class s_ extends Fy{constructor(t){super(),Oy(this,t,i_,o_,kp,{id:2})}}function a_(t,e,n){const r=t.slice();return r[12]=e[n],r}function c_(t){let e,n=t[12].qty+"";return{c(){e=Gp(n)},m(t,n){Kp(t,e,n)},p(t,r){4&r&&n!==(n=t[12].qty+"")&&ey(e,n)},d(t){t&&Rp(e)}}}function u_(t){let e,n,r,o,i,s,a,c,u=Dd.ITEMS[t[12].id].image+"",l="consumable"===Dd.ITEMS[t[12].id].type&&c_(t);function h(){return t[7](t[12])}return{c(){e=Hp("item"),n=Hp("emo"),r=Gp(u),o=qp(),l&&l.c(),i=qp(),Zp(e,"role","button"),Zp(e,"class",s=Dd.ITEMS[t[12].id].category)},m(t,s){Kp(t,e,s),Yp(e,n),Yp(n,r),Yp(e,o),l&&l.m(e,null),Yp(e,i),a||(c=Jp(e,"click",h),a=!0)},p(n,o){t=n,4&o&&u!==(u=Dd.ITEMS[t[12].id].image+"")&&ey(r,u),"consumable"===Dd.ITEMS[t[12].id].type?l?l.p(t,o):(l=c_(t),l.c(),l.m(e,i)):l&&(l.d(1),l=null),4&o&&s!==(s=Dd.ITEMS[t[12].id].category)&&Zp(e,"class",s)},d(t){t&&Rp(e),l&&l.d(),a=!1,c()}}}function l_(t){let e,n;return e=new km({props:{open:!0,$$slots:{default:[d_]},$$scope:{ctx:t}}}),e.$on("fade",t[11]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};32769&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function h_(t){let e,n,r;return{c(){e=Hp("button"),e.textContent="Use",Zp(e,"class","hgap")},m(o,i){Kp(o,e,i),n||(r=Jp(e,"click",t[9]),n=!0)},p:wp,d(t){t&&Rp(e),n=!1,r()}}}function f_(t){let e,n,r;return{c(){e=Hp("button"),e.textContent="Activate",Zp(e,"class","hgap")},m(o,i){Kp(o,e,i),n||(r=Jp(e,"click",t[10]),n=!0)},p:wp,d(t){t&&Rp(e),n=!1,r()}}}function d_(t){let e,n,r,o,i,s,a,c,u,l;n=new mv({props:{id:t[0].id}});let h="consumable"===Dd.ITEMS[t[0].id].type&&h_(t),f="active"===Dd.ITEMS[t[0].id].type&&f_(t);return{c(){e=Hp("article"),Dy(n.$$.fragment),r=qp(),o=Hp("footer"),i=Hp("button"),i.textContent="ok",s=qp(),h&&h.c(),a=qp(),f&&f.c(),Zp(i,"class","hgap"),Zp(o,"class","row space-between")},m(d,g){Kp(d,e,g),$y(n,e,null),Yp(e,r),Yp(e,o),Yp(o,i),Yp(o,s),h&&h.m(o,null),Yp(o,a),f&&f.m(o,null),c=!0,u||(l=Jp(i,"click",t[8]),u=!0)},p(t,e){const r={};1&e&&(r.id=t[0].id),n.$set(r),"consumable"===Dd.ITEMS[t[0].id].type?h?h.p(t,e):(h=h_(t),h.c(),h.m(o,a)):h&&(h.d(1),h=null),"active"===Dd.ITEMS[t[0].id].type?f?f.p(t,e):(f=f_(t),f.c(),f.m(o,null)):f&&(f.d(1),f=null)},i(t){c||(ky(n.$$.fragment,t),c=!0)},o(t){Sy(n.$$.fragment,t),c=!1},d(t){t&&Rp(e),Ly(n),h&&h.d(),f&&f.d(),u=!1,l()}}}function g_(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B=t[1].balance+"",_=t[1].score+"";d=new dI({props:{expiresAt:t[1].expiresAt,format:"HH:mm:ss"}});let k=t[2],S=[];for(let e=0;e<k.length;e+=1)S[e]=u_(a_(t,k,e));let x=t[0]&&l_(t);return{c(){e=Hp("wallet-view"),n=Hp("div"),r=Hp("h1"),r.textContent="Balance",o=qp(),i=Hp("h1"),s=Gp("¤"),a=Gp(B),c=qp(),u=Hp("div"),l=Hp("h6"),h=Gp("💀 "),f=Hp("code"),Dy(d.$$.fragment),g=Gp("\n      Score "),A=Gp(_),p=Hp("br"),y=qp(),m=Hp("h1"),m.textContent=" ",I=qp(),b=Hp("h1"),b.textContent="Inventory",E=qp(),w=Hp("inventory");for(let t=0;t<S.length;t+=1)S[t].c();C=qp(),x&&x.c(),Zp(r,"class","nogap"),Zp(l,"class","nogap"),Zp(b,"class","nogap"),Zp(n,"class","row column xcenter start")},m(t,B){Kp(t,e,B),Yp(e,n),Yp(n,r),Yp(n,o),Yp(n,i),Yp(i,s),Yp(i,a),Yp(n,c),Yp(n,u),Yp(u,l),Yp(l,h),Yp(l,f),$y(d,f,null),Yp(u,g),Yp(u,A),Yp(u,p),Yp(n,y),Yp(n,m),Yp(n,I),Yp(n,b),Yp(n,E),Yp(n,w);for(let t=0;t<S.length;t+=1)S[t].m(w,null);Yp(n,C),x&&x.m(n,null),v=!0},p(t,[e]){(!v||2&e)&&B!==(B=t[1].balance+"")&&ey(a,B);const r={};if(2&e&&(r.expiresAt=t[1].expiresAt),d.$set(r),(!v||2&e)&&_!==(_=t[1].score+"")&&ey(A,_),5&e){let n;for(k=t[2],n=0;n<k.length;n+=1){const r=a_(t,k,n);S[n]?S[n].p(r,e):(S[n]=u_(r),S[n].c(),S[n].m(w,null))}for(;n<S.length;n+=1)S[n].d(1);S.length=k.length}t[0]?x?(x.p(t,e),1&e&&ky(x,1)):(x=l_(t),x.c(),ky(x,1),x.m(n,null)):x&&(By(),Sy(x,1,1,(()=>{x=null})),_y())},i(t){v||(ky(d.$$.fragment,t),ky(x),v=!0)},o(t){Sy(d.$$.fragment,t),Sy(x),v=!1},d(t){t&&Rp(e),Ly(d),jp(S,t),x&&x.d()}}}function A_(t,e,n){let r,o,i;const s=Jy();Dp(t,s,(t=>n(1,o=t)));const a=Ky(s,(t=>"loading"===t.state?[]:t.inventory.filter((t=>t.qty))));Dp(t,a,(t=>n(2,i=t)));const c=Yy(!1);async function u(t){await Vy.useItem(t).then((e=>console.log("Consumed item",t,e))).catch((e=>console.error("Failed consuming",t,e))),Pp(c,r=!1,r)}Dp(t,c,(t=>n(0,r=t)));return[r,o,i,s,a,c,u,t=>Pp(c,r=t,r),()=>Pp(c,r=!1,r),()=>u(r.id),()=>(r.id,void console.info("todo implement item activation")),()=>Pp(c,r=!1,r)]}class p_ extends Fy{constructor(t){super(),Oy(this,t,A_,g_,kp,{})}}function y_(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p;return{c(){e=Hp("devel-view"),n=Hp("h1"),n.textContent="Developers view",r=qp(),o=Hp("p"),o.textContent="(everything is broken)",i=qp(),s=Hp("script"),c=qp(),u=Hp("div"),l=Hp("button"),l.textContent="dump",h=qp(),f=Hp("button"),f.textContent="reload",d=qp(),g=Hp("graph"),g.textContent="g",Qp(s.src,a="https://cdn.jsdelivr.net/npm/@hpcc-js/wasm/dist/index.min.js")||Zp(s,"src","https://cdn.jsdelivr.net/npm/@hpcc-js/wasm/dist/index.min.js"),Zp(l,"class","hpad"),Zp(f,"class","hpad"),Zp(u,"class","flex row space-between")},m(a,y){Kp(a,e,y),Yp(e,n),Yp(e,r),Yp(e,o),Yp(e,i),Yp(e,s),Yp(e,c),Yp(e,u),Yp(u,l),Yp(u,h),Yp(u,f),Yp(e,d),Yp(e,g),t[3](g),A||(p=[Jp(l,"click",t[1]),Jp(f,"click",t[2])],A=!0)},p:wp,i:wp,o:wp,d(n){n&&Rp(e),t[3](null),A=!1,Bp(p)}}}function m_(t,e,n){let r;return[r,async function(){const{graphviz:t}=window["@hpcc-js/wasm"],e=await Vy.inspect(),o=await t.layout(e,"svg","dot");n(0,r.innerHTML=o,r)},async function(){await Vy.reload()},function(t){fy[t?"unshift":"push"]((()=>{r=t,n(0,r)}))}]}class I_ extends Fy{constructor(t){super(),Oy(this,t,m_,y_,kp,{})}}const[b_,E_]=n.exports.writable(),[w_,C_]=n.exports.writable(),[v_,B_]=n.exports.writable(),__=n.exports.gate(n.exports.mute(b_,(t=>{switch(t){case"shop":return uB;case"msgs":return SB;case"profile":return av;case"chat":return XB;case"about":return t_;case"keygen":return tI;case"append":return s_;case"wallet":return p_;case"devel":return I_;default:return TC}}))),k_=jy(b_),S_=jy(__),x_=jy(w_),Q_=jy(v_),M_=w_;let T_=null;function D_(t,e,n){if(T_&&t===T_)return!1;T_=t,console.info("Rerouting to path:",t,"id:",e,"Q/Search:",n),E_(t),C_(e),B_(n)}function $_(){if(""===window.location.hash)return D_("pub",null,new URLSearchParams);const t=new URL(window.location.hash.replace(/^#\/?/,"x:")),[e,n]=t.pathname.split("/"),r=new URLSearchParams(t.search),o={};let i=!0;for(const[t,e]of r.entries())o[t]=e,i=!1;D_(e.toLowerCase(),n,i?void 0:o)}function L_(t){window.history.pushState(null,null,`/#${t}`.replace(/^#\/+/,"#/")),$_()}function U_(t,e,n){const r=t.slice();return r[11]=e[n],r}function O_(t){let e,n,r,o,i,s,a=t[11]+"";function c(){return t[8](t[11])}return{c(){e=Hp("div"),n=Hp("a"),r=Hp("code"),o=Gp(a)},m(t,a){Kp(t,e,a),Yp(e,n),Yp(n,r),Yp(r,o),i||(s=Jp(n,"click",c),i=!0)},p(e,n){t=e},d(t){t&&Rp(e),i=!1,s()}}}function F_(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p=t[3],y=[];for(let e=0;e<p.length;e+=1)y[e]=O_(U_(t,p,e));return{c(){e=Hp("article"),n=Hp("h6"),n.textContent="namespaces",r=qp(),o=Hp("input"),i=qp(),s=Hp("h6"),s.textContent="quickfilters",a=qp(),c=Hp("div"),u=Hp("a"),u.innerHTML="<code>DEBUG:OFF</code>",l=qp();for(let t=0;t<y.length;t+=1)y[t].c();h=qp(),f=Hp("footer"),d=Hp("button"),d.textContent="ok",Zp(o,"type","text")},m(p,m){Kp(p,e,m),Yp(e,n),Yp(e,r),Yp(e,o),ny(o,t[1]),Yp(e,i),Yp(e,s),Yp(e,a),Yp(e,c),Yp(c,u),Yp(e,l);for(let t=0;t<y.length;t+=1)y[t].m(e,null);Yp(e,h),Yp(e,f),Yp(f,d),g||(A=[Jp(o,"input",t[6]),Jp(u,"click",t[7]),Jp(d,"click",t[9])],g=!0)},p(t,n){if(2&n&&o.value!==t[1]&&ny(o,t[1]),40&n){let r;for(p=t[3],r=0;r<p.length;r+=1){const o=U_(t,p,r);y[r]?y[r].p(o,n):(y[r]=O_(o),y[r].c(),y[r].m(e,h))}for(;r<y.length;r+=1)y[r].d(1);y.length=p.length}},d(t){t&&Rp(e),jp(y,t),g=!1,Bp(A)}}}function N_(t){let e,n;return e=new km({props:{open:t[2],$$slots:{default:[F_]},$$scope:{ctx:t}}}),e.$on("fade",t[10]),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,[n]){const r={};4&n&&(r.open=t[2]),16390&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function P_(t,e,n){let r,o,i=wp,s=()=>(i(),i=Mp(a,(t=>n(2,o=t))),a);t.$$.on_destroy.push((()=>i()));let{open:a=Yy(!1)}=e;s();const c=Yy(Sh.namespaces);function u(t){""===t?(Sh.disable(),Pp(c,r="",r)):(Sh.enable(t),Pp(c,r=Sh.namespaces,r))}Dp(t,c,(t=>n(1,r=t)));return t.$$set=t=>{"open"in t&&s(n(0,a=t.open))},[a,r,o,["*","hyper*","pico*","picochat:kernel","picochat:mod:*","picochat:mod:net","picochat:mod:gc","picochat:mod:reg","picochat:slice*"],c,u,function(){r=this.value,c.set(r)},()=>u(""),t=>u(t),()=>Pp(a,o=!1,o),()=>Pp(a,o=!1,o)]}window.addEventListener("popstate",$_),$_();class Y_ extends Fy{constructor(t){super(),Oy(this,t,P_,N_,kp,{open:0})}}const{window:K_}=My;function R_(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v,B,_,k,S,x,Q,M,T=t[2]?.state[0]+"",D=(t[2].hasKey?1:0)+"",$=(t[2].hasProfile?1:0)+"",L=(t[2].entered?1:0)+"";function U(t,e){return t[2].swarming?t[3]?2>t[3]?H_:j_:V_:G_}let O=U(t),F=O(t);return S=new Y_({props:{open:t[16]}}),{c(){e=Hp("dev-bar"),n=Hp("div"),r=Gp("K["),o=Gp(T),i=Gp("]\n      ID²["),s=Gp(D),a=Gp("]\n      P["),c=Gp($),u=Gp("]\n      m56["),l=Gp(t[3]),h=Gp("]\n      E["),f=Gp(L),d=Gp("]"),g=qp(),A=Hp("div"),p=Hp("btn"),F.c(),y=qp(),m=Hp("btn"),m.textContent="r",I=qp(),b=Hp("btn"),b.textContent="D",E=qp(),w=Hp("btn"),w.textContent="t",C=qp(),v=Hp("btn"),v.textContent="i",B=qp(),_=Hp("btn"),_.textContent="X",k=qp(),Dy(S.$$.fragment),Zp(p,"class",Np(t[22]?"m56 auto":"m56 no-auto")+" svelte-107qq9w"),Zp(_,"class","danger"),ty(e,"class","flex row xcenter space-between")},m(T,D){Kp(T,e,D),Yp(e,n),Yp(n,r),Yp(n,o),Yp(n,i),Yp(n,s),Yp(n,a),Yp(n,c),Yp(n,u),Yp(n,l),Yp(n,h),Yp(n,f),Yp(n,d),Yp(e,g),Yp(e,A),Yp(A,p),F.m(p,null),Yp(A,y),Yp(A,m),Yp(A,I),Yp(A,b),Yp(A,E),Yp(A,w),Yp(A,C),Yp(A,v),Yp(A,B),Yp(A,_),Kp(T,k,D),$y(S,T,D),x=!0,Q||(M=[Jp(p,"click",t[23]),Jp(m,"click",t[20]),Jp(b,"click",t[24]),Jp(w,"click",ak),Jp(v,"click",t[19]),Jp(_,"click",t[25])],Q=!0)},p(t,e){(!x||4&e[0])&&T!==(T=t[2]?.state[0]+"")&&ey(o,T),(!x||4&e[0])&&D!==(D=(t[2].hasKey?1:0)+"")&&ey(s,D),(!x||4&e[0])&&$!==($=(t[2].hasProfile?1:0)+"")&&ey(c,$),(!x||8&e[0])&&ey(l,t[3]),(!x||4&e[0])&&L!==(L=(t[2].entered?1:0)+"")&&ey(f,L),O!==(O=U(t))&&(F.d(1),F=O(t),F&&(F.c(),F.m(p,null)))},i(t){x||(ky(S.$$.fragment,t),x=!0)},o(t){Sy(S.$$.fragment,t),x=!1},d(t){t&&Rp(e),F.d(),t&&Rp(k),Ly(S,t),Q=!1,Bp(M)}}}function j_(t){let e;return{c(){e=Gp("|ó_ó|")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function H_(t){let e;return{c(){e=Gp("|o_o|")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function V_(t){let e;return{c(){e=Gp("|o_=|")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function G_(t){let e;return{c(){e=Gp("|=_=|")},m(t,n){Kp(t,e,n)},d(t){t&&Rp(e)}}}function q_(t){let e,n,r,o,i,s,a=t[31].message+"",c=t[31].stack+"";return{c(){e=Hp("h3"),n=Gp("KernelPanic! "),r=Gp(a),o=qp(),i=Hp("pre"),s=Gp(c)},m(t,a){Kp(t,e,a),Yp(e,n),Yp(e,r),Kp(t,o,a),Kp(t,i,a),Yp(i,s)},p:wp,i:wp,o:wp,d(t){t&&Rp(e),t&&Rp(o),t&&Rp(i)}}}function z_(t){let e,n,r,o;const i=[Z_,X_,W_,J_],s=[];function a(t,e){return t[6]&&t[7]?0:t[7]?1:t[6]?2:3}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=zp()},m(t,n){s[e].m(t,n),Kp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e===c?s[e].p(t,o):(By(),Sy(s[c],1,1,(()=>{s[c]=null})),_y(),n=s[e],n?n.p(t,o):(n=s[e]=i[e](t),n.c()),ky(n,1),n.m(r.parentNode,r))},i(t){o||(ky(n),o=!0)},o(t){Sy(n),o=!1},d(t){s[e].d(t),t&&Rp(r)}}}function J_(t){let e,n,r;var o=t[8];return o&&(e=new o({})),{c(){e&&Dy(e.$$.fragment),n=zp()},m(t,o){e&&$y(e,t,o),Kp(t,n,o),r=!0},p(t,r){if(o!==(o=t[8])){if(e){By();const t=e;Sy(t.$$.fragment,1,0,(()=>{Ly(t,1)})),_y()}o?(e=new o({}),Dy(e.$$.fragment),ky(e.$$.fragment,1),$y(e,n.parentNode,n)):e=null}},i(t){r||(e&&ky(e.$$.fragment,t),r=!0)},o(t){e&&Sy(e.$$.fragment,t),r=!1},d(t){t&&Rp(n),e&&Ly(e,t)}}}function W_(t){let e,n,r;var o=t[8];function i(t){return{props:{id:t[6]}}}return o&&(e=new o(i(t))),{c(){e&&Dy(e.$$.fragment),n=zp()},m(t,o){e&&$y(e,t,o),Kp(t,n,o),r=!0},p(t,r){const s={};if(64&r[0]&&(s.id=t[6]),o!==(o=t[8])){if(e){By();const t=e;Sy(t.$$.fragment,1,0,(()=>{Ly(t,1)})),_y()}o?(e=new o(i(t)),Dy(e.$$.fragment),ky(e.$$.fragment,1),$y(e,n.parentNode,n)):e=null}else o&&e.$set(s)},i(t){r||(e&&ky(e.$$.fragment,t),r=!0)},o(t){e&&Sy(e.$$.fragment,t),r=!1},d(t){t&&Rp(n),e&&Ly(e,t)}}}function X_(t){let e,n,r;var o=t[8];function i(t){return{props:{q:t[7]}}}return o&&(e=new o(i(t))),{c(){e&&Dy(e.$$.fragment),n=zp()},m(t,o){e&&$y(e,t,o),Kp(t,n,o),r=!0},p(t,r){const s={};if(128&r[0]&&(s.q=t[7]),o!==(o=t[8])){if(e){By();const t=e;Sy(t.$$.fragment,1,0,(()=>{Ly(t,1)})),_y()}o?(e=new o(i(t)),Dy(e.$$.fragment),ky(e.$$.fragment,1),$y(e,n.parentNode,n)):e=null}else o&&e.$set(s)},i(t){r||(e&&ky(e.$$.fragment,t),r=!0)},o(t){e&&Sy(e.$$.fragment,t),r=!1},d(t){t&&Rp(n),e&&Ly(e,t)}}}function Z_(t){let e,n,r;var o=t[8];function i(t){return{props:{id:t[6],q:t[7]}}}return o&&(e=new o(i(t))),{c(){e&&Dy(e.$$.fragment),n=zp()},m(t,o){e&&$y(e,t,o),Kp(t,n,o),r=!0},p(t,r){const s={};if(64&r[0]&&(s.id=t[6]),128&r[0]&&(s.q=t[7]),o!==(o=t[8])){if(e){By();const t=e;Sy(t.$$.fragment,1,0,(()=>{Ly(t,1)})),_y()}o?(e=new o(i(t)),Dy(e.$$.fragment),ky(e.$$.fragment,1),$y(e,n.parentNode,n)):e=null}else o&&e.$set(s)},i(t){r||(e&&ky(e.$$.fragment,t),r=!0)},o(t){e&&Sy(e.$$.fragment,t),r=!1},d(t){t&&Rp(n),e&&Ly(e,t)}}}function tk(t){let e;return{c(){e=Hp("div"),e.innerHTML='<h5 aria-busy="true">Booting up...</h5>',Zp(e,"class","column center xcenter"),ry(e,"height","100%")},m(t,n){Kp(t,e,n)},p:wp,i:wp,o:wp,d(t){t&&Rp(e)}}}function ek(t){let e,n,r,o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,C,v;r=new Qm({props:{id:"gfx-vibe",nofill:!0}}),s=new Qm({props:{id:"gfx-shop",nofill:!0}});const B=[rk,nk],_=[];function k(t,e){return t[2].entered?1:0}u=k(t),l=_[u]=B[u](t),d=new Qm({props:{id:"gfx-msgs",nofill:!0}});const S=[ik,ok],x=[];function Q(t,e){return t[11]?1:0}return b=Q(t),E=x[b]=S[b](t),{c(){e=Hp("bar"),n=Hp("round"),Dy(r.$$.fragment),o=qp(),i=Hp("round"),Dy(s.$$.fragment),c=qp(),l.c(),h=qp(),f=Hp("round"),Dy(d.$$.fragment),g=qp(),A=Hp("samp"),p=Gp(t[10]),m=qp(),I=Hp("round"),E.c(),Zp(n,"class","flex column center xcenter noselect"),Zp(i,"class","flex column center xcenter noselect"),Zp(i,"disabled",a=!t[2].entered||null),Zp(A,"class","notifications-badge"),oy(A,"zero",!t[10]),Zp(f,"class","flex column center xcenter noselect"),Zp(f,"disabled",y=!t[2].entered||null),Zp(I,"class","flex column center xcenter noselect"),Zp(e,"class","flex row xcenter space-between")},m(a,l){Kp(a,e,l),Yp(e,n),$y(r,n,null),Yp(e,o),Yp(e,i),$y(s,i,null),Yp(e,c),_[u].m(e,null),Yp(e,h),Yp(e,f),$y(d,f,null),Yp(f,g),Yp(f,A),Yp(A,p),Yp(e,m),Yp(e,I),x[b].m(I,null),w=!0,C||(v=[Jp(n,"click",t[26]),Jp(i,"click",t[27]),Jp(f,"click",t[29]),Jp(I,"click",t[30])],C=!0)},p(t,n){(!w||4&n[0]&&a!==(a=!t[2].entered||null))&&Zp(i,"disabled",a);let r=u;u=k(t),u===r?_[u].p(t,n):(By(),Sy(_[r],1,1,(()=>{_[r]=null})),_y(),l=_[u],l?l.p(t,n):(l=_[u]=B[u](t),l.c()),ky(l,1),l.m(e,h)),(!w||1024&n[0])&&ey(p,t[10]),1024&n[0]&&oy(A,"zero",!t[10]),(!w||4&n[0]&&y!==(y=!t[2].entered||null))&&Zp(f,"disabled",y);let o=b;b=Q(t),b===o?x[b].p(t,n):(By(),Sy(x[o],1,1,(()=>{x[o]=null})),_y(),E=x[b],E?E.p(t,n):(E=x[b]=S[b](t),E.c()),ky(E,1),E.m(I,null))},i(t){w||(ky(r.$$.fragment,t),ky(s.$$.fragment,t),ky(l),ky(d.$$.fragment,t),ky(E),w=!0)},o(t){Sy(r.$$.fragment,t),Sy(s.$$.fragment,t),Sy(l),Sy(d.$$.fragment,t),Sy(E),w=!1},d(t){t&&Rp(e),Ly(r),Ly(s),_[u].d(),Ly(d),x[b].d(),C=!1,Bp(v)}}}function nk(t){let e,n,r,o,i,s,a,c;return r=new dI({props:{expiresAt:t[9].expiresAt,format:"HH:mm"}}),{c(){e=Hp("stat"),n=Hp("h3"),Dy(r.$$.fragment),o=qp(),i=Hp("h6"),i.textContent="wallet",Zp(n,"class","primary svelte-107qq9w"),Zp(i,"class","muted svelte-107qq9w"),Zp(e,"class","flex column center xcenter inside noselect svelte-107qq9w")},m(u,l){Kp(u,e,l),Yp(e,n),$y(r,n,null),Yp(e,o),Yp(e,i),s=!0,a||(c=Jp(e,"click",t[28]),a=!0)},p(t,e){const n={};512&e[0]&&(n.expiresAt=t[9].expiresAt),r.$set(n)},i(t){s||(ky(r.$$.fragment,t),s=!0)},o(t){Sy(r.$$.fragment,t),s=!1},d(t){t&&Rp(e),Ly(r),a=!1,c()}}}function rk(t){let e,n,r;return{c(){e=Hp("stat"),e.innerHTML='<h3 class="muted svelte-107qq9w">--:--</h3> \n        <h6 class="primary svelte-107qq9w">start</h6>',Zp(e,"class","flex column center xcenter outside noselect btn-enter svelte-107qq9w")},m(o,i){Kp(o,e,i),n||(r=Jp(e,"click",t[21]),n=!0)},p:wp,i:wp,o:wp,d(t){t&&Rp(e),n=!1,r()}}}function ok(t){let e,n;return e=new jw({props:{src:t[11]}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p(t,n){const r={};2048&n[0]&&(r.src=t[11]),e.$set(r)},i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function ik(t){let e,n;return e=new Qm({props:{id:"gfx-profile",nofill:!0}}),{c(){Dy(e.$$.fragment)},m(t,r){$y(e,t,r),n=!0},p:wp,i(t){n||(ky(e.$$.fragment,t),n=!0)},o(t){Sy(e.$$.fragment,t),n=!1},d(t){Ly(e,t)}}}function sk(t){let e,n,r,o,i,s,a,c,u=t[1]&&R_(t),l={ctx:t,current:null,token:null,hasCatch:!0,pending:tk,then:z_,catch:q_,error:31,blocks:[,,,]};xy(t[12],l);let h=t[5]&&ek(t);return{c(){e=Hp("root"),u&&u.c(),n=qp(),r=Hp("main"),l.block.c(),o=qp(),h&&h.c(),oy(r,"has-dev",t[1]),oy(r,"has-bar",t[5]),Zp(e,"class",i=Np("view-"+t[0])+" svelte-107qq9w")},m(t,i){Kp(t,e,i),u&&u.m(e,null),Yp(e,n),Yp(e,r),l.block.m(r,l.anchor=null),l.mount=()=>r,l.anchor=null,Yp(e,o),h&&h.m(e,null),s=!0,a||(c=[Jp(K_,"error",uk),Jp(K_,"unhandledrejection",ck)],a=!0)},p(o,a){(t=o)[1]?u?(u.p(t,a),2&a[0]&&ky(u,1)):(u=R_(t),u.c(),ky(u,1),u.m(e,n)):u&&(By(),Sy(u,1,1,(()=>{u=null})),_y()),Qy(l,t,a),2&a[0]&&oy(r,"has-dev",t[1]),32&a[0]&&oy(r,"has-bar",t[5]),t[5]?h?(h.p(t,a),32&a[0]&&ky(h,1)):(h=ek(t),h.c(),ky(h,1),h.m(e,null)):h&&(By(),Sy(h,1,1,(()=>{h=null})),_y()),(!s||1&a[0]&&i!==(i=Np("view-"+t[0])+" svelte-107qq9w"))&&Zp(e,"class",i)},i(t){s||(ky(u),ky(l.block),ky(h),s=!0)},o(t){Sy(u);for(let t=0;t<3;t+=1){Sy(l.blocks[t])}Sy(h),s=!1},d(t){t&&Rp(e),u&&u.d(),l.block.d(),l.token=null,l=null,h&&h.d(),a=!1,Bp(c)}}}function ak(){const t=document.documentElement;t.dataset.theme?delete t.dataset.theme:t.dataset.theme="dark"}function ck(t){console.error("[Unhandled Rejection]",t)}function uk(t){console.error("[GlobError]",t)}function lk(t,e,r){let o,i,s,a,c,u,l,h,f,d,g,A;Dp(t,k_,(t=>r(0,o=t))),Dp(t,gm,(t=>r(2,s=t))),Dp(t,x_,(t=>r(6,l=t))),Dp(t,Q_,(t=>r(7,h=t))),Dp(t,S_,(t=>r(8,f=t))),Dp(t,Am,(t=>r(11,A=t)));const p=pm(),y=jy(n.exports.gate(n.exports.init(0,n.exports.mute(Vy.$connections(),(t=>t.length)))));Dp(t,y,(t=>r(3,a=t)));const m=Ky([gm,k_],(([t,e])=>t.hasKey&&t.hasProfile&&"shop"!==e));Dp(t,m,(t=>r(5,u=t)));const I=Ky(k_,(t=>"profile"===t));Dp(t,I,(t=>r(1,i=t)));const b=Yy(!1);Dp(t,b,(t=>r(4,c=t)));const E=jy(n.exports.mute(n.exports.combine(Vy.$vibes(),Vy.$chats()),(([t,e])=>t.reduce(((t,e)=>"waiting_local"===e.state?t+1:t),0)+e.reduce(((t,e)=>e.myTurn?t+1:t),0))));Dp(t,E,(t=>r(10,g=t)));const w=Jy();Dp(t,w,(t=>r(9,d=t)));const C=JSON.parse(window.localStorage.getItem("auto_swarm"));cy((()=>S_.subscribe((()=>{window.document.scrollingElement.scrollTo({top:0,left:0})}))));return[o,i,s,a,c,u,l,h,f,d,g,A,p,y,m,I,b,E,w,async function(){L_("/devel")},async function(){await Vy.store.reload(),console.info("Internal cache`s cleared")},function(){!async function(){if(!n.exports.get(am))return L_("/keygen");if(!n.exports.get(um))return L_("/profile");if(!n.exports.get(rm)){const t=await Gy.readIdentity(),e=await Gy.readProfile();await Vy.register(e,t),om(!0)}Im()}()},C,function(){window.localStorage.setItem("auto_swarm",!C),window.location.reload()},()=>Pp(b,c=!0,c),()=>Em(!1),()=>L_("pub"),()=>s.entered&&L_("shop"),()=>L_("wallet"),()=>s.entered&&L_("msgs"),()=>L_("profile")]}var hk={exports:{}};!function(t,e){t.exports=function(){var t,e,n=1e3,r=6e4,o=36e5,i=864e5,s=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,a=31536e6,c=2592e6,u=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:a,months:c,days:i,hours:o,minutes:r,seconds:n,milliseconds:1,weeks:6048e5},h=function(t){return t instanceof m},f=function(t,e,n){return new m(t,n,e.$l)},d=function(t){return e.p(t)+"s"},g=function(t){return t<0},A=function(t){return g(t)?Math.ceil(t):Math.floor(t)},p=function(t){return Math.abs(t)},y=function(t,e){return t?g(t)?{negative:!0,format:""+p(t)+e}:{negative:!1,format:""+t+e}:{negative:!1,format:""}},m=function(){function g(t,e,n){var r=this;if(this.$d={},this.$l=n,void 0===t&&(this.$ms=0,this.parseFromMilliseconds()),e)return f(t*l[d(e)],this);if("number"==typeof t)return this.$ms=t,this.parseFromMilliseconds(),this;if("object"==typeof t)return Object.keys(t).forEach((function(e){r.$d[d(e)]=t[e]})),this.calMilliseconds(),this;if("string"==typeof t){var o=t.match(u);if(o){var i=o.slice(2).map((function(t){return null!=t?Number(t):0}));return this.$d.years=i[0],this.$d.months=i[1],this.$d.weeks=i[2],this.$d.days=i[3],this.$d.hours=i[4],this.$d.minutes=i[5],this.$d.seconds=i[6],this.calMilliseconds(),this}}return this}var p=g.prototype;return p.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce((function(e,n){return e+(t.$d[n]||0)*l[n]}),0)},p.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=A(t/a),t%=a,this.$d.months=A(t/c),t%=c,this.$d.days=A(t/i),t%=i,this.$d.hours=A(t/o),t%=o,this.$d.minutes=A(t/r),t%=r,this.$d.seconds=A(t/n),t%=n,this.$d.milliseconds=t},p.toISOString=function(){var t=y(this.$d.years,"Y"),e=y(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var r=y(n,"D"),o=y(this.$d.hours,"H"),i=y(this.$d.minutes,"M"),s=this.$d.seconds||0;this.$d.milliseconds&&(s+=this.$d.milliseconds/1e3);var a=y(s,"S"),c=t.negative||e.negative||r.negative||o.negative||i.negative||a.negative,u=o.format||i.format||a.format?"T":"",l=(c?"-":"")+"P"+t.format+e.format+r.format+u+o.format+i.format+a.format;return"P"===l||"-P"===l?"P0D":l},p.toJSON=function(){return this.toISOString()},p.format=function(t){var n=t||"YYYY-MM-DDTHH:mm:ss",r={Y:this.$d.years,YY:e.s(this.$d.years,2,"0"),YYYY:e.s(this.$d.years,4,"0"),M:this.$d.months,MM:e.s(this.$d.months,2,"0"),D:this.$d.days,DD:e.s(this.$d.days,2,"0"),H:this.$d.hours,HH:e.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:e.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:e.s(this.$d.seconds,2,"0"),SSS:e.s(this.$d.milliseconds,3,"0")};return n.replace(s,(function(t,e){return e||String(r[t])}))},p.as=function(t){return this.$ms/l[d(t)]},p.get=function(t){var e=this.$ms,n=d(t);return"milliseconds"===n?e%=1e3:e="weeks"===n?A(e/l[n]):this.$d[n],0===e?0:e},p.add=function(t,e,n){var r;return r=e?t*l[d(e)]:h(t)?t.$ms:f(t,this).$ms,f(this.$ms+r*(n?-1:1),this)},p.subtract=function(t,e){return this.add(t,e,!0)},p.locale=function(t){var e=this.clone();return e.$l=t,e},p.clone=function(){return f(this.$ms,this)},p.humanize=function(e){return t().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},p.milliseconds=function(){return this.get("milliseconds")},p.asMilliseconds=function(){return this.as("milliseconds")},p.seconds=function(){return this.get("seconds")},p.asSeconds=function(){return this.as("seconds")},p.minutes=function(){return this.get("minutes")},p.asMinutes=function(){return this.as("minutes")},p.hours=function(){return this.get("hours")},p.asHours=function(){return this.as("hours")},p.days=function(){return this.get("days")},p.asDays=function(){return this.as("days")},p.weeks=function(){return this.get("weeks")},p.asWeeks=function(){return this.as("weeks")},p.months=function(){return this.get("months")},p.asMonths=function(){return this.as("months")},p.years=function(){return this.get("years")},p.asYears=function(){return this.as("years")},g}();return function(n,r,o){t=o,e=o().$utils(),o.duration=function(t,e){var n=o.locale();return f(t,{$l:n},e)},o.isDuration=h;var i=r.prototype.add,s=r.prototype.subtract;r.prototype.add=function(t,e){return h(t)&&(t=t.asMilliseconds()),i.bind(this)(t,e)},r.prototype.subtract=function(t,e){return h(t)&&(t=t.asMilliseconds()),s.bind(this)(t,e)}}}()}(hk);var fk=hk.exports;cI.extend(fk);return new class extends Fy{constructor(t){super(),Oy(this,t,lk,sk,kp,{},null,[-1,-1])}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
