var app=function(){"use strict";var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(t){var e=t.default;if("function"==typeof e){var n=function(){return e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(n,e,r.get?r:{enumerable:!0,get:function(){return t[e]}})})),n}var n={exports:{}};!function(t){const e=Symbol.for("piconeuro:Error");t.exports={ERROR:e,get:function(t){let e=null;return t((t=>{e=t}))(),e},next:async function(t,e=1,n=!1){let o=null;n&&(t=r(t,n));for await(const n of c(t,e+1))o=n;return o},until:async function(t,e,n=-1){let r,o;const i=new Promise(((t,e)=>{r=t,o=e}));let s=null;n>0&&(s=setTimeout((()=>{o(new Error("until($n) timed out"))}),n));const a=t((t=>{e(t)&&(s&&clearTimeout(s),r(t))}));return i.finally(a),i},write:a,writable:a,notEqual:i,notEqualDeep:s,memo:function(t){let e;const n=new Set;let r=null;return function(i){return n.add(i),r?i(e):r=t(o),()=>{n.delete(i),n.length||(r&&r(),r=null)}};function o(t){e=t;for(const e of n)e(t)}},mute:function(t,n){if("function"!=typeof n)throw new Error("expected a mutation function");return function(r){let o=Promise.resolve(0);return t((t=>{const i=n(t);i&&"function"==typeof i.then&&"function"==typeof i.catch?o=o.then((()=>i.then(r).catch((t=>{console.error("n:mute() failed: ",t),r(e,t)})))):r(i)}))}},init:function(t,e){return function(n){let r=!1,i=function(){},s=!1;return"function"==typeof e&&(i=e((t=>{s=!0,r||n(t)}))),s||n(o(t)),()=>{r=!0,i()}}},when:function(t){if(!t||"function"!=typeof t.then)throw new Error("Expected a Promise");return function(n){return t.then(n).catch((t=>{console.error("n:when() failed: ",t),n(e,t)})),function(){}}},combine:function(...t){if(!Array.isArray(t)||!t.length)throw new Error("A list of neurons is required");const e=[];if(1===t.length&&"function"!=typeof t[0]){const n=t[0];t=[];for(const r in n)t.push(n[r]),e.push(r)}return function(n){if("function"!=typeof n)throw new Error("Derivation function required");const r=[],o=[];let i=t.length;const s=[];for(let e=0;e<t.length;e++)s.push(t[e](a.bind(null,e)));return()=>{for(const t of s)t()};function a(t,s){r[t]||(r[t]=!0,i--),o[t]=s,i||(e.length?n(o.reduce(((t,n,r)=>(t[e[r]]=n,t)),{})):n(o))}}},isSync:async function(t,e=100){let n=!1,r=!1,o=()=>{n=!0};t((()=>o()))();let i=null;const s=new Promise((t=>{i=t}));o=()=>{r=!0,i()};let a=setTimeout((()=>{a=null,i()}),e);if(await s,a)clearTimeout(a);else if(!n&&!r)throw new Error("Neuron did not fire during grace period");return n&&!r},_isSync:function(t){let e=!1,n=()=>{e=!0};return t((()=>n()))(),n=()=>{throw new Error("NeuronNotSync, subscription invoked after unsubscribe()")},e},gate:function(t,e=!1){const n="function"==typeof e?e:e?i:s;return function(e){let r,i=!0;return t((t=>{const s=n(t,r);(i||s)&&(i=!1,r=o(t),e(t))}))}},settle:function(t,e=10,n=!1){return function(r){let o,i,s=!0;const a=t((t=>{o=t,n&&s&&(s=!1,r(o)),i&&clearTimeout(i),i=setTimeout((()=>{i=null,r(o)}),e)}));return()=>{a&&a(),i&&clearTimeout(i)}}},iter:c,nfo:r};let n=0;function r(e,r){if(!t.exports.V)return e;const o=n++;r||(r=`NFO${a(o)}`);const i=console.info.bind(null,r);let s=0;return t=>{let n=0;const r=i.bind(null,`SYN${a(s++)}`);r(`>>${a(n)}>> connected`);const o=e((e=>{r(`!!${a(n++)}!! `,e),t(e)}));return()=>{o(),r(`<<${a(n)}<< disconnected`)}};function a(t,e=2){return(t+"").padStart(e,"0")}}function o(t){return Array.isArray(t)?[...t]:"object"==typeof t&&null!==t?{...t}:t}function i(t,e){return Array.isArray(t)&&Array.isArray(e)?e.length!==t.length||!!t.find(((t,n)=>e[n]!==t)):"object"==typeof t&&"object"==typeof e&&null!==t&&null!==e?(n=Object.keys(t),r=Object.keys(e).length,!(n.length===r&&!n.find((n=>t[n]!==e[n])))):t!==e;var n,r}function s(t,e){return Array.isArray(t)&&Array.isArray(e)?e.length!==t.length||!!t.find(((t,n)=>s(e[n],t))):"object"==typeof t&&"object"==typeof e&&null!==t&&null!==e?(n=Object.keys(t),r=Object.keys(e).length,!(n.length===r&&!n.find((n=>s(t[n],e[n]))))):t!==e;var n,r}function a(t){const e=new Set;return[function(n){return e.add(n),n(t),()=>{e.delete(n)}},function(n){if(i(t,n)){t=n;for(const t of e)t(n)}return n}]}async function*c(t,e=5){const n=[],r=[];s();let o=0;const i=t((t=>{(-1===e||++o<e)&&s();const r=n.shift();r&&r(t)}));for(;r.length;){const t=r.shift(),e=await t;yield e}function s(){let t=null;const e=new Promise((e=>{t=e}));n.push(t),r.push(e)}i()}t.exports.V=1}(n);for(var r={},o={byteLength:function(t){var e=f(t),n=e[0],r=e[1];return 3*(n+r)/4-r},toByteArray:function(t){var e,n,r=f(t),o=r[0],i=r[1],s=new c(function(t,e,n){return 3*(e+n)/4-n}(0,o,i)),u=0,l=i>0?o-4:o;for(n=0;n<l;n+=4)e=a[t.charCodeAt(n)]<<18|a[t.charCodeAt(n+1)]<<12|a[t.charCodeAt(n+2)]<<6|a[t.charCodeAt(n+3)],s[u++]=e>>16&255,s[u++]=e>>8&255,s[u++]=255&e;2===i&&(e=a[t.charCodeAt(n)]<<2|a[t.charCodeAt(n+1)]>>4,s[u++]=255&e);1===i&&(e=a[t.charCodeAt(n)]<<10|a[t.charCodeAt(n+1)]<<4|a[t.charCodeAt(n+2)]>>2,s[u++]=e>>8&255,s[u++]=255&e);return s},fromByteArray:function(t){for(var e,n=t.length,r=n%3,o=[],i=16383,a=0,c=n-r;a<c;a+=i)o.push(g(t,a,a+i>c?c:a+i));1===r?(e=t[n-1],o.push(s[e>>2]+s[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(s[e>>10]+s[e>>4&63]+s[e<<2&63]+"="));return o.join("")}},s=[],a=[],c="undefined"!=typeof Uint8Array?Uint8Array:Array,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l=0,h=u.length;l<h;++l)s[l]=u[l],a[u.charCodeAt(l)]=l;function f(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function g(t,e,n){for(var r,o,i=[],a=e;a<n;a+=3)r=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),i.push(s[(o=r)>>18&63]+s[o>>12&63]+s[o>>6&63]+s[63&o]);return i.join("")}a["-".charCodeAt(0)]=62,a["_".charCodeAt(0)]=63;var d={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,n,r,o){var i,s,a=8*o-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?o-1:0,f=n?-1:1,g=t[e+h];for(h+=f,i=g&(1<<-l)-1,g>>=-l,l+=a;l>0;i=256*i+t[e+h],h+=f,l-=8);for(s=i&(1<<-l)-1,i>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=f,l-=8);if(0===i)i=1-u;else{if(i===c)return s?NaN:1/0*(g?-1:1);s+=Math.pow(2,r),i-=u}return(g?-1:1)*s*Math.pow(2,i-r)},write:function(t,e,n,r,o,i){var s,a,c,u=8*i-o-1,l=(1<<u)-1,h=l>>1,f=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,g=r?0:i-1,d=r?1:-1,A=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),(e+=s+h>=1?f/c:f*Math.pow(2,1-h))*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*c-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[n+g]=255&a,g+=d,a/=256,o-=8);for(s=s<<o|a,u+=o;u>0;t[n+g]=255&s,g+=d,s/=256,u-=8);t[n+g-d]|=128*A}};
/*!
	 * The buffer module from node.js, for the browser.
	 *
	 * @author   Feross Aboukhadijeh <https://feross.org>
	 * @license  MIT
	 */
!function(t){const e=o,n=d,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=function(t){+t!=t&&(t=0);return a.alloc(+t)},t.INSPECT_MAX_BYTES=50;const i=2147483647;function s(t){if(t>i)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,a.prototype),e}function a(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return l(t)}return c(t,e,n)}function c(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!a.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|A(t,e);let r=s(n);const o=r.write(t,e);o!==n&&(r=r.slice(0,o));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(z(t,Uint8Array)){const e=new Uint8Array(t);return f(e.buffer,e.byteOffset,e.byteLength)}return h(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(z(t,ArrayBuffer)||t&&z(t.buffer,ArrayBuffer))return f(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(z(t,SharedArrayBuffer)||t&&z(t.buffer,SharedArrayBuffer)))return f(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return a.from(r,e,n);const o=function(t){if(a.isBuffer(t)){const e=0|g(t.length),n=s(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||J(t.length)?s(0):h(t);if("Buffer"===t.type&&Array.isArray(t.data))return h(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return a.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function l(t){return u(t),s(t<0?0:0|g(t))}function h(t){const e=t.length<0?0:0|g(t.length),n=s(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function f(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,a.prototype),r}function g(t){if(t>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|t}function A(t,e){if(a.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||z(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(o)return r?-1:V(t).length;e=(""+e).toLowerCase(),o=!0}}function p(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return Q(this,e,n);case"utf8":case"utf-8":return _(this,e,n);case"ascii":return x(this,e,n);case"latin1":case"binary":return S(this,e,n);case"base64":return v(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return M(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function I(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),J(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=a.from(e,r)),a.isBuffer(e))return 0===e.length?-1:m(t,e,n,r,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):m(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function m(t,e,n,r,o){let i,s=1,a=t.length,c=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,c/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let r=-1;for(i=n;i<a;i++)if(u(t,i)===u(e,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===c)return r*s}else-1!==r&&(i-=i-r),r=-1}else for(n+c>a&&(n=a-c),i=n;i>=0;i--){let n=!0;for(let r=0;r<c;r++)if(u(t,i+r)!==u(e,r)){n=!1;break}if(n)return i}return-1}function E(t,e,n,r){n=Number(n)||0;const o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=e.length;let s;for(r>i/2&&(r=i/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(J(r))return s;t[n+s]=r}return s}function w(t,e,n,r){return q(V(e,t.length-n),t,n,r)}function b(t,e,n,r){return q(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function C(t,e,n,r){return q(G(e),t,n,r)}function B(t,e,n,r){return q(function(t,e){let n,r,o;const i=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function v(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function _(t,e,n){n=Math.min(t.length,n);const r=[];let o=e;for(;o<n;){const e=t[o];let i=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=n){let n,r,a,c;switch(s){case 1:e<128&&(i=e);break;case 2:n=t[o+1],128==(192&n)&&(c=(31&e)<<6|63&n,c>127&&(i=c));break;case 3:n=t[o+1],r=t[o+2],128==(192&n)&&128==(192&r)&&(c=(15&e)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(i=c));break;case 4:n=t[o+1],r=t[o+2],a=t[o+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(c=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(i=c))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=s}return function(t){const e=t.length;if(e<=k)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=k));return n}(r)}t.kMaxLength=i,a.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),a.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}}),a.poolSize=8192,a.from=function(t,e,n){return c(t,e,n)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array),a.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?s(t):void 0!==e?"string"==typeof n?s(t).fill(e,n):s(t).fill(e):s(t)}(t,e,n)},a.allocUnsafe=function(t){return l(t)},a.allocUnsafeSlow=function(t){return l(t)},a.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==a.prototype},a.compare=function(t,e){if(z(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),z(e,Uint8Array)&&(e=a.from(e,e.offset,e.byteLength)),!a.isBuffer(t)||!a.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},a.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return a.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=a.allocUnsafe(e);let o=0;for(n=0;n<t.length;++n){let e=t[n];if(z(e,Uint8Array))o+e.length>r.length?(a.isBuffer(e)||(e=a.from(e)),e.copy(r,o)):Uint8Array.prototype.set.call(r,e,o);else{if(!a.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,o)}o+=e.length}return r},a.byteLength=A,a.prototype._isBuffer=!0,a.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},a.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},a.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},a.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?_(this,0,t):p.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(t){if(!a.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===a.compare(this,t)},a.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},r&&(a.prototype[r]=a.prototype.inspect),a.prototype.compare=function(t,e,n,r,o){if(z(t,Uint8Array)&&(t=a.from(t,t.offset,t.byteLength)),!a.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;let i=(o>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0);const c=Math.min(i,s),u=this.slice(r,o),l=t.slice(e,n);for(let t=0;t<c;++t)if(u[t]!==l[t]){i=u[t],s=l[t];break}return i<s?-1:s<i?1:0},a.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},a.prototype.indexOf=function(t,e,n){return I(this,t,e,n,!0)},a.prototype.lastIndexOf=function(t,e,n){return I(this,t,e,n,!1)},a.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return E(this,t,e,n);case"utf8":case"utf-8":return w(this,t,e,n);case"ascii":case"latin1":case"binary":return b(this,t,e,n);case"base64":return C(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const k=4096;function x(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function S(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function Q(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=e;r<n;++r)o+=W[t[r]];return o}function M(t,e,n){const r=t.slice(e,n);let o="";for(let t=0;t<r.length-1;t+=2)o+=String.fromCharCode(r[t]+256*r[t+1]);return o}function D(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function T(t,e,n,r,o,i){if(!a.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function L(t,e,n,r,o){K(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function $(t,e,n,r,o){K(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n+7]=i,i>>=8,t[n+6]=i,i>>=8,t[n+5]=i,i>>=8,t[n+4]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function U(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function O(t,e,r,o,i){return e=+e,r>>>=0,i||U(t,0,r,4),n.write(t,e,r,o,23,4),r+4}function F(t,e,r,o,i){return e=+e,r>>>=0,i||U(t,0,r,8),n.write(t,e,r,o,52,8),r+8}a.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,a.prototype),r},a.prototype.readUintLE=a.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return r},a.prototype.readUintBE=a.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=this[t+--e],o=1;for(;e>0&&(o*=256);)r+=this[t+--e]*o;return r},a.prototype.readUint8=a.prototype.readUInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),this[t]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]|this[t+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(t,e){return t>>>=0,e||D(t,2,this.length),this[t]<<8|this[t+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},a.prototype.readBigUInt64LE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(o)<<BigInt(32))})),a.prototype.readBigUInt64BE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(o)})),a.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},a.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||D(t,e,this.length);let r=e,o=1,i=this[t+--r];for(;r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},a.prototype.readInt8=function(t,e){return t>>>=0,e||D(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},a.prototype.readInt16LE=function(t,e){t>>>=0,e||D(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt16BE=function(t,e){t>>>=0,e||D(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},a.prototype.readInt32LE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},a.prototype.readInt32BE=function(t,e){return t>>>=0,e||D(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},a.prototype.readBigInt64LE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),a.prototype.readBigInt64BE=X((function(t){R(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||j(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),a.prototype.readFloatLE=function(t,e){return t>>>=0,e||D(t,4,this.length),n.read(this,t,!0,23,4)},a.prototype.readFloatBE=function(t,e){return t>>>=0,e||D(t,4,this.length),n.read(this,t,!1,23,4)},a.prototype.readDoubleLE=function(t,e){return t>>>=0,e||D(t,8,this.length),n.read(this,t,!0,52,8)},a.prototype.readDoubleBE=function(t,e){return t>>>=0,e||D(t,8,this.length),n.read(this,t,!1,52,8)},a.prototype.writeUintLE=a.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){T(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){T(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},a.prototype.writeUint8=a.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,1,255,0),this[e]=255&t,e+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeBigUInt64LE=X((function(t,e=0){return L(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeBigUInt64BE=X((function(t,e=0){return $(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),a.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);T(this,t,e,n,r-1,-r)}let o=0,i=1,s=0;for(this[e]=255&t;++o<n&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},a.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);T(this,t,e,n,r-1,-r)}let o=n-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},a.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},a.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},a.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},a.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},a.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||T(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},a.prototype.writeBigInt64LE=X((function(t,e=0){return L(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeBigInt64BE=X((function(t,e=0){return $(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),a.prototype.writeFloatLE=function(t,e,n){return O(this,t,e,!0,n)},a.prototype.writeFloatBE=function(t,e,n){return O(this,t,e,!1,n)},a.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},a.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},a.prototype.copy=function(t,e,n,r){if(!a.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const o=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),o},a.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!a.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{const i=a.isBuffer(t)?t:a.from(t,r),s=i.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=i[o%s]}return this};const N={};function P(t,e,n){N[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function Y(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function K(t,e,n,r,o,i){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let o;throw o=i>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new N.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,n){R(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||j(e,t.length-(n+1))}(r,o,i)}function R(t,e){if("number"!=typeof t)throw new N.ERR_INVALID_ARG_TYPE(e,"number",t)}function j(t,e,n){if(Math.floor(t)!==t)throw R(t,n),new N.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new N.ERR_BUFFER_OUT_OF_BOUNDS;throw new N.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}P("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),P("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),P("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=Y(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=Y(o)),o+="n"),r+=` It must be ${e}. Received ${o}`,r}),RangeError);const H=/[^+/0-9A-Za-z-_]/g;function V(t,e){let n;e=e||1/0;const r=t.length;let o=null;const i=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function G(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function q(t,e,n,r){let o;for(o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function z(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function J(t){return t!=t}const W=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)e[r+o]=t[n]+t[o]}return e}();function X(t){return"undefined"==typeof BigInt?Z:t}function Z(){throw new Error("BigInt not supported")}}(r);var A={},p={},y={supports:function(...t){const e=t.reduce(((t,e)=>Object.assign(t,e)),{});return Object.assign(e,{snapshots:e.snapshots||!1,permanence:e.permanence||!1,seek:e.seek||!1,clear:e.clear||!1,getMany:e.getMany||!1,keyIterator:e.keyIterator||!1,valueIterator:e.valueIterator||!1,iteratorNextv:e.iteratorNextv||!1,iteratorAll:e.iteratorAll||!1,status:e.status||!1,createIfMissing:e.createIfMissing||!1,errorIfExists:e.errorIfExists||!1,deferredOpen:e.deferredOpen||!1,promises:e.promises||!1,streams:e.streams||!1,encodings:Object.assign({},e.encodings),events:Object.assign({},e.events),additionalMethods:Object.assign({},e.additionalMethods)})}},I={},m=class extends Error{constructor(t,e){super(t||""),"object"==typeof e&&null!==e&&(e.code&&(this.code=String(e.code)),e.expected&&(this.expected=!0),e.transient&&(this.transient=!0),e.cause&&(this.cause=e.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}},E={};let w=null;var b=function(){return null===w&&(w={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),w},C={},B={};const v=m,_=new Set(["buffer","view","utf8"]);B.Encoding=class{constructor(t){if(this.encode=t.encode||this.encode,this.decode=t.decode||this.decode,this.name=t.name||this.name,this.format=t.format||this.format,"function"!=typeof this.encode)throw new TypeError("The 'encode' property must be a function");if("function"!=typeof this.decode)throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),"string"!=typeof this.name||""===this.name)throw new TypeError("The 'name' property must be a string");if("string"!=typeof this.format||!_.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");t.createViewTranscoder&&(this.createViewTranscoder=t.createViewTranscoder),t.createBufferTranscoder&&(this.createBufferTranscoder=t.createBufferTranscoder),t.createUTF8Transcoder&&(this.createUTF8Transcoder=t.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new v(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new v(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new v(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};const{Buffer:k}=r||{},{Encoding:x}=B,S=b;class Q extends x{constructor(t){super({...t,format:"buffer"})}createViewTranscoder(){return new M({encode:this.encode,decode:t=>this.decode(k.from(t.buffer,t.byteOffset,t.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}}class M extends x{constructor(t){super({...t,format:"view"})}createBufferTranscoder(){return new Q({encode:t=>{const e=this.encode(t);return k.from(e.buffer,e.byteOffset,e.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}}C.BufferFormat=Q,C.ViewFormat=M,C.UTF8Format=class extends x{constructor(t){super({...t,format:"utf8"})}createBufferTranscoder(){return new Q({encode:t=>k.from(this.encode(t),"utf8"),decode:t=>this.decode(t.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){const{textEncoder:t,textDecoder:e}=S();return new M({encode:e=>t.encode(this.encode(e)),decode:t=>this.decode(e.decode(t)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};const{Buffer:D}=r||{Buffer:{isBuffer:()=>!1}},{textEncoder:T,textDecoder:L}=b(),{BufferFormat:$,ViewFormat:U,UTF8Format:O}=C,F=t=>t;E.utf8=new O({encode:function(t){return D.isBuffer(t)?t.toString("utf8"):ArrayBuffer.isView(t)?L.decode(t):String(t)},decode:F,name:"utf8",createViewTranscoder(){return new U({encode:function(t){return ArrayBuffer.isView(t)?t:T.encode(t)},decode:function(t){return L.decode(t)},name:`${this.name}+view`})},createBufferTranscoder(){return new $({encode:function(t){return D.isBuffer(t)?t:ArrayBuffer.isView(t)?D.from(t.buffer,t.byteOffset,t.byteLength):D.from(String(t),"utf8")},decode:function(t){return t.toString("utf8")},name:`${this.name}+buffer`})}}),E.json=new O({encode:JSON.stringify,decode:JSON.parse,name:"json"}),E.buffer=new $({encode:function(t){return D.isBuffer(t)?t:ArrayBuffer.isView(t)?D.from(t.buffer,t.byteOffset,t.byteLength):D.from(String(t),"utf8")},decode:F,name:"buffer",createViewTranscoder(){return new U({encode:function(t){return ArrayBuffer.isView(t)?t:D.from(String(t),"utf8")},decode:function(t){return D.from(t.buffer,t.byteOffset,t.byteLength)},name:`${this.name}+view`})}}),E.view=new U({encode:function(t){return ArrayBuffer.isView(t)?t:T.encode(t)},decode:F,name:"view",createBufferTranscoder(){return new $({encode:function(t){return D.isBuffer(t)?t:ArrayBuffer.isView(t)?D.from(t.buffer,t.byteOffset,t.byteLength):D.from(String(t),"utf8")},decode:F,name:`${this.name}+buffer`})}}),E.hex=new $({encode:function(t){return D.isBuffer(t)?t:D.from(String(t),"hex")},decode:function(t){return t.toString("hex")},name:"hex"}),E.base64=new $({encode:function(t){return D.isBuffer(t)?t:D.from(String(t),"base64")},decode:function(t){return t.toString("base64")},name:"base64"});const N=m,P=E,{Encoding:Y}=B,{BufferFormat:K,ViewFormat:R,UTF8Format:j}=C,H=Symbol("formats"),V=Symbol("encodings"),G=new Set(["buffer","view","utf8"]);I.Transcoder=class{constructor(t){if(!Array.isArray(t))throw new TypeError("The first argument 'formats' must be an array");if(!t.every((t=>G.has(t))))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'");this[V]=new Map,this[H]=new Set(t);for(const t in P)try{this.encoding(t)}catch(t){if("LEVEL_ENCODING_NOT_SUPPORTED"!==t.code)throw t}}encodings(){return Array.from(new Set(this[V].values()))}encoding(t){let e=this[V].get(t);if(void 0===e){if("string"==typeof t&&""!==t){if(e=z[t],!e)throw new N(`Encoding '${t}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if("object"!=typeof t||null===t)throw new TypeError("First argument 'encoding' must be a string or object");e=function(t){if(t instanceof Y)return t;const e="type"in t&&"string"==typeof t.type?t.type:void 0,n=t.name||e||"anonymous-"+J++;switch(function(t){return"format"in t&&void 0!==t.format?t.format:"buffer"in t&&"boolean"==typeof t.buffer?t.buffer?"buffer":"utf8":"code"in t&&Number.isInteger(t.code)?"view":"buffer"}(t)){case"view":return new R({...t,name:n});case"utf8":return new j({...t,name:n});case"buffer":return new K({...t,name:n});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}(t)}const{name:n,format:r}=e;if(!this[H].has(r))if(this[H].has("view"))e=e.createViewTranscoder();else if(this[H].has("buffer"))e=e.createBufferTranscoder();else{if(!this[H].has("utf8"))throw new N(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});e=e.createUTF8Transcoder()}for(const r of[t,n,e.name,e.commonName])this[V].set(r,e)}return e}};const q={binary:P.buffer,"utf-8":P.utf8},z={...P,...q};let J=0;var W,X={exports:{}},Z="object"==typeof Reflect?Reflect:null,tt=Z&&"function"==typeof Z.apply?Z.apply:function(t,e,n){return Function.prototype.apply.call(t,e,n)};W=Z&&"function"==typeof Z.ownKeys?Z.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var et=Number.isNaN||function(t){return t!=t};function nt(){nt.init.call(this)}X.exports=nt,X.exports.once=function(t,e){return new Promise((function(n,r){function o(n){t.removeListener(e,i),r(n)}function i(){"function"==typeof t.removeListener&&t.removeListener("error",o),n([].slice.call(arguments))}ft(t,e,i,{once:!0}),"error"!==e&&function(t,e,n){"function"==typeof t.on&&ft(t,"error",e,n)}(t,o,{once:!0})}))},nt.EventEmitter=nt,nt.prototype._events=void 0,nt.prototype._eventsCount=0,nt.prototype._maxListeners=void 0;var rt=10;function ot(t){if("function"!=typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function it(t){return void 0===t._maxListeners?nt.defaultMaxListeners:t._maxListeners}function st(t,e,n,r){var o,i,s,a;if(ot(n),void 0===(i=t._events)?(i=t._events=Object.create(null),t._eventsCount=0):(void 0!==i.newListener&&(t.emit("newListener",e,n.listener?n.listener:n),i=t._events),s=i[e]),void 0===s)s=i[e]=n,++t._eventsCount;else if("function"==typeof s?s=i[e]=r?[n,s]:[s,n]:r?s.unshift(n):s.push(n),(o=it(t))>0&&s.length>o&&!s.warned){s.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=t,c.type=e,c.count=s.length,a=c,console&&console.warn&&console.warn(a)}return t}function at(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function ct(t,e,n){var r={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},o=at.bind(r);return o.listener=n,r.wrapFn=o,o}function ut(t,e,n){var r=t._events;if(void 0===r)return[];var o=r[e];return void 0===o?[]:"function"==typeof o?n?[o.listener||o]:[o]:n?function(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}(o):ht(o,o.length)}function lt(t){var e=this._events;if(void 0!==e){var n=e[t];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function ht(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t[r];return n}function ft(t,e,n,r){if("function"==typeof t.on)r.once?t.once(e,n):t.on(e,n);else{if("function"!=typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function o(i){r.once&&t.removeEventListener(e,o),n(i)}))}}Object.defineProperty(nt,"defaultMaxListeners",{enumerable:!0,get:function(){return rt},set:function(t){if("number"!=typeof t||t<0||et(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");rt=t}}),nt.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},nt.prototype.setMaxListeners=function(t){if("number"!=typeof t||t<0||et(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},nt.prototype.getMaxListeners=function(){return it(this)},nt.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e.push(arguments[n]);var r="error"===t,o=this._events;if(void 0!==o)r=r&&void 0===o.error;else if(!r)return!1;if(r){var i;if(e.length>0&&(i=e[0]),i instanceof Error)throw i;var s=new Error("Unhandled error."+(i?" ("+i.message+")":""));throw s.context=i,s}var a=o[t];if(void 0===a)return!1;if("function"==typeof a)tt(a,this,e);else{var c=a.length,u=ht(a,c);for(n=0;n<c;++n)tt(u[n],this,e)}return!0},nt.prototype.addListener=function(t,e){return st(this,t,e,!1)},nt.prototype.on=nt.prototype.addListener,nt.prototype.prependListener=function(t,e){return st(this,t,e,!0)},nt.prototype.once=function(t,e){return ot(e),this.on(t,ct(this,t,e)),this},nt.prototype.prependOnceListener=function(t,e){return ot(e),this.prependListener(t,ct(this,t,e)),this},nt.prototype.removeListener=function(t,e){var n,r,o,i,s;if(ot(e),void 0===(r=this._events))return this;if(void 0===(n=r[t]))return this;if(n===e||n.listener===e)0==--this._eventsCount?this._events=Object.create(null):(delete r[t],r.removeListener&&this.emit("removeListener",t,n.listener||e));else if("function"!=typeof n){for(o=-1,i=n.length-1;i>=0;i--)if(n[i]===e||n[i].listener===e){s=n[i].listener,o=i;break}if(o<0)return this;0===o?n.shift():function(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}(n,o),1===n.length&&(r[t]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",t,s||e)}return this},nt.prototype.off=nt.prototype.removeListener,nt.prototype.removeAllListeners=function(t){var e,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[t]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[t]),this;if(0===arguments.length){var o,i=Object.keys(n);for(r=0;r<i.length;++r)"removeListener"!==(o=i[r])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(e=n[t]))this.removeListener(t,e);else if(void 0!==e)for(r=e.length-1;r>=0;r--)this.removeListener(t,e[r]);return this},nt.prototype.listeners=function(t){return ut(this,t,!0)},nt.prototype.rawListeners=function(t){return ut(this,t,!1)},nt.listenerCount=function(t,e){return"function"==typeof t.listenerCount?t.listenerCount(e):lt.call(t,e)},nt.prototype.listenerCount=lt,nt.prototype.eventNames=function(){return this._eventsCount>0?W(this._events):[]};var gt={},dt="function"==typeof queueMicrotask?queueMicrotask:t=>Promise.resolve().then(t);gt.fromCallback=function(t,e){if(void 0===t){var n=new Promise((function(e,n){t=function(t,r){t?n(t):e(r)}}));t[void 0!==e?e:"promise"]=n}else if("function"!=typeof t)throw new TypeError("Callback must be a function");return t},gt.fromPromise=function(t,e){if(void 0===e)return t;t.then((function(t){dt((()=>e(null,t)))})).catch((function(t){dt((()=>e(t)))}))};var At={},pt={getCallback:function(t,e){return"function"==typeof t?t:e},getOptions:function(t,e){return"object"==typeof t&&null!==t?t:void 0!==e?e:{}}};const{fromCallback:yt}=gt,It=m,{getOptions:mt,getCallback:Et}=pt,wt=Symbol("promise"),bt=Symbol("callback"),Ct=Symbol("working"),Bt=Symbol("handleOne"),vt=Symbol("handleMany"),_t=Symbol("autoClose"),kt=Symbol("finishWork"),xt=Symbol("returnMany"),St=Symbol("closing"),Qt=Symbol("handleClose"),Mt=Symbol("closed"),Dt=Symbol("closeCallbacks"),Tt=Symbol("keyEncoding"),Lt=Symbol("valueEncoding"),$t=Symbol("abortOnClose"),Ut=Symbol("legacy"),Ot=Symbol("keys"),Ft=Symbol("values"),Nt=Symbol("limit"),Pt=Symbol("count"),Yt=Object.freeze({}),Kt=()=>{};let Rt=!1;class jt{constructor(t,e,n){if("object"!=typeof t||null===t){throw new TypeError(`The first argument must be an abstract-level database, received ${null===t?"null":typeof t}`)}if("object"!=typeof e||null===e)throw new TypeError("The second argument must be an options object");this[Mt]=!1,this[Dt]=[],this[Ct]=!1,this[St]=!1,this[_t]=!1,this[bt]=null,this[Bt]=this[Bt].bind(this),this[vt]=this[vt].bind(this),this[Qt]=this[Qt].bind(this),this[Tt]=e[Tt],this[Lt]=e[Lt],this[Ut]=n,this[Nt]=Number.isInteger(e.limit)&&e.limit>=0?e.limit:1/0,this[Pt]=0,this[$t]=!!e.abortOnClose,this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get count(){return this[Pt]}get limit(){return this[Nt]}next(t){let e;if(void 0===t)e=new Promise(((e,n)=>{t=(t,r,o)=>{t?n(t):this[Ut]?void 0===r&&void 0===o?e():e([r,o]):e(r)}}));else if("function"!=typeof t)throw new TypeError("Callback must be a function");return this[St]?this.nextTick(t,new It("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Ct]?this.nextTick(t,new It("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Ct]=!0,this[bt]=t,this[Pt]>=this[Nt]?this.nextTick(this[Bt],null):this._next(this[Bt])),e}_next(t){this.nextTick(t)}nextv(t,e,n){return n=Et(e,n),n=yt(n,wt),e=mt(e,Yt),Number.isInteger(t)?(this[St]?this.nextTick(n,new It("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Ct]?this.nextTick(n,new It("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(t<1&&(t=1),this[Nt]<1/0&&(t=Math.min(t,this[Nt]-this[Pt])),this[Ct]=!0,this[bt]=n,t<=0?this.nextTick(this[vt],null,[]):this._nextv(t,e,this[vt])),n[wt]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[wt])}_nextv(t,e,n){const r=[],o=(e,i,s)=>e?n(e):(this[Ut]?void 0===i&&void 0===s:void 0===i)?n(null,r):(r.push(this[Ut]?[i,s]:i),void(r.length===t?n(null,r):this._next(o)));this._next(o)}all(t,e){return e=Et(t,e),e=yt(e,wt),t=mt(t,Yt),this[St]?this.nextTick(e,new It("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Ct]?this.nextTick(e,new It("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Ct]=!0,this[bt]=e,this[_t]=!0,this[Pt]>=this[Nt]?this.nextTick(this[vt],null,[]):this._all(t,this[vt])),e[wt]}_all(t,e){let n=this[Pt];const r=[],o=()=>{const t=this[Nt]<1/0?Math.min(1e3,this[Nt]-n):1e3;t<=0?this.nextTick(e,null,r):this._nextv(t,Yt,i)},i=(t,i)=>{t?e(t):0===i.length?e(null,r):(r.push.apply(r,i),n+=i.length,o())};o()}[kt](){const t=this[bt];return this[$t]&&null===t?Kt:(this[Ct]=!1,this[bt]=null,this[St]&&this._close(this[Qt]),t)}[xt](t,e,n){this[_t]?this.close(t.bind(null,e,n)):t(e,n)}seek(t,e){if(e=mt(e,Yt),this[St]);else{if(this[Ct])throw new It("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{const n=this.db.keyEncoding(e.keyEncoding||this[Tt]),r=n.format;e.keyEncoding!==r&&(e={...e,keyEncoding:r});const o=this.db.prefixKey(n.encode(t),r);this._seek(o,e)}}}_seek(t,e){throw new It("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(t){if(t=yt(t,wt),this[Mt])this.nextTick(t);else if(this[St])this[Dt].push(t);else if(this[St]=!0,this[Dt].push(t),this[Ct]){if(this[$t]){this[kt]()(new It("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))}}else this._close(this[Qt]);return t[wt]}_close(t){this.nextTick(t)}[Qt](){this[Mt]=!0,this.db.detachResource(this);const t=this[Dt];this[Dt]=[];for(const e of t)e()}async*[Symbol.asyncIterator](){try{let t;for(;void 0!==(t=await this.next());)yield t}finally{this[Mt]||await this.close()}}}class Ht extends jt{constructor(t,e){super(t,e,!0),this[Ot]=!1!==e.keys,this[Ft]=!1!==e.values}[Bt](t,e,n){const r=this[kt]();if(t)return r(t);try{e=this[Ot]&&void 0!==e?this[Tt].decode(e):void 0,n=this[Ft]&&void 0!==n?this[Lt].decode(n):void 0}catch(t){return r(new Vt("entry",t))}void 0===e&&void 0===n||this[Pt]++,r(null,e,n)}[vt](t,e){const n=this[kt]();if(t)return this[xt](n,t);try{for(const t of e){const e=t[0],n=t[1];t[0]=this[Ot]&&void 0!==e?this[Tt].decode(e):void 0,t[1]=this[Ft]&&void 0!==n?this[Lt].decode(n):void 0}}catch(t){return this[xt](n,new Vt("entries",t))}this[Pt]+=e.length,this[xt](n,null,e)}end(t){return Rt||"undefined"==typeof console||(Rt=!0,console.warn(new It("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(t)}}class Vt extends It{constructor(t,e){super(`Iterator could not decode ${t}`,{code:"LEVEL_DECODE_ERROR",cause:e})}}for(const t of["_ended property","_nexting property","_end method"])Object.defineProperty(Ht.prototype,t.split(" ")[0],{get(){throw new It(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new It(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})}});Ht.keyEncoding=Tt,Ht.valueEncoding=Lt,At.AbstractIterator=Ht,At.AbstractKeyIterator=class extends jt{constructor(t,e){super(t,e,!1)}[Bt](t,e){const n=this[kt]();if(t)return n(t);try{e=void 0!==e?this[Tt].decode(e):void 0}catch(t){return n(new Vt("key",t))}void 0!==e&&this[Pt]++,n(null,e)}[vt](t,e){const n=this[kt]();if(t)return this[xt](n,t);try{for(let t=0;t<e.length;t++){const n=e[t];e[t]=void 0!==n?this[Tt].decode(n):void 0}}catch(t){return this[xt](n,new Vt("keys",t))}this[Pt]+=e.length,this[xt](n,null,e)}},At.AbstractValueIterator=class extends jt{constructor(t,e){super(t,e,!1)}[Bt](t,e){const n=this[kt]();if(t)return n(t);try{e=void 0!==e?this[Lt].decode(e):void 0}catch(t){return n(new Vt("value",t))}void 0!==e&&this[Pt]++,n(null,e)}[vt](t,e){const n=this[kt]();if(t)return this[xt](n,t);try{for(let t=0;t<e.length;t++){const n=e[t];e[t]=void 0!==n?this[Lt].decode(n):void 0}}catch(t){return this[xt](n,new Vt("values",t))}this[Pt]+=e.length,this[xt](n,null,e)}};var Gt={};const{AbstractKeyIterator:qt,AbstractValueIterator:zt}=At,Jt=Symbol("iterator"),Wt=Symbol("callback"),Xt=Symbol("handleOne"),Zt=Symbol("handleMany");class te extends qt{constructor(t,e){super(t,e),this[Jt]=t.iterator({...e,keys:!0,values:!1}),this[Xt]=this[Xt].bind(this),this[Zt]=this[Zt].bind(this)}}class ee extends zt{constructor(t,e){super(t,e),this[Jt]=t.iterator({...e,keys:!1,values:!0}),this[Xt]=this[Xt].bind(this),this[Zt]=this[Zt].bind(this)}}for(const t of[te,ee]){const e=t===te,n=e?t=>t[0]:t=>t[1];t.prototype._next=function(t){this[Wt]=t,this[Jt].next(this[Xt])},t.prototype[Xt]=function(t,n,r){const o=this[Wt];t?o(t):o(null,e?n:r)},t.prototype._nextv=function(t,e,n){this[Wt]=n,this[Jt].nextv(t,e,this[Zt])},t.prototype._all=function(t,e){this[Wt]=e,this[Jt].all(t,this[Zt])},t.prototype[Zt]=function(t,e){const r=this[Wt];t?r(t):r(null,e.map(n))},t.prototype._seek=function(t,e){this[Jt].seek(t,e)},t.prototype._close=function(t){this[Jt].close(t)}}Gt.DefaultKeyIterator=te,Gt.DefaultValueIterator=ee;var ne={};const{AbstractIterator:re,AbstractKeyIterator:oe,AbstractValueIterator:ie}=At,se=m,ae=Symbol("nut"),ce=Symbol("undefer"),ue=Symbol("factory");class le extends re{constructor(t,e){super(t,e),this[ae]=null,this[ue]=()=>t.iterator(e),this.db.defer((()=>this[ce]()))}}class he extends oe{constructor(t,e){super(t,e),this[ae]=null,this[ue]=()=>t.keys(e),this.db.defer((()=>this[ce]()))}}class fe extends ie{constructor(t,e){super(t,e),this[ae]=null,this[ue]=()=>t.values(e),this.db.defer((()=>this[ce]()))}}for(const t of[le,he,fe])t.prototype[ce]=function(){"open"===this.db.status&&(this[ae]=this[ue]())},t.prototype._next=function(t){null!==this[ae]?this[ae].next(t):"opening"===this.db.status?this.db.defer((()=>this._next(t))):this.nextTick(t,new se("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._nextv=function(t,e,n){null!==this[ae]?this[ae].nextv(t,e,n):"opening"===this.db.status?this.db.defer((()=>this._nextv(t,e,n))):this.nextTick(n,new se("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._all=function(t,e){null!==this[ae]?this[ae].all(e):"opening"===this.db.status?this.db.defer((()=>this._all(t,e))):this.nextTick(e,new se("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._seek=function(t,e){null!==this[ae]?this[ae]._seek(t,e):"opening"===this.db.status&&this.db.defer((()=>this._seek(t,e)))},t.prototype._close=function(t){null!==this[ae]?this[ae].close(t):"opening"===this.db.status?this.db.defer((()=>this._close(t))):this.nextTick(t)};ne.DeferredIterator=le,ne.DeferredKeyIterator=he,ne.DeferredValueIterator=fe;var ge={},de={};const{fromCallback:Ae}=gt,pe=m,{getCallback:ye,getOptions:Ie}=pt,me=Symbol("promise"),Ee=Symbol("status"),we=Symbol("operations"),be=Symbol("finishClose"),Ce=Symbol("closeCallbacks");de.AbstractChainedBatch=class{constructor(t){if("object"!=typeof t||null===t){throw new TypeError(`The first argument must be an abstract-level database, received ${null===t?"null":typeof t}`)}this[we]=[],this[Ce]=[],this[Ee]="open",this[be]=this[be].bind(this),this.db=t,this.db.attachResource(this),this.nextTick=t.nextTick}get length(){return this[we].length}put(t,e,n){if("open"!==this[Ee])throw new pe("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const r=this.db._checkKey(t)||this.db._checkValue(e);if(r)throw r;const o=n&&null!=n.sublevel?n.sublevel:this.db,i=n,s=o.keyEncoding(n&&n.keyEncoding),a=o.valueEncoding(n&&n.valueEncoding),c=s.format;n={...n,keyEncoding:c,valueEncoding:a.format},o!==this.db&&(n.sublevel=null);const u=o.prefixKey(s.encode(t),c),l=a.encode(e);return this._put(u,l,n),this[we].push({...i,type:"put",key:t,value:e}),this}_put(t,e,n){}del(t,e){if("open"!==this[Ee])throw new pe("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});const n=this.db._checkKey(t);if(n)throw n;const r=e&&null!=e.sublevel?e.sublevel:this.db,o=e,i=r.keyEncoding(e&&e.keyEncoding),s=i.format;return e={...e,keyEncoding:s},r!==this.db&&(e.sublevel=null),this._del(r.prefixKey(i.encode(t),s),e),this[we].push({...o,type:"del",key:t}),this}_del(t,e){}clear(){if("open"!==this[Ee])throw new pe("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[we]=[],this}_clear(){}write(t,e){return e=ye(t,e),e=Ae(e,me),t=Ie(t),"open"!==this[Ee]?this.nextTick(e,new pe("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):0===this.length?this.close(e):(this[Ee]="writing",this._write(t,(t=>{this[Ee]="closing",this[Ce].push((()=>e(t))),t||this.db.emit("batch",this[we]),this._close(this[be])}))),e[me]}_write(t,e){}close(t){return t=Ae(t,me),"closing"===this[Ee]?this[Ce].push(t):"closed"===this[Ee]?this.nextTick(t):(this[Ce].push(t),"writing"!==this[Ee]&&(this[Ee]="closing",this._close(this[be]))),t[me]}_close(t){this.nextTick(t)}[be](){this[Ee]="closed",this.db.detachResource(this);const t=this[Ce];this[Ce]=[];for(const e of t)e()}};const{AbstractChainedBatch:Be}=de,ve=m,_e=Symbol("encoded");ge.DefaultChainedBatch=class extends Be{constructor(t){super(t),this[_e]=[]}_put(t,e,n){this[_e].push({...n,type:"put",key:t,value:e})}_del(t,e){this[_e].push({...e,type:"del",key:t})}_clear(){this[_e]=[]}_write(t,e){"opening"===this.db.status?this.db.defer((()=>this._write(t,e))):"open"===this.db.status?0===this[_e].length?this.nextTick(e):this.db._batch(this[_e],t,e):this.nextTick(e,new ve("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};const ke=m,xe=Object.prototype.hasOwnProperty,Se=new Set(["lt","lte","gt","gte"]);
/*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
let Qe;var Me,De,Te="function"==typeof queueMicrotask?queueMicrotask.bind("undefined"!=typeof window?window:t):t=>(Qe||(Qe=Promise.resolve())).then(t).catch((t=>setTimeout((()=>{throw t}),0)));var Le,$e,Ue,Oe={};const{supports:Fe}=y,{Transcoder:Ne}=I,{EventEmitter:Pe}=X.exports,{fromCallback:Ye}=gt,Ke=m,{AbstractIterator:Re}=At,{DefaultKeyIterator:je,DefaultValueIterator:He}=Gt,{DeferredIterator:Ve,DeferredKeyIterator:Ge,DeferredValueIterator:qe}=ne,{DefaultChainedBatch:ze}=ge,{getCallback:Je,getOptions:We}=pt,Xe=function(t,e){const n={};for(const r in t)if(xe.call(t,r)&&"keyEncoding"!==r&&"valueEncoding"!==r){if("start"===r||"end"===r)throw new ke(`The legacy range option '${r}' has been removed`,{code:"LEVEL_LEGACY"});if("encoding"===r)throw new ke("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});Se.has(r)?n[r]=e.encode(t[r]):n[r]=t[r]}return n.reverse=!!n.reverse,n.limit=Number.isInteger(n.limit)&&n.limit>=0?n.limit:-1,n},Ze=Symbol("promise"),tn=Symbol("landed"),en=Symbol("resources"),nn=Symbol("closeResources"),rn=Symbol("operations"),on=Symbol("undefer"),sn=Symbol("deferOpen"),an=Symbol("options"),cn=Symbol("status"),un=Symbol("defaultOptions"),ln=Symbol("transcoder"),hn=Symbol("keyEncoding"),fn=Symbol("valueEncoding"),gn=()=>{};class dn extends Pe{constructor(t,e){if(super(),"object"!=typeof t||null===t)throw new TypeError("The first argument 'manifest' must be an object");e=We(e);const{keyEncoding:n,valueEncoding:r,passive:o,...i}=e;this[en]=new Set,this[rn]=[],this[sn]=!0,this[an]=i,this[cn]="opening",this.supports=Fe(t,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:!1!==t.snapshots,permanence:!1!==t.permanence,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:t.encodings||{},events:Object.assign({},t.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[ln]=new Ne(yn(this)),this[hn]=this[ln].encoding(n||"utf8"),this[fn]=this[ln].encoding(r||"utf8");for(const t of this[ln].encodings())this.supports.encodings[t.commonName]||(this.supports.encodings[t.commonName]=!0);this[un]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[hn].commonName,valueEncoding:this[fn].commonName}),key:Object.freeze({keyEncoding:this[hn].commonName})},this.nextTick((()=>{this[sn]&&this.open({passive:!1},gn)}))}get status(){return this[cn]}keyEncoding(t){return this[ln].encoding(null!=t?t:this[hn])}valueEncoding(t){return this[ln].encoding(null!=t?t:this[fn])}open(t,e){e=Je(t,e),e=Ye(e,Ze),(t={...this[an],...We(t)}).createIfMissing=!1!==t.createIfMissing,t.errorIfExists=!!t.errorIfExists;const n=t=>{"closing"===this[cn]||"opening"===this[cn]?this.once(tn,t?()=>n(t):n):"open"!==this[cn]?e(new Ke("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:t})):e()};return t.passive?"opening"===this[cn]?this.once(tn,n):this.nextTick(n):"closed"===this[cn]||this[sn]?(this[sn]=!1,this[cn]="opening",this.emit("opening"),this._open(t,(t=>{if(t)return this[cn]="closed",this[nn]((()=>{this.emit(tn),n(t)})),void this[on]();this[cn]="open",this[on](),this.emit(tn),"open"===this[cn]&&this.emit("open"),"open"===this[cn]&&this.emit("ready"),n()}))):"open"===this[cn]?this.nextTick(n):this.once(tn,(()=>this.open(t,e))),e[Ze]}_open(t,e){this.nextTick(e)}close(t){t=Ye(t,Ze);const e=n=>{"opening"===this[cn]||"closing"===this[cn]?this.once(tn,n?e(n):e):"closed"!==this[cn]?t(new Ke("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):t()};if("open"===this[cn]){this[cn]="closing",this.emit("closing");const t=t=>{this[cn]="open",this[on](),this.emit(tn),e(t)};this[nn]((()=>{this._close((n=>{if(n)return t(n);this[cn]="closed",this[on](),this.emit(tn),"closed"===this[cn]&&this.emit("closed"),e()}))}))}else"closed"===this[cn]?this.nextTick(e):this.once(tn,(()=>this.close(t)));return t[Ze]}[nn](t){if(0===this[en].size)return this.nextTick(t);let e=this[en].size,n=!0;const r=()=>{0==--e&&(n?this.nextTick(t):t())};for(const t of this[en])t.close(r);n=!1,this[en].clear()}_close(t){this.nextTick(t)}get(t,e,n){if(n=Je(e,n),n=Ye(n,Ze),e=We(e,this[un].entry),"opening"===this[cn])return this.defer((()=>this.get(t,e,n))),n[Ze];if(pn(this,n))return n[Ze];const r=this._checkKey(t);if(r)return this.nextTick(n,r),n[Ze];const o=this.keyEncoding(e.keyEncoding),i=this.valueEncoding(e.valueEncoding),s=o.format,a=i.format;return e.keyEncoding===s&&e.valueEncoding===a||(e=Object.assign({},e,{keyEncoding:s,valueEncoding:a})),this._get(this.prefixKey(o.encode(t),s),e,((t,e)=>{if(t)return("LEVEL_NOT_FOUND"===t.code||t.notFound||/NotFound/i.test(t))&&(t.code||(t.code="LEVEL_NOT_FOUND"),t.notFound||(t.notFound=!0),t.status||(t.status=404)),n(t);try{e=i.decode(e)}catch(t){return n(new Ke("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:t}))}n(null,e)})),n[Ze]}_get(t,e,n){this.nextTick(n,new Error("NotFound"))}getMany(t,e,n){if(n=Je(e,n),n=Ye(n,Ze),e=We(e,this[un].entry),"opening"===this[cn])return this.defer((()=>this.getMany(t,e,n))),n[Ze];if(pn(this,n))return n[Ze];if(!Array.isArray(t))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[Ze];if(0===t.length)return this.nextTick(n,null,[]),n[Ze];const r=this.keyEncoding(e.keyEncoding),o=this.valueEncoding(e.valueEncoding),i=r.format,s=o.format;e.keyEncoding===i&&e.valueEncoding===s||(e=Object.assign({},e,{keyEncoding:i,valueEncoding:s}));const a=new Array(t.length);for(let e=0;e<t.length;e++){const o=t[e],s=this._checkKey(o);if(s)return this.nextTick(n,s),n[Ze];a[e]=this.prefixKey(r.encode(o),i)}return this._getMany(a,e,((t,e)=>{if(t)return n(t);try{for(let t=0;t<e.length;t++)void 0!==e[t]&&(e[t]=o.decode(e[t]))}catch(t){return n(new Ke(`Could not decode one or more of ${e.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:t}))}n(null,e)})),n[Ze]}_getMany(t,e,n){this.nextTick(n,null,new Array(t.length).fill(void 0))}put(t,e,n,r){if(r=Je(n,r),r=Ye(r,Ze),n=We(n,this[un].entry),"opening"===this[cn])return this.defer((()=>this.put(t,e,n,r))),r[Ze];if(pn(this,r))return r[Ze];const o=this._checkKey(t)||this._checkValue(e);if(o)return this.nextTick(r,o),r[Ze];const i=this.keyEncoding(n.keyEncoding),s=this.valueEncoding(n.valueEncoding),a=i.format,c=s.format;n.keyEncoding===a&&n.valueEncoding===c||(n=Object.assign({},n,{keyEncoding:a,valueEncoding:c}));const u=this.prefixKey(i.encode(t),a),l=s.encode(e);return this._put(u,l,n,(n=>{if(n)return r(n);this.emit("put",t,e),r()})),r[Ze]}_put(t,e,n,r){this.nextTick(r)}del(t,e,n){if(n=Je(e,n),n=Ye(n,Ze),e=We(e,this[un].key),"opening"===this[cn])return this.defer((()=>this.del(t,e,n))),n[Ze];if(pn(this,n))return n[Ze];const r=this._checkKey(t);if(r)return this.nextTick(n,r),n[Ze];const o=this.keyEncoding(e.keyEncoding),i=o.format;return e.keyEncoding!==i&&(e=Object.assign({},e,{keyEncoding:i})),this._del(this.prefixKey(o.encode(t),i),e,(e=>{if(e)return n(e);this.emit("del",t),n()})),n[Ze]}_del(t,e,n){this.nextTick(n)}batch(t,e,n){if(!arguments.length){if("opening"===this[cn])return new ze(this);if("open"!==this[cn])throw new Ke("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(n="function"==typeof t?t:Je(e,n),n=Ye(n,Ze),e=We(e,this[un].empty),"opening"===this[cn])return this.defer((()=>this.batch(t,e,n))),n[Ze];if(pn(this,n))return n[Ze];if(!Array.isArray(t))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[Ze];if(0===t.length)return this.nextTick(n),n[Ze];const r=new Array(t.length),{keyEncoding:o,valueEncoding:i,...s}=e;for(let e=0;e<t.length;e++){if("object"!=typeof t[e]||null===t[e])return this.nextTick(n,new TypeError("A batch operation must be an object")),n[Ze];const s=Object.assign({},t[e]);if("put"!==s.type&&"del"!==s.type)return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[Ze];const a=this._checkKey(s.key);if(a)return this.nextTick(n,a),n[Ze];const c=null!=s.sublevel?s.sublevel:this,u=c.keyEncoding(s.keyEncoding||o),l=u.format;if(s.key=c.prefixKey(u.encode(s.key),l),s.keyEncoding=l,"put"===s.type){const t=this._checkValue(s.value);if(t)return this.nextTick(n,t),n[Ze];const e=c.valueEncoding(s.valueEncoding||i);s.value=e.encode(s.value),s.valueEncoding=e.format}c!==this&&(s.sublevel=null),r[e]=s}return this._batch(r,s,(e=>{if(e)return n(e);this.emit("batch",t),n()})),n[Ze]}_batch(t,e,n){this.nextTick(n)}sublevel(t,e){return this._sublevel(t,An.defaults(e))}_sublevel(t,e){return new An(this,t,e)}prefixKey(t,e){return t}clear(t,e){if(e=Je(t,e),e=Ye(e,Ze),t=We(t,this[un].empty),"opening"===this[cn])return this.defer((()=>this.clear(t,e))),e[Ze];if(pn(this,e))return e[Ze];const n=t,r=this.keyEncoding(t.keyEncoding);return(t=Xe(t,r)).keyEncoding=r.format,0===t.limit?this.nextTick(e):this._clear(t,(t=>{if(t)return e(t);this.emit("clear",n),e()})),e[Ze]}_clear(t,e){this.nextTick(e)}iterator(t){const e=this.keyEncoding(t&&t.keyEncoding),n=this.valueEncoding(t&&t.valueEncoding);if((t=Xe(t,e)).keys=!1!==t.keys,t.values=!1!==t.values,t[Re.keyEncoding]=e,t[Re.valueEncoding]=n,t.keyEncoding=e.format,t.valueEncoding=n.format,"opening"===this[cn])return new Ve(this,t);if("open"!==this[cn])throw new Ke("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(t)}_iterator(t){return new Re(this,t)}keys(t){const e=this.keyEncoding(t&&t.keyEncoding),n=this.valueEncoding(t&&t.valueEncoding);if((t=Xe(t,e))[Re.keyEncoding]=e,t[Re.valueEncoding]=n,t.keyEncoding=e.format,t.valueEncoding=n.format,"opening"===this[cn])return new Ge(this,t);if("open"!==this[cn])throw new Ke("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(t)}_keys(t){return new je(this,t)}values(t){const e=this.keyEncoding(t&&t.keyEncoding),n=this.valueEncoding(t&&t.valueEncoding);if((t=Xe(t,e))[Re.keyEncoding]=e,t[Re.valueEncoding]=n,t.keyEncoding=e.format,t.valueEncoding=n.format,"opening"===this[cn])return new qe(this,t);if("open"!==this[cn])throw new Ke("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(t)}_values(t){return new He(this,t)}defer(t){if("function"!=typeof t)throw new TypeError("The first argument must be a function");this[rn].push(t)}[on](){if(0===this[rn].length)return;const t=this[rn];this[rn]=[];for(const e of t)e()}attachResource(t){if("object"!=typeof t||null===t||"function"!=typeof t.close)throw new TypeError("The first argument must be a resource object");this[en].add(t)}detachResource(t){this[en].delete(t)}_chainedBatch(){return new ze(this)}_checkKey(t){if(null==t)return new Ke("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(t){if(null==t)return new Ke("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}}dn.prototype.nextTick=function(){if(De)return Me;De=1;const t=Te;return Me=function(e,...n){0===n.length?t(e):t((()=>e(...n)))}}();const{AbstractSublevel:An}=function(){if(Ue)return $e;Ue=1;const t=m,{Buffer:e}=r||{},{AbstractSublevelIterator:n,AbstractSublevelKeyIterator:o,AbstractSublevelValueIterator:i}=function(){if(Le)return Oe;Le=1;const{AbstractIterator:t,AbstractKeyIterator:e,AbstractValueIterator:n}=At,r=Symbol("unfix"),o=Symbol("iterator"),i=Symbol("handleOne"),s=Symbol("handleMany"),a=Symbol("callback");class c extends t{constructor(t,e,n,c){super(t,e),this[o]=n,this[r]=c,this[i]=this[i].bind(this),this[s]=this[s].bind(this),this[a]=null}[i](t,e,n){const o=this[a];if(t)return o(t);void 0!==e&&(e=this[r](e)),o(t,e,n)}[s](t,e){const n=this[a];if(t)return n(t);for(const t of e){const e=t[0];void 0!==e&&(t[0]=this[r](e))}n(t,e)}}class u extends e{constructor(t,e,n,c){super(t,e),this[o]=n,this[r]=c,this[i]=this[i].bind(this),this[s]=this[s].bind(this),this[a]=null}[i](t,e){const n=this[a];if(t)return n(t);void 0!==e&&(e=this[r](e)),n(t,e)}[s](t,e){const n=this[a];if(t)return n(t);for(let t=0;t<e.length;t++){const n=e[t];void 0!==n&&(e[t]=this[r](n))}n(t,e)}}class l extends n{constructor(t,e,n){super(t,e),this[o]=n}}for(const t of[c,u])t.prototype._next=function(t){this[a]=t,this[o].next(this[i])},t.prototype._nextv=function(t,e,n){this[a]=n,this[o].nextv(t,e,this[s])},t.prototype._all=function(t,e){this[a]=e,this[o].all(t,this[s])};for(const t of[l])t.prototype._next=function(t){this[o].next(t)},t.prototype._nextv=function(t,e,n){this[o].nextv(t,e,n)},t.prototype._all=function(t,e){this[o].all(t,e)};for(const t of[c,u,l])t.prototype._seek=function(t,e){this[o].seek(t,e)},t.prototype._close=function(t){this[o].close(t)};return Oe.AbstractSublevelIterator=c,Oe.AbstractSublevelKeyIterator=u,Oe.AbstractSublevelValueIterator=l,Oe}(),s=Symbol("prefix"),a=Symbol("upperBound"),c=Symbol("prefixRange"),u=Symbol("parent"),l=Symbol("unfix"),h=new TextEncoder,f={separator:"!"};$e=function({AbstractLevel:r}){class d extends r{static defaults(e){if("string"==typeof e)throw new t("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(e&&e.open)throw new t("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return null==e?f:e.separator?e:{...e,separator:"!"}}constructor(e,n,r){const{separator:o,manifest:i,...c}=d.defaults(r);n=y(n,o);const f=o.charCodeAt(0)+1,I=e[u]||e;if(!h.encode(n).every((t=>t>f&&t<127)))throw new t(`Prefix must use bytes > ${f} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(g(I,i),c);const m=(e.prefix||"")+o+n+o,E=m.slice(0,-1)+String.fromCharCode(f);this[u]=I,this[s]=new A(m),this[a]=new A(E),this[l]=new p,this.nextTick=I.nextTick}prefixKey(t,n){if("utf8"===n)return this[s].utf8+t;if(0===t.byteLength)return this[s][n];if("view"===n){const e=this[s].view,n=new Uint8Array(e.byteLength+t.byteLength);return n.set(e,0),n.set(t,e.byteLength),n}{const n=this[s].buffer;return e.concat([n,t],n.byteLength+t.byteLength)}}[c](t,e){void 0!==t.gte?t.gte=this.prefixKey(t.gte,e):void 0!==t.gt?t.gt=this.prefixKey(t.gt,e):t.gte=this[s][e],void 0!==t.lte?t.lte=this.prefixKey(t.lte,e):void 0!==t.lt?t.lt=this.prefixKey(t.lt,e):t.lte=this[a][e]}get prefix(){return this[s].utf8}get db(){return this[u]}_open(t,e){this[u].open({passive:!0},e)}_put(t,e,n,r){this[u].put(t,e,n,r)}_get(t,e,n){this[u].get(t,e,n)}_getMany(t,e,n){this[u].getMany(t,e,n)}_del(t,e,n){this[u].del(t,e,n)}_batch(t,e,n){this[u].batch(t,e,n)}_clear(t,e){this[c](t,t.keyEncoding),this[u].clear(t,e)}_iterator(t){this[c](t,t.keyEncoding);const e=this[u].iterator(t),r=this[l].get(this[s].utf8.length,t.keyEncoding);return new n(this,t,e,r)}_keys(t){this[c](t,t.keyEncoding);const e=this[u].keys(t),n=this[l].get(this[s].utf8.length,t.keyEncoding);return new o(this,t,e,n)}_values(t){this[c](t,t.keyEncoding);const e=this[u].values(t);return new i(this,t,e)}}return{AbstractSublevel:d}};const g=function(t,e){return{...t.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...e,encodings:{utf8:d(t,"utf8"),buffer:d(t,"buffer"),view:d(t,"view")}}},d=function(t,e){return!!t.supports.encodings[e]&&t.keyEncoding(e).name===e};class A{constructor(t){this.utf8=t,this.view=h.encode(t),this.buffer=e?e.from(this.view.buffer,0,this.view.byteLength):{}}}class p{constructor(){this.cache=new Map}get(t,e){let n=this.cache.get(e);return void 0===n&&(n="view"===e?function(t,e){return e.subarray(t)}.bind(null,t):function(t,e){return e.slice(t)}.bind(null,t),this.cache.set(e,n)),n}}const y=function(t,e){let n=0,r=t.length;for(;n<r&&t[n]===e;)n++;for(;r>n&&t[r-1]===e;)r--;return t.slice(n,r)};return $e}()({AbstractLevel:dn});p.AbstractLevel=dn,p.AbstractSublevel=An;const pn=function(t,e){return"open"!==t[cn]&&(t.nextTick(e,new Ke("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0)},yn=function(t){return Object.keys(t.supports.encodings).filter((e=>!!t.supports.encodings[e]))};A.AbstractLevel=p.AbstractLevel,A.AbstractSublevel=p.AbstractSublevel,A.AbstractIterator=At.AbstractIterator,A.AbstractKeyIterator=At.AbstractKeyIterator,A.AbstractValueIterator=At.AbstractValueIterator,A.AbstractChainedBatch=de.AbstractChainedBatch;
/*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var In=function(t,e,n){if("number"!=typeof e)throw new Error("second argument must be a Number");let r,o,i,s,a,c,u=!0;Array.isArray(t)?(r=[],i=o=t.length):(s=Object.keys(t),r={},i=o=s.length);function l(t){function e(){n&&n(t,r),n=null}u?mn(e):e()}function h(e,n,u){if(r[e]=u,n&&(a=!0),0==--i||n)l(n);else if(!a&&c<o){let e;s?(e=s[c],c+=1,t[e]((function(t,n){h(e,t,n)}))):(e=c,c+=1,t[e]((function(t,n){h(e,t,n)})))}}c=e,i?s?s.some((function(n,r){return t[n]((function(t,e){h(n,t,e)})),r===e-1})):t.some((function(t,n){return t((function(t,e){h(n,t,e)})),n===e-1})):l(null);u=!1};const mn=Te;var En={},wn="function"==typeof queueMicrotask?queueMicrotask:t=>Promise.resolve().then(t);En.fromCallback=function(t,e){if(void 0===t){var n=new Promise((function(e,n){t=function(t,r){t?n(t):e(r)}}));t[void 0!==e?e:"promise"]=n}else if("function"!=typeof t)throw new TypeError("Callback must be a function");return t},En.fromPromise=function(t,e){if(void 0===e)return t;t.then((function(t){wn((()=>e(null,t)))})).catch((function(t){wn((()=>e(t)))}))};var bn={},Cn=function(t){const e=void 0!==t.gte?t.gte:void 0!==t.gt?t.gt:void 0,n=void 0!==t.lte?t.lte:void 0!==t.lt?t.lt:void 0,r=void 0===t.gte,o=void 0===t.lte;return void 0!==e&&void 0!==n?IDBKeyRange.bound(e,n,r,o):void 0!==e?IDBKeyRange.lowerBound(e,r):void 0!==n?IDBKeyRange.upperBound(n,o):null};const Bn=new TextEncoder;var vn=function(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):Bn.encode(t)};const{AbstractIterator:_n}=A,kn=Cn,xn=vn,Sn=Symbol("cache"),Qn=Symbol("finished"),Mn=Symbol("options"),Dn=Symbol("currentOptions"),Tn=Symbol("position"),Ln=Symbol("location"),$n=Symbol("first"),Un={};function On(t){"function"==typeof t.commit&&t.commit()}bn.Iterator=class extends _n{constructor(t,e,n){super(t,n),this[Sn]=[],this[Qn]=0===this.limit,this[Mn]=n,this[Dn]={...n},this[Tn]=void 0,this[Ln]=e,this[$n]=!0}_nextv(t,e,n){if(this[$n]=!1,this[Qn])return this.nextTick(n,null,[]);if(this[Sn].length>0)return t=Math.min(t,this[Sn].length),this.nextTick(n,null,this[Sn].splice(0,t));let r;void 0!==this[Tn]&&(this[Mn].reverse?(this[Dn].lt=this[Tn],this[Dn].lte=void 0):(this[Dn].gt=this[Tn],this[Dn].gte=void 0));try{r=kn(this[Dn])}catch(t){return this[Qn]=!0,this.nextTick(n,null,[])}const o=this.db.db.transaction([this[Ln]],"readonly"),i=o.objectStore(this[Ln]),s=[];if(this[Mn].reverse){i[!this[Mn].values&&i.openKeyCursor?"openKeyCursor":"openCursor"](r,"prev").onsuccess=e=>{const n=e.target.result;if(n){const{key:e,value:r}=n;this[Tn]=e,s.push([this[Mn].keys&&void 0!==e?xn(e):void 0,this[Mn].values&&void 0!==r?xn(r):void 0]),s.length<t?n.continue():On(o)}else this[Qn]=!0}}else{let e,n;const a=()=>{if(void 0===e||void 0===n)return;const r=Math.max(e.length,n.length);0===r||t===1/0?this[Qn]=!0:this[Tn]=e[r-1],s.length=r;for(let t=0;t<r;t++){const r=e[t],o=n[t];s[t]=[this[Mn].keys&&void 0!==r?xn(r):void 0,this[Mn].values&&void 0!==o?xn(o):void 0]}On(o)};this[Mn].keys||t<1/0?i.getAllKeys(r,t<1/0?t:void 0).onsuccess=t=>{e=t.target.result,a()}:(e=[],this.nextTick(a)),this[Mn].values?i.getAll(r,t<1/0?t:void 0).onsuccess=t=>{n=t.target.result,a()}:(n=[],this.nextTick(a))}o.onabort=()=>{n(o.error||new Error("aborted by user")),n=null},o.oncomplete=()=>{n(null,s),n=null}}_next(t){if(this[Sn].length>0){const[e,n]=this[Sn].shift();this.nextTick(t,null,e,n)}else if(this[Qn])this.nextTick(t);else{let e=Math.min(100,this.limit-this.count);this[$n]&&(this[$n]=!1,e=1),this._nextv(e,Un,((e,n)=>{if(e)return t(e);this[Sn]=n,this._next(t)}))}}_all(t,e){this[$n]=!1;const n=this[Sn].splice(0,this[Sn].length),r=this.limit-this.count-n.length;if(r<=0)return this.nextTick(e,null,n);this._nextv(r,Un,((t,r)=>{if(t)return e(t);n.length>0&&(r=n.concat(r)),e(null,r)}))}_seek(t,e){let n;this[$n]=!0,this[Sn]=[],this[Qn]=!1,this[Tn]=void 0,this[Dn]={...this[Mn]};try{n=kn(this[Mn])}catch(t){return void(this[Qn]=!0)}null===n||n.includes(t)?this[Mn].reverse?this[Dn].lte=t:this[Dn].gte=t:this[Qn]=!0}};const{AbstractLevel:Fn}=A,Nn=m,Pn=In,{fromCallback:Yn}=En,{Iterator:Kn}=bn,Rn=vn,jn=function(t,e,n,r,o){if(0===r.limit)return t.nextTick(o);const i=t.db.transaction([e],"readwrite"),s=i.objectStore(e);let a=0;i.oncomplete=function(){o()},i.onabort=function(){o(i.error||new Error("aborted by user"))};const c=s.openKeyCursor?"openKeyCursor":"openCursor",u=r.reverse?"prev":"next";s[c](n,u).onsuccess=function(t){const e=t.target.result;e&&(s.delete(e.key).onsuccess=function(){(r.limit<=0||++a<r.limit)&&e.continue()})}},Hn=Cn,Vn="level-js-",Gn=Symbol("idb"),qn=Symbol("namePrefix"),zn=Symbol("location"),Jn=Symbol("version"),Wn=Symbol("store"),Xn=Symbol("onComplete"),Zn=Symbol("promise");class tr extends Fn{constructor(t,e,n){if("function"==typeof e||"function"==typeof n)throw new Nn("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});const{prefix:r,version:o,...i}=e||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},i),"string"!=typeof t)throw new Error("constructor requires a location string argument");this[zn]=t,this[qn]=null==r?Vn:r,this[Jn]=parseInt(o||1,10),this[Gn]=null}get location(){return this[zn]}get namePrefix(){return this[qn]}get version(){return this[Jn]}get db(){return this[Gn]}get type(){return"browser-level"}_open(t,e){const n=indexedDB.open(this[qn]+this[zn],this[Jn]);n.onerror=function(){e(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[Gn]=n.result,e()},n.onupgradeneeded=t=>{const e=t.target.result;e.objectStoreNames.contains(this[zn])||e.createObjectStore(this[zn])}}[Wn](t){return this[Gn].transaction([this[zn]],t).objectStore(this[zn])}[Xn](t,e){const n=t.transaction;n.onabort=function(){e(n.error||new Error("aborted by user"))},n.oncomplete=function(){e(null,t.result)}}_get(t,e,n){const r=this[Wn]("readonly");let o;try{o=r.get(t)}catch(t){return this.nextTick(n,t)}this[Xn](o,(function(t,e){return t?n(t):void 0===e?n(new Nn("Entry not found",{code:"LEVEL_NOT_FOUND"})):void n(null,Rn(e))}))}_getMany(t,e,n){const r=this[Wn]("readonly"),o=t.map((t=>e=>{let n;try{n=r.get(t)}catch(t){return e(t)}n.onsuccess=()=>{const t=n.result;e(null,void 0===t?t:Rn(t))},n.onerror=t=>{t.stopPropagation(),e(n.error)}}));Pn(o,16,n)}_del(t,e,n){const r=this[Wn]("readwrite");let o;try{o=r.delete(t)}catch(t){return this.nextTick(n,t)}this[Xn](o,n)}_put(t,e,n,r){const o=this[Wn]("readwrite");let i;try{i=o.put(e,t)}catch(t){return this.nextTick(r,t)}this[Xn](i,r)}_iterator(t){return new Kn(this,this[zn],t)}_batch(t,e,n){const r=this[Wn]("readwrite"),o=r.transaction;let i,s=0;o.onabort=function(){n(i||o.error||new Error("aborted by user"))},o.oncomplete=function(){n()},function e(){const n=t[s++],a=n.key;let c;try{c="del"===n.type?r.delete(a):r.put(n.value,a)}catch(t){return i=t,void o.abort()}s<t.length?c.onsuccess=e:"function"==typeof o.commit&&o.commit()}()}_clear(t,e){let n,r;try{n=Hn(t)}catch(t){return this.nextTick(e)}if(t.limit>=0)return jn(this,this[zn],n,t,e);try{const t=this[Wn]("readwrite");r=n?t.delete(n):t.clear()}catch(t){return this.nextTick(e,t)}this[Xn](r,e)}_close(t){this[Gn].close(),this.nextTick(t)}}tr.destroy=function(t,e,n){"function"==typeof e&&(n=e,e=Vn),n=Yn(n,Zn);const r=indexedDB.deleteDatabase(e+t);return r.onsuccess=function(){n()},r.onerror=function(t){n(t)},n[Zn]};var er=tr;const nr="0123456789bcdefghjkmnpqrstuvwxyz";class rr{static encode(t,e,n){if(void 0===n){for(let n=1;n<=12;n++){const r=rr.encode(t,e,n),o=rr.decode(r);if(o.lat==t&&o.lon==e)return r}n=12}if(t=Number(t),e=Number(e),n=Number(n),isNaN(t)||isNaN(e)||isNaN(n))throw new Error("Invalid geohash");let r=0,o=0,i=!0,s="",a=-90,c=90,u=-180,l=180;for(;s.length<n;){if(i){const t=(u+l)/2;e>=t?(r=2*r+1,u=t):(r*=2,l=t)}else{const e=(a+c)/2;t>=e?(r=2*r+1,a=e):(r*=2,c=e)}i=!i,5==++o&&(s+=nr.charAt(r),o=0,r=0)}return s}static decode(t){const e=rr.bounds(t),n=e.sw.lat,r=e.sw.lon,o=e.ne.lat,i=e.ne.lon;let s=(n+o)/2,a=(r+i)/2;return s=s.toFixed(Math.floor(2-Math.log(o-n)/Math.LN10)),a=a.toFixed(Math.floor(2-Math.log(i-r)/Math.LN10)),{lat:Number(s),lon:Number(a)}}static bounds(t){if(0==t.length)throw new Error("Invalid geohash");t=t.toLowerCase();let e=!0,n=-90,r=90,o=-180,i=180;for(let s=0;s<t.length;s++){const a=t.charAt(s),c=nr.indexOf(a);if(-1==c)throw new Error("Invalid geohash");for(let t=4;t>=0;t--){const s=c>>t&1;if(e){const t=(o+i)/2;1==s?o=t:i=t}else{const t=(n+r)/2;1==s?n=t:r=t}e=!e}}return{sw:{lat:n,lon:o},ne:{lat:r,lon:i}}}static adjacent(t,e){if(t=t.toLowerCase(),e=e.toLowerCase(),0==t.length)throw new Error("Invalid geohash");if(-1=="nsew".indexOf(e))throw new Error("Invalid direction");const n=t.slice(-1);let r=t.slice(0,-1);const o=t.length%2;return-1!={n:["prxz","bcfguvyz"],s:["028b","0145hjnp"],e:["bcfguvyz","prxz"],w:["0145hjnp","028b"]}[e][o].indexOf(n)&&""!=r&&(r=rr.adjacent(r,e)),r+nr.charAt({n:["p0r21436x8zb9dcf5h7kjnmqesgutwvy","bc01fg45238967deuvhjyznpkmstqrwx"],s:["14365h7k9dcfesgujnmqp0r2twvyx8zb","238967debc01fg45kmstqrwxuvhjyznp"],e:["bc01fg45238967deuvhjyznpkmstqrwx","p0r21436x8zb9dcf5h7kjnmqesgutwvy"],w:["238967debc01fg45kmstqrwxuvhjyznp","14365h7k9dcfesgujnmqp0r2twvyx8zb"]}[e][o].indexOf(n))}static neighbours(t){return{n:rr.adjacent(t,"n"),ne:rr.adjacent(rr.adjacent(t,"n"),"e"),e:rr.adjacent(t,"e"),se:rr.adjacent(rr.adjacent(t,"s"),"e"),s:rr.adjacent(t,"s"),sw:rr.adjacent(rr.adjacent(t,"s"),"w"),w:rr.adjacent(t,"w"),nw:rr.adjacent(rr.adjacent(t,"n"),"w")}}}var or={exports:{}},ir={exports:{}};function sr(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ar,cr={exports:{}},ur=function t(e,n){if(!e){var r=new lr(n);throw Error.captureStackTrace&&Error.captureStackTrace(r,t),r}};class lr extends Error{}function hr(t){t.fill(0)}lr.prototype.name="AssertionError",function(t){var e,n=ur,r=(e=globalThis.crypto||globalThis.msCrypto)&&e.getRandomValues?function(t,n){for(let r=0;r<n;r+=65536)e.getRandomValues(new Uint8Array(t.buffer,r+t.byteOffset,Math.min(n-r,65536)))}:null!=sr&&(e=sr("crypto"))&&e.randomBytes?function(t,n){new Uint8Array(t.buffer,t.byteOffset,n).set(e.randomBytes(n))}:function(){throw new Error("No secure random number generator available")};Object.defineProperty(t.exports,"randombytes",{value:r}),t.exports.randombytes_buf=function(t){n(t,"out must be given"),r(t,t.byteLength)}}(cr);var fr={sodium_malloc:function(t){return new Uint8Array(t)},sodium_free:function(t){hr(t),function(){if(ar)return ar;var t=globalThis.MessageChannel;null==t&&({MessageChannel:t}=sr("worker_threads"));return ar=new t}().port1.postMessage(t.buffer,[t.buffer])},sodium_memzero:hr},gr={exports:{}};!function(t){function e(t,e,n,r,o){var i=0;for(let s=0;s<o;s++)i|=t[e+s]^n[r+s];return(1&i-1>>>8)-1}t.exports={crypto_verify_16:function(t,n,r,o){return 0===e(t,n,r,o,16)},crypto_verify_32:function(t,n,r,o){return 0===e(t,n,r,o,32)},crypto_verify_64:function(t,n,r,o){return 0===e(t,n,r,o,64)}},Object.defineProperty(t.exports,"vn",{value:e})}(gr);const dr=ur,{vn:Ar}=gr.exports;var pr={sodium_increment:function(t){const e=t.byteLength;for(var n=1,r=0;r<e;r++)n+=t[r],t[r]=n,n>>=8},sodium_memcmp:function(t,e){return dr(t.byteLength===e.byteLength,"buffers must be the same size"),0===Ar(t,0,e,0,t.byteLength)},sodium_is_zero:function(t){var e=0;for(let n=0;n<t.length;n++)e|=t[n];return 0===e}},yr={exports:{}};function Ir(t){return t.length}var mr={byteLength:Ir,toString:function(t){const e=t.byteLength;let n="";for(let r=0;r<e;r++)n+=String.fromCharCode(t[r]);return n},write:function(t,e,n=0,r=Ir(e)){const o=Math.min(r,t.byteLength-n);for(let r=0;r<o;r++)t[n+r]=e.charCodeAt(r);return o}};const Er="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",wr=new Uint8Array(256);for(let t=0;t<Er.length;t++)wr[Er.charCodeAt(t)]=t;function br(t){let e=t.length;return 61===t.charCodeAt(e-1)&&e--,e>1&&61===t.charCodeAt(e-1)&&e--,3*e>>>2}wr[45]=62,wr[95]=63;var Cr={byteLength:br,toString:function(t){const e=t.byteLength;let n="";for(let r=0;r<e;r+=3)n+=Er[t[r]>>2]+Er[(3&t[r])<<4|t[r+1]>>4]+Er[(15&t[r+1])<<2|t[r+2]>>6]+Er[63&t[r+2]];return e%3==2?n=n.substring(0,n.length-1)+"=":e%3==1&&(n=n.substring(0,n.length-2)+"=="),n},write:function(t,e,n=0,r=br(e)){const o=Math.min(r,t.byteLength-n);for(let n=0,r=0;n<o;n+=4){const o=wr[e.charCodeAt(n)],i=wr[e.charCodeAt(n+1)],s=wr[e.charCodeAt(n+2)],a=wr[e.charCodeAt(n+3)];t[r++]=o<<2|i>>4,t[r++]=(15&i)<<4|s>>2,t[r++]=(3&s)<<6|63&a}return o}};function Br(t){return t.length>>>1}var vr={byteLength:Br,toString:function(t){const e=t.byteLength;t=new DataView(t.buffer,t.byteOffset,e);let n="",r=0;for(let o=e-e%4;r<o;r+=4)n+=t.getUint32(r).toString(16).padStart(8,"0");for(;r<e;r++)n+=t.getUint8(r).toString(16).padStart(2,"0");return n},write:function(t,e,n=0,r=Br(e)){const o=Math.min(r,t.byteLength-n);for(let r=0;r<o;r++){const o=_r(e.charCodeAt(2*r)),i=_r(e.charCodeAt(2*r+1));if(void 0===o||void 0===i)return t.subarray(0,r);t[n+r]=o<<4|i}return o}};function _r(t){return t>=48&&t<=57?t-48:t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:void 0}function kr(t){let e=0;for(let n=0,r=t.length;n<r;n++){const o=t.charCodeAt(n);if(o>=55296&&o<=56319&&n+1<r){const r=t.charCodeAt(n+1);if(r>=56320&&r<=57343){e+=4,n++;continue}}e+=o<=127?1:o<=2047?2:3}return e}let xr,Sr;if("undefined"!=typeof TextDecoder){const t=new TextDecoder;xr=function(e){return t.decode(e)}}else xr=function(t){const e=t.byteLength;let n="",r=0;for(;r<e;){let o=t[r];if(o<=127){n+=String.fromCharCode(o),r++;continue}let i=0,s=0;if(o<=223?(i=1,s=31&o):o<=239?(i=2,s=15&o):o<=244&&(i=3,s=7&o),e-r-i>0){let e=0;for(;e<i;)o=t[r+e+1],s=s<<6|63&o,e+=1}else s=65533,i=e-r;n+=String.fromCodePoint(s),r+=i+1}return n};if("undefined"!=typeof TextEncoder){const t=new TextEncoder;Sr=function(e,n,r=0,o=kr(n)){const i=Math.min(o,e.byteLength-r);return t.encodeInto(n,e.subarray(r,r+i)),i}}else Sr=function(t,e,n=0,r=kr(e)){const o=Math.min(r,t.byteLength-n);t=t.subarray(n,n+o);let i=0,s=0;for(;i<e.length;){const n=e.codePointAt(i);if(n<=127){t[s++]=n,i++;continue}let r=0,o=0;for(n<=2047?(r=6,o=192):n<=65535?(r=12,o=224):n<=2097151&&(r=18,o=240),t[s++]=o|n>>r,r-=6;r>=0;)t[s++]=128|n>>r&63,r-=6;i+=n>=65536?2:1}return o};function Qr(t){return 2*t.length}var Mr={byteLength:Qr,toString:function(t){const e=t.byteLength;let n="";for(let r=0;r<e-1;r+=2)n+=String.fromCharCode(t[r]+256*t[r+1]);return n},write:function(t,e,n=0,r=Qr(e)){const o=Math.min(r,t.byteLength-n);let i=o;for(let r=0;r<e.length&&!((i-=2)<0);++r){const o=e.charCodeAt(r),i=o>>8,s=o%256;t[n+2*r]=s,t[n+2*r+1]=i}return o}};const Dr=mr,Tr=Cr,Lr=vr,$r={byteLength:kr,toString:xr,write:Sr},Ur=Mr;function Or(t){switch(t){case"ascii":return Dr;case"base64":return Tr;case"hex":return Lr;case"utf8":case"utf-8":case void 0:return $r;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ur;default:throw new Error(`Unknown encoding: ${t}`)}}function Fr(t){return t instanceof Uint8Array}function Nr(t,e,n){return"string"==typeof t?function(t,e){const n=Or(e),r=new Uint8Array(n.byteLength(t));return n.write(r,t,0,r.byteLength),r}(t,e):Array.isArray(t)?function(t){const e=new Uint8Array(t.length);return e.set(t),e}(t):ArrayBuffer.isView(t)?function(t){const e=new Uint8Array(t.byteLength);return e.set(t),e}(t):function(t,e,n){return new Uint8Array(t,e,n)}(t,e,n)}function Pr(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}var Yr={isBuffer:Fr,alloc:function(t,e,n){const r=new Uint8Array(t);return void 0!==e&&e(r,e,0,r.byteLength,n),r},allocUnsafe:function(t){return new Uint8Array(t)},allocUnsafeSlow:function(t){return new Uint8Array(t)},byteLength:function(t,e){return Or(e).byteLength(t)},compare:function(t,e){if(t===e)return 0;const n=Math.min(t.byteLength,e.byteLength);t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let r=0;for(let o=n-n%4;r<o;r+=4){const n=t.getUint32(r),o=e.getUint32(r);if(n<o)return-1;if(n>o)return 1}for(;r<n;r++){const n=t.getUint8(r),o=e.getUint8(r);if(n<o)return-1;if(n>o)return 1}return t.byteLength>e.byteLength?1:t.byteLength<e.byteLength?-1:0},concat:function(t,e){void 0===e&&(e=t.reduce(((t,e)=>t+e.byteLength),0));const n=new Uint8Array(e);return t.reduce(((t,e)=>(n.set(e,t),t+e.byteLength)),0),n},copy:function(t,e,n=0,r=0,o=t.byteLength){if(o>0&&o<r)return 0;if(o===r)return 0;if(0===t.byteLength||0===e.byteLength)return 0;if(n<0)throw new RangeError("targetStart is out of range");if(r<0||r>=t.byteLength)throw new RangeError("sourceStart is out of range");if(o<0)throw new RangeError("sourceEnd is out of range");n>=e.byteLength&&(n=e.byteLength),o>t.byteLength&&(o=t.byteLength),e.byteLength-n<o-r&&(o=e.length-n+r);const i=o-r;return t===e?e.copyWithin(n,r,o):e.set(t.subarray(r,o),n),i},equals:function(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;const n=t.byteLength;t=new DataView(t.buffer,t.byteOffset,t.byteLength),e=new DataView(e.buffer,e.byteOffset,e.byteLength);let r=0;for(let o=n-n%4;r<o;r+=4)if(t.getUint32(r)!==e.getUint32(r))return!1;for(;r<n;r++)if(t.getUint8(r)!==e.getUint8(r))return!1;return!0},fill:function(t,e,n,r,o){if("string"==typeof e?"string"==typeof n?(o=n,n=0,r=t.byteLength):"string"==typeof r&&(o=r,r=t.byteLength):"number"==typeof val?e&=255:"boolean"==typeof val&&(e=+e),n<0||t.byteLength<n||t.byteLength<r)throw new RangeError("Out of range index");if(void 0===n&&(n=0),void 0===r&&(r=t.byteLength),r<=n)return t;if(e||(e=0),"number"==typeof e)for(let o=n;o<r;++o)t[o]=e;else{const i=(e=Fr(e)?e:Nr(e,o)).byteLength;for(let o=0;o<r-n;++o)t[o+n]=e[o%i]}return t},from:Nr,swap16:function(t){const e=t.byteLength;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let n=0;n<e;n+=2)Pr(t,n,n+1);return t},swap32:function(t){const e=t.byteLength;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let n=0;n<e;n+=4)Pr(t,n,n+3),Pr(t,n+1,n+2);return t},swap64:function(t){const e=t.byteLength;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let n=0;n<e;n+=8)Pr(t,n,n+7),Pr(t,n+1,n+6),Pr(t,n+2,n+5),Pr(t,n+3,n+4);return t},toBuffer:function(t){return t},toString:function(t,e,n=0,r=t.byteLength){const o=t.byteLength;return n>=o||r<=n?"":(n<0&&(n=0),r>o&&(r=o),(0!==n||r<o)&&(t=t.subarray(n,r)),Or(e).toString(t))},write:function(t,e,n,r,o){return void 0===n?o="utf8":void 0===r&&"string"==typeof n?(o=n,n=void 0):void 0===o&&"string"==typeof r&&(o=r,r=void 0),Or(o).write(t,e,n,r)}};const Kr=ur,Rr=Yr;var jr=Gr;const Hr=128;var Vr=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Gr(){return this instanceof Gr?(this.hh=new Int32Array(8),this.hl=new Int32Array(8),this.buffer=new Uint8Array(128),this.finalised=!1,this.bytesRead=0,this.pos=0,this.hh[0]=1779033703,this.hh[1]=3144134277,this.hh[2]=1013904242,this.hh[3]=2773480762,this.hh[4]=1359893119,this.hh[5]=2600822924,this.hh[6]=528734635,this.hh[7]=1541459225,this.hl[0]=4089235720,this.hl[1]=2227873595,this.hl[2]=4271175723,this.hl[3]=1595750129,this.hl[4]=2917565137,this.hl[5]=725511199,this.hl[6]=4215389547,this.hl[7]=327033209,this):new Gr}function qr(t,e,n,r){t[e]=n>>24&255,t[e+1]=n>>16&255,t[e+2]=n>>8&255,t[e+3]=255&n,t[e+4]=r>>24&255,t[e+5]=r>>16&255,t[e+6]=r>>8&255,t[e+7]=255&r}function zr(t,e,n,r){for(var o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v,_,k,x,S,Q=new Int32Array(16),M=new Int32Array(16),D=t[0],T=t[1],L=t[2],$=t[3],U=t[4],O=t[5],F=t[6],N=t[7],P=e[0],Y=e[1],K=e[2],R=e[3],j=e[4],H=e[5],V=e[6],G=e[7],q=0;r>=128;){for(b=0;b<16;b++)C=8*b+q,Q[b]=n[C+0]<<24|n[C+1]<<16|n[C+2]<<8|n[C+3],M[b]=n[C+4]<<24|n[C+5]<<16|n[C+6]<<8|n[C+7];for(b=0;b<80;b++)if(o=D,i=T,s=L,a=$,c=U,u=O,l=F,N,f=P,g=Y,d=K,A=R,p=j,y=H,I=V,G,_=65535&(v=G),k=v>>>16,x=65535&(B=N),S=B>>>16,_+=65535&(v=(j>>>14|U<<18)^(j>>>18|U<<14)^(U>>>9|j<<23)),k+=v>>>16,x+=65535&(B=(U>>>14|j<<18)^(U>>>18|j<<14)^(j>>>9|U<<23)),S+=B>>>16,_+=65535&(v=j&H^~j&V),k+=v>>>16,x+=65535&(B=U&O^~U&F),S+=B>>>16,_+=65535&(v=Vr[2*b+1]),k+=v>>>16,x+=65535&(B=Vr[2*b]),S+=B>>>16,B=Q[b%16],k+=(v=M[b%16])>>>16,x+=65535&B,S+=B>>>16,x+=(k+=(_+=65535&v)>>>16)>>>16,_=65535&(v=w=65535&_|k<<16),k=v>>>16,x=65535&(B=E=65535&x|(S+=x>>>16)<<16),S=B>>>16,_+=65535&(v=(P>>>28|D<<4)^(D>>>2|P<<30)^(D>>>7|P<<25)),k+=v>>>16,x+=65535&(B=(D>>>28|P<<4)^(P>>>2|D<<30)^(P>>>7|D<<25)),S+=B>>>16,k+=(v=P&Y^P&K^Y&K)>>>16,x+=65535&(B=D&T^D&L^T&L),S+=B>>>16,h=65535&(x+=(k+=(_+=65535&v)>>>16)>>>16)|(S+=x>>>16)<<16,m=65535&_|k<<16,_=65535&(v=A),k=v>>>16,x=65535&(B=a),S=B>>>16,k+=(v=w)>>>16,x+=65535&(B=E),S+=B>>>16,T=o,L=i,$=s,U=a=65535&(x+=(k+=(_+=65535&v)>>>16)>>>16)|(S+=x>>>16)<<16,O=c,F=u,N=l,D=h,Y=f,K=g,R=d,j=A=65535&_|k<<16,H=p,V=y,G=I,P=m,b%16==15)for(C=0;C<16;C++)B=Q[C],_=65535&(v=M[C]),k=v>>>16,x=65535&B,S=B>>>16,B=Q[(C+9)%16],_+=65535&(v=M[(C+9)%16]),k+=v>>>16,x+=65535&B,S+=B>>>16,E=Q[(C+1)%16],_+=65535&(v=((w=M[(C+1)%16])>>>1|E<<31)^(w>>>8|E<<24)^(w>>>7|E<<25)),k+=v>>>16,x+=65535&(B=(E>>>1|w<<31)^(E>>>8|w<<24)^E>>>7),S+=B>>>16,E=Q[(C+14)%16],k+=(v=((w=M[(C+14)%16])>>>19|E<<13)^(E>>>29|w<<3)^(w>>>6|E<<26))>>>16,x+=65535&(B=(E>>>19|w<<13)^(w>>>29|E<<3)^E>>>6),S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,Q[C]=65535&x|S<<16,M[C]=65535&_|k<<16;_=65535&(v=P),k=v>>>16,x=65535&(B=D),S=B>>>16,B=t[0],k+=(v=e[0])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[0]=D=65535&x|S<<16,e[0]=P=65535&_|k<<16,_=65535&(v=Y),k=v>>>16,x=65535&(B=T),S=B>>>16,B=t[1],k+=(v=e[1])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[1]=T=65535&x|S<<16,e[1]=Y=65535&_|k<<16,_=65535&(v=K),k=v>>>16,x=65535&(B=L),S=B>>>16,B=t[2],k+=(v=e[2])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[2]=L=65535&x|S<<16,e[2]=K=65535&_|k<<16,_=65535&(v=R),k=v>>>16,x=65535&(B=$),S=B>>>16,B=t[3],k+=(v=e[3])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[3]=$=65535&x|S<<16,e[3]=R=65535&_|k<<16,_=65535&(v=j),k=v>>>16,x=65535&(B=U),S=B>>>16,B=t[4],k+=(v=e[4])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[4]=U=65535&x|S<<16,e[4]=j=65535&_|k<<16,_=65535&(v=H),k=v>>>16,x=65535&(B=O),S=B>>>16,B=t[5],k+=(v=e[5])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[5]=O=65535&x|S<<16,e[5]=H=65535&_|k<<16,_=65535&(v=V),k=v>>>16,x=65535&(B=F),S=B>>>16,B=t[6],k+=(v=e[6])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[6]=F=65535&x|S<<16,e[6]=V=65535&_|k<<16,_=65535&(v=G),k=v>>>16,x=65535&(B=N),S=B>>>16,B=t[7],k+=(v=e[7])>>>16,x+=65535&B,S+=B>>>16,S+=(x+=(k+=(_+=65535&v)>>>16)>>>16)>>>16,t[7]=N=65535&x|S<<16,e[7]=G=65535&_|k<<16,q+=128,r-=128}}function Jr(t){if(!(this instanceof Jr))return new Jr(t);this.pad=Rr.alloc(128),this.inner=Gr(),this.outer=Gr();const e=Rr.alloc(64);t.byteLength>128&&(Gr().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}Gr.prototype.update=function(t,e){Kr(!1===this.finalised,"Hash instance finalised");var[n,r]=function(t,e){var n=Rr.from(t,e);return[n,n.byteLength]}(t,e);this.bytesRead+=r;const o=r+this.pos&-128;this.buffer.set(n.subarray(0,Hr-this.pos),this.pos);const i=this.pos;return(r-=Hr-this.pos)>=0&&(zr(this.hh,this.hl,this.buffer,128),this.pos=0),r>127&&(zr(this.hh,this.hl,n.subarray(Hr-i,o-i),o-Hr),r%=128),this.buffer.set(n.subarray(n.byteLength-r)),this.pos=127&this.bytesRead,this.buffer.fill(0,this.pos),this},Gr.prototype.digest=function(t,e=0){if(Kr(!1===this.finalised,"Hash instance finalised"),this.finalised=!0,this.buffer.fill(0,this.pos),this.buffer[this.pos]=128,this.pos>111&&(zr(this.hh,this.hl,this.buffer,128),this.buffer.fill(0),this.pos=0),qr(this.buffer,120,this.bytesRead/536870912|0,this.bytesRead<<3),zr(this.hh,this.hl,this.buffer,128),t instanceof Uint8Array&&t.byteLength>63){for(let n=0;n<8;n++)qr(t,8*n+e,this.hh[n],this.hl[n]);return t}const n=new Uint8Array(64);for(let t=0;t<8;t++)qr(n,8*t,this.hh[t],this.hl[t]);return"string"==typeof t?Rr.toString(n,t):n},Jr.prototype.update=function(t,e){return this.inner.update(t,e),this},Jr.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},Gr.HMAC=Jr;var Wr,Xr,Zr={exports:{}},to=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),eo=(Wr={"wasm-binary:./sha512.wat"(t,e){e.exports=to("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")}},function(){return Xr||(0,Wr[Object.keys(Wr)[0]])((Xr={exports:{}}).exports,Xr),Xr.exports})(),no=new WebAssembly.Module(eo);const ro=ur,oo=Yr,io=(so={imports:{debug:{log(...t){console.log(...t.map((t=>(t>>>0).toString(16).padStart(8,"0"))))},log_tee:t=>(console.log((t>>>0).toString(16).padStart(8,"0")),t)}}},new WebAssembly.Instance(no,so).exports);var so;let ao=0;const co=[];Zr.exports=ho;const uo=Zr.exports.SHA512_BYTES=64,lo=128;function ho(){if(!(this instanceof ho))return new ho;if(!io)throw new Error("WASM not loaded. Wait for Sha512.ready(cb)");co.length||(co.push(ao),ao+=216),this.finalized=!1,this.digestLength=uo,this.pointer=co.pop(),this.pos=0,this.wasm=io,this._memory=new Uint8Array(io.memory.buffer),this._memory.fill(0,this.pointer,this.pointer+216),this.pointer+this.digestLength>this._memory.length&&this._realloc(this.pointer+216)}function fo(t){if(!(this instanceof fo))return new fo(t);this.pad=oo.alloc(128),this.inner=ho(),this.outer=ho();const e=oo.alloc(64);t.byteLength>128&&(ho().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}function go(){}ho.prototype._realloc=function(t){io.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(io.memory.buffer)},ho.prototype.update=function(t,e){ro(!1===this.finalized,"Hash instance finalized"),ao%8!=0&&(ao+=8-ao%8),ro(ao%8==0,"input should be aligned for int64");const[n,r]=function(t,e){var n=oo.from(t,e);return[n,n.byteLength]}(t,e);return ro(n instanceof Uint8Array,"input must be Uint8Array or Buffer"),ao+t.length>this._memory.length&&this._realloc(ao+t.length),this._memory.fill(0,ao,ao+function(t,e){return t+e-1&-e}(r,lo)-lo),this._memory.set(n.subarray(0,lo-this.pos),this.pointer+80+this.pos),this._memory.set(n.subarray(lo-this.pos),ao),this.pos=this.pos+r&127,io.sha512(this.pointer,ao,r,0),this},ho.prototype.digest=function(t,e=0){ro(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,co.push(this.pointer);const n=this.pointer+80+this.pos;this._memory.fill(0,n,this.pointer+80+lo),io.sha512(this.pointer,ao,0,1);const r=this._memory.subarray(this.pointer,this.pointer+this.digestLength);if(!t)return r;if("string"==typeof t)return oo.toString(r,t);ro(t instanceof Uint8Array,"output must be Uint8Array or Buffer"),ro(t.byteLength>=this.digestLength+e,"output must have at least 'SHA512_BYTES' bytes remaining");for(let n=0;n<this.digestLength;n++)t[n+e]=r[n];return t},ho.WASM=io,ho.WASM_SUPPORTED="undefined"!=typeof WebAssembly,ho.ready=function(t){return t||(t=go),io?(t(),Promise.resolve()):t(new Error("WebAssembly not supported"))},ho.prototype.ready=ho.ready,fo.prototype.update=function(t,e){return this.inner.update(t,e),this},fo.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},ho.HMAC=fo;const Ao=jr,po=Zr.exports;var yo=Ao;yr.exports=function(){return new yo},yr.exports.ready=function(t){po.ready((function(){t()}))},yr.exports.WASM_SUPPORTED=po.SUPPORTED,yr.exports.WASM_LOADED=!1,yr.exports.SHA512_BYTES=64,po.ready((function(t){t||(yr.exports.WASM_LOADED=!0,yr.exports=yo=po)}));const{crypto_verify_32:Io}=gr.exports,mo=yr.exports,Eo=ur;var wo={crypto_auth_BYTES:32,crypto_auth_KEYBYTES:32,crypto_auth:function(t,e,n){Eo(32===t.byteLength,"out should be 'crypto_auth_BYTES' in length"),Eo(32===n.byteLength,"key should be 'crypto_auth_KEYBYTES' in length");const r=new Uint8Array(64),o=mo.HMAC(n);o.update(e),o.digest(r),t.set(r.subarray(0,32))},crypto_auth_verify:function(t,e,n){Eo(32===t.byteLength,"h should be 'crypto_auth_BYTES' in length"),Eo(32===n.byteLength,"key should be 'crypto_auth_KEYBYTES' in length");const r=mo.HMAC(n).update(e).digest();return Io(t,0,r,0)}};const bo=yr.exports,Co=ur;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");function Bo(t,e,n){return Co(64===t.byteLength,"out must be 'crypto_hash_sha512_BYTES' bytes long"),bo().update(e.subarray(0,n)).digest(t),0}var vo={crypto_hash:function(t,e,n){return Bo(t,e,n)},crypto_hash_sha512:Bo,crypto_hash_sha512_BYTES:64,crypto_hash_BYTES:64};if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var _o=function(t){var e,n=new Float64Array(16);if(t)for(e=0;e<t.length;e++)n[e]=t[e];return n},ko=new Uint8Array(32);ko[0]=9;var xo=_o(),So=_o([1]),Qo=_o([56129,1]),Mo=_o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),Do=_o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),To=_o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),Lo=_o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),$o=_o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function Uo(t,e,n){var r,o,i=0,s=0,a=0,c=0,u=0,l=0,h=0,f=0,g=0,d=0,A=0,p=0,y=0,I=0,m=0,E=0,w=0,b=0,C=0,B=0,v=0,_=0,k=0,x=0,S=0,Q=0,M=0,D=0,T=0,L=0,$=0,U=n[0],O=n[1],F=n[2],N=n[3],P=n[4],Y=n[5],K=n[6],R=n[7],j=n[8],H=n[9],V=n[10],G=n[11],q=n[12],z=n[13],J=n[14],W=n[15];i+=(r=e[0])*U,s+=r*O,a+=r*F,c+=r*N,u+=r*P,l+=r*Y,h+=r*K,f+=r*R,g+=r*j,d+=r*H,A+=r*V,p+=r*G,y+=r*q,I+=r*z,m+=r*J,E+=r*W,s+=(r=e[1])*U,a+=r*O,c+=r*F,u+=r*N,l+=r*P,h+=r*Y,f+=r*K,g+=r*R,d+=r*j,A+=r*H,p+=r*V,y+=r*G,I+=r*q,m+=r*z,E+=r*J,w+=r*W,a+=(r=e[2])*U,c+=r*O,u+=r*F,l+=r*N,h+=r*P,f+=r*Y,g+=r*K,d+=r*R,A+=r*j,p+=r*H,y+=r*V,I+=r*G,m+=r*q,E+=r*z,w+=r*J,b+=r*W,c+=(r=e[3])*U,u+=r*O,l+=r*F,h+=r*N,f+=r*P,g+=r*Y,d+=r*K,A+=r*R,p+=r*j,y+=r*H,I+=r*V,m+=r*G,E+=r*q,w+=r*z,b+=r*J,C+=r*W,u+=(r=e[4])*U,l+=r*O,h+=r*F,f+=r*N,g+=r*P,d+=r*Y,A+=r*K,p+=r*R,y+=r*j,I+=r*H,m+=r*V,E+=r*G,w+=r*q,b+=r*z,C+=r*J,B+=r*W,l+=(r=e[5])*U,h+=r*O,f+=r*F,g+=r*N,d+=r*P,A+=r*Y,p+=r*K,y+=r*R,I+=r*j,m+=r*H,E+=r*V,w+=r*G,b+=r*q,C+=r*z,B+=r*J,v+=r*W,h+=(r=e[6])*U,f+=r*O,g+=r*F,d+=r*N,A+=r*P,p+=r*Y,y+=r*K,I+=r*R,m+=r*j,E+=r*H,w+=r*V,b+=r*G,C+=r*q,B+=r*z,v+=r*J,_+=r*W,f+=(r=e[7])*U,g+=r*O,d+=r*F,A+=r*N,p+=r*P,y+=r*Y,I+=r*K,m+=r*R,E+=r*j,w+=r*H,b+=r*V,C+=r*G,B+=r*q,v+=r*z,_+=r*J,k+=r*W,g+=(r=e[8])*U,d+=r*O,A+=r*F,p+=r*N,y+=r*P,I+=r*Y,m+=r*K,E+=r*R,w+=r*j,b+=r*H,C+=r*V,B+=r*G,v+=r*q,_+=r*z,k+=r*J,x+=r*W,d+=(r=e[9])*U,A+=r*O,p+=r*F,y+=r*N,I+=r*P,m+=r*Y,E+=r*K,w+=r*R,b+=r*j,C+=r*H,B+=r*V,v+=r*G,_+=r*q,k+=r*z,x+=r*J,S+=r*W,A+=(r=e[10])*U,p+=r*O,y+=r*F,I+=r*N,m+=r*P,E+=r*Y,w+=r*K,b+=r*R,C+=r*j,B+=r*H,v+=r*V,_+=r*G,k+=r*q,x+=r*z,S+=r*J,Q+=r*W,p+=(r=e[11])*U,y+=r*O,I+=r*F,m+=r*N,E+=r*P,w+=r*Y,b+=r*K,C+=r*R,B+=r*j,v+=r*H,_+=r*V,k+=r*G,x+=r*q,S+=r*z,Q+=r*J,M+=r*W,y+=(r=e[12])*U,I+=r*O,m+=r*F,E+=r*N,w+=r*P,b+=r*Y,C+=r*K,B+=r*R,v+=r*j,_+=r*H,k+=r*V,x+=r*G,S+=r*q,Q+=r*z,M+=r*J,D+=r*W,I+=(r=e[13])*U,m+=r*O,E+=r*F,w+=r*N,b+=r*P,C+=r*Y,B+=r*K,v+=r*R,_+=r*j,k+=r*H,x+=r*V,S+=r*G,Q+=r*q,M+=r*z,D+=r*J,T+=r*W,m+=(r=e[14])*U,E+=r*O,w+=r*F,b+=r*N,C+=r*P,B+=r*Y,v+=r*K,_+=r*R,k+=r*j,x+=r*H,S+=r*V,Q+=r*G,M+=r*q,D+=r*z,T+=r*J,L+=r*W,E+=(r=e[15])*U,s+=38*(b+=r*F),a+=38*(C+=r*N),c+=38*(B+=r*P),u+=38*(v+=r*Y),l+=38*(_+=r*K),h+=38*(k+=r*R),f+=38*(x+=r*j),g+=38*(S+=r*H),d+=38*(Q+=r*V),A+=38*(M+=r*G),p+=38*(D+=r*q),y+=38*(T+=r*z),I+=38*(L+=r*J),m+=38*($+=r*W),i=(r=(i+=38*(w+=r*O))+(o=1)+65535)-65536*(o=Math.floor(r/65536)),s=(r=s+o+65535)-65536*(o=Math.floor(r/65536)),a=(r=a+o+65535)-65536*(o=Math.floor(r/65536)),c=(r=c+o+65535)-65536*(o=Math.floor(r/65536)),u=(r=u+o+65535)-65536*(o=Math.floor(r/65536)),l=(r=l+o+65535)-65536*(o=Math.floor(r/65536)),h=(r=h+o+65535)-65536*(o=Math.floor(r/65536)),f=(r=f+o+65535)-65536*(o=Math.floor(r/65536)),g=(r=g+o+65535)-65536*(o=Math.floor(r/65536)),d=(r=d+o+65535)-65536*(o=Math.floor(r/65536)),A=(r=A+o+65535)-65536*(o=Math.floor(r/65536)),p=(r=p+o+65535)-65536*(o=Math.floor(r/65536)),y=(r=y+o+65535)-65536*(o=Math.floor(r/65536)),I=(r=I+o+65535)-65536*(o=Math.floor(r/65536)),m=(r=m+o+65535)-65536*(o=Math.floor(r/65536)),E=(r=E+o+65535)-65536*(o=Math.floor(r/65536)),i=(r=(i+=o-1+37*(o-1))+(o=1)+65535)-65536*(o=Math.floor(r/65536)),s=(r=s+o+65535)-65536*(o=Math.floor(r/65536)),a=(r=a+o+65535)-65536*(o=Math.floor(r/65536)),c=(r=c+o+65535)-65536*(o=Math.floor(r/65536)),u=(r=u+o+65535)-65536*(o=Math.floor(r/65536)),l=(r=l+o+65535)-65536*(o=Math.floor(r/65536)),h=(r=h+o+65535)-65536*(o=Math.floor(r/65536)),f=(r=f+o+65535)-65536*(o=Math.floor(r/65536)),g=(r=g+o+65535)-65536*(o=Math.floor(r/65536)),d=(r=d+o+65535)-65536*(o=Math.floor(r/65536)),A=(r=A+o+65535)-65536*(o=Math.floor(r/65536)),p=(r=p+o+65535)-65536*(o=Math.floor(r/65536)),y=(r=y+o+65535)-65536*(o=Math.floor(r/65536)),I=(r=I+o+65535)-65536*(o=Math.floor(r/65536)),m=(r=m+o+65535)-65536*(o=Math.floor(r/65536)),E=(r=E+o+65535)-65536*(o=Math.floor(r/65536)),i+=o-1+37*(o-1),t[0]=i,t[1]=s,t[2]=a,t[3]=c,t[4]=u,t[5]=l,t[6]=h,t[7]=f,t[8]=g,t[9]=d,t[10]=A,t[11]=p,t[12]=y,t[13]=I,t[14]=m,t[15]=E}function Oo(t,e){Uo(t,e,e)}function Fo(t,e,n){for(var r,o=~(n-1),i=0;i<16;i++)r=o&(t[i]^e[i]),t[i]^=r,e[i]^=r}function No(t){var e,n,r=1;for(e=0;e<16;e++)n=t[e]+r+65535,r=Math.floor(n/65536),t[e]=n-65536*r;t[0]+=r-1+37*(r-1)}var Po={gf:_o,A:function(t,e,n){for(var r=0;r<16;r++)t[r]=e[r]+n[r]},Z:function(t,e,n){for(var r=0;r<16;r++)t[r]=e[r]-n[r]},M:Uo,S:Oo,sel25519:Fo,pack25519:function(t,e){var n,r,o,i=_o(),s=_o();for(n=0;n<16;n++)s[n]=e[n];for(No(s),No(s),No(s),r=0;r<2;r++){for(i[0]=s[0]-65517,n=1;n<15;n++)i[n]=s[n]-65535-(i[n-1]>>16&1),i[n-1]&=65535;i[15]=s[15]-32767-(i[14]>>16&1),o=i[15]>>16&1,i[14]&=65535,Fo(s,i,1-o)}for(n=0;n<16;n++)t[2*n]=255&s[n],t[2*n+1]=s[n]>>8},unpack25519:function(t,e){var n;for(n=0;n<16;n++)t[n]=e[2*n]+(e[2*n+1]<<8);t[15]&=32767},inv25519:function(t,e){var n,r=_o();for(n=0;n<16;n++)r[n]=e[n];for(n=253;n>=0;n--)Oo(r,r),2!==n&&4!==n&&Uo(r,r,e);for(n=0;n<16;n++)t[n]=r[n]},gf0:xo,gf1:So,_9:ko,_121665:Qo,D:Mo,D2:Do,X:To,Y:Lo,I:$o};const{_9:Yo,_121665:Ko,gf:Ro,inv25519:jo,pack25519:Ho,unpack25519:Vo,sel25519:Go,A:qo,M:zo,Z:Jo,S:Wo}=Po;var Xo={crypto_scalarmult:Zo,crypto_scalarmult_base:function(t,e){return Zo(t,e,Yo)},crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32};function Zo(t,e,n){ti(t,32),ti(e,32),ti(n,32);var r,o,i=new Uint8Array(32),s=new Float64Array(80),a=Ro(),c=Ro(),u=Ro(),l=Ro(),h=Ro(),f=Ro();for(o=0;o<31;o++)i[o]=e[o];for(i[31]=127&e[31]|64,i[0]&=248,Vo(s,n),o=0;o<16;o++)c[o]=s[o],l[o]=a[o]=u[o]=0;for(a[0]=l[0]=1,o=254;o>=0;--o)r=i[o>>>3]>>>(7&o)&1,Go(a,c,r),Go(u,l,r),qo(h,a,u),Jo(a,a,u),qo(u,c,l),Jo(c,c,l),Wo(l,h),Wo(f,a),zo(a,u,a),zo(u,c,h),qo(h,a,u),Jo(a,a,u),Wo(c,a),Jo(u,l,f),zo(a,u,Ko),qo(a,a,l),zo(u,u,a),zo(a,l,f),zo(l,c,s),Wo(c,h),Go(a,c,r),Go(u,l,r);for(o=0;o<16;o++)s[o+16]=a[o],s[o+32]=u[o],s[o+48]=c[o],s[o+64]=l[o];var g=s.subarray(32),d=s.subarray(16);return jo(g,g),zo(d,d,g),Ho(t,d),0}function ti(t,e){if(!t||e&&t.length<e)throw new Error("Argument must be a buffer"+(e?" of length "+e:""))}var ei,ni,ri={exports:{}},oi={exports:{}},ii={exports:{}};var si=ur,ai=Yr,ci=null,ui="undefined"!=typeof WebAssembly&&function(){if(ni)return ei;ni=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./blake2b.wat"(e,n){n.exports=t("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")}}),n=e(),r=WebAssembly.compile(n);return ei=async t=>(await WebAssembly.instantiate(await r,t)).exports,ei}()().then((t=>{ci=t})),li=64,hi=[];ii.exports=Ii;var fi=ii.exports.BYTES_MIN=16,gi=ii.exports.BYTES_MAX=64;ii.exports.BYTES=32;var di=ii.exports.KEYBYTES_MIN=16,Ai=ii.exports.KEYBYTES_MAX=64;ii.exports.KEYBYTES=32;var pi=ii.exports.SALTBYTES=16,yi=ii.exports.PERSONALBYTES=16;function Ii(t,e,n,r,o){if(!(this instanceof Ii))return new Ii(t,e,n,r,o);if(!ci)throw new Error("WASM not loaded. Wait for Blake2b.ready(cb)");t||(t=32),!0!==o&&(si(t>=fi,"digestLength must be at least "+fi+", was given "+t),si(t<=gi,"digestLength must be at most "+gi+", was given "+t),null!=e&&(si(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),si(e.length>=di,"key must be at least "+di+", was given "+e.length),si(e.length<=Ai,"key must be at least "+Ai+", was given "+e.length)),null!=n&&(si(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),si(n.length===pi,"salt must be exactly "+pi+", was given "+n.length)),null!=r&&(si(r instanceof Uint8Array,"personal must be Uint8Array or Buffer"),si(r.length===yi,"personal must be exactly "+yi+", was given "+r.length))),hi.length||(hi.push(li),li+=216),this.digestLength=t,this.finalized=!1,this.pointer=hi.pop(),this._memory=new Uint8Array(ci.memory.buffer),this._memory.fill(0,0,64),this._memory[0]=this.digestLength,this._memory[1]=e?e.length:0,this._memory[2]=1,this._memory[3]=1,n&&this._memory.set(n,32),r&&this._memory.set(r,48),this.pointer+216>this._memory.length&&this._realloc(this.pointer+216),ci.blake2b_init(this.pointer,this.digestLength),e&&(this.update(e),this._memory.fill(0,li,li+e.length),this._memory[this.pointer+200]=128)}function mi(){}Ii.prototype._realloc=function(t){ci.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(ci.memory.buffer)},Ii.prototype.update=function(t){return si(!1===this.finalized,"Hash instance finalized"),si(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),li+t.length>this._memory.length&&this._realloc(li+t.length),this._memory.set(t,li),ci.blake2b_update(this.pointer,li,li+t.length),this},Ii.prototype.digest=function(t){if(si(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,hi.push(this.pointer),ci.blake2b_final(this.pointer),!t||"binary"===t)return this._memory.slice(this.pointer+128,this.pointer+128+this.digestLength);if("string"==typeof t)return ai.toString(this._memory,t,this.pointer+128,this.pointer+128+this.digestLength);si(t instanceof Uint8Array&&t.length>=this.digestLength,"input must be Uint8Array or Buffer");for(var e=0;e<this.digestLength;e++)t[e]=this._memory[this.pointer+128+e];return t},Ii.prototype.final=Ii.prototype.digest,Ii.WASM=ci,Ii.SUPPORTED="undefined"!=typeof WebAssembly,Ii.ready=function(t){return t||(t=mi),ui?ui.then((()=>t()),t):t(new Error("WebAssembly not supported"))},Ii.prototype.ready=Ii.ready,Ii.prototype.getPartialHash=function(){return this._memory.slice(this.pointer,this.pointer+216)},Ii.prototype.setPartialHash=function(t){this._memory.set(t,this.pointer)};var Ei=ur,wi=ii.exports;function bi(t,e,n){var r=t[e]+t[n],o=t[e+1]+t[n+1];r>=4294967296&&o++,t[e]=r,t[e+1]=o}function Ci(t,e,n,r){var o=t[e]+n;n<0&&(o+=4294967296);var i=t[e+1]+r;o>=4294967296&&i++,t[e]=o,t[e+1]=i}function Bi(t,e){return t[e]^t[e+1]<<8^t[e+2]<<16^t[e+3]<<24}function vi(t,e,n,r,o,i){var s=Si[o],a=Si[o+1],c=Si[i],u=Si[i+1];bi(xi,t,e),Ci(xi,t,s,a);var l=xi[r]^xi[t],h=xi[r+1]^xi[t+1];xi[r]=h,xi[r+1]=l,bi(xi,n,r),l=xi[e]^xi[n],h=xi[e+1]^xi[n+1],xi[e]=l>>>24^h<<8,xi[e+1]=h>>>24^l<<8,bi(xi,t,e),Ci(xi,t,c,u),l=xi[r]^xi[t],h=xi[r+1]^xi[t+1],xi[r]=l>>>16^h<<16,xi[r+1]=h>>>16^l<<16,bi(xi,n,r),l=xi[e]^xi[n],h=xi[e+1]^xi[n+1],xi[e]=h>>>31^l<<1,xi[e+1]=l>>>31^h<<1}var _i=new Uint32Array([4089235720,1779033703,2227873595,3144134277,4271175723,1013904242,1595750129,2773480762,2917565137,1359893119,725511199,2600822924,4215389547,528734635,327033209,1541459225]),ki=new Uint8Array([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3,11,8,12,0,5,2,15,13,10,14,3,6,7,1,9,4,7,9,3,1,13,12,11,14,2,6,5,10,4,0,15,8,9,0,5,7,2,4,10,15,14,1,11,12,6,8,3,13,2,12,6,10,0,11,8,3,4,13,7,5,15,14,1,9,12,5,1,15,14,13,4,10,0,7,6,3,9,2,8,11,13,11,7,14,12,1,3,9,5,0,15,4,8,6,2,10,6,15,14,9,11,3,0,8,12,2,13,7,1,4,10,5,10,2,8,4,7,6,1,5,15,11,9,14,3,12,13,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,14,10,4,8,9,15,13,6,1,12,0,2,11,7,5,3].map((function(t){return 2*t}))),xi=new Uint32Array(32),Si=new Uint32Array(32);function Qi(t,e){var n=0;for(n=0;n<16;n++)xi[n]=t.h[n],xi[n+16]=_i[n];for(xi[24]=xi[24]^t.t,xi[25]=xi[25]^t.t/4294967296,e&&(xi[28]=~xi[28],xi[29]=~xi[29]),n=0;n<32;n++)Si[n]=Bi(t.b,4*n);for(n=0;n<12;n++)vi(0,8,16,24,ki[16*n+0],ki[16*n+1]),vi(2,10,18,26,ki[16*n+2],ki[16*n+3]),vi(4,12,20,28,ki[16*n+4],ki[16*n+5]),vi(6,14,22,30,ki[16*n+6],ki[16*n+7]),vi(0,10,20,30,ki[16*n+8],ki[16*n+9]),vi(2,12,22,24,ki[16*n+10],ki[16*n+11]),vi(4,14,16,26,ki[16*n+12],ki[16*n+13]),vi(6,8,18,28,ki[16*n+14],ki[16*n+15]);for(n=0;n<16;n++)t.h[n]=t.h[n]^xi[n]^xi[n+16]}var Mi=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]);function Di(t,e,n,r){Mi.fill(0),this.b=new Uint8Array(128),this.h=new Uint32Array(16),this.t=0,this.c=0,this.outlen=t,Mi[0]=t,e&&(Mi[1]=e.length),Mi[2]=1,Mi[3]=1,n&&Mi.set(n,32),r&&Mi.set(r,48);for(var o=0;o<16;o++)this.h[o]=_i[o]^Bi(Mi,4*o);e&&(Ti(this,e),this.c=128)}function Ti(t,e){for(var n=0;n<e.length;n++)128===t.c&&(t.t+=t.c,Qi(t,!1),t.c=0),t.b[t.c++]=e[n]}function Li(t){return t<16?"0"+t.toString(16):t.toString(16)}Di.prototype.update=function(t){return Ei(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),Ti(this,t),this},Di.prototype.digest=function(t){var e=t&&"binary"!==t&&"hex"!==t?t:new Uint8Array(this.outlen);return Ei(e instanceof Uint8Array,'out must be "binary", "hex", Uint8Array, or Buffer'),Ei(e.length>=this.outlen,"out must have at least outlen bytes of space"),function(t,e){t.t+=t.c;for(;t.c<128;)t.b[t.c++]=0;Qi(t,!0);for(var n=0;n<t.outlen;n++)e[n]=t.h[n>>2]>>8*(3&n)}(this,e),"hex"===t?function(t){for(var e="",n=0;n<t.length;n++)e+=Li(t[n]);return e}(e):e},Di.prototype.final=Di.prototype.digest,Di.ready=function(t){wi.ready((function(){t()}))};var $i=Di;oi.exports=function(t,e,n,r,o){return!0!==o&&(Ei(t>=Ui,"outlen must be at least "+Ui+", was given "+t),Ei(t<=Oi,"outlen must be at most "+Oi+", was given "+t),null!=e&&(Ei(e instanceof Uint8Array,"key must be Uint8Array or Buffer"),Ei(e.length>=Fi,"key must be at least "+Fi+", was given "+e.length),Ei(e.length<=Ni,"key must be at most "+Ni+", was given "+e.length)),null!=n&&(Ei(n instanceof Uint8Array,"salt must be Uint8Array or Buffer"),Ei(n.length===Pi,"salt must be exactly "+Pi+", was given "+n.length)),null!=r&&(Ei(r instanceof Uint8Array,"personal must be Uint8Array or Buffer"),Ei(r.length===Yi,"personal must be exactly "+Yi+", was given "+r.length))),new $i(t,e,n,r)},oi.exports.ready=function(t){wi.ready((function(){t()}))},oi.exports.WASM_SUPPORTED=wi.SUPPORTED,oi.exports.WASM_LOADED=!1;var Ui=oi.exports.BYTES_MIN=16,Oi=oi.exports.BYTES_MAX=64;oi.exports.BYTES=32;var Fi=oi.exports.KEYBYTES_MIN=16,Ni=oi.exports.KEYBYTES_MAX=64;oi.exports.KEYBYTES=32;var Pi=oi.exports.SALTBYTES=16,Yi=oi.exports.PERSONALBYTES=16;wi.ready((function(t){t||(oi.exports.WASM_LOADED=!0,oi.exports=wi)})),function(t){var e=oi.exports;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");t.exports.crypto_generichash_PRIMITIVE="blake2b",t.exports.crypto_generichash_BYTES_MIN=e.BYTES_MIN,t.exports.crypto_generichash_BYTES_MAX=e.BYTES_MAX,t.exports.crypto_generichash_BYTES=e.BYTES,t.exports.crypto_generichash_KEYBYTES_MIN=e.KEYBYTES_MIN,t.exports.crypto_generichash_KEYBYTES_MAX=e.KEYBYTES_MAX,t.exports.crypto_generichash_KEYBYTES=e.KEYBYTES,t.exports.crypto_generichash_WASM_SUPPORTED=e.WASM_SUPPORTED,t.exports.crypto_generichash_WASM_LOADED=!1,t.exports.crypto_generichash=function(t,n,r){e(t.length,r).update(n).final(t)},t.exports.crypto_generichash_ready=e.ready,t.exports.crypto_generichash_batch=function(t,n,r){for(var o=e(t.length,r),i=0;i<n.length;i++)o.update(n[i]);o.final(t)},t.exports.crypto_generichash_instance=function(n,r){return null==r&&(r=t.exports.crypto_generichash_BYTES),e(r,n)},e.ready((function(n){t.exports.crypto_generichash_WASM_LOADED=e.WASM_LOADED}))}(ri);var Ki,Ri,ji={};var Hi="undefined"!=typeof WebAssembly&&function(){if(Ri)return Ki;Ri=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./xsalsa20.wat"(e,n){n.exports=t("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")}}),n=e(),r=new WebAssembly.Module(n);return Ki=t=>new WebAssembly.Instance(r,t).exports,Ki}()(),Vi=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]),Gi=144,qi=Gi,zi=[],Ji=Wi;function Wi(t,e){if(!(this instanceof Wi))return new Wi(t,e);if(!t||t.length<24)throw new Error("nonce must be at least 24 bytes");if(!e||e.length<32)throw new Error("key must be at least 32 bytes");this._xor=Hi?new Xi(t,e):new Zi(t,e)}function Xi(t,e){zi.length||(zi.push(Gi),Gi+=64),this._pointer=zi.pop(),this._nonce=this._pointer+8,this._key=this._nonce+24,this._overflow=0,this._memory=new Uint8Array(Hi.memory.buffer),this._memory.fill(0,this._pointer,this._pointer+8),this._memory.set(t,this._nonce),this._memory.set(e,this._key)}function Zi(t,e){this._s=new Uint8Array(32),this._z=new Uint8Array(16),this._overflow=0,es(this._s,t,e,Vi);for(var n=0;n<8;n++)this._z[n]=t[n+16]}function ts(t,e,n,r){for(var o,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,u=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,l=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,f=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,g=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,d=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,A=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,p=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,I=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,m=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,E=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,w=i,b=s,C=a,B=c,v=u,_=l,k=h,x=f,S=g,Q=d,M=A,D=p,T=y,L=I,$=m,U=E,O=0;O<20;O+=2)w^=(o=(T^=(o=(S^=(o=(v^=(o=w+T|0)<<7|o>>>25)+w|0)<<9|o>>>23)+v|0)<<13|o>>>19)+S|0)<<18|o>>>14,_^=(o=(b^=(o=(L^=(o=(Q^=(o=_+b|0)<<7|o>>>25)+_|0)<<9|o>>>23)+Q|0)<<13|o>>>19)+L|0)<<18|o>>>14,M^=(o=(k^=(o=(C^=(o=($^=(o=M+k|0)<<7|o>>>25)+M|0)<<9|o>>>23)+$|0)<<13|o>>>19)+C|0)<<18|o>>>14,U^=(o=(D^=(o=(x^=(o=(B^=(o=U+D|0)<<7|o>>>25)+U|0)<<9|o>>>23)+B|0)<<13|o>>>19)+x|0)<<18|o>>>14,w^=(o=(B^=(o=(C^=(o=(b^=(o=w+B|0)<<7|o>>>25)+w|0)<<9|o>>>23)+b|0)<<13|o>>>19)+C|0)<<18|o>>>14,_^=(o=(v^=(o=(x^=(o=(k^=(o=_+v|0)<<7|o>>>25)+_|0)<<9|o>>>23)+k|0)<<13|o>>>19)+x|0)<<18|o>>>14,M^=(o=(Q^=(o=(S^=(o=(D^=(o=M+Q|0)<<7|o>>>25)+M|0)<<9|o>>>23)+D|0)<<13|o>>>19)+S|0)<<18|o>>>14,U^=(o=($^=(o=(L^=(o=(T^=(o=U+$|0)<<7|o>>>25)+U|0)<<9|o>>>23)+T|0)<<13|o>>>19)+L|0)<<18|o>>>14;w=w+i|0,b=b+s|0,C=C+a|0,B=B+c|0,v=v+u|0,_=_+l|0,k=k+h|0,x=x+f|0,S=S+g|0,Q=Q+d|0,M=M+A|0,D=D+p|0,T=T+y|0,L=L+I|0,$=$+m|0,U=U+E|0,t[0]=w>>>0&255,t[1]=w>>>8&255,t[2]=w>>>16&255,t[3]=w>>>24&255,t[4]=b>>>0&255,t[5]=b>>>8&255,t[6]=b>>>16&255,t[7]=b>>>24&255,t[8]=C>>>0&255,t[9]=C>>>8&255,t[10]=C>>>16&255,t[11]=C>>>24&255,t[12]=B>>>0&255,t[13]=B>>>8&255,t[14]=B>>>16&255,t[15]=B>>>24&255,t[16]=v>>>0&255,t[17]=v>>>8&255,t[18]=v>>>16&255,t[19]=v>>>24&255,t[20]=_>>>0&255,t[21]=_>>>8&255,t[22]=_>>>16&255,t[23]=_>>>24&255,t[24]=k>>>0&255,t[25]=k>>>8&255,t[26]=k>>>16&255,t[27]=k>>>24&255,t[28]=x>>>0&255,t[29]=x>>>8&255,t[30]=x>>>16&255,t[31]=x>>>24&255,t[32]=S>>>0&255,t[33]=S>>>8&255,t[34]=S>>>16&255,t[35]=S>>>24&255,t[36]=Q>>>0&255,t[37]=Q>>>8&255,t[38]=Q>>>16&255,t[39]=Q>>>24&255,t[40]=M>>>0&255,t[41]=M>>>8&255,t[42]=M>>>16&255,t[43]=M>>>24&255,t[44]=D>>>0&255,t[45]=D>>>8&255,t[46]=D>>>16&255,t[47]=D>>>24&255,t[48]=T>>>0&255,t[49]=T>>>8&255,t[50]=T>>>16&255,t[51]=T>>>24&255,t[52]=L>>>0&255,t[53]=L>>>8&255,t[54]=L>>>16&255,t[55]=L>>>24&255,t[56]=$>>>0&255,t[57]=$>>>8&255,t[58]=$>>>16&255,t[59]=$>>>24&255,t[60]=U>>>0&255,t[61]=U>>>8&255,t[62]=U>>>16&255,t[63]=U>>>24&255}function es(t,e,n,r){for(var o,i=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,s=255&n[0]|(255&n[1])<<8|(255&n[2])<<16|(255&n[3])<<24,a=255&n[4]|(255&n[5])<<8|(255&n[6])<<16|(255&n[7])<<24,c=255&n[8]|(255&n[9])<<8|(255&n[10])<<16|(255&n[11])<<24,u=255&n[12]|(255&n[13])<<8|(255&n[14])<<16|(255&n[15])<<24,l=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,h=255&e[0]|(255&e[1])<<8|(255&e[2])<<16|(255&e[3])<<24,f=255&e[4]|(255&e[5])<<8|(255&e[6])<<16|(255&e[7])<<24,g=255&e[8]|(255&e[9])<<8|(255&e[10])<<16|(255&e[11])<<24,d=255&e[12]|(255&e[13])<<8|(255&e[14])<<16|(255&e[15])<<24,A=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,p=255&n[16]|(255&n[17])<<8|(255&n[18])<<16|(255&n[19])<<24,y=255&n[20]|(255&n[21])<<8|(255&n[22])<<16|(255&n[23])<<24,I=255&n[24]|(255&n[25])<<8|(255&n[26])<<16|(255&n[27])<<24,m=255&n[28]|(255&n[29])<<8|(255&n[30])<<16|(255&n[31])<<24,E=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,w=0;w<20;w+=2)i^=(o=(y^=(o=(g^=(o=(u^=(o=i+y|0)<<7|o>>>25)+i|0)<<9|o>>>23)+u|0)<<13|o>>>19)+g|0)<<18|o>>>14,l^=(o=(s^=(o=(I^=(o=(d^=(o=l+s|0)<<7|o>>>25)+l|0)<<9|o>>>23)+d|0)<<13|o>>>19)+I|0)<<18|o>>>14,A^=(o=(h^=(o=(a^=(o=(m^=(o=A+h|0)<<7|o>>>25)+A|0)<<9|o>>>23)+m|0)<<13|o>>>19)+a|0)<<18|o>>>14,E^=(o=(p^=(o=(f^=(o=(c^=(o=E+p|0)<<7|o>>>25)+E|0)<<9|o>>>23)+c|0)<<13|o>>>19)+f|0)<<18|o>>>14,i^=(o=(c^=(o=(a^=(o=(s^=(o=i+c|0)<<7|o>>>25)+i|0)<<9|o>>>23)+s|0)<<13|o>>>19)+a|0)<<18|o>>>14,l^=(o=(u^=(o=(f^=(o=(h^=(o=l+u|0)<<7|o>>>25)+l|0)<<9|o>>>23)+h|0)<<13|o>>>19)+f|0)<<18|o>>>14,A^=(o=(d^=(o=(g^=(o=(p^=(o=A+d|0)<<7|o>>>25)+A|0)<<9|o>>>23)+p|0)<<13|o>>>19)+g|0)<<18|o>>>14,E^=(o=(m^=(o=(I^=(o=(y^=(o=E+m|0)<<7|o>>>25)+E|0)<<9|o>>>23)+y|0)<<13|o>>>19)+I|0)<<18|o>>>14;t[0]=i>>>0&255,t[1]=i>>>8&255,t[2]=i>>>16&255,t[3]=i>>>24&255,t[4]=l>>>0&255,t[5]=l>>>8&255,t[6]=l>>>16&255,t[7]=l>>>24&255,t[8]=A>>>0&255,t[9]=A>>>8&255,t[10]=A>>>16&255,t[11]=A>>>24&255,t[12]=E>>>0&255,t[13]=E>>>8&255,t[14]=E>>>16&255,t[15]=E>>>24&255,t[16]=h>>>0&255,t[17]=h>>>8&255,t[18]=h>>>16&255,t[19]=h>>>24&255,t[20]=f>>>0&255,t[21]=f>>>8&255,t[22]=f>>>16&255,t[23]=f>>>24&255,t[24]=g>>>0&255,t[25]=g>>>8&255,t[26]=g>>>16&255,t[27]=g>>>24&255,t[28]=d>>>0&255,t[29]=d>>>8&255,t[30]=d>>>16&255,t[31]=d>>>24&255}if(Wi.NONCEBYTES=24,Wi.KEYBYTES=32,Wi.core_hsalsa20=es,Wi.SIGMA=Vi,Wi.prototype.update=function(t,e){if(!t)throw new Error("input must be Uint8Array or Buffer");return e||(e=new Uint8Array(t.length)),t.length&&this._xor.update(t,e),e},Wi.prototype.final=Wi.prototype.finalize=function(){this._xor.finalize(),this._xor=null},Xi.prototype.realloc=function(t){Hi.memory.grow(Math.ceil(Math.abs(t-this._memory.length)/65536)),this._memory=new Uint8Array(Hi.memory.buffer)},Xi.prototype.update=function(t,e){var n=this._overflow+t.length,r=Gi+this._overflow;(qi=Gi+n)>=this._memory.length&&this.realloc(qi),this._memory.set(t,r),Hi.xsalsa20_xor(this._pointer,Gi,Gi,n,this._nonce,this._key),e.set(this._memory.subarray(r,Gi+n)),this._overflow=63&n},Xi.prototype.finalize=function(){this._memory.fill(0,this._pointer,this._key+32),qi>Gi&&(this._memory.fill(0,Gi,qi),qi=0),zi.push(this._pointer)},Zi.prototype.update=function(t,e){for(var n=new Uint8Array(64),r=0,o=this._overflow,i=t.length+this._overflow,s=this._z,a=-this._overflow,c=-this._overflow;i>=64;){for(ts(n,s,this._s,Vi);o<64;o++)e[c+o]=t[a+o]^n[o];for(r=1,o=8;o<16;o++)r+=255&s[o]|0,s[o]=255&r,r>>>=8;i-=64,c+=64,a+=64,o=0}if(i>0)for(ts(n,s,this._s,Vi);o<i;o++)e[c+o]=t[a+o]^n[o];this._overflow=63&i},Zi.prototype.finalize=function(){this._s.fill(0),this._z.fill(0)},function(t){const e=Ji;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");function n(t,n){this._instance=e(t,n)}t.crypto_stream_KEYBYTES=32,t.crypto_stream_NONCEBYTES=24,t.crypto_stream_PRIMITIVE="xsalsa20",t.crypto_stream_xsalsa20_MESSAGEBYTES_MAX=Number.MAX_SAFE_INTEGER,t.crypto_stream=function(e,n,r){e.fill(0),t.crypto_stream_xor(e,e,n,r)},t.crypto_stream_xor=function(t,n,r,o){const i=e(r,o);i.update(n,t),i.final()},t.crypto_stream_xor_instance=function(t,e){return new n(t,e)},n.prototype.update=function(t,e){this._instance.update(e,t)},n.prototype.final=function(){this._instance.finalize(),this._instance=null}}(ji),1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var ns=function(t){var e,n,r,o,i,s,a,c;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,e=255&t[0]|(255&t[1])<<8,this.r[0]=8191&e,n=255&t[2]|(255&t[3])<<8,this.r[1]=8191&(e>>>13|n<<3),r=255&t[4]|(255&t[5])<<8,this.r[2]=7939&(n>>>10|r<<6),o=255&t[6]|(255&t[7])<<8,this.r[3]=8191&(r>>>7|o<<9),i=255&t[8]|(255&t[9])<<8,this.r[4]=255&(o>>>4|i<<12),this.r[5]=i>>>1&8190,s=255&t[10]|(255&t[11])<<8,this.r[6]=8191&(i>>>14|s<<2),a=255&t[12]|(255&t[13])<<8,this.r[7]=8065&(s>>>11|a<<5),c=255&t[14]|(255&t[15])<<8,this.r[8]=8191&(a>>>8|c<<8),this.r[9]=c>>>5&127,this.pad[0]=255&t[16]|(255&t[17])<<8,this.pad[1]=255&t[18]|(255&t[19])<<8,this.pad[2]=255&t[20]|(255&t[21])<<8,this.pad[3]=255&t[22]|(255&t[23])<<8,this.pad[4]=255&t[24]|(255&t[25])<<8,this.pad[5]=255&t[26]|(255&t[27])<<8,this.pad[6]=255&t[28]|(255&t[29])<<8,this.pad[7]=255&t[30]|(255&t[31])<<8};ns.prototype.blocks=function(t,e,n){for(var r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b=this.fin?0:2048,C=this.h[0],B=this.h[1],v=this.h[2],_=this.h[3],k=this.h[4],x=this.h[5],S=this.h[6],Q=this.h[7],M=this.h[8],D=this.h[9],T=this.r[0],L=this.r[1],$=this.r[2],U=this.r[3],O=this.r[4],F=this.r[5],N=this.r[6],P=this.r[7],Y=this.r[8],K=this.r[9];n>=16;)f=h=0,f+=(C+=8191&(r=255&t[e+0]|(255&t[e+1])<<8))*T,f+=(B+=8191&(r>>>13|(o=255&t[e+2]|(255&t[e+3])<<8)<<3))*(5*K),f+=(v+=8191&(o>>>10|(i=255&t[e+4]|(255&t[e+5])<<8)<<6))*(5*Y),f+=(_+=8191&(i>>>7|(s=255&t[e+6]|(255&t[e+7])<<8)<<9))*(5*P),h=(f+=(k+=8191&(s>>>4|(a=255&t[e+8]|(255&t[e+9])<<8)<<12))*(5*N))>>>13,f&=8191,f+=(x+=a>>>1&8191)*(5*F),f+=(S+=8191&(a>>>14|(c=255&t[e+10]|(255&t[e+11])<<8)<<2))*(5*O),f+=(Q+=8191&(c>>>11|(u=255&t[e+12]|(255&t[e+13])<<8)<<5))*(5*U),f+=(M+=8191&(u>>>8|(l=255&t[e+14]|(255&t[e+15])<<8)<<8))*(5*$),g=h+=(f+=(D+=l>>>5|b)*(5*L))>>>13,g+=C*L,g+=B*T,g+=v*(5*K),g+=_*(5*Y),h=(g+=k*(5*P))>>>13,g&=8191,g+=x*(5*N),g+=S*(5*F),g+=Q*(5*O),g+=M*(5*U),h+=(g+=D*(5*$))>>>13,g&=8191,d=h,d+=C*$,d+=B*L,d+=v*T,d+=_*(5*K),h=(d+=k*(5*Y))>>>13,d&=8191,d+=x*(5*P),d+=S*(5*N),d+=Q*(5*F),d+=M*(5*O),A=h+=(d+=D*(5*U))>>>13,A+=C*U,A+=B*$,A+=v*L,A+=_*T,h=(A+=k*(5*K))>>>13,A&=8191,A+=x*(5*Y),A+=S*(5*P),A+=Q*(5*N),A+=M*(5*F),p=h+=(A+=D*(5*O))>>>13,p+=C*O,p+=B*U,p+=v*$,p+=_*L,h=(p+=k*T)>>>13,p&=8191,p+=x*(5*K),p+=S*(5*Y),p+=Q*(5*P),p+=M*(5*N),y=h+=(p+=D*(5*F))>>>13,y+=C*F,y+=B*O,y+=v*U,y+=_*$,h=(y+=k*L)>>>13,y&=8191,y+=x*T,y+=S*(5*K),y+=Q*(5*Y),y+=M*(5*P),I=h+=(y+=D*(5*N))>>>13,I+=C*N,I+=B*F,I+=v*O,I+=_*U,h=(I+=k*$)>>>13,I&=8191,I+=x*L,I+=S*T,I+=Q*(5*K),I+=M*(5*Y),m=h+=(I+=D*(5*P))>>>13,m+=C*P,m+=B*N,m+=v*F,m+=_*O,h=(m+=k*U)>>>13,m&=8191,m+=x*$,m+=S*L,m+=Q*T,m+=M*(5*K),E=h+=(m+=D*(5*Y))>>>13,E+=C*Y,E+=B*P,E+=v*N,E+=_*F,h=(E+=k*O)>>>13,E&=8191,E+=x*U,E+=S*$,E+=Q*L,E+=M*T,w=h+=(E+=D*(5*K))>>>13,w+=C*K,w+=B*Y,w+=v*P,w+=_*N,h=(w+=k*F)>>>13,w&=8191,w+=x*O,w+=S*U,w+=Q*$,w+=M*L,C=f=8191&(h=(h=((h+=(w+=D*T)>>>13)<<2)+h|0)+(f&=8191)|0),B=g+=h>>>=13,v=d&=8191,_=A&=8191,k=p&=8191,x=y&=8191,S=I&=8191,Q=m&=8191,M=E&=8191,D=w&=8191,e+=16,n-=16;this.h[0]=C,this.h[1]=B,this.h[2]=v,this.h[3]=_,this.h[4]=k,this.h[5]=x,this.h[6]=S,this.h[7]=Q,this.h[8]=M,this.h[9]=D},ns.prototype.finish=function(t,e){var n,r,o,i,s=new Uint16Array(10);if(this.leftover){for(i=this.leftover,this.buffer[i++]=1;i<16;i++)this.buffer[i]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(n=this.h[1]>>>13,this.h[1]&=8191,i=2;i<10;i++)this.h[i]+=n,n=this.h[i]>>>13,this.h[i]&=8191;for(this.h[0]+=5*n,n=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=n,n=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=n,s[0]=this.h[0]+5,n=s[0]>>>13,s[0]&=8191,i=1;i<10;i++)s[i]=this.h[i]+n,n=s[i]>>>13,s[i]&=8191;for(s[9]-=8192,r=(1^n)-1,i=0;i<10;i++)s[i]&=r;for(r=~r,i=0;i<10;i++)this.h[i]=this.h[i]&r|s[i];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),o=this.h[0]+this.pad[0],this.h[0]=65535&o,i=1;i<8;i++)o=(this.h[i]+this.pad[i]|0)+(o>>>16)|0,this.h[i]=65535&o;t[e+0]=this.h[0]>>>0&255,t[e+1]=this.h[0]>>>8&255,t[e+2]=this.h[1]>>>0&255,t[e+3]=this.h[1]>>>8&255,t[e+4]=this.h[2]>>>0&255,t[e+5]=this.h[2]>>>8&255,t[e+6]=this.h[3]>>>0&255,t[e+7]=this.h[3]>>>8&255,t[e+8]=this.h[4]>>>0&255,t[e+9]=this.h[4]>>>8&255,t[e+10]=this.h[5]>>>0&255,t[e+11]=this.h[5]>>>8&255,t[e+12]=this.h[6]>>>0&255,t[e+13]=this.h[6]>>>8&255,t[e+14]=this.h[7]>>>0&255,t[e+15]=this.h[7]>>>8&255},ns.prototype.update=function(t,e,n){var r,o;if(this.leftover){for((o=16-this.leftover)>n&&(o=n),r=0;r<o;r++)this.buffer[this.leftover+r]=t[e+r];if(n-=o,e+=o,this.leftover+=o,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(n>=16&&(o=n-n%16,this.blocks(t,e,o),e+=o,n-=o),n){for(r=0;r<n;r++)this.buffer[this.leftover+r]=t[e+r];this.leftover+=n}};var rs=ns;const os=ur,is=rs,{crypto_verify_16:ss}=gr.exports;var as={crypto_onetimeauth:cs,crypto_onetimeauth_verify:function(t,e,n){os(16===t.byteLength,"mac must be 'crypto_onetimeauth_BYTES' bytes"),os(null!=e.byteLength,"msg must be buffer"),os(32===n.byteLength,"key must be 'crypto_onetimeauth_KEYBYTES' bytes");var r=new Uint8Array(16);return cs(r,e,n),ss(t,0,r,0)},crypto_onetimeauth_BYTES:16,crypto_onetimeauth_KEYBYTES:32,crypto_onetimeauth_PRIMITIVE:"poly1305"};function cs(t,e,n){os(16===t.byteLength,"mac must be 'crypto_onetimeauth_BYTES' bytes"),os(null!=e.byteLength,"msg must be buffer"),os(32===n.byteLength,"key must be 'crypto_onetimeauth_KEYBYTES' bytes");var r=new is(n);r.update(e,0,e.byteLength),r.finish(t,0)}const us=ur,{crypto_stream:ls,crypto_stream_xor:hs}=ji,{crypto_onetimeauth:fs,crypto_onetimeauth_verify:gs,crypto_onetimeauth_BYTES:ds,crypto_onetimeauth_KEYBYTES:As}=as,ps=32,ys=24,Is=32,ms=16;var Es={crypto_secretbox:ws,crypto_secretbox_open:bs,crypto_secretbox_detached:function(t,e,n,r,o){us(t.byteLength===n.byteLength,"o must be 'msg.byteLength' bytes"),us(16===e.byteLength,"mac must be 'crypto_secretbox_MACBYTES' bytes"),us(r.byteLength===ys,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),us(o.byteLength===ps,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(n.byteLength+e.byteLength);return Cs(i,n,r,o),e.set(i.subarray(0,e.byteLength)),t.set(i.subarray(e.byteLength)),!0},crypto_secretbox_open_detached:function(t,e,n,r,o){us(e.byteLength===t.byteLength,"o must be 'msg.byteLength' bytes"),us(16===n.byteLength,"mac must be 'crypto_secretbox_MACBYTES' bytes"),us(r.byteLength===ys,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),us(o.byteLength===ps,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(e.byteLength+n.byteLength);return i.set(n),i.set(e,n.byteLength),Bs(t,i,r,o)},crypto_secretbox_easy:Cs,crypto_secretbox_open_easy:Bs,crypto_secretbox_KEYBYTES:ps,crypto_secretbox_NONCEBYTES:ys,crypto_secretbox_ZEROBYTES:Is,crypto_secretbox_BOXZEROBYTES:ms,crypto_secretbox_MACBYTES:16};function ws(t,e,n,r){us(t.byteLength===e.byteLength,"c must be 'm.byteLength' bytes");const o=e.byteLength;us(o>=Is,"mlen must be at least 'crypto_secretbox_ZEROBYTES'"),us(n.byteLength===ys,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),us(r.byteLength===ps,"k must be 'crypto_secretbox_KEYBYTES' bytes"),hs(t,e,n,r),fs(t.subarray(ms,ms+ds),t.subarray(ms+ds,t.byteLength),t.subarray(0,As)),t.fill(0,0,ms)}function bs(t,e,n,r){us(e.byteLength===t.byteLength,"c must be 'm.byteLength' bytes");const o=t.byteLength;us(o>=Is,"mlen must be at least 'crypto_secretbox_ZEROBYTES'"),us(n.byteLength===ys,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),us(r.byteLength===ps,"k must be 'crypto_secretbox_KEYBYTES' bytes");const i=new Uint8Array(As);ls(i,n,r);return!1!==gs(e.subarray(ms,ms+ds),e.subarray(ms+ds,e.byteLength),i)&&(hs(t,e,n,r),t.fill(0,0,32),!0)}function Cs(t,e,n,r){us(t.byteLength===e.byteLength+16,"o must be 'msg.byteLength + crypto_secretbox_MACBYTES' bytes"),us(n.byteLength===ys,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),us(r.byteLength===ps,"k must be 'crypto_secretbox_KEYBYTES' bytes");const o=new Uint8Array(Is+e.byteLength),i=new Uint8Array(o.byteLength);o.set(e,Is),ws(i,o,n,r),t.set(i.subarray(ms))}function Bs(t,e,n,r){us(e.byteLength===t.byteLength+16,"box must be 'msg.byteLength + crypto_secretbox_MACBYTES' bytes"),us(n.byteLength===ys,"n must be 'crypto_secretbox_NONCEBYTES' bytes"),us(r.byteLength===ps,"k must be 'crypto_secretbox_KEYBYTES' bytes");const o=new Uint8Array(ms+e.byteLength),i=new Uint8Array(o.byteLength);return o.set(e,ms),!1!==bs(i,o,n,r)&&(t.set(i.subarray(Is)),!0)}const{crypto_hash_sha512:vs}=vo,{crypto_scalarmult:_s,crypto_scalarmult_base:ks}=Xo,{randombytes:xs}=cr.exports,{crypto_generichash_batch:Ss}=ri.exports,{crypto_stream_xsalsa20_MESSAGEBYTES_MAX:Qs}=ji,{crypto_secretbox_open_easy:Ms,crypto_secretbox_easy:Ds,crypto_secretbox_detached:Ts,crypto_secretbox_open_detached:Ls}=Es,$s=Ji,Us=ur,Os=32,Fs=32,Ns=16,Ps=Qs-16;var Ys={crypto_box_easy:function(t,e,n,r,o){return Us(t.length>=e.length+Ns,"c should be at least 'm.length + crypto_box_MACBYTES' bytes"),Us(e.length<=Ps,"m should be at most 'crypto_box_MESSAGEBYTES_MAX' bytes"),js(t.subarray(Ns,e.length+Ns),t.subarray(0,Ns),e,n,r,o)},crypto_box_open_easy:function(t,e,n,r,o){return Us(e.length>=t.length+Ns,"c should be at least 'm.length + crypto_box_MACBYTES' bytes"),Hs(t,e.subarray(Ns,t.length+Ns),e.subarray(0,Ns),n,r,o)},crypto_box_keypair:Ks,crypto_box_seed_keypair:function(t,e,n){Us(t.byteLength===Os,"pk should be 'crypto_box_PUBLICKEYBYTES' bytes"),Us(e.byteLength===Fs,"sk should be 'crypto_box_SECRETKEYBYTES' bytes"),Us(32===e.byteLength,"sk should be 'crypto_box_SEEDBYTES' bytes");const r=new Uint8Array(64);return vs(r,n,32),e.set(r.subarray(0,32)),r.fill(0),ks(t,e)},crypto_box_seal:function(t,e,n){Vs(t,48+e.length),Vs(n,Os);var r=t.subarray(0,Os),o=new Uint8Array(Fs);Ks(r,o);var i=new Uint8Array(24);Ss(i,[r,n]);var s=new Uint8Array(Os);_s(s,o,n);var a=new Uint8Array(32),c=new Uint8Array(16);$s.core_hsalsa20(a,c,s,$s.SIGMA),Ds(t.subarray(r.length),e,i,a),Gs(o)},crypto_box_seal_open:function(t,e,n,r){Vs(e,48),Vs(t,e.length-48),Vs(n,Os),Vs(r,Fs);var o=e.subarray(0,Os),i=new Uint8Array(24);Ss(i,[o,n]);var s=new Uint8Array(Os);_s(s,r,o);var a=new Uint8Array(32),c=new Uint8Array(16);return $s.core_hsalsa20(a,c,s,$s.SIGMA),Ms(t,e.subarray(o.length),i,a)},crypto_box_PUBLICKEYBYTES:Os,crypto_box_SECRETKEYBYTES:Fs,crypto_box_NONCEBYTES:24,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_box_SEALBYTES:48,crypto_box_SEEDBYTES:32,crypto_box_BEFORENMBYTES:32,crypto_box_MACBYTES:Ns};function Ks(t,e){return Vs(t,Os),Vs(e,Fs),xs(e,32),ks(t,e)}function Rs(t,e,n){const r=new Uint8Array(16),o=new Uint8Array(32);return Us(0===_s(o,n,e)),$s.core_hsalsa20(t,r,o,$s.SIGMA),!0}function js(t,e,n,r,o,i){Vs(e,Ns),Vs(r,24),Vs(o,Os),Vs(i,Fs);const s=new Uint8Array(32);Us(Rs(s,o,i));const a=function(t,e,n,r,o){return Ts(t,e,n,r,o)}(t,e,n,r,s);return Gs(s),a}function Hs(t,e,n,r,o,i){const s=new Uint8Array(32);Us(Rs(s,o,i));const a=function(t,e,n,r,o){return Ls(t,e,n,r,o)}(t,e,n,r,s);return Gs(s),a}function Vs(t,e){if(!t||e&&t.length<e)throw new Error("Argument must be a buffer"+(e?" of length "+e:""))}function Gs(t){for(let e=0;e<t.length;e++)t[e]=0}var qs={exports:{}},zs={exports:{}};const Js=ur,Ws=Yr;zs.exports=na;const Xs=zs.exports.SHA256_BYTES=32,Zs=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function ta(t,e,n,r){return((t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10)+e+(((n>>>7|n<<25)^(n>>>18|n<<14)^n>>>3)+r)<<0}function ea(t,e){var n,r,o,[i,s,a,c,u,l,h,f]=t;const g=new Uint32Array(64);for(let t=0;t<16;t++)g[t]=oa(e[t]);for(let t=16;t<64;t++)g[t]=ta(g[t-2],g[t-7],g[t-15],g[t-16]);for(let t=0;t<64;t+=4)d(t);function d(t){n=i&s^i&a^s&a,r=(i>>>2|i<<30)^(i>>>13|i<<19)^(i>>>22|i<<10),o=f+(u&l^~u&h)+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))+g[t]+Zs[t],f=c+o,n=(c=o+(r+n))&i^c&s^i&s,r=(c>>>2|c<<30)^(c>>>13|c<<19)^(c>>>22|c<<10),o=h+(f&u^~f&l)+((f>>>6|f<<26)^(f>>>11|f<<21)^(f>>>25|f<<7))+g[t+1]+Zs[t+1],h=a+o,n=(a=o+(r+n))&c^a&i^c&i,r=(a>>>2|a<<30)^(a>>>13|a<<19)^(a>>>22|a<<10),o=l+(h&f^~h&u)+((h>>>6|h<<26)^(h>>>11|h<<21)^(h>>>25|h<<7))+g[t+2]+Zs[t+2],l=s+o,n=(s=o+(r+n))&a^s&c^a&c,r=(s>>>2|s<<30)^(s>>>13|s<<19)^(s>>>22|s<<10),o=u+(l&h^~l&f)+((l>>>6|l<<26)^(l>>>11|l<<21)^(l>>>25|l<<7))+g[t+3]+Zs[t+3],u=i+o,i=o+(r+n)}t[0]=t[0]+i,t[1]=t[1]+s,t[2]=t[2]+a,t[3]=t[3]+c,t[4]=t[4]+u,t[5]=t[5]+l,t[6]=t[6]+h,t[7]=t[7]+f}function na(){return this instanceof na?(this.buffer=new ArrayBuffer(64),this.bytesRead=0,this.pos=0,this.digestLength=Xs,this.finalised=!1,this.load=new Uint8Array(this.buffer),this.words=new Uint32Array(this.buffer),this.state=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),this):new na}function ra(t){if(!(this instanceof ra))return new ra(t);this.pad=Ws.alloc(64),this.inner=na(),this.outer=na();const e=Ws.alloc(32);t.byteLength>64&&(na().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}function oa(t){return(16711935&t)>>>8|(16711935&t)<<24|((4278255360&t)<<8|(4278255360&t)>>>24)}na.prototype.update=function(t,e){Js(!1===this.finalised,"Hash instance finalised");var[n,r]=function(t,e){var n=Ws.from(t,e);return[n,n.byteLength]}(t,e),o=0;for(this.bytesRead+=r;r>0&&(this.load.set(n.subarray(o,o+64-this.pos),this.pos),o+=64-this.pos,!((r-=64-this.pos)<0));)this.pos=0,ea(this.state,this.words);return this.pos=63&this.bytesRead,this.load.fill(0,this.pos),this},na.prototype.digest=function(t,e=0){Js(!1===this.finalised,"Hash instance finalised"),this.finalised=!0,this.load.fill(0,this.pos),this.load[this.pos]=128,this.pos>55&&(ea(this.state,this.words),this.words.fill(0),this.pos=0);const n=new DataView(this.buffer);n.setUint32(56,this.bytesRead/2**29),n.setUint32(60,this.bytesRead<<3),ea(this.state,this.words);const r=new Uint8Array(this.state.map(oa).buffer);if(!t)return new Uint8Array(r);if("string"==typeof t)return Ws.toString(r,t);Js(t instanceof Uint8Array,"input must be Uint8Array or Buffer"),Js(t.byteLength>=this.digestLength+e,"input not large enough for digest");for(let n=0;n<this.digestLength;n++)t[n+e]=r[n];return t},ra.prototype.update=function(t,e){return this.inner.update(t,e),this},ra.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},na.HMAC=ra;var ia,sa,aa={exports:{}};const ca=ur,ua=Yr,la="undefined"!=typeof WebAssembly&&function(){if(sa)return ia;sa=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./sha256.wat"(e,n){n.exports=t("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")}}),n=e(),r=new WebAssembly.Module(n);return ia=t=>new WebAssembly.Instance(r,t).exports,ia}()({imports:{debug:{log(...t){console.log(...t.map((t=>(t>>>0).toString(16).padStart(8,"0"))))},log_tee:t=>(console.log((t>>>0).toString(16).padStart(8,"0")),t)}}});let ha=0;const fa=[];aa.exports=da;const ga=aa.exports.SHA256_BYTES=32;function da(){if(!(this instanceof da))return new da;if(!la)throw new Error("WASM not loaded. Wait for Sha256.ready(cb)");fa.length||(fa.push(ha),ha+=108),this.finalized=!1,this.digestLength=ga,this.pointer=fa.pop(),this.pos=0,this._memory=new Uint8Array(la.memory.buffer),this._memory.fill(0,this.pointer,this.pointer+108),this.pointer+this.digestLength>this._memory.length&&this._realloc(this.pointer+108)}function Aa(t){if(!(this instanceof Aa))return new Aa(t);this.pad=ua.alloc(64),this.inner=da(),this.outer=da();const e=ua.alloc(32);t.byteLength>64&&(da().update(t).digest(e),t=e),this.pad.fill(54);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.inner.update(this.pad),this.pad.fill(92);for(let e=0;e<t.byteLength;e++)this.pad[e]^=t[e];this.outer.update(this.pad),this.pad.fill(0),e.fill(0)}function pa(){}da.prototype._realloc=function(t){la.memory.grow(Math.max(0,Math.ceil(Math.abs(t-this._memory.length)/65536))),this._memory=new Uint8Array(la.memory.buffer)},da.prototype.update=function(t,e){ca(!1===this.finalized,"Hash instance finalized"),ha%4!=0&&(ha+=4-ha%4),ca(ha%4==0,"input shoud be aligned for int32");const[n,r]=function(t,e){var n=ua.from(t,e);return[n,n.byteLength]}(t,e);return ca(n instanceof Uint8Array,"input must be Uint8Array or Buffer"),ha+r>this._memory.length&&this._realloc(ha+t.length),this._memory.fill(0,ha,ha+function(t,e){return t+e-1&-e}(r,64)-64),this._memory.set(n.subarray(0,64-this.pos),this.pointer+40+this.pos),this._memory.set(n.subarray(64-this.pos),ha),this.pos=this.pos+r&63,la.sha256(this.pointer,ha,r,0),this},da.prototype.digest=function(t,e=0){ca(!1===this.finalized,"Hash instance finalized"),this.finalized=!0,fa.push(this.pointer);const n=this.pointer+40+this.pos;this._memory.fill(0,n,this.pointer+40+64),la.sha256(this.pointer,ha,0,1);const r=this._memory.subarray(this.pointer,this.pointer+this.digestLength);if(!t)return r;if("string"==typeof t)return ua.toString(r,t);ca(t instanceof Uint8Array,"output must be Uint8Array or Buffer"),ca(t.byteLength>=this.digestLength+e,"output must have at least 'SHA256_BYTES' bytes remaining");for(let n=0;n<this.digestLength;n++)t[n+e]=r[n];return t},da.WASM=la,da.WASM_SUPPORTED="undefined"!=typeof WebAssembly,da.ready=function(t){return t||(t=pa),la?(t(),Promise.resolve()):t(new Error("WebAssembly not supported"))},da.prototype.ready=da.ready,Aa.prototype.update=function(t,e){return this.inner.update(t,e),this},Aa.prototype.digest=function(t,e=0){return this.outer.update(this.inner.digest()),this.outer.digest(t,e)},da.HMAC=Aa;const ya=zs.exports,Ia=aa.exports;var ma=ya;qs.exports=function(){return new ma},qs.exports.ready=function(t){Ia.ready((function(){t()}))},qs.exports.WASM_SUPPORTED=Ia.WASM_SUPPORTED,qs.exports.WASM_LOADED=!1,qs.exports.SHA256_BYTES=32,Ia.ready((function(t){t||(qs.exports.WASM_LOADED=!0,qs.exports=ma=Ia)}));const Ea=qs.exports,wa=ur;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");var ba={crypto_hash_sha256:function(t,e,n){return wa(32===t.byteLength,"out must be 'crypto_hash_sha256_BYTES' bytes long"),Ea().update(e.subarray(0,n)).digest(t),0},crypto_hash_sha256_BYTES:32},Ca={exports:{}};!function(t){const e=ur,n=cr.exports.randombytes_buf,r=oi.exports;t.exports.crypto_kdf_PRIMITIVE="blake2b",t.exports.crypto_kdf_BYTES_MIN=16,t.exports.crypto_kdf_BYTES_MAX=64,t.exports.crypto_kdf_CONTEXTBYTES=8,t.exports.crypto_kdf_KEYBYTES=32,t.exports.crypto_kdf_derive_from_key=function(n,o,i,s){e(n.length>=t.exports.crypto_kdf_BYTES_MIN,"subkey must be at least crypto_kdf_BYTES_MIN"),e(o>=0&&o<=9007199254740991,"subkey_id must be safe integer"),e(i.length>=t.exports.crypto_kdf_CONTEXTBYTES,"context must be at least crypto_kdf_CONTEXTBYTES");var a=new Uint8Array(r.PERSONALBYTES),c=new Uint8Array(r.SALTBYTES);a.set(i,0,t.exports.crypto_kdf_CONTEXTBYTES),function(t,e){var n=1,r=0;for(t[0]=255&e;++r<8&&(n*=256);)t[r]=e/n&255}(c,o);var u=Math.min(n.length,t.exports.crypto_kdf_BYTES_MAX);r(u,s.subarray(0,t.exports.crypto_kdf_KEYBYTES),c,a,!0).final(n)},t.exports.crypto_kdf_keygen=function(r){e(r.length>=t.exports.crypto_kdf_KEYBYTES,"out.length must be crypto_kdf_KEYBYTES"),n(r.subarray(0,t.exports.crypto_kdf_KEYBYTES))}}(Ca);const{crypto_scalarmult_base:Ba}=Xo,{crypto_generichash:va}=ri.exports,{randombytes_buf:_a}=cr.exports,ka=ur;var xa={crypto_kx_keypair:function(t,e){return ka(32===t.byteLength,"pk must be 'crypto_kx_PUBLICKEYBYTES' bytes"),ka(32===e.byteLength,"sk must be 'crypto_kx_SECRETKEYBYTES' bytes"),_a(e,32),Ba(t,e)},crypto_kx_seed_keypair:function(t,e,n){return ka(32===t.byteLength,"pk must be 'crypto_kx_PUBLICKEYBYTES' bytes"),ka(32===e.byteLength,"sk must be 'crypto_kx_SECRETKEYBYTES' bytes"),ka(32===n.byteLength,"seed must be 'crypto_kx_SEEDBYTES' bytes"),va(e,n),Ba(t,e)},crypto_kx_SEEDBYTES:32,crypto_kx_SECRETKEYBYTES:32,crypto_kx_PUBLICKEYBYTES:32},Sa={};const Qa=ur;var Ma=Ta;const Da=[1634760805,857760878,2036477234,1797285236];function Ta(t,e,n){Qa(32===e.byteLength),Qa(8===t.byteLength||12===t.byteLength);const r=new Uint32Array(t.buffer,t.byteOffset,t.byteLength/4),o=new Uint32Array(e.buffer,e.byteOffset,e.byteLength/4);n||(n=0),Qa(n<Number.MAX_SAFE_INTEGER),this.finalized=!1,this.pos=0,this.state=new Uint32Array(16);for(let t=0;t<4;t++)this.state[t]=Da[t];for(let t=0;t<8;t++)this.state[4+t]=o[t];return this.state[12]=4294967295&n,8===r.byteLength?(this.state[13]=(n&&0xffffffff00000000)>>32,this.state[14]=r[0],this.state[15]=r[1]):(this.state[13]=r[0],this.state[14]=r[1],this.state[15]=r[2]),this}function La(t){const e=new Uint32Array(16);for(let n=16;n--;)e[n]=t[n];for(let t=0;t<20;t+=2)Ua(e,0,4,8,12),Ua(e,1,5,9,13),Ua(e,2,6,10,14),Ua(e,3,7,11,15),Ua(e,0,5,10,15),Ua(e,1,6,11,12),Ua(e,2,7,8,13),Ua(e,3,4,9,14);for(let n=0;n<16;n++)e[n]+=t[n];return new Uint8Array(e.buffer,e.byteOffset,e.byteLength)}function $a(t,e){return t<<e|t>>>32-e}function Ua(t,e,n,r,o){t[e]+=t[n],t[o]^=t[e],t[o]=$a(t[o],16),t[r]+=t[o],t[n]^=t[r],t[n]=$a(t[n],12),t[e]+=t[n],t[o]^=t[e],t[o]=$a(t[o],8),t[r]+=t[o],t[n]^=t[r],t[n]=$a(t[n],7)}Ta.prototype.update=function(t,e){Qa(!this.finalized,"cipher finalized."),Qa(t.byteLength>=e.byteLength,"output cannot be shorter than input.");let n=e.length,r=this.pos%64;this.pos+=n;let o=0,i=La(this.state);for(;r>0&&n>0;)t[o]=e[o++]^i[r],r=r+1&63,r||this.state[12]++,n--;for(;n>0;){if(i=La(this.state),n<64){for(let s=0;s<n;s++)t[o]=e[o++]^i[r++],r&=63;return}for(;r<64;)t[o]=e[o++]^i[r++];this.state[12]++,r=0,n-=64}},Ta.prototype.final=function(){this.state.fill(0),this.pos=0,this.finalized=!0},function(t){const e=ur,n=Ma;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");t.crypto_stream_chacha20_KEYBYTES=32,t.crypto_stream_chacha20_NONCEBYTES=8,t.crypto_stream_chacha20_MESSAGEBYTES_MAX=Number.MAX_SAFE_INTEGER,t.crypto_stream_chacha20_ietf_KEYBYTES=32,t.crypto_stream_chacha20_ietf_NONCEBYTES=12,t.crypto_stream_chacha20_ietf_MESSAGEBYTES_MAX=2**32,t.crypto_stream_chacha20=function(e,n,r){e.fill(0),t.crypto_stream_chacha20_xor(e,e,n,r)},t.crypto_stream_chacha20_xor=function(r,o,i,s){e(i.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),e(s.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES");const a=new n(i,s);a.update(r,o),a.final()},t.crypto_stream_chacha20_xor_ic=function(r,o,i,s,a){e(i.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),e(a.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES");const c=new n(i,a,s);c.update(r,o),c.final()},t.crypto_stream_chacha20_xor_instance=function(r,o){return e(r.byteLength===t.crypto_stream_chacha20_NONCEBYTES,"n should be crypto_stream_chacha20_NONCEBYTES"),e(o.byteLength===t.crypto_stream_chacha20_KEYBYTES,"k should be crypto_stream_chacha20_KEYBYTES"),new n(r,o)},t.crypto_stream_chacha20_ietf=function(e,n,r){e.fill(0),t.crypto_stream_chacha20_ietf_xor(e,e,n,r)},t.crypto_stream_chacha20_ietf_xor=function(r,o,i,s){e(i.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),e(s.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES");const a=new n(i,s);a.update(r,o),a.final()},t.crypto_stream_chacha20_ietf_xor_ic=function(r,o,i,s,a){e(i.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),e(a.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES");const c=new n(i,a,s);c.update(r,o),c.final()},t.crypto_stream_chacha20_ietf_xor_instance=function(r,o){return e(r.byteLength===t.crypto_stream_chacha20_ietf_NONCEBYTES,"n should be crypto_stream_chacha20_ietf_NONCEBYTES"),e(o.byteLength===t.crypto_stream_chacha20_ietf_KEYBYTES,"k should be crypto_stream_chacha20_ietf_KEYBYTES"),new n(r,o)}}(Sa);const{crypto_stream_chacha20_ietf:Oa,crypto_stream_chacha20_ietf_xor_ic:Fa}=Sa,{crypto_verify_16:Na}=gr.exports,Pa=rs,Ya=ur,Ka=16,Ra=Number.MAX_SAFE_INTEGER,ja=new Uint8Array(16);function Ha(t,e,n,r,o,i,s){if(null===r)return Ha(t,e,n,new Uint8Array(0),o,i,s);Ya(t.byteLength===n.byteLength,"ciphertext should be same length than message"),Ya(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Ya(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Ya(n.byteLength<=Ra,"message is too large"),Ya(e.byteLength<=Ka,"mac should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' long");const a=new Uint8Array(64);var c=new Uint8Array(8);Oa(a,i,s);const u=new Pa(a);return a.fill(0),u.update(r,0,r.byteLength),u.update(ja,0,16-r.byteLength&15),Fa(t,n,i,1,s),u.update(t,0,n.byteLength),u.update(ja,0,16-n.byteLength&15),Ga(c,0,r.byteLength),u.update(c,0,c.byteLength),Ga(c,0,n.byteLength),u.update(c,0,c.byteLength),u.finish(e,0),c.fill(0),Ka}function Va(t,e,n,r,o,i,s){if(null===o)return Va(t,e,n,r,new Uint8Array(0),i,s);Ya(n.byteLength===t.byteLength,"message should be same length than ciphertext"),Ya(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Ya(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Ya(t.byteLength<=Ra,"message is too large"),Ya(r.byteLength<=Ka,"mac should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' long");const a=new Uint8Array(64),c=new Uint8Array(8),u=new Uint8Array(Ka);Oa(a,i,s);const l=new Pa(a);a.fill(0),l.update(o,0,o.byteLength),l.update(ja,0,16-o.byteLength&15);const h=n.byteLength;l.update(n,0,h),l.update(ja,0,16-h&15),Ga(c,0,o.byteLength),l.update(c,0,c.byteLength),Ga(c,0,h),l.update(c,0,c.byteLength),l.finish(u,0),Ya(16===u.byteLength);const f=Na(u,0,r,0);if(u.fill(0),c.fill(0),!f)throw t.fill(0),new Error("could not verify data");Fa(t,n,i,1,s)}function Ga(t,e,n){t.fill(0,0,8);const r=new DataView(t.buffer,t.byteOffset,t.byteLength);r.setUint32(e,4294967295&n,!0),r.setUint32(e+4,n/2**32&4294967295,!0)}var qa,za,Ja={crypto_aead_chacha20poly1305_ietf_encrypt:function t(e,n,r,o,i,s){if(null===r)return t(e,n,new Uint8Array(0),o,i,s);Ya(e.byteLength===n.byteLength+Ka,"ciphertext should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' longer than message"),Ya(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Ya(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Ya(n.byteLength<=Ra,"message is too large");const a=Ha(e.subarray(0,n.byteLength),e.subarray(n.byteLength),n,r,o,i,s);return n.byteLength+a},crypto_aead_chacha20poly1305_ietf_encrypt_detached:Ha,crypto_aead_chacha20poly1305_ietf_decrypt:function t(e,n,r,o,i,s){if(null===o)return t(e,n,r,new Uint8Array(0),i,s);if(Ya(e.byteLength===r.byteLength-Ka,"message should be 'crypto_aead_chacha20poly1305_ietf_ABYTES' shorter than ciphertext"),Ya(12===i.byteLength,"npub should be 'crypto_aead_chacha20poly1305_ietf_NPUBBYTES' long"),Ya(32===s.byteLength,"k should be 'crypto_aead_chacha20poly1305_ietf_KEYBYTES' long"),Ya(e.byteLength<=Ra,"message is too large"),r.byteLength<Ka)throw new Error("could not verify data");return Va(e,n,r.subarray(0,r.byteLength-Ka),r.subarray(r.byteLength-Ka),o,i,s),r.byteLength-Ka},crypto_aead_chacha20poly1305_ietf_decrypt_detached:Va,crypto_aead_chacha20poly1305_ietf_ABYTES:Ka,crypto_aead_chacha20poly1305_ietf_KEYBYTES:32,crypto_aead_chacha20poly1305_ietf_NPUBBYTES:12,crypto_aead_chacha20poly1305_ietf_NSECBYTES:0,crypto_aead_chacha20poly1305_ietf_MESSAGEBYTES_MAX:Ra},Wa={};var Xa=function(t,e,n){var r,o={h:oc(n,4),l:oc(n,0)},i={h:oc(n,12),l:oc(n,8)},s={h:o.h,l:o.l},a=o,c={h:i.h,l:i.l},u=i,l=0,h=e.length,f=h-7,g=new Uint8Array(new ArrayBuffer(8));tc(s,{h:1936682341,l:1886610805}),tc(c,{h:1685025377,l:1852075885}),tc(a,{h:1819895653,l:1852142177}),tc(u,{h:1952801890,l:2037671283});for(;l<f;)r={h:oc(e,l+4),l:oc(e,l)},tc(u,r),rc(s,c,a,u),rc(s,c,a,u),tc(s,r),l+=8;g[7]=h;var d=0;for(;l<h;)g[d++]=e[l++];for(;d<7;)g[d++]=0;r={h:g[7]<<24|g[6]<<16|g[5]<<8|g[4],l:g[3]<<24|g[2]<<16|g[1]<<8|g[0]},tc(u,r),rc(s,c,a,u),rc(s,c,a,u),tc(s,r),tc(a,{h:0,l:255}),rc(s,c,a,u),rc(s,c,a,u),rc(s,c,a,u),rc(s,c,a,u);var A=s;tc(A,c),tc(A,a),tc(A,u),t[0]=255&A.l,t[1]=A.l>>8&255,t[2]=A.l>>16&255,t[3]=A.l>>24&255,t[4]=255&A.h,t[5]=A.h>>8&255,t[6]=A.h>>16&255,t[7]=A.h>>24&255};function Za(t,e){var n=t.l+e.l,r={h:t.h+e.h+(n/2>>>31)>>>0,l:n>>>0};t.h=r.h,t.l=r.l}function tc(t,e){t.h^=e.h,t.h>>>=0,t.l^=e.l,t.l>>>=0}function ec(t,e){var n={h:t.h<<e|t.l>>>32-e,l:t.l<<e|t.h>>>32-e};t.h=n.h,t.l=n.l}function nc(t){var e=t.l;t.l=t.h,t.h=e}function rc(t,e,n,r){Za(t,e),Za(n,r),ec(e,13),ec(r,16),tc(e,t),tc(r,n),nc(t),Za(n,e),Za(t,r),ec(e,17),ec(r,21),tc(e,n),tc(r,t),nc(n)}function oc(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]}var ic=ur,sc="undefined"!=typeof WebAssembly&&function(){if(za)return qa;za=1;var t=(()=>{for(var t=new Uint8Array(128),e=0;e<64;e++)t[e<26?e+65:e<52?e+71:e<62?e-4:4*e-205]=e;return e=>{for(var n=e.length,r=new Uint8Array(3*(n-("="==e[n-1])-("="==e[n-2]))/4|0),o=0,i=0;o<n;){var s=t[e.charCodeAt(o++)],a=t[e.charCodeAt(o++)],c=t[e.charCodeAt(o++)],u=t[e.charCodeAt(o++)];r[i++]=s<<2|a>>4,r[i++]=a<<4|c>>2,r[i++]=c<<6|u}return r}})(),e=((t,e)=>function(){return e||(0,t[Object.keys(t)[0]])((e={exports:{}}).exports,e),e.exports})({"wasm-binary:./siphash24.wat"(e,n){n.exports=t("AGFzbQEAAAABBgFgAn9/AAMCAQAFBQEBCpBOBxQCBm1lbW9yeQIAB3NpcGhhc2gAAArdCAHaCAIIfgJ/QvXKzYPXrNu38wAhAkLt3pHzlszct+QAIQNC4eSV89bs2bzsACEEQvPK0cunjNmy9AAhBUEIKQMAIQdBECkDACEIIAGtQjiGIQYgAUEHcSELIAAgAWogC2shCiAFIAiFIQUgBCAHhSEEIAMgCIUhAyACIAeFIQICQANAIAAgCkYNASAAKQMAIQkgBSAJhSEFIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAmFIQIgAEEIaiEADAALCwJAAkACQAJAAkACQAJAAkAgCw4HBwYFBAMCAQALIAYgADEABkIwhoQhBgsgBiAAMQAFQiiGhCEGCyAGIAAxAARCIIaEIQYLIAYgADEAA0IYhoQhBgsgBiAAMQACQhCGhCEGCyAGIAAxAAFCCIaEIQYLIAYgADEAAIQhBgsgBSAGhSEFIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAaFIQIgBEL/AYUhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEIAIgA3whAiADQg2JIQMgAyAChSEDIAJCIIkhAiAEIAV8IQQgBUIQiSEFIAUgBIUhBSACIAV8IQIgBUIViSEFIAUgAoUhBSAEIAN8IQQgA0IRiSEDIAMgBIUhAyAEQiCJIQQgAiADfCECIANCDYkhAyADIAKFIQMgAkIgiSECIAQgBXwhBCAFQhCJIQUgBSAEhSEFIAIgBXwhAiAFQhWJIQUgBSAChSEFIAQgA3whBCADQhGJIQMgAyAEhSEDIARCIIkhBCACIAN8IQIgA0INiSEDIAMgAoUhAyACQiCJIQIgBCAFfCEEIAVCEIkhBSAFIASFIQUgAiAFfCECIAVCFYkhBSAFIAKFIQUgBCADfCEEIANCEYkhAyADIASFIQMgBEIgiSEEQQAgAiADIAQgBYWFhTcDAAs=")}}),n=e(),r=new WebAssembly.Module(n);return qa=t=>new WebAssembly.Instance(r,t).exports,qa}()(),ac=Xa,cc=fc,uc=fc.BYTES=8,lc=fc.KEYBYTES=16;fc.WASM_SUPPORTED=!!sc,fc.WASM_LOADED=!!sc;var hc=new Uint8Array(sc.memory.buffer);function fc(t,e,n,r){var o;return n||(n=new Uint8Array(8)),!0!==r&&(ic(n.length>=uc,"output must be at least "+uc),ic(e.length>=lc,"key must be at least "+lc)),sc?(t.length+24>hc.length&&(o=t.length+24,sc.memory.grow(Math.max(0,Math.ceil(Math.abs(o-hc.length)/65536))),hc=new Uint8Array(sc.memory.buffer)),hc.set(e,8),hc.set(t,24),sc.siphash(24,t.length),n.set(hc.subarray(0,8))):ac(n,t,e),n}var gc=cc;if(1!==new Uint16Array([1])[0])throw new Error("Big endian architecture is not supported.");Wa.crypto_shorthash_PRIMITIVE="siphash24",Wa.crypto_shorthash_BYTES=gc.BYTES,Wa.crypto_shorthash_KEYBYTES=gc.KEYBYTES,Wa.crypto_shorthash_WASM_SUPPORTED=gc.WASM_SUPPORTED,Wa.crypto_shorthash_WASM_LOADED=gc.WASM_LOADED,Wa.crypto_shorthash=function(t,e,n,r){gc(e,n,t,r)};const{crypto_verify_32:dc}=gr.exports,{crypto_hash:Ac}=vo,{gf:pc,gf0:yc,gf1:Ic,D:mc,D2:Ec,X:wc,Y:bc,I:Cc,A:Bc,Z:vc,M:_c,S:kc,sel25519:xc,pack25519:Sc,inv25519:Qc,unpack25519:Mc}=Po,{randombytes:Dc}=cr.exports,{crypto_scalarmult_BYTES:Tc}=Xo,{crypto_hash_sha512_BYTES:Lc}=vo,$c=ur,Uc=64;var Oc={crypto_sign_keypair:jc,crypto_sign_seed_keypair:function(t,e,n){return Zc(n,32),e.set(n),jc(t,e,!0)},crypto_sign:qc,crypto_sign_detached:function(t,e,n){var r=new Uint8Array(e.length+Uc);qc(r,e,n);for(let e=0;e<Uc;e++)t[e]=r[e]},crypto_sign_open:Jc,crypto_sign_verify_detached:function(t,e,n){Zc(t,Uc);var r=new Uint8Array(e.length+Uc),o=0;for(o=0;o<Uc;o++)r[o]=t[o];for(o=0;o<e.length;o++)r[o+Uc]=e[o];return Jc(e,r,n)},crypto_sign_BYTES:Uc,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_sign_ed25519_PUBLICKEYBYTES:32,crypto_sign_ed25519_SECRETKEYBYTES:64,crypto_sign_ed25519_SEEDBYTES:32,crypto_sign_ed25519_BYTES:64,crypto_sign_ed25519_pk_to_curve25519:function(t,e){Zc(t,32),Zc(e,32);var n=[pc(),pc(),pc(),pc()],r=pc([1]),o=pc([1]);$c(function(t){var e,n=[Uint8Array.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uint8Array.from([1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Uint8Array.from([38,232,149,143,194,178,39,176,69,195,244,137,242,239,152,240,213,223,172,5,211,198,51,57,177,56,2,136,109,83,252,5]),Uint8Array.from([199,23,106,112,61,77,216,79,186,60,11,118,13,16,103,15,42,32,83,250,44,57,204,198,78,199,253,119,146,172,3,122]),Uint8Array.from([236,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127]),Uint8Array.from([237,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127]),Uint8Array.from([238,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,127])],r=new Uint8Array(7);Zc(n,7);for(let o=0;o<n.length;o++)for(e=0;e<31;e++)r[o]|=t[e]^n[o][e];for(let o=0;o<n.length;o++)r[o]|=127&t[e]^n[o][e];var o=0;for(let t=0;t<n.length;t++)o|=r[t]-1;return 0==(o>>8&1)}(e)&&zc(n,e)&&function(t){var e=[pc(),pc(),pc(),pc()];!function(t,e){Kc(t,e,Hc)}(e,t);var n=0;for(let t=0;t<16;t++)n|=65535&e[0][t];return 0===n}(n),"Cannot convert key: bad point");for(let e=0;e<n.length;e++)Sc(t,n[e]);return vc(o,o,n[1]),Bc(r,r,n[1]),Qc(o,o),_c(r,r,o),Sc(t,r),0},crypto_sign_ed25519_sk_to_curve25519:function(t,e){$c(t&&t.byteLength===Tc,"curveSk must be 'crypto_sign_SECRETKEYBYTES' long"),$c(e&&64===e.byteLength,"edSk must be 'crypto_sign_ed25519_SECRETKEYBYTES' long");var n=new Uint8Array(Lc);return Ac(n,e,32),n[0]&=248,n[31]&=127,n[31]|=64,t.set(n.subarray(0,Tc)),n.fill(0),t},crypto_sign_ed25519_sk_to_pk:function(t,e){return Zc(t,32),t.set(e.subarray(32)),t},unpackneg:zc,pack:Yc};function Fc(t,e){for(let n=0;n<16;n++)t[n]=0|e[n]}function Nc(t,e){var n=pc(),r=pc(),o=pc(),i=pc(),s=pc(),a=pc(),c=pc(),u=pc(),l=pc();vc(n,t[1],t[0]),vc(l,e[1],e[0]),_c(n,n,l),Bc(r,t[0],t[1]),Bc(l,e[0],e[1]),_c(r,r,l),_c(o,t[3],e[3]),_c(o,o,Ec),_c(i,t[2],e[2]),Bc(i,i,i),vc(s,r,n),vc(a,i,o),Bc(c,i,o),Bc(u,r,n),_c(t[0],s,a),_c(t[1],u,c),_c(t[2],c,a),_c(t[3],s,u)}function Pc(t,e,n){var r;for(r=0;r<4;r++)xc(t[r],e[r],n)}function Yc(t,e){var n=pc(),r=pc(),o=pc();Qc(o,e[2]),_c(n,e[0],o),_c(r,e[1],o),Sc(t,r),t[31]^=Wc(n)<<7}function Kc(t,e,n){var r,o,i=[pc(e[0]),pc(e[1]),pc(e[2]),pc(e[3])];for(Fc(t[0],yc),Fc(t[1],Ic),Fc(t[2],Ic),Fc(t[3],yc),o=255;o>=0;--o)Pc(t,i,r=n[o/8|0]>>(7&o)&1),Nc(i,t),Nc(t,t),Pc(t,i,r)}function Rc(t,e){var n=[pc(),pc(),pc(),pc()];Fc(n[0],wc),Fc(n[1],bc),Fc(n[2],Ic),_c(n[3],wc,bc),Kc(t,n,e)}function jc(t,e,n){Zc(t,32),Zc(e,64);var r,o=new Uint8Array(64),i=[pc(),pc(),pc(),pc()];for(n||Dc(e,32),Ac(o,e,32),o[0]&=248,o[31]&=127,o[31]|=64,Rc(i,o),Yc(t,i),r=0;r<32;r++)e[r+32]=t[r]}var Hc=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Vc(t,e){var n,r,o,i;for(r=63;r>=32;--r){for(n=0,o=r-32,i=r-12;o<i;++o)e[o]+=n-16*e[r]*Hc[o-(r-32)],n=e[o]+128>>8,e[o]-=256*n;e[o]+=n,e[r]=0}for(n=0,o=0;o<32;o++)e[o]+=n-(e[31]>>4)*Hc[o],n=e[o]>>8,e[o]&=255;for(o=0;o<32;o++)e[o]-=n*Hc[o];for(r=0;r<32;r++)e[r+1]+=e[r]>>8,t[r]=255&e[r]}function Gc(t){var e=new Float64Array(64);for(let n=0;n<64;n++)e[n]=t[n];for(let e=0;e<64;e++)t[e]=0;Vc(t,e)}function qc(t,e,n){Zc(t,Uc+e.length),Zc(e,0),Zc(n,64);var r,o,i=e.length,s=new Uint8Array(64),a=new Uint8Array(64),c=new Uint8Array(64),u=new Float64Array(64),l=[pc(),pc(),pc(),pc()];Ac(s,n,32),s[0]&=248,s[31]&=127,s[31]|=64;var h=i+64;for(r=0;r<i;r++)t[64+r]=e[r];for(r=0;r<32;r++)t[32+r]=s[32+r];for(Ac(c,t.subarray(32),i+32),Gc(c),Rc(l,c),Yc(t,l),r=32;r<64;r++)t[r]=n[r];for(Ac(a,t,i+64),Gc(a),r=0;r<64;r++)u[r]=0;for(r=0;r<32;r++)u[r]=c[r];for(r=0;r<32;r++)for(o=0;o<32;o++)u[r+o]+=a[r]*s[o];return Vc(t.subarray(32),u),h}function zc(t,e){var n=pc(),r=pc(),o=pc(),i=pc(),s=pc(),a=pc(),c=pc();return Fc(t[2],Ic),Mc(t[1],e),kc(o,t[1]),_c(i,o,mc),vc(o,o,t[2]),Bc(i,t[2],i),kc(s,i),kc(a,s),_c(c,a,s),_c(n,c,o),_c(n,n,i),function(t,e){var n,r=pc();for(n=0;n<16;n++)r[n]=e[n];for(n=250;n>=0;n--)kc(r,r),1!==n&&_c(r,r,e);for(n=0;n<16;n++)t[n]=r[n]}(n,n),_c(n,n,o),_c(n,n,i),_c(n,n,i),_c(t[0],n,i),kc(r,t[0]),_c(r,r,i),Xc(r,o)||_c(t[0],t[0],Cc),kc(r,t[0]),_c(r,r,i),!!Xc(r,o)&&(Wc(t[0])===e[31]>>7&&vc(t[0],pc(),t[0]),_c(t[3],t[0],t[1]),!0)}function Jc(t,e,n){Zc(t,e.length-Uc),Zc(e,Uc),Zc(n,32);var r,o=e.length,i=new Uint8Array(e.length),s=new Uint8Array(32),a=new Uint8Array(64),c=[pc(),pc(),pc(),pc()],u=[pc(),pc(),pc(),pc()];if(o<64)return!1;if(!zc(u,n))return!1;for(r=0;r<o;r++)i[r]=e[r];for(r=0;r<32;r++)i[r+32]=n[r];if(Ac(a,i,o),Gc(a),Kc(c,u,a),Rc(u,e.subarray(32)),Nc(c,u),Yc(s,c),o-=64,!dc(e,0,s,0)){for(r=0;r<o;r++)i[r]=0;return!1}for(r=0;r<o;r++)t[r]=e[r+64];return!0}function Wc(t){var e=new Uint8Array(32);return Sc(e,t),1&e[0]}function Xc(t,e){var n=new Uint8Array(32),r=new Uint8Array(32);return Sc(n,t),Sc(r,e),dc(n,0,r,0)}function Zc(t,e,n="Argument"){if(!t||e&&t.length<e)throw new Error(n+" must be a buffer"+(e?" of length "+e:""))}!function(t){function e(e){Object.keys(e).forEach((function(n){t.exports[n]=e[n]}))}e(cr.exports),e(fr),e(pr),e(gr.exports),e(wo),e(Ys),e(ri.exports),e(vo),e(ba),e(Ca.exports),e(xa),e(Ja),e(as),e(Xo),e(Es),e(Wa),e(Oc),e(ji),e(Sa)}(ir),or.exports=ir.exports;var tu=Symbol.for("nodejs.util.inspect.custom");const{crypto_sign_BYTES:eu,crypto_sign_SECRETKEYBYTES:nu,crypto_sign_PUBLICKEYBYTES:ru,crypto_sign_detached:ou,crypto_sign_verify_detached:iu,crypto_sign_keypair:su}=or.exports,au=tu,cu=Symbol.for("Pico::block"),uu=Symbol.for("Pico::feed"),lu=r.Buffer.alloc(eu).fill(0);var hu=class t{static get MAX_FEED_SIZE(){return 65536}static get INITIAL_FEED_SIZE(){return 1024}static get PICKLE(){return r.Buffer.from("PIC0.")}static get KEY(){return r.Buffer.from("K0.")}static get BLOCK(){return r.Buffer.from("B0.")}static get KEY_SIZE(){return ru}static get SIGNATURE_SIZE(){return eu}static get COUNTER_SIZE(){return 4}static get META_SIZE(){return 2*t.SIGNATURE_SIZE+t.COUNTER_SIZE}static get BLOCK_SYMBOL(){return cu}static get FEED_SYMBOL(){return uu}static get GENESIS(){return lu}constructor(e={}){this[uu]=!0,this.tail=0,this._hasGenisis=null,this._keychain=[],this._cache=[],this._MAX_FEED_SIZE=e.maxSize||t.MAX_FEED_SIZE,this.buf=r.Buffer.alloc(e.initialSize||t.INITIAL_FEED_SIZE)}get partial(){return!(null===this._hasGenisis&&!this.length)&&!this._hasGenisis}get free(){return this._MAX_FEED_SIZE-this.tail}get _isDirty(){if(!this.tail)return!1;if(!this._cache.length)return!0;const e=this._cache[this._cache.length-1];return t.mapBlock(this.buf,e.offset).end!==this.tail}get length(){return this._reIndex(),this._cache.length}get last(){return this.get(this.length-1)}get first(){return this.get(0)}get keys(){return this._reIndex(),[...this._keychain]}_reIndex(t=!1){if(!t&&!this._isDirty)return;const e=this._index(t);for(;!e.next().done;)continue}_appendKey(e){this._ensureMinimumCapacity(this.tail+t.KEY.length+e.length),this.tail+=t.KEY.copy(this.buf,this.tail),this.tail+=e.copy(this.buf,this.tail)}_appendBlock(t){this._ensureMinimumCapacity(this.tail+t.length),this.tail+=t.copy(this.buf,this.tail)}_ensureMinimumCapacity(t){if(this.buf.length<t){const e=r.Buffer.allocUnsafe(t+32);this.buf.copy(e),this.buf=e}}_ensureKey(t){for(const e of this.keys)if(t.equals(e))return;this._appendKey(t)}get(e){this._isDirty&&this._reIndex(),e<0&&(e=this.length+e);const n=this._cache[e];if(n)return t.mapBlock(this.buf,n.offset,this._keychain[n.keyId])}toArray(){const t=[];for(const e of this.blocks())t.push(e);return t}append(e,n,o){if(!n)throw new Error("Can't append without a signing secret");if(64!==n.length)throw new Error("Unknown signature secret key format");const i=n.slice(t.KEY_SIZE);this._ensureKey(i);const s=t.META_SIZE,a=this.last;r.Buffer.isBuffer(e)||(e=r.Buffer.from(e));const c=e.length,u=this.tail+c+s;if(this._MAX_FEED_SIZE<u){console.error(`MAX_FEED_SIZE reached, block won't fit: ${u} > ${this._MAX_FEED_SIZE}`);const t=new Error("FeedOverflowError");throw t.type=t.message,t.maxSize=this._MAX_FEED_SIZE,t.requestedSize=u,t.bytesOverflow=u-this._MAX_FEED_SIZE,t}this._ensureMinimumCapacity(u);const l=t.mapBlock(this.buf,this.tail);if(l.header.fill(0),l.size=c,e.copy(l.body),a&&a.sig.copy(l.parentSig),ou(l.sig,l.dat,n),!l.verify(i))throw new Error("newly stored block is invalid. something went wrong");return this.tail=u,"function"==typeof o&&o(null,this.length),this.length}*_index(e=!1){let n=0,o=0;e&&this._clearCache();const i=t.KEY,s=t.KEY_SIZE;let a=null;for(;;){if(n>=this.tail)return;if(n+i.length>this.buf.length)return;if(i.equals(this.buf.slice(n,n+i.length))){const t=this.buf.slice(n+i.length,n+i.length+s);let e=this._keychain.findIndex((e=>e.equals(t)));~e||(e=this._keychain.length,this._keychain.push(t)),yield{type:0,id:e,key:t,offset:n},n+=i.length+s}else if(this._cache[o]&&this._cache[o].offset===n){const e=o++,r=this._cache[e],i=this._keychain[r.keyId];if(!i)throw new Error("InternalError:KeyCacheBroken");const s=t.mapBlock(this.buf,r.offset,i);yield{type:1,seq:e,key:i,block:s,offset:r.offset},a=s.sig,n=s.end}else{const e=t.mapBlock(this.buf,n);if(0===e.size)return;if(n+e.size>this.buf.length)return;if(o){if(!a.equals(e.parentSig))return}else this._hasGenisis=e.parentSig.equals(r.Buffer.alloc(64));let i=!1;for(let t=this._keychain.length-1;t>=0;t--){if(i=e.verify(this._keychain[t]),!i)continue;const r=o++;e.key=this._keychain[t],this._cache[r]={offset:n,keyId:t},yield{type:1,seq:r,block:e,offset:n,key:this._keychain[t]},a=e.sig,n=e.end;break}if(!i)return}}}toString(){return this.pickle()}pickle(e=0){let n=encodeURIComponent(t.PICKLE.toString("utf8"));const r=t.KEY,o=t.BLOCK,i=(e?this.slice(e):this)._index();for(const t of i)n+=t.type?o+fu(t.block.buffer):r+fu(t.key);return n}slice(e=0,n,r=!1){const o=new t;for(const t of this.blocks(e,n))r||o._ensureKey(t.key),o._appendBlock(t.buffer);return o}_unpack(e){if(!e)throw new Error("Missing first argument");if("string"!=typeof e)throw new Error("url-friendly string expected");const n=encodeURIComponent(t.PICKLE),r=encodeURIComponent(t.KEY),o=encodeURIComponent(t.BLOCK),i=e.indexOf(n);if(-1===i)throw new Error("NotPickleError");let s=n.length+i,a=0,c=0,u=-1,l=-1;const h=()=>{if(-1!==u){const n=decodeURIComponent(e.substr(l,s-l-c-a+1));if(u)this._appendBlock(gu(n));else{const e=gu(n);if(e.length!==t.KEY_SIZE)throw new Error("PSIG key wrong size: ");this._ensureKey(e)}u=-1}l=s+1,u=a?0:1,a=c=0};for(;s<e.length;)e[s]===r[a]?++a===r.length&&h():a=0,e[s]===o[c]?++c===o.length&&h():c=0,s++;h()}truncate(t){if(0===t)return this.tail=0,this._cache=[],this._keychain=[],!0;const e=this.tail,n=this.get(t-1);if(this.tail=n.end,e===this.tail)return!1;let r=this._cache.length-t;for(;r--;)this._cache.pop();return!0}*blocks(t=0,e=0){for(t<0&&(t=this.length+t),e||(e=this.length),e<0&&(e=this.length+e+1);t<e;)yield this.get(t++)}_steal(t,e=!1){return e?(this.buf=r.Buffer.alloc(t.buf.length),t.buf.copy(this.buf),this._cache=t._cache.map((t=>({...t})))):(this.buf=t.buf,this._cache=[...t._cache]),this._keychain=[...t._keychain],this._hasGenisis=t._hasGenisis,this.tail=t.tail,t._robbed=!0,!0}_clearCache(){this._keychain=[],this._cache=[]}merge(e,n={},r=null){if("function"==typeof n)return this.merge(e,void 0,n);const o=n.forceCopy||!1;if(!e)throw new Error("First argument `source` expected by merge");const i=t.from(e),s="function"==typeof r,a=s?t=>{let e=!1;return r(t,(()=>{e=!0})),e}:()=>!1,c=t=>{let e=!1;for(const n of t){const t=n.key;if(s){if(a(n))return e}this._ensureKey(t),this._appendBlock(n.buffer),e=!0}return e};if(!this.length)return s?c(i.blocks()):this._steal(i,o);const u=()=>{if(this._reverseMergeFlag)return!1;const t=i.clone();t._reverseMergeFlag=!0;const e=t.length;if((!s||!a(t.get(0)))&&t.merge(this,n,r)){if(e===t.length)throw new Error("InternalError:NothingMerged");return this._steal(t)}return!1};try{const t=this._compare(i);return t<1||c(i.blocks(i.length-t))}catch(t){switch(t.type){case"BlockConflict":return!1;case"NoCommonParent":return!!this.partial&&u()}throw t}}clone(){const e=new t;return e._steal(this,!0),e}_compare(t){if(this===t)return 0;const e=[-1,-1],n=[this._index(),t._index()],r=[],o=[!1,!1],i=t=>{for(r[t]&&r[t].sig,r[t]=null;!r[t]&&!o[t];){const i=n[t].next();if(o[t]=o[t]||i.done,i.done&&void 0===i.value)break;i.value.type&&(e[t]++,r[t]=i.value.block)}},s=t=>{const n=e[t]-1;for(;r[t];)i(t);return e[t]-n},a=t=>{const n=new Error(t);return n.type=t,n.idxA=e[0],n.idxB=e[1],n};if(i(1),!r[1])return-s(0);const c=r[1].parentSig;for(;!o[0]&&(i(0),r[0])&&!r[0].parentSig.equals(c);)if(r[0].sig.equals(c)&&this.length===e[0]+1)return s(1);if(!r[0])throw a("NoCommonParent");if(!r[0].sig.equals(r[1].sig))throw a("BlockConflict");for(;;){if(i(0),i(1),!r[0]||!r[1])return r[0]||r[1]?r[0]?-s(0):s(1):0;if(!r[0].sig.equals(r[1].sig))throw a("BlockConflict")}}inspect(t=!1){const e=[["ID","KEY","SIG","PARENT","HEX","ASCII"]],n=[2];let r=0;for(const t of this.blocks()){const o=t.body.slice(0,12).toString("utf8"),i=[""+r++,t.key.slice(0,2).toString("hex"),t.sig.slice(0,4).toString("hex"),t.isGenesis?"_GENESIS":t.parentSig.slice(0,4).toString("hex"),t.body.slice(0,6).toString("hex").replace(/(.{2})/g,"$1 ").trimEnd(),o];for(let t=0;t<i.length;t++)n[t]=Math.max(n[t]||0,i[t].length);e.push(i)}const o=[];for(const t of e)o.push(" "+t.map(((t,e)=>t.padEnd(n[e]))).join("  ")+" ");if(o.splice(1,0,"".padEnd(o[0].length-1,"")+""),t)return o.join("\n");console.log(o.join("\n"))}static isFeed(t){return t&&t[uu]}static from(e,n={}){if(t.isFeed(e))return e;const o=new t(n);if(e[cu])o._ensureKey(e.key),o._appendBlock(e.buffer);else if("string"==typeof e)o._unpack(e);else if("string"==typeof e.hash)o._unpack(e.hash);else{if(!r.Buffer.isBuffer(e))throw new Error("NotAFeed");o._unpack(e.toString("utf8"))}return o}static fromBlockArray(e){if(!Array.isArray(e))throw new Error("fromBlockArray() expects an Array of blocks");const n={};let o=0;for(const t of e)o+=t.size,n[t.key.toString("hex")]=1;const i=new t,s=Object.keys(n).length*(t.KEY_SIZE+t.KEY.length)+e.length*t.META_SIZE+o;i.buf=r.Buffer.alloc(s);for(const t of e)n[t.key.toString("hex")]<2&&i._appendKey(t.key),i._appendBlock(t.buffer);return i._reIndex(!0),i}static signPair(){const t=r.Buffer.allocUnsafe(nu),e=r.Buffer.allocUnsafe(ru);return su(e,t),{sk:t,pk:e}}static mapBlock(e,n=0,r=null){const o=t.SIGNATURE_SIZE,i=t.COUNTER_SIZE,s=o+i,a={[cu]:!0,get start(){return n},get sig(){return e.subarray(n,n+o)},get header(){return e.subarray(n+o,n+o+s)},get parentSig(){return e.subarray(n+o,n+o+o)},get size(){return e.readUInt32BE(n+2*o)},set size(t){if("number"!=typeof t||t<0||t+n+o+s>e.length)throw new Error("Invalid blob size");return e.writeUInt32BE(t,n+2*o)},get body(){return e.subarray(n+o+s,a.safeEnd)},get dat(){return e.subarray(n+o,a.safeEnd)},get end(){return n+o+s+a.size},get safeEnd(){const t=a.size;if(t<1)throw new Error("Invalid blob size: "+t);const r=n+o+s+t;if(r>e.length)throw new Error("Incomplete or invalid block: end overflows buffer length"+r);return r},get next(){return t.mapBlock(e,a.safeEnd)},verify:t=>iu(a.sig,a.dat,t),get buffer(){return e.subarray(n,a.safeEnd)},get key(){if(!r)throw new Error("InternalError:MissingKey");return r},set key(t){if(r)throw new Error("InternalError:KeyExists");r=t},get isGenesis(){return lu.equals(a.parentSig)},[au]:()=>`[BlockMapper] start: ${a.start}, blocksize: ${a.size}, id: ${a.sig.slice(0,6).toString("hex")}, parent: ${a.parentSig.slice(0,6).toString("hex")}`};return a}};function fu(t){return t.toString("base64").replace(/\+/,"-").replace(/\//g,"_").replace(/=+$/,"")}function gu(t){return t=(t=(t+"===").slice(0,t.length+t.length%4)).replace(/-/g,"+").replace(/_/g,"/"),r.Buffer.from(t,"base64")}const du=hu,Au=Symbol.for("PicoRepo");function pu(t,e){if(!r.Buffer.isBuffer(e))throw new Error("Expected key to be a Buffer");const n=r.Buffer.alloc(1+e.length);return e.copy(n,1),n[0]=t,n}var yu,Iu,mu,Eu=class{static isRepo(t){return t&&t[Au]}constructor(t,e=[]){this[Au]=!0,this._db=t,this.allowDetached=!1,this._strategies=Array.isArray(e)?e:[e];for(const t of this._strategies)if("function"!=typeof t)throw new Error("ExpectedCallback")}get mkKey(){return pu}async _setHeadPtr(t,e){const n=pu(0,t);return await this._db.put(n,e),e}async _setLatestPtr(t,e){const n=pu(3,t);return await this._db.put(n,e),e}async _getTag(t,e){const n=pu(t,e);return await this._db.get(n).catch((t=>{if(!t.notFound)throw t}))}async _getHeadPtr(t){return this._getTag(0,t)}async _getTailPtr(t){return this._getTag(2,t)}async _getLatestPtr(t){return this._getTag(3,t)}async _getChainPtr(t){return this._getTag(5,t)}async writeBlock(t){const e=pu(1,t.sig),n=r.Buffer.alloc(32+t.buffer.length);t.key.copy(n,0),t.buffer.copy(n,32);const o=[];if(o.push({type:"put",key:e,value:n}),t.isGenesis)o.push({type:"put",key:pu(2,t.key),value:t.sig}),o.push({type:"put",key:pu(5,t.sig),value:t.sig}),o.push({type:"put",key:pu(6,t.sig),value:t.sig});else{const e=pu(5,t.parentSig),n=await this._db.get(e);o.push({type:"del",key:e}),o.push({type:"put",key:pu(5,t.sig),value:n}),o.push({type:"put",key:pu(6,n),value:t.sig})}return await this._db.batch(o),!0}async readBlock(t){const e=pu(1,t),n=await this._db.get(e).catch((t=>{if(!t.notFound)throw t}));if(n)return du.mapBlock(n,32,n.slice(0,32))}async _hasBlock(t){return!!await this.readBlock(t)}async _traceOwnerOf(t){let e=0;for await(const n of this._chainLoad(t)){if(n.isGenesis)return n.key;e++}if(e)throw new Error("Orphaned Chain")}async resolveFeed(t,e){let n=await this._getTag(5,t);if(n)return this.loadFeed(t,e);for await(const e of this._chainLoad(t))e.isGenesis&&(n=await this._getTag(6,e.sig));if(!n)throw new Error("Unknown feed");return this.loadFeed(n,e)}async merge(t,e){if(du.isFeed(t)||(t=du.from(t)),!t.length)return 0;let n=0,r=null;const o=t.first;if(r=o.isGenesis?o.key:await this._traceOwnerOf(o.parentSig),!r)throw new Error("CannotMerge: Unknown Chain");for(const o of t.blocks()){const t=o.key,i=o.sig;if(await this._hasBlock(i))continue;const s=async()=>{await this.writeBlock(o),await this._setHeadPtr(r,o.sig),await this._setLatestPtr(t,o.sig),n++},a=await this._getHeadPtr(r);if(!a){await s();continue}if(a.equals(o.parentSig)){await s();continue}if(this.allowDetached&&(o.isGenesis||await this._hasBlock(o.parentSig))){await s();continue}if(!await this._hasBlock(o.parentSig))break;let c=!1;for await(const t of this._chainLoad(o.parentSig))if(a.equals(t.sig)){c=!0;break}if(c)await s();else{if(!await this._queryUserStrategy(o,e))break;await s()}}return n}async _queryUserStrategy(t,e){for(const n of[e,...this._strategies]){if(!n)continue;const e=n(t,this);if("function"!=typeof e.then)throw new Error("PromiseExpected");if(await e)return!0}return!1}async loadHead(t,e){const n=await this._getHeadPtr(t);if(n)return this.loadFeed(n,e)}async loadLatest(t,e){const n=await this._getLatestPtr(t);if(n)return this.loadFeed(n,e)}async loadFeed(t,e){let n=0;Number.isInteger(e)&&e>0&&(n=e),n&&(e=(t,e)=>!--n&&e(!0));const r=[];for await(const n of this._chainLoad(t)){let t=!1,o=!1;if("function"==typeof e&&e(n,(e=>{e?o=!0:t=!0})),t||r.unshift(n),o||t)break}const o=du.fromBlockArray(r);if(o.length)return o}async*_chainLoad(t){let e=!0;for(;;){const n=await this.readBlock(t);if(!n&&e)break;if(e=!1,!n)throw new Error("ParentNotFound");if(yield n,n.isGenesis)break;t=n.parentSig}}async rollback(t,e){let n=!1;const r=await this.loadHead(t,((t,r)=>{e&&t.sig.equals(e)&&(n=!0,r())}));if(e&&!n)throw new Error("ReferenceNotFound");const o=[],i=[],s={};for(let t=r.length-1;t>=0;t--){const e=r.get(t),n=e.key.toString("hex");s[n]||(s[n]=await this._getLatestPtr(e.key)),s[n]?.equals(e.sig)&&i.push(e.key),o.push({type:"del",key:pu(1,e.sig)})}const a=r.first.isGenesis;a&&o.push({type:"del",key:pu(2,t)}),o.push({type:"del",key:pu(0,t)}),e?o.push({type:"put",key:pu(0,t),value:e}):a||o.push({type:"put",key:pu(0,t),value:r.first.parentSig}),o.push({type:"del",key:pu(5,r.last.sig)});const c=await this._getTag(5,r.last.sig);c&&o.push({type:"del",key:pu(6,c)}),c&&!a&&(o.push({type:"put",key:pu(5,r.first.parentSig),value:c}),o.push({type:"put",key:pu(6,c),value:r.first.parentSig}));for(const t of i)o.push({type:"del",key:pu(3,t)});return await this._db.batch(o),r}get headOf(){return this._getHeadPtr}get tailOf(){return this._getTailPtr}get latestOf(){return this._getLatestPtr}get chainload(){return this._chainLoad}get ownerOf(){return this._traceOwnerOf}async writeReg(t,e){const n=pu(4,r.Buffer.from(t));return await this._db.put(n,r.Buffer.from(e)),!0}async readReg(t){const e=pu(4,r.Buffer.from(t));return await this._db.get(e).catch((t=>{if(!t.notFound)throw t}))}async listHeads(){return this._listRange({gt:pu(0,r.Buffer.alloc(32).fill(0)),lt:pu(0,r.Buffer.alloc(32).fill(255))})}async listTails(){return this._listRange({gt:pu(2,r.Buffer.alloc(32).fill(0)),lt:pu(2,r.Buffer.alloc(32).fill(255))})}async listLatest(){return this._listRange({gt:pu(3,r.Buffer.alloc(32).fill(0)),lt:pu(3,r.Buffer.alloc(32).fill(255))})}async listFeeds(){return this._listRange({gt:pu(5,r.Buffer.alloc(32).fill(0)),lt:pu(5,r.Buffer.alloc(32).fill(255))})}async listFeedHeads(){return this._listRange({gt:pu(6,r.Buffer.alloc(32).fill(0)),lt:pu(6,r.Buffer.alloc(32).fill(255))})}async _listRange(t){const e=this._db.iterator(t),n=[];for(;;)try{const[t,r]=await new Promise(((t,n)=>{e.next(((e,r,o)=>{e?n(e):t([r,o])}))}));if(!t)break;n.push({key:t.slice(1),value:r})}catch(t){console.warn("Iterator died with an error",t);break}return await new Promise(((t,n)=>{e.close((e=>e?n(e):t()))})),n}};try{yu=new TextDecoder}catch(t){}var wu,bu,Cu,Bu,vu,_u=0,ku={},xu=0,Su=0,Qu=[],Mu={useRecords:!1,mapsAsObjects:!0};class Du{}const Tu=new Du;Tu.name="MessagePack 0xC1";var Lu=!1,$u=2;try{new Function("")}catch(t){$u=1/0}class Uu{constructor(t){t&&(!1===t.useRecords&&void 0===t.mapsAsObjects&&(t.mapsAsObjects=!0),t.sequential&&!1!==t.trusted&&(t.trusted=!0,t.structures||0==t.useRecords||(t.structures=[],t.maxSharedStructures||(t.maxSharedStructures=0))),t.structures?t.structures.sharedLength=t.structures.length:t.getStructures&&((t.structures=[]).uninitialized=!0,t.structures.sharedLength=0)),Object.assign(this,t)}unpack(t,e){if(Iu)return cl((()=>(ul(),this?this.unpack(t,e):Uu.prototype.unpack.call(Mu,t,e))));mu=e>-1?e:t.length,_u=0,Su=0,bu=null,Cu=null,Iu=t;try{vu=t.dataView||(t.dataView=new DataView(t.buffer,t.byteOffset,t.byteLength))}catch(e){if(Iu=null,t instanceof Uint8Array)throw e;throw new Error("Source must be a Uint8Array or Buffer but was a "+(t&&"object"==typeof t?t.constructor.name:typeof t))}if(this instanceof Uu){if(ku=this,this.structures)return wu=this.structures,Ou();(!wu||wu.length>0)&&(wu=[])}else ku=Mu,(!wu||wu.length>0)&&(wu=[]);return Ou()}unpackMultiple(t,e){let n,r=0;try{Lu=!0;let o=t.length,i=this?this.unpack(t,o):fl.unpack(t,o);if(!e){for(n=[i];_u<o;)r=_u,n.push(Ou());return n}for(e(i);_u<o;)if(r=_u,!1===e(Ou()))return}catch(t){throw t.lastPosition=r,t.values=n,t}finally{Lu=!1,ul()}}_mergeStructures(t,e){for(let e=0,n=(t=t||[]).length;e<n;e++){let n=t[e];n&&(n.isShared=!0,e>=32&&(n.highByte=e-32>>5))}t.sharedLength=t.length;for(let n in e||[])if(n>=0){let r=t[n],o=e[n];o&&(r&&((t.restoreStructures||(t.restoreStructures=[]))[n]=r),t[n]=o)}return this.structures=t}decode(t,e){return this.unpack(t,e)}}function Ou(){try{if(!ku.trusted&&!Lu){let t=wu.sharedLength||0;t<wu.length&&(wu.length=t)}let t=Nu();if(Cu&&(_u=Cu.postBundlePosition),_u==mu)wu.restoreStructures&&Fu(),wu=null,Iu=null,Bu&&(Bu=null);else{if(_u>mu)throw new Error("Unexpected end of MessagePack data");if(!Lu)throw new Error("Data read, but end of buffer not reached "+JSON.stringify(t).slice(0,100))}return t}catch(t){throw wu.restoreStructures&&Fu(),ul(),(t instanceof RangeError||t.message.startsWith("Unexpected end of buffer")||_u>mu)&&(t.incomplete=!0),t}}function Fu(){for(let t in wu.restoreStructures)wu[t]=wu.restoreStructures[t];wu.restoreStructures=null}function Nu(){let t=Iu[_u++];if(t<160){if(t<128){if(t<64)return t;{let e=wu[63&t]||ku.getStructures&&Ru()[63&t];return e?(e.read||(e.read=Yu(e,63&t)),e.read()):t}}if(t<144){if(t-=128,ku.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[ol()]=Nu();return e}{let e=new Map;for(let n=0;n<t;n++)e.set(Nu(),Nu());return e}}{t-=144;let e=new Array(t);for(let n=0;n<t;n++)e[n]=Nu();return e}}if(t<192){let e=t-160;if(Su>=_u)return bu.slice(_u-xu,(_u+=e)-xu);if(0==Su&&mu<140){let t=e<16?Zu(e):Xu(e);if(null!=t)return t}return ju(e)}{let e;switch(t){case 192:return null;case 193:return Cu?(e=Nu(),e>0?Cu[1].slice(Cu.position1,Cu.position1+=e):Cu[0].slice(Cu.position0,Cu.position0-=e)):Tu;case 194:return!1;case 195:return!0;case 196:if(e=Iu[_u++],void 0===e)throw new Error("Unexpected end of buffer");return el(e);case 197:return e=vu.getUint16(_u),_u+=2,el(e);case 198:return e=vu.getUint32(_u),_u+=4,el(e);case 199:return nl(Iu[_u++]);case 200:return e=vu.getUint16(_u),_u+=2,nl(e);case 201:return e=vu.getUint32(_u),_u+=4,nl(e);case 202:if(e=vu.getFloat32(_u),ku.useFloat32>2){let t=ll[(127&Iu[_u])<<1|Iu[_u+1]>>7];return _u+=4,(t*e+(e>0?.5:-.5)>>0)/t}return _u+=4,e;case 203:return e=vu.getFloat64(_u),_u+=8,e;case 204:return Iu[_u++];case 205:return e=vu.getUint16(_u),_u+=2,e;case 206:return e=vu.getUint32(_u),_u+=4,e;case 207:return ku.int64AsNumber?(e=4294967296*vu.getUint32(_u),e+=vu.getUint32(_u+4)):e=vu.getBigUint64(_u),_u+=8,e;case 208:return vu.getInt8(_u++);case 209:return e=vu.getInt16(_u),_u+=2,e;case 210:return e=vu.getInt32(_u),_u+=4,e;case 211:return ku.int64AsNumber?(e=4294967296*vu.getInt32(_u),e+=vu.getUint32(_u+4)):e=vu.getBigInt64(_u),_u+=8,e;case 212:if(e=Iu[_u++],114==e)return il(63&Iu[_u++]);{let t=Qu[e];if(t)return t.read?(_u++,t.read(Nu())):t.noBuffer?(_u++,t()):t(Iu.subarray(_u,++_u));throw new Error("Unknown extension "+e)}case 213:return e=Iu[_u],114==e?(_u++,il(63&Iu[_u++],Iu[_u++])):nl(2);case 214:return nl(4);case 215:return nl(8);case 216:return nl(16);case 217:return e=Iu[_u++],Su>=_u?bu.slice(_u-xu,(_u+=e)-xu):Hu(e);case 218:return e=vu.getUint16(_u),Su>=(_u+=2)?bu.slice(_u-xu,(_u+=e)-xu):Vu(e);case 219:return e=vu.getUint32(_u),Su>=(_u+=4)?bu.slice(_u-xu,(_u+=e)-xu):Gu(e);case 220:return e=vu.getUint16(_u),_u+=2,zu(e);case 221:return e=vu.getUint32(_u),_u+=4,zu(e);case 222:return e=vu.getUint16(_u),_u+=2,Ju(e);case 223:return e=vu.getUint32(_u),_u+=4,Ju(e);default:if(t>=224)return t-256;if(void 0===t){let t=new Error("Unexpected end of MessagePack data");throw t.incomplete=!0,t}throw new Error("Unknown MessagePack token "+t)}}}const Pu=/^[a-zA-Z_$][a-zA-Z\d_$]*$/;function Yu(t,e){function n(){if(n.count++>$u){let n=t.read=new Function("r","return function(){return {"+t.map((t=>Pu.test(t)?t+":r()":"["+JSON.stringify(t)+"]:r()")).join(",")+"}}")(Nu);return 0===t.highByte&&(t.read=Ku(e,t.read)),n()}let r={};for(let e=0,n=t.length;e<n;e++){r[t[e]]=Nu()}return r}return n.count=0,0===t.highByte?Ku(e,n):n}const Ku=(t,e)=>function(){let n=Iu[_u++];if(0===n)return e();let r=t<32?-(t+(n<<5)):t+(n<<5),o=wu[r]||Ru()[r];if(!o)throw new Error("Record id is not defined for "+r);return o.read||(o.read=Yu(o,t)),o.read()};function Ru(){let t=cl((()=>(Iu=null,ku.getStructures())));return wu=ku._mergeStructures(t,wu)}var ju=qu,Hu=qu,Vu=qu,Gu=qu;function qu(t){let e;if(t<16&&(e=Zu(t)))return e;if(t>64&&yu)return yu.decode(Iu.subarray(_u,_u+=t));const n=_u+t,r=[];for(e="";_u<n;){const t=Iu[_u++];if(0==(128&t))r.push(t);else if(192==(224&t)){const e=63&Iu[_u++];r.push((31&t)<<6|e)}else if(224==(240&t)){const e=63&Iu[_u++],n=63&Iu[_u++];r.push((31&t)<<12|e<<6|n)}else if(240==(248&t)){let e=(7&t)<<18|(63&Iu[_u++])<<12|(63&Iu[_u++])<<6|63&Iu[_u++];e>65535&&(e-=65536,r.push(e>>>10&1023|55296),e=56320|1023&e),r.push(e)}else r.push(t);r.length>=4096&&(e+=Wu.apply(String,r),r.length=0)}return r.length>0&&(e+=Wu.apply(String,r)),e}function zu(t){let e=new Array(t);for(let n=0;n<t;n++)e[n]=Nu();return e}function Ju(t){if(ku.mapsAsObjects){let e={};for(let n=0;n<t;n++)e[ol()]=Nu();return e}{let e=new Map;for(let n=0;n<t;n++)e.set(Nu(),Nu());return e}}var Wu=String.fromCharCode;function Xu(t){let e=_u,n=new Array(t);for(let r=0;r<t;r++){const t=Iu[_u++];if((128&t)>0)return void(_u=e);n[r]=t}return Wu.apply(String,n)}function Zu(t){if(t<4){if(t<2){if(0===t)return"";{let t=Iu[_u++];return(128&t)>1?void(_u-=1):Wu(t)}}{let e=Iu[_u++],n=Iu[_u++];if((128&e)>0||(128&n)>0)return void(_u-=2);if(t<3)return Wu(e,n);let r=Iu[_u++];return(128&r)>0?void(_u-=3):Wu(e,n,r)}}{let e=Iu[_u++],n=Iu[_u++],r=Iu[_u++],o=Iu[_u++];if((128&e)>0||(128&n)>0||(128&r)>0||(128&o)>0)return void(_u-=4);if(t<6){if(4===t)return Wu(e,n,r,o);{let t=Iu[_u++];return(128&t)>0?void(_u-=5):Wu(e,n,r,o,t)}}if(t<8){let i=Iu[_u++],s=Iu[_u++];if((128&i)>0||(128&s)>0)return void(_u-=6);if(t<7)return Wu(e,n,r,o,i,s);let a=Iu[_u++];return(128&a)>0?void(_u-=7):Wu(e,n,r,o,i,s,a)}{let i=Iu[_u++],s=Iu[_u++],a=Iu[_u++],c=Iu[_u++];if((128&i)>0||(128&s)>0||(128&a)>0||(128&c)>0)return void(_u-=8);if(t<10){if(8===t)return Wu(e,n,r,o,i,s,a,c);{let t=Iu[_u++];return(128&t)>0?void(_u-=9):Wu(e,n,r,o,i,s,a,c,t)}}if(t<12){let u=Iu[_u++],l=Iu[_u++];if((128&u)>0||(128&l)>0)return void(_u-=10);if(t<11)return Wu(e,n,r,o,i,s,a,c,u,l);let h=Iu[_u++];return(128&h)>0?void(_u-=11):Wu(e,n,r,o,i,s,a,c,u,l,h)}{let u=Iu[_u++],l=Iu[_u++],h=Iu[_u++],f=Iu[_u++];if((128&u)>0||(128&l)>0||(128&h)>0||(128&f)>0)return void(_u-=12);if(t<14){if(12===t)return Wu(e,n,r,o,i,s,a,c,u,l,h,f);{let t=Iu[_u++];return(128&t)>0?void(_u-=13):Wu(e,n,r,o,i,s,a,c,u,l,h,f,t)}}{let g=Iu[_u++],d=Iu[_u++];if((128&g)>0||(128&d)>0)return void(_u-=14);if(t<15)return Wu(e,n,r,o,i,s,a,c,u,l,h,f,g,d);let A=Iu[_u++];return(128&A)>0?void(_u-=15):Wu(e,n,r,o,i,s,a,c,u,l,h,f,g,d,A)}}}}}function tl(){let t,e=Iu[_u++];if(e<192)t=e-160;else switch(e){case 217:t=Iu[_u++];break;case 218:t=vu.getUint16(_u),_u+=2;break;case 219:t=vu.getUint32(_u),_u+=4;break;default:throw new Error("Expected string")}return qu(t)}function el(t){return ku.copyBuffers?Uint8Array.prototype.slice.call(Iu,_u,_u+=t):Iu.subarray(_u,_u+=t)}function nl(t){let e=Iu[_u++];if(Qu[e])return Qu[e](Iu.subarray(_u,_u+=t));throw new Error("Unknown extension type "+e)}var rl=new Array(4096);function ol(){let t=Iu[_u++];if(!(t>=160&&t<192))return _u--,Nu();if(t-=160,Su>=_u)return bu.slice(_u-xu,(_u+=t)-xu);if(!(0==Su&&mu<180))return ju(t);let e,n=4095&(t<<5^(t>1?vu.getUint16(_u):t>0?Iu[_u]:0)),r=rl[n],o=_u,i=_u+t-3,s=0;if(r&&r.bytes==t){for(;o<i;){if(e=vu.getUint32(o),e!=r[s++]){o=1879048192;break}o+=4}for(i+=3;o<i;)if(e=Iu[o++],e!=r[s++]){o=1879048192;break}if(o===i)return _u=o,r.string;i-=3,o=_u}for(r=[],rl[n]=r,r.bytes=t;o<i;)e=vu.getUint32(o),r.push(e),o+=4;for(i+=3;o<i;)e=Iu[o++],r.push(e);let a=t<16?Zu(t):Xu(t);return r.string=null!=a?a:ju(t)}const il=(t,e)=>{var n=Nu();let r=t;void 0!==e&&(t=t<32?-((e<<5)+t):(e<<5)+t,n.highByte=e);let o=wu[t];return o&&o.isShared&&((wu.restoreStructures||(wu.restoreStructures=[]))[t]=o),wu[t]=n,n.read=Yu(n,r),n.read()};Qu[0]=()=>{},Qu[0].noBuffer=!0,Qu[101]=()=>{let t=Nu();return(globalThis[t[0]]||Error)(t[1])},Qu[105]=t=>{let e=vu.getUint32(_u-4);Bu||(Bu=new Map);let n,r=Iu[_u];n=r>=144&&r<160||220==r||221==r?[]:{};let o={target:n};Bu.set(e,o);let i=Nu();return o.used?Object.assign(n,i):(o.target=i,i)},Qu[112]=t=>{let e=vu.getUint32(_u-4),n=Bu.get(e);return n.used=!0,n.target},Qu[115]=()=>new Set(Nu());const sl=["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64","BigInt64","BigUint64"].map((t=>t+"Array"));Qu[116]=t=>{let e=t[0],n=sl[e];if(!n)throw new Error("Could not find typed array for code "+e);return new globalThis[n](Uint8Array.prototype.slice.call(t,1).buffer)},Qu[120]=()=>{let t=Nu();return new RegExp(t[0],t[1])};const al=[];function cl(t){let e=mu,n=_u,r=xu,o=Su,i=bu,s=Bu,a=Cu,c=new Uint8Array(Iu.slice(0,mu)),u=wu,l=wu.slice(0,wu.length),h=ku,f=Lu,g=t();return mu=e,_u=n,xu=r,Su=o,bu=i,Bu=s,Cu=a,Iu=c,Lu=f,(wu=u).splice(0,wu.length,...l),ku=h,vu=new DataView(Iu.buffer,Iu.byteOffset,Iu.byteLength),g}function ul(){Iu=null,Bu=null,wu=null}Qu[98]=t=>{let e=(t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3],n=_u;return _u+=e-t.length,Cu=al,(Cu=[tl(),tl()]).position0=0,Cu.position1=0,Cu.postBundlePosition=_u,_u=n,Nu()},Qu[255]=t=>4==t.length?new Date(1e3*(16777216*t[0]+(t[1]<<16)+(t[2]<<8)+t[3])):8==t.length?new Date(((t[0]<<22)+(t[1]<<14)+(t[2]<<6)+(t[3]>>2))/1e6+1e3*(4294967296*(3&t[3])+16777216*t[4]+(t[5]<<16)+(t[6]<<8)+t[7])):12==t.length?new Date(((t[0]<<24)+(t[1]<<16)+(t[2]<<8)+t[3])/1e6+1e3*((128&t[4]?-281474976710656:0)+1099511627776*t[6]+4294967296*t[7]+16777216*t[8]+(t[9]<<16)+(t[10]<<8)+t[11])):new Date("invalid");const ll=new Array(147);for(let t=0;t<256;t++)ll[t]=+("1e"+Math.floor(45.15-.30103*t));const hl=Uu;var fl=new Uu({useRecords:!1});const gl=fl.unpack,dl=fl.unpackMultiple,Al=fl.unpack,pl={NEVER:0,ALWAYS:1,DECIMAL_ROUND:3,DECIMAL_FIT:4};let yl,Il,ml,El=new Float32Array(1),wl=new Uint8Array(El.buffer,0,4);try{yl=new TextEncoder}catch(t){}const bl=void 0!==r.Buffer,Cl=bl?function(t){return r.Buffer.allocUnsafeSlow(t)}:Uint8Array,Bl=bl?r.Buffer:Uint8Array,vl=bl?4294967296:2144337920;let _l,kl,xl,Sl,Ql=0,Ml=null;const Dl=/[\u0080-\uFFFF]/,Tl=Symbol("record-id");class Ll extends Uu{constructor(t){let e,n,r,o;super(t),this.offset=0;let i=0,s=Bl.prototype.utf8Write?function(t,e){return _l.utf8Write(t,e,4294967295)}:!(!yl||!yl.encodeInto)&&function(t,e){return yl.encodeInto(t,_l.subarray(e)).written},a=this;t||(t={});let c=t&&t.sequential,u=t.structures||t.saveStructures,l=t.maxSharedStructures;if(null==l&&(l=u?32:0),l>8160)throw new Error("Maximum maxSharedStructure is 8160");t.structuredClone&&null==t.moreTypes&&(t.moreTypes=!0);let h=t.maxOwnStructures;null==h&&(h=u?32:64),this.structures||0==t.useRecords||(this.structures=[]);let f=l>32||h+l>64,g=l+64,d=l+h+64;if(d>8256)throw new Error("Maximum maxSharedStructure + maxOwnStructure is 8192");let A=[],p=0,y=0;this.pack=this.encode=function(t,s){if(_l||(_l=new Cl(8192),xl=new DataView(_l.buffer,0,8192),Ql=0),Sl=_l.length-10,Sl-Ql<2048?(_l=new Cl(_l.length),xl=new DataView(_l.buffer,0,_l.length),Sl=_l.length-10,Ql=0):Ql=Ql+7&2147483640,e=Ql,o=a.structuredClone?new Map:null,a.bundleStrings&&"string"!=typeof t?(Ml=[],Ml.size=1/0):Ml=null,r=a.structures,r){r.uninitialized&&(r=a._mergeStructures(a.getStructures()));let t=r.sharedLength||0;if(t>l)throw new Error("Shared structures is larger than maximum shared structures, try increasing maxSharedStructures to "+r.sharedLength);if(!r.transitions){r.transitions=Object.create(null);for(let e=0;e<t;e++){let t=r[e];if(!t)continue;let n,o=r.transitions;for(let e=0,r=t.length;e<r;e++){let r=t[e];n=o[r],n||(n=o[r]=Object.create(null)),o=n}o[Tl]=e+64}i=t}c||(r.nextId=t+64)}n&&(n=!1);try{if(I(t),Ml&&Fl(e,I),a.offset=Ql,o&&o.idsToInsert){Ql+=6*o.idsToInsert.length,Ql>Sl&&E(Ql),a.offset=Ql;let t=function(t,e){let n,r=6*e.length,o=t.length-r;e.sort(((t,e)=>t.offset>e.offset?1:-1));for(;n=e.pop();){let e=n.offset,i=n.id;t.copyWithin(e+r,e,o),r-=6;let s=e+r;t[s++]=214,t[s++]=105,t[s++]=i>>24,t[s++]=i>>16&255,t[s++]=i>>8&255,t[s++]=255&i,o=e}return t}(_l.subarray(e,Ql),o.idsToInsert);return o=null,t}return s&Gl?(_l.start=e,_l.end=Ql,_l):_l.subarray(e,Ql)}finally{if(r){y<10&&y++;let o=r.sharedLength||l;if(r.length>o&&(r.length=o),p>1e4)r.transitions=null,y=0,p=0,A.length>0&&(A=[]);else if(A.length>0&&!c){for(let t=0,e=A.length;t<e;t++)A[t][Tl]=0;A=[]}if(n&&a.saveStructures){let n=_l.subarray(e,Ql);return!1===a.saveStructures(r,i)?(a._mergeStructures(a.getStructures()),a.pack(t)):(i=o,n)}}s&ql&&(Ql=e)}};const I=t=>{Ql>Sl&&(_l=E(Ql));var n,r=typeof t;if("string"===r){let r,o=t.length;if(Ml&&o>=4&&o<4096){if((Ml.size+=o)>61440){let t,n=(Ml[0]?3*Ml[0].length+Ml[1].length:0)+10;Ql+n>Sl&&(_l=E(Ql+n)),Ml.position?(_l[Ql]=200,Ql+=3,_l[Ql++]=98,t=Ql-e,Ql+=4,Fl(e,I),xl.setUint16(t+e-3,Ql-e-t)):(_l[Ql++]=214,_l[Ql++]=98,t=Ql-e,Ql+=4),Ml=["",""],Ml.size=0,Ml.position=t}let n=Dl.test(t);return Ml[n?0:1]+=t,_l[Ql++]=193,void I(n?-o:o)}r=o<32?1:o<256?2:o<65536?3:5;let i=3*o;if(Ql+i>Sl&&(_l=E(Ql+i)),o<64||!s){let e,i,s,a=Ql+r;for(e=0;e<o;e++)i=t.charCodeAt(e),i<128?_l[a++]=i:i<2048?(_l[a++]=i>>6|192,_l[a++]=63&i|128):55296==(64512&i)&&56320==(64512&(s=t.charCodeAt(e+1)))?(i=65536+((1023&i)<<10)+(1023&s),e++,_l[a++]=i>>18|240,_l[a++]=i>>12&63|128,_l[a++]=i>>6&63|128,_l[a++]=63&i|128):(_l[a++]=i>>12|224,_l[a++]=i>>6&63|128,_l[a++]=63&i|128);n=a-Ql-r}else n=s(t,Ql+r);n<32?_l[Ql++]=160|n:n<256?(r<2&&_l.copyWithin(Ql+2,Ql+1,Ql+1+n),_l[Ql++]=217,_l[Ql++]=n):n<65536?(r<3&&_l.copyWithin(Ql+3,Ql+2,Ql+2+n),_l[Ql++]=218,_l[Ql++]=n>>8,_l[Ql++]=255&n):(r<5&&_l.copyWithin(Ql+5,Ql+3,Ql+3+n),_l[Ql++]=219,xl.setUint32(Ql,n),Ql+=4),Ql+=n}else if("number"===r)if(t>>>0===t)t<64||t<128&&!1===this.useRecords?_l[Ql++]=t:t<256?(_l[Ql++]=204,_l[Ql++]=t):t<65536?(_l[Ql++]=205,_l[Ql++]=t>>8,_l[Ql++]=255&t):(_l[Ql++]=206,xl.setUint32(Ql,t),Ql+=4);else if(t>>0===t)t>=-32?_l[Ql++]=256+t:t>=-128?(_l[Ql++]=208,_l[Ql++]=t+256):t>=-32768?(_l[Ql++]=209,xl.setInt16(Ql,t),Ql+=2):(_l[Ql++]=210,xl.setInt32(Ql,t),Ql+=4);else{let e;if((e=this.useFloat32)>0&&t<4294967296&&t>=-2147483648){let n;if(_l[Ql++]=202,xl.setFloat32(Ql,t),e<4||(n=t*ll[(127&_l[Ql])<<1|_l[Ql+1]>>7])>>0===n)return void(Ql+=4);Ql--}_l[Ql++]=203,xl.setFloat64(Ql,t),Ql+=8}else if("object"===r)if(t){if(o){let n=o.get(t);if(n){if(!n.id){let t=o.idsToInsert||(o.idsToInsert=[]);n.id=t.push(n)}return _l[Ql++]=214,_l[Ql++]=112,xl.setUint32(Ql,n.id),void(Ql+=4)}o.set(t,{offset:Ql-e})}let r=t.constructor;if(r===Object)m(t,!0);else if(r===Array){(n=t.length)<16?_l[Ql++]=144|n:n<65536?(_l[Ql++]=220,_l[Ql++]=n>>8,_l[Ql++]=255&n):(_l[Ql++]=221,xl.setUint32(Ql,n),Ql+=4);for(let e=0;e<n;e++)I(t[e])}else if(r===Map){(n=t.size)<16?_l[Ql++]=128|n:n<65536?(_l[Ql++]=222,_l[Ql++]=n>>8,_l[Ql++]=255&n):(_l[Ql++]=223,xl.setUint32(Ql,n),Ql+=4);for(let[e,n]of t)I(e),I(n)}else{for(let e=0,n=Il.length;e<n;e++){if(t instanceof ml[e]){let n=Il[e];if(n.write)return n.type&&(_l[Ql++]=212,_l[Ql++]=n.type,_l[Ql++]=0),void I(n.write.call(this,t));let r,o=_l,i=xl,s=Ql;_l=null;try{r=n.pack.call(this,t,(t=>(_l=o,o=null,Ql+=t,Ql>Sl&&E(Ql),{target:_l,targetView:xl,position:Ql-t})),I)}finally{o&&(_l=o,xl=i,Ql=s,Sl=_l.length-10)}return void(r&&(r.length+Ql>Sl&&E(r.length+Ql),Ql=Ol(r,_l,Ql,n.type)))}}m(t,!t.hasOwnProperty)}}else _l[Ql++]=192;else if("boolean"===r)_l[Ql++]=t?195:194;else if("bigint"===r){if(t<BigInt(1)<<BigInt(63)&&t>=-(BigInt(1)<<BigInt(63)))_l[Ql++]=211,xl.setBigInt64(Ql,t);else if(t<BigInt(1)<<BigInt(64)&&t>0)_l[Ql++]=207,xl.setBigUint64(Ql,t);else{if(!this.largeBigIntToFloat)throw new RangeError(t+" was too large to fit in MessagePack 64-bit integer format, set largeBigIntToFloat to convert to float-64");_l[Ql++]=203,xl.setFloat64(Ql,Number(t))}Ql+=8}else if("undefined"===r)this.encodeUndefinedAsNil?_l[Ql++]=192:(_l[Ql++]=212,_l[Ql++]=0,_l[Ql++]=0);else{if("function"!==r)throw new Error("Unknown type: "+r);I(this.writeFunction&&this.writeFunction())}},m=!1===this.useRecords?this.variableMapSize?t=>{let e,n=Object.keys(t),r=n.length;r<16?_l[Ql++]=128|r:r<65536?(_l[Ql++]=222,_l[Ql++]=r>>8,_l[Ql++]=255&r):(_l[Ql++]=223,xl.setUint32(Ql,r),Ql+=4);for(let o=0;o<r;o++)I(e=n[o]),I(t[e])}:(t,n)=>{_l[Ql++]=222;let r=Ql-e;Ql+=2;let o=0;for(let e in t)(n||t.hasOwnProperty(e))&&(I(e),I(t[e]),o++);_l[r+++e]=o>>8,_l[r+e]=255&o}:t.progressiveRecords&&!f?(t,n)=>{let o,i,s=r.transitions||(r.transitions=Object.create(null)),a=Ql++-e;for(let c in t)if(n||t.hasOwnProperty(c)){if(o=s[c],o)s=o;else{let n=Object.keys(t),u=s;s=r.transitions;let l=0;for(let t=0,e=n.length;t<e;t++){let e=n[t];o=s[e],o||(o=s[e]=Object.create(null),l++),s=o}a+e+1==Ql?(Ql--,w(s,n,l)):b(s,n,a,l),i=!0,s=u[c]}I(t[c])}if(!i){let n=s[Tl];n?_l[a+e]=n:b(s,Object.keys(t),a,0)}}:(t,e)=>{let n,o=r.transitions||(r.transitions=Object.create(null)),i=0;for(let r in t)(e||t.hasOwnProperty(r))&&(n=o[r],n||(n=o[r]=Object.create(null),i++),o=n);let s=o[Tl];s?s>=96&&f?(_l[Ql++]=96+(31&(s-=96)),_l[Ql++]=s>>5):_l[Ql++]=s:w(o,o.__keys__||Object.keys(t),i);for(let n in t)(e||t.hasOwnProperty(n))&&I(t[n])},E=t=>{let n;if(t>16777216){if(t-e>vl)throw new Error("Packed buffer would be larger than maximum buffer size");n=Math.min(vl,4096*Math.round(Math.max((t-e)*(t>67108864?1.25:2),4194304)/4096))}else n=1+(Math.max(t-e<<2,_l.length-1)>>12)<<12;let r=new Cl(n);return xl=new DataView(r.buffer,0,n),t=Math.min(t,_l.length),_l.copy?_l.copy(r,0,e,t):r.set(_l.slice(e,t)),Ql-=e,e=0,Sl=r.length-10,_l=r},w=(t,e,o)=>{let i=r.nextId;i||(i=64),i<g&&this.shouldShareStructure&&!this.shouldShareStructure(e)?(i=r.nextOwnId,i<d||(i=g),r.nextOwnId=i+1):(i>=d&&(i=g),r.nextId=i+1);let s=e.highByte=i>=96&&f?i-96>>5:-1;t[Tl]=i,t.__keys__=e,r[i-64]=e,i<g?(e.isShared=!0,r.sharedLength=i-63,n=!0,s>=0?(_l[Ql++]=96+(31&i),_l[Ql++]=s):_l[Ql++]=i):(s>=0?(_l[Ql++]=213,_l[Ql++]=114,_l[Ql++]=96+(31&i),_l[Ql++]=s):(_l[Ql++]=212,_l[Ql++]=114,_l[Ql++]=i),o&&(p+=y*o),A.length>=h&&(A.shift()[Tl]=0),A.push(t),I(e))},b=(t,n,r,o)=>{let i=_l,s=Ql,a=Sl,c=e;_l=kl,Ql=0,e=0,_l||(kl=_l=new Cl(8192)),Sl=_l.length-10,w(t,n,o),kl=_l;let u=Ql;if(_l=i,Ql=s,Sl=a,e=c,u>1){let t=Ql+u-1;t>Sl&&E(t);let n=r+e;_l.copyWithin(n+u,n+1,Ql),_l.set(kl.slice(0,u),n),Ql=t}else _l[r+e]=kl[0]}}useBuffer(t){_l=t,xl=new DataView(_l.buffer,_l.byteOffset,_l.byteLength),Ql=0}clearSharedData(){this.structures&&(this.structures=[])}}function $l(t,e,n,r){let o=t.byteLength;if(o+1<256){var{target:i,position:s}=n(4+o);i[s++]=199,i[s++]=o+1}else if(o+1<65536){var{target:i,position:s}=n(5+o);i[s++]=200,i[s++]=o+1>>8,i[s++]=o+1&255}else{var{target:i,position:s,targetView:a}=n(7+o);i[s++]=201,a.setUint32(s,o+1),s+=4}i[s++]=116,i[s++]=e,i.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),s)}function Ul(t,e){let n=t.byteLength;var r,o;if(n<256){var{target:r,position:o}=e(n+2);r[o++]=196,r[o++]=n}else if(n<65536){var{target:r,position:o}=e(n+3);r[o++]=197,r[o++]=n>>8,r[o++]=255&n}else{var{target:r,position:o,targetView:i}=e(n+5);r[o++]=198,i.setUint32(o,n),o+=4}r.set(t,o)}function Ol(t,e,n,r){let o=t.length;switch(o){case 1:e[n++]=212;break;case 2:e[n++]=213;break;case 4:e[n++]=214;break;case 8:e[n++]=215;break;case 16:e[n++]=216;break;default:o<256?(e[n++]=199,e[n++]=o):o<65536?(e[n++]=200,e[n++]=o>>8,e[n++]=255&o):(e[n++]=201,e[n++]=o>>24,e[n++]=o>>16&255,e[n++]=o>>8&255,e[n++]=255&o)}return e[n++]=r,e.set(t,n),n+=o}function Fl(t,e){if(Ml.length>0){xl.setUint32(Ml.position+t,Ql-Ml.position-t);let n=Ml;Ml=null,e(n[0]),e(n[1])}}ml=[Date,Set,Error,RegExp,ArrayBuffer,Object.getPrototypeOf(Uint8Array.prototype).constructor,Du],Il=[{pack(t,e,n){let r=t.getTime()/1e3;if((this.useTimestamp32||0===t.getMilliseconds())&&r>=0&&r<4294967296){let{target:t,targetView:n,position:o}=e(6);t[o++]=214,t[o++]=255,n.setUint32(o,r)}else if(r>0&&r<4294967296){let{target:n,targetView:o,position:i}=e(10);n[i++]=215,n[i++]=255,o.setUint32(i,4e6*t.getMilliseconds()+(r/1e3/4294967296>>0)),o.setUint32(i+4,r)}else if(isNaN(r)){if(this.onInvalidDate)return e(0),n(this.onInvalidDate());let{target:t,targetView:r,position:o}=e(3);t[o++]=212,t[o++]=255,t[o++]=255}else{let{target:n,targetView:o,position:i}=e(15);n[i++]=199,n[i++]=12,n[i++]=255,o.setUint32(i,1e6*t.getMilliseconds()),o.setBigInt64(i+4,BigInt(Math.floor(r)))}}},{pack(t,e,n){let r=Array.from(t),{target:o,position:i}=e(this.moreTypes?3:0);this.moreTypes&&(o[i++]=212,o[i++]=115,o[i++]=0),n(r)}},{pack(t,e,n){let{target:r,position:o}=e(this.moreTypes?3:0);this.moreTypes&&(r[o++]=212,r[o++]=101,r[o++]=0),n([t.name,t.message])}},{pack(t,e,n){let{target:r,position:o}=e(this.moreTypes?3:0);this.moreTypes&&(r[o++]=212,r[o++]=120,r[o++]=0),n([t.source,t.flags])}},{pack(t,e){this.moreTypes?$l(t,16,e):Ul(bl?r.Buffer.from(t):new Uint8Array(t),e)}},{pack(t,e){let n=t.constructor;n!==Bl&&this.moreTypes?$l(t,sl.indexOf(n.name),e):Ul(t,e)}},{pack(t,e){let{target:n,position:r}=e(1);n[r]=193}}];let Nl=new Ll({useRecords:!1});const Pl=Nl.pack,Yl=Nl.pack,Kl=Ll,{NEVER:Rl,ALWAYS:jl,DECIMAL_ROUND:Hl,DECIMAL_FIT:Vl}=pl,Gl=512,ql=1024;const zl=function(t,e={}){if(!t||"object"!=typeof t)throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a promise");const n=new Uu(e);let o;const i=t=>{let e;o&&(t=r.Buffer.concat([o,t]),o=void 0);try{e=n.unpackMultiple(t)}catch(n){if(!n.incomplete)throw n;o=t.slice(n.lastPosition),e=n.values}return e};return"function"==typeof t[Symbol.iterator]?function*(){for(const e of t)yield*i(e)}():"function"==typeof t[Symbol.asyncIterator]?async function*(){for await(const e of t)yield*i(e)}():void 0},Jl=function(t,e={}){if(t&&"object"==typeof t){if("function"==typeof t[Symbol.iterator])return function*(t,e){const n=new Ll(e);for(const e of t)yield n.pack(e)}(t,e);if("function"==typeof t.then||"function"==typeof t[Symbol.asyncIterator])return async function*(t,e){const n=new Ll(e);for await(const e of t)yield n.pack(e)}(t,e);throw new Error("first argument must be an Iterable, Async Iterable, Iterator, Async Iterator, or a Promise")}throw new Error("first argument must be an Iterable, Async Iterable, or a Promise for an Async Iterable")};var Wl=e(Object.freeze({__proto__:null,useRecords:!1,mapsAsObjects:!0,Packr:Ll,Encoder:Kl,addExtension:function(t){if(t.Class){if(!t.pack&&!t.write)throw new Error("Extension has no pack or write function");if(t.pack&&!t.type)throw new Error("Extension has no type (numeric code to identify the extension)");ml.unshift(t.Class),Il.unshift(t)}!function(t){t.unpack?Qu[t.type]=t.unpack:Qu[t.type]=t}(t)},pack:Pl,encode:Yl,NEVER:Rl,ALWAYS:jl,DECIMAL_ROUND:Hl,DECIMAL_FIT:Vl,REUSE_BUFFER_MODE:Gl,Unpackr:Uu,Decoder:hl,C1:Tu,unpack:gl,unpackMultiple:dl,decode:Al,FLOAT32_OPTIONS:pl,clearSource:ul,roundFloat32:function(t){El[0]=t;let e=ll[(127&wl[3])<<1|wl[2]>>7];return(e*t+(t>0?.5:-.5)>>0)/e},isNativeAccelerationEnabled:!1,decodeIter:zl,encodeIter:Jl}));const Xl=Eu,Zl=hu,{Packr:th,pack:eh,unpack:nh}=Wl,rh="msgpackr::structs";var oh=class{constructor(t,e){this.repo=Xl.isRepo(t)?t:new Xl(t),this.cache=new ih(this.repo._db),this._strategy=e||(()=>{}),this._stores=[],this._loaded=!1,this._mutex=Promise.resolve(0),this._tap=null,this._packr=null,this.mutexTimeout=5e3}async _waitLock(){const t=this._mutex;let e,n;const r=new Promise(((t,r)=>{e=t,n=r}));this._mutex=r;let o=null;try{throw new Error("MutexTimeout")}catch(t){o=t}const i=setTimeout((()=>{console.error("MutexTimeout",o.stack),n(o)}),this.mutexTimeout);return await t,()=>{clearTimeout(i),e()}}register(t,e,n,r,o){if(this._loaded)throw new Error("register() must be invoked before load()");return"string"!=typeof t?this.register(t.name,t.initialValue,t.filter,t.reducer,t.trap):"function"==typeof e?this.register(t,void 0,e,n):void this._stores.push({name:t,validator:n,reducer:r,trap:o,version:0,head:void 0,value:e,initialValue:e,observers:new Set})}async load(){const t=await this._waitLock();if(this._loaded)throw new Error("Store already loaded");let e=await this.repo.readReg(rh);e=e?nh(e):[],this._packr=new th({structures:e,saveStructures:()=>this.repo.writeReg(rh,eh(e)).catch(console.error.bind(null,"Failed saving msgpackr:structs"))});for(const t of this._stores){const e=await this.repo.readReg(`HEADS/${t.name}`);if(e){t.head=e,t.version=this._decodeValue(await this.repo.readReg(`VER/${t.name}`)),t.value=this._decodeValue(await this.repo.readReg(`STATES/${t.name}`));for(const e of t.observers)e(t.value)}}this._loaded=!0,t()}async dispatch(t,e){const n=await this._waitLock();try{const r=await this._dispatch(t,e);return n(),r}catch(t){throw n(),t}}async _dispatch(t,e=!1){if(!this._loaded)throw Error("Store not ready, call load()");t=Zl.from(t);let n=null;try{const e=t.first.isGenesis?t.first.sig:t.first.parentSig;n=await this.repo.resolveFeed(e)}catch(e){if("Unknown feed"!==e.message)throw e;if(!t.first.isGenesis)return await this.cache.push(t),[];n=new Zl}for(const e of t.blocks()){const[n,r]=await this.cache.pop(e.parentSig,e.sig);n&&ah(!t.merge(n),"Backward merge failed"),r&&ah(!t.merge(r),"Forwrad merge failed")}if(!n.clone().merge(t)){if(e)throw new Error("UnmergablePatch");return[]}const r={};n.first?.isGenesis?(r.HEAD=n.first.key,r.CHAIN=n.first.sig):!n.length&&t.first.isGenesis&&(r.HEAD=t.first.key,r.CHAIN=t.first.sig);const o=n.length?n._compare(t):t.length;if(o<1)return[];const i=new Set,s=this.state;let a=null;const c=t.get(-o);if(!c.isGenesis&&!n.length){if(e)throw new Error("NoCommonParent");return[]}if(!c.isGenesis&&n.length){const t=n.blocks();let e=t.next();for(;!a&&!e.done;)e.value.sig.equals(c.parentSig)&&(a=e.value),e=t.next();if(!a)throw new Error("ParentNotFound")}let u=0;for(const n of t.blocks(-o)){const t=[];for(const o of this._stores){if("function"!=typeof o.validator)continue;let i=o.validator({block:n,parentBlock:a,state:o.value,root:s,...r});if(i){if(!0===i);else if(e)throw"string"==typeof i&&(i=new Error(`InvalidBlock: ${i}`)),i}else t.push(o)}if(!t.length)break;const o=await this._mutateState(n,a,r,!1,e);for(const t of o)i.add(t);a=n,u++}this._notifyObservers(i);const l=Array.from(i);return Object.defineProperty(l,"patch",{enumerable:!1,get:()=>t.slice(-o,-o+u)}),l}async _mutateState(t,e,n,r=!1,o=!1){const i=[],s=[];for(const r of this._stores){if("function"!=typeof r.validator)continue;if("function"!=typeof r.reducer)continue;const o=this.state;r.validator({block:t,parentBlock:e,state:r.value,root:o,...n})||s.push(r)}if(s.length){const e=await this.repo.merge(t,this._strategy);if(!r&&!e)return o&&console.warn("RejectedByBucket: MergeStrategy failed"),i}const a=[],c=(t,e)=>a.push([t,e]);for(const r of s){const o=this.state,s=r.reducer({block:t,parentBlock:e,state:r.value,root:o,signal:c,...n});void 0===s&&console.warn("Reducer returned `undefined` state."),await this._commitHead(r,t.sig,s),i.push(r.name)}for(const[r,o]of a)for(const s of this._stores){if("function"!=typeof s.trap)continue;const a=this.state,c=s.trap({code:r,payload:o,block:t,parentBlock:e,state:s.value,root:a,...n});void 0!==c&&(await this._commitHead(s,t.sig,c),i.push(s.name))}if("function"==typeof this._tap)for(const[t,e]of a)this._tap(t,e);return i}_notifyObservers(t){for(const e of t){const t=this._stores.find((t=>t.name===e));for(const e of t.observers)e(t.value)}}async _commitHead(t,e,n){await this.repo.writeReg(`STATES/${t.name}`,this._encodeValue(n)),await this.repo.writeReg(`HEADS/${t.name}`,e),await this.repo.writeReg(`VER/${t.name}`,this._encodeValue(t.version++)),t.value=n,t.head=e}get state(){return this._stores.reduce(((t,e)=>(t[e.name]=e.value,t)),{})}async reload(){const t=await this._waitLock();try{const e=[],n=await this.repo.listFeeds();for(const t of this._stores){t.value=t.initialValue,t.version=0,t.head=void 0;for(const e of t.observers)e(t.value)}for(const{key:t,value:r}of n){const n=await this.repo.loadFeed(t),o={HEAD:n.first.key,CHAIN:r};let i=null;for(const t of n.blocks()){const n=await this._mutateState(t,i,o,!0);for(const t of n)~e.indexOf(t)||e.push(t);i=t}}return t(),this._notifyObservers(e),e}catch(e){throw t(),e}}on(t,e){const n=this._stores.find((e=>e.name===t));if(!n)throw new Error(`No such store: "${t}"`);if("function"!=typeof e)throw new Error("observer must be a function");return n.observers.add(e),e(n.value),()=>n.observers.delete(e)}hotswap(t){const e=this.repo;this.repo=t instanceof Xl?t:new Xl(t);return[this.reload(),e._db.clear()]}_decodeValue(t){return t?this._packr.unpack(t):t}_encodeValue(t){return this._packr.pack(t)}};class ih{constructor(t){this.blocks=t.sublevel("b",{keyEncoding:"buffer",valueEncoding:"buffer"}),this.refs=t.sublevel("r",{keyEncoding:"buffer",valueEncoding:"buffer"})}async push(t){if(t.first.isGenesis)throw new Error("GenesisRefused");for(const e of t.blocks())await this.refs.put(e.parentSig,e.sig),await this._writeBlock(e)}async pop(t,e){const n=[],r=[],o=[];let i=t,s=[];for(;;){const t=await this._readBlock(i);if(!t)break;n.push(t.parentSig),r.push(t.parentSig),s.push(t),i=t.parentSig}for(s.length&&o.push(Zl.fromBlockArray(s)),i=e,s=[];;){const t=await this.refs.get(i).catch(sh);if(!t)break;const e=await this._readBlock(t);n.push(t),r.push(e.sig),s.push(e),i=e.sig}return s.length&&o.push(Zl.fromBlockArray(s)),await Promise.all([this.blocks.batch(r.map((t=>({type:"del",key:t})))),this.refs.batch(n.map((t=>({type:"del",key:t}))))]),o}async _writeBlock(t){const e=t.sig,n=r.Buffer.alloc(32+t.buffer.length);t.key.copy(n,0),t.buffer.copy(n,32),await this.blocks.put(e,n)}async _readBlock(t){const e=await this.blocks.get(t).catch(sh);if(e)return Zl.mapBlock(e,32,e.slice(0,32))}async _hasBlock(t){return!!await this.readBlock(t)}}function sh(t){if(!t.notFound)throw t}function ah(t,e){if(t)throw new Error(e||"AssertionError")}var ch,uh,lh={exports:{}},hh={exports:{}},fh=hh.exports={};function gh(){throw new Error("setTimeout has not been defined")}function dh(){throw new Error("clearTimeout has not been defined")}function Ah(t){if(ch===setTimeout)return setTimeout(t,0);if((ch===gh||!ch)&&setTimeout)return ch=setTimeout,setTimeout(t,0);try{return ch(t,0)}catch(e){try{return ch.call(null,t,0)}catch(e){return ch.call(this,t,0)}}}!function(){try{ch="function"==typeof setTimeout?setTimeout:gh}catch(t){ch=gh}try{uh="function"==typeof clearTimeout?clearTimeout:dh}catch(t){uh=dh}}();var ph,yh=[],Ih=!1,mh=-1;function Eh(){Ih&&ph&&(Ih=!1,ph.length?yh=ph.concat(yh):mh=-1,yh.length&&wh())}function wh(){if(!Ih){var t=Ah(Eh);Ih=!0;for(var e=yh.length;e;){for(ph=yh,yh=[];++mh<e;)ph&&ph[mh].run();mh=-1,e=yh.length}ph=null,Ih=!1,function(t){if(uh===clearTimeout)return clearTimeout(t);if((uh===dh||!uh)&&clearTimeout)return uh=clearTimeout,clearTimeout(t);try{uh(t)}catch(e){try{return uh.call(null,t)}catch(e){return uh.call(this,t)}}}(t)}}function bh(t,e){this.fun=t,this.array=e}function Ch(){}fh.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];yh.push(new bh(t,e)),1!==yh.length||Ih||Ah(wh)},bh.prototype.run=function(){this.fun.apply(null,this.array)},fh.title="browser",fh.browser=!0,fh.env={},fh.argv=[],fh.version="",fh.versions={},fh.on=Ch,fh.addListener=Ch,fh.once=Ch,fh.off=Ch,fh.removeListener=Ch,fh.removeAllListeners=Ch,fh.emit=Ch,fh.prependListener=Ch,fh.prependOnceListener=Ch,fh.listeners=function(t){return[]},fh.binding=function(t){throw new Error("process.binding is not supported")},fh.cwd=function(){return"/"},fh.chdir=function(t){throw new Error("process.chdir is not supported")},fh.umask=function(){return 0};var Bh,vh,_h={exports:{}};function kh(){if(vh)return Bh;vh=1;var t=1e3,e=60*t,n=60*e,r=24*n,o=7*r,i=365.25*r;function s(t,e,n,r){var o=e>=1.5*n;return Math.round(t/n)+" "+r+(o?"s":"")}return Bh=function(a,c){c=c||{};var u=typeof a;if("string"===u&&a.length>0)return function(s){if((s=String(s)).length>100)return;var a=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(s);if(!a)return;var c=parseFloat(a[1]);switch((a[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return c*i;case"weeks":case"week":case"w":return c*o;case"days":case"day":case"d":return c*r;case"hours":case"hour":case"hrs":case"hr":case"h":return c*n;case"minutes":case"minute":case"mins":case"min":case"m":return c*e;case"seconds":case"second":case"secs":case"sec":case"s":return c*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return c;default:return}}(a);if("number"===u&&isFinite(a))return c.long?function(o){var i=Math.abs(o);if(i>=r)return s(o,i,r,"day");if(i>=n)return s(o,i,n,"hour");if(i>=e)return s(o,i,e,"minute");if(i>=t)return s(o,i,t,"second");return o+" ms"}(a):function(o){var i=Math.abs(o);if(i>=r)return Math.round(o/r)+"d";if(i>=n)return Math.round(o/n)+"h";if(i>=e)return Math.round(o/e)+"m";if(i>=t)return Math.round(o/t)+"s";return o+"ms"}(a);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(a))},Bh}var xh=function(t){function e(t){let r,o,i,s=null;function a(...t){if(!a.enabled)return;const n=a,o=Number(new Date),i=o-(r||o);n.diff=i,n.prev=r,n.curr=o,r=o,t[0]=e.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let s=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,((r,o)=>{if("%%"===r)return"%";s++;const i=e.formatters[o];if("function"==typeof i){const e=t[s];r=i.call(n,e),t.splice(s,1),s--}return r})),e.formatArgs.call(n,t);(n.log||e.log).apply(n,t)}return a.namespace=t,a.useColors=e.useColors(),a.color=e.selectColor(t),a.extend=n,a.destroy=e.destroy,Object.defineProperty(a,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(o!==e.namespaces&&(o=e.namespaces,i=e.enabled(t)),i),set:t=>{s=t}}),"function"==typeof e.init&&e.init(a),a}function n(t,n){const r=e(this.namespace+(void 0===n?":":n)+t);return r.log=this.log,r}function r(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return e.debug=e,e.default=e,e.coerce=function(t){if(t instanceof Error)return t.stack||t.message;return t},e.disable=function(){const t=[...e.names.map(r),...e.skips.map(r).map((t=>"-"+t))].join(",");return e.enable(""),t},e.enable=function(t){let n;e.save(t),e.namespaces=t,e.names=[],e.skips=[];const r=("string"==typeof t?t:"").split(/[\s,]+/),o=r.length;for(n=0;n<o;n++)r[n]&&("-"===(t=r[n].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.slice(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){if("*"===t[t.length-1])return!0;let n,r;for(n=0,r=e.skips.length;n<r;n++)if(e.skips[n].test(t))return!1;for(n=0,r=e.names.length;n<r;n++)if(e.names[n].test(t))return!0;return!1},e.humanize=kh(),e.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach((n=>{e[n]=t[n]})),e.names=[],e.skips=[],e.formatters={},e.selectColor=function(t){let n=0;for(let e=0;e<t.length;e++)n=(n<<5)-n+t.charCodeAt(e),n|=0;return e.colors[Math.abs(n)%e.colors.length]},e.enable(e.load()),e};!function(t,e){e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+t.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;e.splice(1,0,n,"color: inherit");let r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,(t=>{"%%"!==t&&(r++,"%c"===t&&(o=r))})),e.splice(o,0,n)},e.save=function(t){try{t?e.storage.setItem("debug",t):e.storage.removeItem("debug")}catch(t){}},e.load=function(){let t;try{t=e.storage.getItem("debug")}catch(t){}!t&&void 0!==hh.exports&&"env"in hh.exports&&(t=hh.exports.env.DEBUG);return t},e.useColors=function(){if("undefined"!=typeof window&&window.process&&("renderer"===window.process.type||window.process.__nwjs))return!0;if("undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))return!1;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage=function(){try{return localStorage}catch(t){}}(),e.destroy=(()=>{let t=!1;return()=>{t||(t=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),t.exports=xh(e);const{formatters:n}=t.exports;n.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}(_h,_h.exports);var Sh=_h.exports;!function(t){const e=_h.exports("pico-net"),n=Symbol.for("pico:plug");function o(o={}){const a=o?.timeout||3e4;let c=o?.id,l=!1,[h,f]=[!1,!1];const g=v(!0),d=v(!1),[A,p,y]=u(),[I,m,E]=u(),w=[!1,!1],[b,C]=u(),B=new Set;return[g,d];function v(t){const r={get name(){return`${c||"|"} ${t?"--\x3e":"<--"} `},get id(){return c},set id(t){if(c)throw new Error("ID has already been set");c=t},get onmessage(){return w[t?0:1]=!0,t?A:I},get opened(){return l?Promise.reject(new Error("Disconnected")):(w[t?1:0]=!0,(t?I:A).then((t=>!!t)))},get closed(){return b},set onmessage(e){if("function"!=typeof e)throw new Error("expected onmessage to be a function");if(t?h:f)throw new Error("Handler has already been set");t?(p(e),h=!0):(m(e),f=!0)},async postMessage(e,n){if(l)throw new Error("Disconnected");if(!r.isActive)throw new Error("Void");w[t?1:0]=!0;const o=await(t?I:A);return _(t,(t=>o(t)),e,n)},get isActive(){return(t?f:h)&&!l},get isClosed(){return l},open:t=>i(t)?s(r,t):(r.onmessage=t,r.opened.then((()=>[r.postMessage,r]))),close(n=null){!function(t,n=null){if(l)return!0;e("PipeClosed by: %s cause: %s pending: %d",t?"A":"B",n?.message,B.size),l=!0;for(const t of Array.from(B))B.delete(t),t.abort(n||new Error("Disconnected"));C(n),w[0]&&y(n||new Error("Disconnected"));w[1]&&E(n||new Error("Disconnected"))}(t,n)},get other(){return t?d:g}};return r[n]=!0,r}async function _(e,n,o,i){if(l)throw new Error("Disconnected");if("function"==typeof i)throw new Error("Callback API has been deprecated");const s=1&i||i,c=t.exports.V&&`${(e?g:d).name} = ${o.toString(r.Buffer.isBuffer(o)&&"hex").slice(0,14)}`,[h,f,A]=function(t,e=!1){const[n,r,o]=u(e),i=setTimeout(o.bind(null,new Error("Timeout")),t);return[n,(t,e)=>{clearTimeout(i),r(t,e)},function(t){clearTimeout(i),o(t||new Error("Aborted"))}]}(a,c);f.abort=A,s&&B.add(f),B.delete(n);const p=s?_.bind(null,!e,f):null;try{n([o,p,e?d:g]),s||f([])}catch(t){A(t),console.warn("Trap A: ",t.message)}return h.catch((t=>{throw console.warn("Trap B: ",t.message),t}))}}function i(t){return!(!t||!t[n])}function s(t,e){if(!i(t)||!i(e))throw new Error("Expected two pipe-ends");function n(t,e){if(!Array.isArray(e))throw new Error("DesignFlaw");const[r,o]=e;let i=t(r,!!o);return o&&(i=i.then(n.bind(null,o))),i.catch((t=>{console.warn("Trap S: ",t.message)}))}return t.onmessage=t=>n(e.postMessage,t),e.onmessage=e=>n(t.postMessage,e),t.closed.then(e.close).catch(e.close),e.closed.then(t.close).catch(t.close),t.close}let a=0;const c=[];function u(e=!1){if(e)return function(e="_"){const n=a++;let r=null;try{throw new Error}catch(t){r=t.stack}console.debug("[UNP]",n,e,"Promise Created\n",t.exports.V>1&&r);const[o,i,s]=u();return c[n]=s,[o.then((t=>(l("resolved",t),t))).catch((t=>{throw l("rejected",void 0,t),t})),t=>{l("set",t),i(t)},t=>{l("abort",void 0,t),s(t)}];function l(r,o,i){c[n]=void 0;const s=c.map(((t,e)=>t&&e)).filter((t=>t));if("set"!==r)console.debug("[UNP]",n,e,r,`P(${s.join(",")})`,i?i.message:Array.isArray(o)?`Arr[${o.length}]: ${o[0]||""}`:o);else{let r=null;try{throw new Error}catch(t){r=t.stack}t.exports.V>1&&console.debug("[UNP]",n,e,"SET at: \n",r)}}}(e);let n,r;return[new Promise(((t,e)=>{n=t,r=e})),n,r]}const l=3e4;function h(t,e){const n=(t,n,o,i)=>t(e.encode(n),o&&r.bind(null,o,i)),r=(t,r,o,i)=>t(e.decode(r),o&&n.bind(null,o,i));return e=>{const o=t(r.bind(null,e));return n.bind(null,o)}}t.exports=class{constructor(t,e){this._nodes=new Set,this._tap=null,"function"==typeof t&&(this._tap=t),"function"==typeof e&&(this._afterRemove=e)}createWire(t,e={}){const[n,r]=o(e);n.onmessage=([t,e])=>{if(!this._tap)return this.broadcast(t,e,n).catch((t=>console.error("_broadcast failed:",t)));this._tap(n,t,e).catch((t=>console.error("_tap failed:",t)))};const i=setTimeout((()=>n.close(new Error("NodeTimedout"))),3e4);return n.opened.then((e=>{if(!e)return console.warn("wire.opened resolved false?",e);clearTimeout(i),this._nodes.add(n),"function"==typeof t&&t(n)})).catch((t=>this.disconnect(n,t))),n.closed.then((t=>this.disconnect(n,t))),r}disconnect(t,e){if(!t)return!1;if(this._nodes.delete(t))return"function"==typeof this._afterRemove?this._afterRemove(t,e):e&&console.warn("NodeDisconnected",e),!0;for(const t of this._nodes)if(t.id===t&&this._nodes.delete(t))return"function"==typeof this._afterRemove?this._afterRemove(t,e):e&&console.warn("NodeDisconnected",e),!0}get count(){return this._nodes.size}async*survey(t,e,n){let r=!1;const o=new Set;for(const r of this._filterNodes(n)){const n=r.postMessage(t,e);o.add(n),n.catch((t=>{o.delete(n),console.warn("Survey node ignored:",t)}))}for(;!r&&o.size;){const t=await Promise.race(Array.from(o).map((t=>t.then((e=>({val:e,p:t}))))));if(!t)continue;o.delete(t.p);const e=()=>{r=!0};yield[...t.val,e]}}async broadcast(t,e,n){const r=this.survey(t,e,n),o=[];let i=await r.next();for(;!i.done;)o.push(i.value),i=await r.next();return o}_filterNodes(t){return t?(Array.isArray(t)||(t=[t]),Array.from(this._nodes).filter((e=>e.isActive&&!t.find((t=>i(t)?t===e:t===e.id))))):this._nodes}},t.exports.V=0,t.exports.picoWire=o,t.exports.simpleWire=function(t,e,n){const[r,i]=o();return r.closed.then(n).catch(n),r.opened.then(e).catch(e),r.onmessage=t,i},t.exports.streamWire=function(t,e){const n=new Map;let o=1,i=r.Buffer.alloc(256);const s=t(h.bind(null,0));e.on("data",u),e.once("close",c),e.once("error",c);const a=t=>t?e.end():e.destroy(t);return a;function c(t){e.off("data",u),e.off("error",c),e.off("close",c),s.close(t)}function u(t){const e=t.readUInt16BE(0),r=t.readUInt16BE(2);if(n.has(e)){const{replyTo:o,timer:i}=n.get(e);n.delete(e),clearTimeout(i),o(t.slice(6),((t,e)=>h(r,t,e)))}else 0===e?s(t.slice(6),((t,e)=>h(r,t,e))):console.warn("WARN: streamWire Message dropped",t[6])}function h(t,s,c){let u=0;"function"==typeof c&&(u=o++,function(t,e){const r=setTimeout((()=>{n.has(t)&&(n.delete(t),a(new Error("ResponseTimeout")))}),l);n.set(t,{replyTo:e,timer:r})}(u,c));const h=s.length+6;if(h>i.length){if(h>=262144)throw new Error("Message exceeds MTU");i=r.Buffer.alloc(h)}i.writeUInt16BE(t),i.writeUInt16BE(u,2),i.writeUInt16BE(h,4),s.copy(i,6),e.write(i.slice(0,h))}},t.exports.hyperWire=function(t,e,n,o=125){if(!i(t))throw new Error("Wire end expected");const s=new Map;let a=1;const c=e.open(n,{onextension:function(e,n){if(e!==o)return console.warn("Message dropped! multiple extensions on this channel??",o,e);const r=n.readUInt16BE(0),i=n.readUInt16BE(2),a=n[4],c=!!(1&a);if(s.has(r)){const{replyTo:t,timer:e}=s.get(r);s.delete(r),clearTimeout(e),t(n.slice(5),a).then(c&&h.bind(null,i)).catch((t=>console.error("Hyperwire writeerror",t)))}else 0===r?t.postMessage(n.slice(5),a).then(c&&h.bind(null,i)).catch((t=>console.error("Hyperwire writeerror",t))):console.warn("Hyperwire message dropped! unknown port",r,i)},onclose:t.close}),u=()=>{c.close()};return t.onmessage=t=>h(0,t),t.closed.then((()=>!c.closed&&u())).catch((t=>e.delete(t))),u;function h(t,e){const[n,i]=e;if(!r.Buffer.isBuffer(n))throw new Error("Binary message expected");let h=0,f=0;"function"==typeof i&&(h=a++,function(t,e){const n=setTimeout((()=>{s.has(t)&&(s.delete(t),u())}),l);s.set(t,{replyTo:e,timer:n})}(h,i),f|=1);const g=r.Buffer.alloc(n.length+5);g.writeUInt16BE(t),g.writeUInt16BE(h,2),g[4]=f,n.copy(g,5),c.extension(o,g)}},t.exports.spliceWires=s,t.exports.jsonTransformer=function(t){return h(t,{encode:t=>r.Buffer.from(JSON.stringify(t)),decode:t=>JSON.parse(t)})},t.exports.encodingTransformer=h,t.exports.messageIterator=async function*(t){const e=[],n=[];let r=!1;e.push(new Promise((t=>n.push(t))));const o=t(((t,i)=>{e.push(new Promise((t=>n.push(t)))),n.shift()([t,i,function(){o.close(),r=!0}])}));for(;!r;)yield await e.shift()},t.exports.unpromise=u}(lh);const Qh=lh.exports,Mh=hu,{pack:Dh,unpack:Th}=Wl,{write:Lh}=n.exports;var $h=class{constructor(t){this.nodeId=(t=>r.Buffer.from(Array.from(new Array(t)).map((t=>Math.floor(256*Math.random())))))(8),this._controller=this._controller.bind(this),this.hub=new Qh(((...t)=>this._controller(...t)),((...t)=>this._ondisconnect(...t))),this.handlers=t;const[e,n]=Lh([]);this._setConnections=n,this.$connections=e}spawnWire(){return this.hub.createWire((t=>{t.postMessage(Uh(3,this.nodeId),!0).then((([e,n])=>{if(0===Fh(e).type)return this._setConnections(Array.from(this.hub._nodes)),this.handlers.onconnect(t)})).catch((t=>console.error("Handshake failed",t)))}))}_ondisconnect(...t){this._setConnections(Array.from(this.hub._nodes)),this.handlers.ondisconnect(...t)}async _controller(t,e,n){try{const{type:o,data:i}=Fh(e);switch(o){case 2:for await(const r of this._downloadFeeds(e,n)){const e=await this.handlers.onblocks(r);e&&this.shareBlocks(e,t).catch((t=>console.error("Gossip failed",t)))}break;case 1:{const t=await this.handlers.onquery(i);this._uploadFeeds(n,t).catch((t=>console.error("Failed uploading blocks",t)))}break;case 3:for(const e of this.hub._nodes)if(r.Buffer.isBuffer(e.id)&&e.id.equals(i))return n(Uh(-1)),t.close(new Error("DuplicatePeer"));t.id=i,await n(Uh(0));break;default:throw new Error(`Unknown message type: ${o}`)}}catch(t){console.error("RPC:internal error",t)}}async shareBlocks(t,e){Mh.isFeed(t)&&(t=[t]);const n=(t=[...t]).shift(),r=this.hub.survey(Uh(2,n),!!t.length,e);for await(const[e,n]of r)t.length&&(0===Oh(e)&&n?this._uploadFeeds(n,t).catch((t=>console.error("Failed sending subsequent feeds",t))):console.warn("Remote rejected subsequent blocks",Oh(e)))}async query(t,e={}){const[n,r]=await t.postMessage(Uh(1,e),!0);0!==Fh(n).type&&this._controller(t,n,r)}_uploadFeeds(t,e){if(!e||!e.length)return t(Uh(0));const n=[...e];return t(Uh(2,n.shift()),!!n.length).then((([t,e])=>{if(n.length)return t?0!==Oh(t)?console.warn("Peer rejected subsequent blocks",Oh(t)):this._uploadFeeds(e,n):console.warn("Empty scope")}))}async*_downloadFeeds(t,e){let n=!1;for(;!n;){n=!0;const{type:r,data:o}=Fh(t);if(2===r)yield o;else if(e){console.warn("Expected BLOCKS but got",r),await e(Uh(-1),!1);continue}if(!e)continue;const i=await e(Uh(0),!0);t=i[0],e=i[1],n=!1}}};function Uh(t,e){let n=null;switch(t){case 2:if(!e)throw new Error("Feed expected");e=Mh.from(e),n=r.Buffer.alloc(e.tail+1),e.buf.copy(n,1,0,e.tail);break;case-1:case 0:n=r.Buffer.alloc(1);break;case 1:{const t=Dh(e);n=r.Buffer.alloc(t.length+1),t.copy(n,1)}break;case 3:n=r.Buffer.alloc(9),e.copy(n,1);break;default:throw new Error("UnknownMessageType: "+t)}return n[0]=t,n}function Oh(t){if(!r.Buffer.isBuffer(t))throw new Error("BufferExpected");return t[0]}function Fh(t){if(!r.Buffer.isBuffer(t))throw new Error("BufferExpected");const e=Oh(t);let n=null;switch(e){case 2:n=new Mh,n.buf=t.slice(1),n.tail=t.length-1;break;case 0:n="OK";break;case-1:n="ERROR";break;case 1:n=Th(t.slice(1));break;case 3:n=t.slice(1,9);break;default:throw new Error("UnknownMessageType: "+e)}return{type:e,data:n}}const Nh=Eu,Ph=oh,Yh=hu,{pack:Kh,unpack:Rh}=Wl,jh=$h,Hh="reg/sk";class Vh{constructor(t,e={}){this.db=t,this.repo=new Nh(t),this.store=new Ph(this.repo,this.mergeStrategy.bind(this)),this.ready=!1,this._secret=e.secret??null,this.rpc=new jh({onconnect:t=>this.onconnect(t),ondisconnect:t=>this.ondisconnect(t),onquery:(t,e)=>this.onquery(t,e),onblocks:t=>this.onblocks(t)})}get pk(){return this._secret?.slice(32)}async boot(){return this.__loading||(this.__loading=(async()=>{if(!this._secret)try{this._secret=await this.repo.readReg(Hh)}catch(t){if(!t.notFound)throw t}if(!this._secret){const{sk:t}=Yh.signPair();this._secret=t,await this.repo.writeReg(Hh,t)}await this.store.load(),this.ready=!0})()),this.__loading}mergeStrategy(t,e){return!1}async feed(t){return this._checkReady(),this.repo.loadHead(this.pk)}_checkReady(){if(!this.ready)throw new Error("Kernel not ready, did you await kernel.boot()?")}async seq(){const t=await this.feed(1);return t?Vh.decodeBlock(t.last.body).seq:-1}async dispatch(t,e=!1){return this._checkReady(),await this.store.dispatch(t,e)}async createBlock(t,e,n){if("string"==typeof t)return this.createBlock(null,t,e);this._checkReady(),t=t||await this.feed()||new Yh;const r=await this.seq()+1,o=Vh.encodeBlock(e,r,n);t.append(o,this._secret);if(!(await this.dispatch(t,!0)).length)throw new Error("createBlock() failed: rejected by store");return this.rpc.shareBlocks(t.slice(-1)),t}spawnWire(){return this.rpc.spawnWire()}ondisconnect(t){}async onconnect(t){await this.rpc.query(t)}async onquery(t){const e=[],n=await this.repo.listHeads();for(const{key:t}of n){const n=await this.repo.loadHead(t);n&&e.push(n)}return e}async onblocks(t){return(await this.dispatch(t,!1)).patch}async _networkResolveFeed(t,e){}$connections(){return this.rpc.$connections}async close(){for(const t of this.rpc.hub._nodes)this.rpc.hub.disconnect(t);await this.db.close()}static encodeBlock(t,e,n){return Kh({...n,type:t,seq:e,date:(new Date).getTime()})}static decodeBlock(t){return Rh(t)}static typeOfBlock(t){return Vh.decodeBlock(t).type}}const Gh=hu,qh=oh,zh=lh.exports,Jh=Vh,Wh=$h,Xh=Eu,{decodeBlock:Zh,encodeBlock:tf}=Jh;var ef={Feed:Gh,SimpleKernel:Jh,decodeBlock:Zh,encodeBlock:tf,n:n.exports,Store:qh,Hub:zh,SimpleRPC:Wh,Repo:Xh},nf={exports:{}};const{crypto_box_seal:rf,crypto_box_seal_open:of,crypto_box_keypair:sf,crypto_box_SEALBYTES:af,crypto_box_PUBLICKEYBYTES:cf,crypto_box_SECRETKEYBYTES:uf}=or.exports,lf=ur,hf=_h.exports,{SimpleKernel:ff}=ef,gf=r.Buffer.from(""),df=r.Buffer.from(""),{encodeBlock:Af,decodeBlock:pf,typeOfBlock:yf}=ff;hf.formatters.h=t=>r.Buffer.isBuffer(t)&&t?.length?t.slice(0,Math.min(8,t.length)).toString("hex"):t,hf.formatters.H=t=>r.Buffer.isBuffer(t)&&t?.length?t.toString("hex"):t;var If={KEY_SK:"reg/sk",KEY_BOX_LIKES_PK:"reg/likes_pk",KEY_BOX_LIKES_SK:"reg/likes_sk",TYPE_PROFILE:"profile",TYPE_VIBE:"vibe",TYPE_VIBE_RESP:"vibe-response",TYPE_MESSAGE:"message",TYPE_BYE:"bye",TYPE_BYE_RESP:"byebye",TYPE_ITEMS:"items",EV_CHAT_END:60,EV_BALANCE_DEBIT:71,EV_BALANCE_CREDIT:70,EV_ADD_SCORE:72,VIBE_REJECTED:gf,PASS_TURN:df,PEACE:0,LOVE:2,UNDERSTANDING:1,G_M:0,G_F:1,G_NB:2,G_R:3,GEO_BITS:17,encodeBlock:Af,decodeBlock:pf,typeOfBlock:yf,fixJsonBuffers:function t(e){if("object"==typeof e&&"Buffer"===e.type)return r.Buffer.from(e.data);if(Array.isArray(e))return e.map(t);if("object"==typeof e)for(const n in e)e[n]=t(e[n]);return e},toBuffer:function(t){return t?r.Buffer.isBuffer(t)?t:"string"==typeof t&&/^[0-9A-f]+$/.test(t)?r.Buffer.from(t,"hex"):"string"==typeof t?r.Buffer.from(t):"object"==typeof t&&"Buffer"===t.type?r.Buffer.from(t.data):t:t},boxPair:function(){const t=r.Buffer.allocUnsafe(cf),e=r.Buffer.allocUnsafe(uf);return sf(t,e),{pk:t,sk:e}},seal:function(t,e){const n=r.Buffer.allocUnsafe(af+t.length);return rf(n,t,e),n},unseal:function(t,e,n){const o=r.Buffer.allocUnsafe(t.length-af),i=of(o,t,n,e);return lf(i,"DecryptionFailedError"),o},bufferReplacer:function(t,e){return e&&"object"==typeof e&&"Buffer"===e.type?r.Buffer.from(e.data):e},btok:function(t){return lf(r.Buffer.isBuffer(t),"Expected Buffer"),t.toString("hex")},ktob:function(t){return lf("string"==typeof t,"Expected string"),r.Buffer.from(t,"hex")}};const{typeOfBlock:mf,TYPE_PROFILE:Ef,TYPE_VIBE:wf,TYPE_VIBE_RESP:bf,TYPE_MESSAGE:Cf,TYPE_BYE:Bf,TYPE_BYE_RESP:vf,VIBE_REJECTED:_f,PASS_TURN:kf,PEACE:xf,LOVE:Sf,UNDERSTANDING:Qf,decodeBlock:Mf}=If;function Df(t,e=!0){switch(mf(t.body)){case Ef:return"";case wf:return"";case bf:return _f.equals(Mf(t.body).box)?"":"";case Cf:return kf.equals(Mf(t.body).content)?e?"":"":e?"":"";case Bf:case vf:return e?"":""}}function Tf(t){const e=[[//,""],[/(|)/,""],[/([])/,"$1"],[/([])/,"$1"],[//,""],[//,""],[//,""],[//,""],[//,""],[/(|)/,""],[//,""],[//,""],[//,""],[//,""],[//,""],[//,""],[//,""],[//,""]];let n=null;for(;n!==t;){n=t;for(const[n,r]of e)t=t.replace(n,r)}return t}var Lf={feedToGraph:function(t){let e="",n=t.first.isGenesis?t.first.key:null;for(const r of t.blocks()){mf(r.body)!==wf||n||(n=r.key);const t=n&&r.key.equals(n);e+=Df(r,t)}return e},scoreGraph:function(t){if(t=Tf(t),//.test(t))return[0,0];const e={"":[0,0],"":[1,0],"":[0,1],"":[5,3],"":[2,4],"":[2,1],"":[0,2],"":[4,3],"":[2,4],"":[-1,2],"":[-1,3],"":[2,4],"":[2,5],"":[1,3],"":[-1,0]};let n=0,r=0;for(const o of t.split(""))e[o]?(n+=e[o][0],r+=e[o][1]):console.warn("Unscored glyph: ",o);return[n,r]},blockToGlyph:Df,rewrite:Tf},$f=Object.freeze({profile_timeout:108e5,vibe_timeout:3e5,vibe_response_timeout:18e4,chat_timeout:18e5,now:Date.now});const{TYPE_PROFILE:Uf,EV_CHAT_END:Of,EV_BALANCE_CREDIT:Ff,EV_BALANCE_DEBIT:Nf,EV_ADD_SCORE:Pf,decodeBlock:Yf,btok:Kf}=If,Rf=ur,{scoreGraph:jf}=Lf,Hf="active",Vf="pending",Gf="locked",qf="expired",{profile_timeout:zf}=$f;function Jf(t){return{name:null,picture:null,pk:t,tagline:null,date:null,sex:2,sig:null,expiresAt:0,state:Hf,balance:0,score:0}}function Wf(t){if(!t.picture)return"Profile Picture missing";if(r.Buffer.isBuffer(t.picture)){if(t.picture.length>21e3)return"Picture should be less than 21kB"}else if("string"!=typeof t.picture||t.picture.length>10)return"Picture should be an emoji";return Xf(t.tagline)?"URL in tagline not permitted":Xf(t.name)?"Links in name is not permitted":t.name.match(/^\s/)?"Name must contain only letters or numbers":"number"!=typeof t.age?"Age must be a number":t.age<18?"Kids not allowed into bars":!~[0,1,2].indexOf(t.sex)&&"Sex should be 0: female, 1: male, 2: other"}function Xf(t){return"string"==typeof t&&!!t.match("://")}nf.exports=()=>({name:"peers",initialValue:{},filter:({block:t,state:e})=>{const n=Yf(t.body);return n.type!==Uf||Wf(n)},reducer:({block:t,state:e,schedule:n})=>{const r=t.key.toString("hex");return e[r]=e[r]||Jf(r),Object.assign(e[r],Yf(t.body,1)),e[r].pk=t.key,e[r].sig=t.sig,e[r].expiresAt=e[r].date+zf,n("peer",t.key,e[r].expiresAt),e},trap({code:t,payload:e,root:n,state:o}){switch(t){case Of:{const t=Kf(e),i=n.chats.chats[t],s=jf(i.graph);o[Kf(i.a)].score+=s[0],o[Kf(i.b)].score+=s[1],o[Kf(i.a)].balance+=s[0],o[Kf(i.b)].balance+=s[1];const a=n.trs[t];if(!a?.length)return;for(const t of a)switch(t.type){case"debit":Rf(r.Buffer.isBuffer(t.target),"InvalidPeerId"),Rf(Number.isFinite(t.amount),"InvalidAmount"),o[Kf(t.target)].balance-=t.amount;break;case"credit":Rf(r.Buffer.isBuffer(t.target),"InvalidPeerId"),Rf(Number.isFinite(t.amount),"InvalidAmount"),o[Kf(t.target)].balance+=t.amount}}break;case Ff:{const{target:t,amount:n}=e;o[Kf(t)].balance+=n}break;case Nf:{const{target:t,amount:n}=e;o[Kf(t)].balance-=n}break;case Pf:{const{target:t,amount:n}=e;o[Kf(t)].score+=n}break;default:return}return o}}),nf.exports.ProfileCtrl=function(t){let e=null;return{name:"peer",initialValue:Jf(),filter({block:n}){if(e=e||t(),!e)return"Cannot process block without knowing own identity";if(!n.key.equals(e))return!0;const r=Yf(n.body);return r.type!==Uf||Wf(r)},reducer:({block:t,state:n,root:r})=>({...r.peers[Kf(e)]}),trap({code:t,payload:n,root:r,state:o}){const i=r.peers[Kf(e)];let s=!1;switch(t){case Of:{const t=Kf(n),o=r.chats.chats[t];s=e.equals(o.a)||e.equals(o.b)}break;case Ff:case Nf:case Pf:s=e.equals(n.target)}if(s)return{...i}}}},nf.exports.stateOfPeer=function(t,e,n){if(t.state===qf)return qf;if(t.state!==Hf)throw new Error(`InvalidState: ${t.state}`);const r=t.pk.toString("hex"),o=e.seen[r]?.toString("hex");if(!o)return Hf;const i=e.matches[o];if(!i)throw new Error("MentalError");if("rejected"===i.state)return Hf;if("match"!==i.state)return Vf;const s=n.chats[o];return s&&"end"===s.state?Hf:Gf},nf.exports.ACTIVE=Hf,nf.exports.PENDING=Vf,nf.exports.LOCKED=Gf,nf.exports.EXPIRED=qf;const{TYPE_VIBE:Zf,TYPE_VIBE_RESP:tg,TYPE_PROFILE:eg,TYPE_BYE_RESP:ng,TYPE_ITEMS:rg,EV_CHAT_END:og,VIBE_REJECTED:ig,decodeBlock:sg,unseal:ag}=If,cg=_h.exports("picochat:slices:vibes"),{vibe_timeout:ug,vibe_response_timeout:lg}=$f;const hg=()=>({chatId:null,response:null,updatedAt:0,a:null,b:null,remoteBox:null});var fg=class{constructor(t=ug){this._sk=null,this._pk=null,this._reduceHasRun=!1,this.ttl=t,this.reducer=this.reducer.bind(this)}setKeys(t,{sk:e,pk:n}){if(this._sk)throw new Error("VibeBox secret has already been set");if(this._reduceHasRun)throw new Error("Reducer has already run without box secret");this._sk=e,this._pk=n,this._peerId=t}get name(){return"vibes"}get initialValue(){return{seen:{},matches:{},own:[]}}filter({block:t,parentBlock:e,state:n}){const r=sg(t.body),{type:o}=r;if(o!==Zf&&o!==tg)return!0;const i=e&&sg(e.body).type;if(o===Zf){if(i!==eg&&i!==ng&&i!==rg)return`InvalidParent: ${i}`;const e=t.key.toString("hex");if(r.date>(new Date).getTime())return"Vibe from the future";const o=n.seen[e];if(o){if(n.matches[o.toString("hex")].expiresAt>=Date.now())return"Only 1 active vibe allowed"}}return o===tg&&i!==Zf?`InvalidParent: ${i}`:(cg("Accepting Vibe %h",t.sig),!1)}reducer({block:t,state:e,parentBlock:n,root:r,schedule:o}){const i=sg(t.body,1),{type:s}=i,a=s===Zf?t.sig:t.parentSig,c=a.toString("hex"),u=ig.equals(i.box);if(s===Zf){if(cg("%s reducing vibe: %o %h",r.peer.name,!!e.matches[c],t.sig),e.matches[c])throw new Error("InternalError: Vibe already registered");e.seen[t.key.toString("hex")]=a;const n=e.matches[c]=hg();n.chatId=a,n.a=t.key,n.updatedAt=i.date,n.createdAt=i.date,n.expiresAt=i.date+ug,n.state="wait"}else{const n=e.matches[c];if(!n)throw new Error("InternalError: MatchNotFound");n.response=t.sig,n.b=t.key,n.updatedAt=i.date,n.expiresAt=n.createdAt+lg,n.state=u?"rejected":"match"}const l=r.peer.pk,h=e.matches[c];s===Zf&&l.equals(t.key)&&e.own.push(a);let f=null;if(!u&&!l.equals(t.key)&&this._sk)try{f=ag(i.box,this._sk,this._pk)}catch(t){if("DecryptionFailedError"!==t.message)throw t}return f&&(e.own.find((t=>t.equals(a)))||e.own.push(a),h.remoteBox=f),this._reduceHasRun=!0,o("chat",h.chatId,h.expiresAt),e}trap({code:t,payload:e,root:n,state:r}){if(t===og){{const t=e.toString("hex"),o=n.chats.chats[t];delete r.seen[o.a.toString("hex")],cg("%s Peer Unseen %h => %h",n.peer.name,o.a.toString("hex"),e)}return r}}};const gg=_h.exports("picochat:slice:chat"),{TYPE_VIBE_RESP:dg,TYPE_MESSAGE:Ag,TYPE_BYE:pg,TYPE_BYE_RESP:yg,EV_CHAT_END:Ig,PASS_TURN:mg,decodeBlock:Eg}=If,{blockToGlyph:wg}=Lf;var bg=function(t={}){const{ttl:e,blockReward:n,health:r,regenerate:o}={ttl:18e4,blockReward:6e4,health:3,regenerate:.3,...t},i=()=>(new Date).getTime();return{name:"chats",initialValue:{chats:{},heads:{},own:[],stats:{}},filter({block:t,parentBlock:e,state:n,root:r}){const o=Eg(t.body),{type:s}=o;if(!~[Ag,pg,yg].indexOf(s))return!0;const a=e&&Eg(e.body).type;if(gg("[%s] FilterOP: %s %h <-- %s %h",r.peer.name,a,e.sig,s,t.sig),s===Ag&&a!==Ag&&a!==dg||s===pg&&a!==Ag||s===yg&&a!==pg)return`Invalid parent type: ${a}`;const c=t.key;if(c.equals(e.key))return"MonologueNotAllowed";if(a===dg){const t=e.parentSig,n=r.vibes.matches[t.toString("hex")];if(!n)return!0;if("match"!==n.state)return"MessagingNotAllowed";if(![n.a,n.b].find((t=>c.equals(t))))return"NotYourConversation";if(n.expiresAt<i())return"ConversationTimeout"}else{const e=n.heads[t.parentSig.toString("hex")];if(!e)return"ConversationNotFound";const r=n.chats[e.toString("hex")],o=r.mLength%2?r.b:r.a;if(!c.equals(o))return"NotYourConversation";if(r.expiresAt<i())return"ConversationTimeout";if(s!==yg&&"active"!==r.state)return"ConversationEnded";if(s===yg&&"finalizing"!==r.state)return"InvalidState"}return!1},reducer({block:t,parentBlock:i,root:s,state:a,schedule:c,signal:u}){const l=Eg(t.body),{type:h}=l,f=Eg(i.body).type,g=s.peer.pk,d=t.key;let A=null;A=f===dg?i.parentSig:a.heads[t.parentSig.toString("hex")];const p=A.toString("hex");if(f===dg){const t=s.vibes.matches[p],e=(t=>({id:t,head:null,messages:[],expiresAt:0,updatedAt:0,state:"active",a:null,b:null,hp:r,aEnd:-1,bEnd:-1,graph:""}))(A);e.a=t.a,e.b=t.b,e.remoteBox=t.remoteBox,e.createdAt=t.createdAt,e.mLength=0,a.chats[p]=e}const y=a.chats[p];y.updatedAt=l.date,y.mLength++,y.expiresAt=y.createdAt+e+y.mLength*n,y.graph+=wg(t,t.key.equals(y.a));const I=t.key.toString("hex");let m=a.stats[I];if(m||(m=a.stats[I]=(t=>({peerId:t,lastSeen:0,nMessages:0,nExhausted:0,nPassed:0,nEnded:0,nStarted:0,blocks:0,blockSize:0,hpRegenerated:0}))(t.key),m.nStarted++,gg("[%s] Initating new stats for %h",s.peer.name,t.key)),m.lastSeen=Math.max(m.lastSeen,l.date),m.nMessages++,m.blocks++,m.blockSize+=t.body.length,Ag===h){const e=mg.equals(l.content);if(e&&m.nPassed++,e&&--y.hp<1?(y.state="exhausted",m.nExhausted++):e||(y.hp=Math.min(o+y.hp,r),m.hpRegenerated+=o),y.own=!![y.a,y.b].find((t=>g.equals(t))),y.own){const n=g.equals(d);y.messages.push({type:n?"sent":"received",date:l.date,content:n?null:l.content,pass:e,sig:t.sig})}y.own&&!a.own.find((t=>t.equals(A)))&&a.own.push(A)}else y.state=pg===h?"finalizing":"end",y.a.equals(d)?y.aEnd=l.gesture:y.bEnd=l.gesture,gg("ENDING: ",s.peer.name,h,y.state,y.aEnd,y.bEnd);if("end"===y.state){const t=a.stats[y.b.toString("hex")],e=a.stats[y.a.toString("hex")];t.nEnded++,e.nEnded++,u(Ig,A)}return gg("[%s] Conversation(%h) state: %s mLength: %d, head: %h => %h",s.peer.name,A,y.state,y.mLength,t.parentSig,t.sig),delete a.heads[t.parentSig.toString("hex")],a.heads[t.sig.toString("hex")]=A,y.head=t.sig,c("chat",y.id,y.expiresAt),a}}};const Cg=ur;var Bg=class t{static ACTION_CONJURE_WATER=0;static ACTION_OFFER=1;static validate(e){if(!e)throw new Error("Must be an object");const{t:n,p:r}=e;let o;switch(n){case t.ACTION_CONJURE_WATER:Cg(null==r,"PayloadNotSupported");break;case t.ACTION_OFFER:{const{i:t,q:e}=r;Cg(function(t){return Number.isInteger(t)&&t>=0}(t),"p.i: ItemId missing"),Cg(function(t){return Number.isInteger(t)}(e),"p.q: Quantity missing"),o={i:t,q:e}}break;default:Cg(!1,`UnknownTransaction: ${n}`)}return{t:n,p:o}}};const{btok:vg,decodeBlock:_g,EV_CHAT_END:kg,EV_BALANCE_CREDIT:xg,EV_BALANCE_DEBIT:Sg,EV_ADD_SCORE:Qg,TYPE_VIBE_RESP:Mg,TYPE_ITEMS:Dg,VIBE_REJECTED:Tg}=If,Lg=ur,{ACTIVE:$g,stateOfPeer:Ug}=nf.exports,Og=Bg,Fg=r.Buffer.from("jWR6XgHjIeNA8xDtVtjOxdsUhgKzABQ75HHi30ab8X0=","base64");function Ng(t,e){return t[e]=t[e]||{},t[e]}function Pg(t,e){return t[e]=t[e]||{id:e,qty:0,activatedAt:-1,expiresAt:-1},t[e]}function Yg(t,e,n){if(53249===e)n(xg,{target:t,amount:60}),n(Qg,{target:t,amount:60})}var Kg={InventorySlice:function(){return{name:"inv",initialValue:{},filter({block:t,root:e,state:n,HEAD:r}){const o=_g(t.body);if(o.type!==Dg)return!0;const i=vg(r),s=e.peers[i],a=Ug(s,e.vibes,e.chats);return o.items.find((t=>t.id<53760))&&!t.key.equals(Fg)?"StampNotTrusted":a!==$g?"PeerBusy":Date.now()-o.date>=36e5&&"DeliveryTimeout"},reducer({block:t,state:e,schedule:n,signal:r,HEAD:o}){const i=vg(o),s=_g(t.body),a=Ng(e,i);for(const t of s.items){const e=Pg(a,t.id);e.qty++,e.expiresAt=t.expiresAt,Yg(o,t.id,r)}return e},trap({code:t,payload:e,root:n,state:r}){if(t!==kg)return;const o=vg(e),i=n.trs[o];if(i?.length){for(const t of i){if("item"!==t.type)continue;Pg(Ng(r,vg(t.target)),t.item).qty+=t.qty}return r}}}},TransactionsSlice:function(){return{name:"trs",initialValue:{},filter({block:t,parentBlock:e,root:n,state:r}){const{type:o,box:i}=_g(t.body);if(o!==Mg)return!0;if(Tg.equals(i))return!0;const{t:s}=_g(e.body);try{for(const t of s){const{t:r,p:o}=Og.validate(t);if(r===Og.ACTION_OFFER){const t=vg(e.key),r=n.inv[t];Lg(r,"InventoryEmpty");const i=r[o.i];Lg(i,"ItemNotHeld"),Lg(i.qty-o.q>=0,"NegativeQuantity")}}}catch(t){return t.message}return!1},reducer({block:t,parentBlock:e,root:n,state:r}){const o=vg(e.sig),{t:i}=_g(e.body),s=r[o]=[];for(const{t:n,p:r}of i)switch(n){case Og.ACTION_CONJURE_WATER:s.push({type:"item",item:55040,qty:1,target:e.key}),s.push({type:"credit",target:e.key,amount:60}),s.push({type:"debit",target:t.key,amount:5});break;case Og.ACTION_OFFER:s.push({type:"item",item:r.i,qty:r.q,target:t.key}),s.push({type:"item",item:r.i,qty:-r.q,target:e.key})}return r},trap({code:t,payload:e,root:n,state:r}){if(t!==kg)return;return delete r[vg(e)],r}}}};const Rg=_h.exports("picochat:mod:chat"),{TYPE_MESSAGE:jg,TYPE_BYE:Hg,TYPE_BYE_RESP:Vg,PASS_TURN:Gg,PEACE:qg,LOVE:zg,UNDERSTANDING:Jg,seal:Wg,unseal:Xg,toBuffer:Zg}=If,{feedToGraph:td}=Lf,{combine:ed,mute:nd,init:rd,gate:od}=n.exports;const{SIGNATURE_SIZE:id}=hu,{toBuffer:sd}=If;const ad=_h.exports("picochat:mod:gc"),{EXPIRED:cd}=nf.exports;function ud(t){const e=r.Buffer.alloc(9);return e.writeBigUInt64BE(BigInt(t),1),e[0]=116,e}function ld(t){const e=t[0];return{type:t.slice(e+1).toString(),id:t.slice(1,e+1)}}var hd={exports:{}};const fd=_h.exports("picochat:mod:peers"),gd=hu,{toBuffer:dd,boxPair:Ad,btok:pd,TYPE_PROFILE:yd,KEY_SK:Id,KEY_BOX_LIKES_PK:md,KEY_BOX_LIKES_SK:Ed}=If,{mute:wd,combine:bd,init:Cd,gate:Bd,when:vd}=n.exports,{EXPIRED:_d,stateOfPeer:kd}=nf.exports,xd=Object.freeze({state:"error",errorMessage:"PeerNotFound"}),Sd=Object.freeze({state:"loading"});function Qd([t,e,n,r]){if(!t)return xd;if(null===t.date)return Sd;if("error"===t.state)return t;if(!t.pk)throw new Error("kernel.$peers invoked before kernel.load() finished?");const o=t.pk.toString("hex"),i=n.stats[o]||{nEnded:0,nStarted:0,nMessages:0,nPassed:0,nExhausted:0},s=60*t.score*1e3,a=t.expiresAt+s,c=pd(t.pk),u=Object.values(r[c]||{}),l=!(!r[c]||!r[c][53249]);return{...t,stats:i,expiresAt:a,hasBadge:l,state:a<Date.now()?_d:kd(t,e,n),inventory:u}}function Md(t){if(!t||!(r.Buffer.isBuffer(t)&&32===t.length||"string"!=typeof t&&64===t.length))throw new Error(`PublicKey expected got "${t}"`);return dd(t)}hd.exports=function(){let t=null;const e=new Promise((e=>{t=e}));return{__setHasProfile:t,hasProfile:e,async register(e,n){n=n||gd.signPair().sk,this._secret=n;const r=Ad();this._vibeBox=r,this._vibeController.setKeys(this.pk,this._vibeBox),await this.updateProfile(e),await this.repo.writeReg(Id,n),await this.repo.writeReg(md,r.pk),await this.repo.writeReg(Ed,r.sk),t(!0)},async profileOf(t){t=Md(t);const e=this.store.state.peers[t.toString("hex")];return e||(fd("Peer does not exist in registry %h",t),xd)},async updateProfile(t){return await this.createBlock(yd,{...t,box:this._vibeBox.pk})},$peer(t){return Bd(Cd(Sd,this._peer(t)))},_peer(t){try{t=Md(t)}catch(t){return Cd({...xd,errorMessage:t.message})}if(this.pk.equals(t))return this.$profile();const e=wd((t=>this.store.on("peers",t)),(e=>e[t.toString("hex")]||xd));return wd(bd(e,(t=>this.store.on("vibes",t)),(t=>this.store.on("chats",t)),(t=>this.store.on("inv",t))),Qd)},$peers(){const t=wd(this.store.on.bind(this.store,"peers"),(t=>{const e=Object.values(t);return this.pk?e.filter((t=>!this.pk.equals(t.pk))):e})),e=this.store.on.bind(this.store,"chats");return Bd(Cd([],wd(bd(t,(t=>this.store.on("vibes",t)),e,(t=>this.store.on("inv",t))),(([t,e,n,r])=>t.map((t=>Qd([t,e,n,r]))).filter((t=>t.state!==_d))))))},$profile(){const t=vd(this.boot());return Bd(Cd(Sd,wd(bd(wd((t=>this.store.on("peer",t)),(async t=>(await e,t))),(t=>this.store.on("vibes",t)),(t=>this.store.on("chats",t)),(t=>this.store.on("inv",t)),t),Qd)))}}},hd.exports.PEER_PLACEHOLDER=Sd,hd.exports.ERR_PEER_NOT_FOUND=xd;const Dd=hu,{TYPE_VIBE:Td,TYPE_VIBE_RESP:Ld,VIBE_REJECTED:$d,toBuffer:Ud,seal:Od,boxPair:Fd}=If,{mute:Nd,combine:Pd,gate:Yd,init:Kd,until:Rd}=n.exports,{PEER_PLACEHOLDER:jd}=hd.exports,Hd=Bg,Vd=_h.exports("picochat:mod:vibes");async function Gd(t){try{if(!t.peerId&&t.initiator){const e=r.Buffer.allocUnsafe(Dd.SIGNATURE_SIZE+1);t.id.copy(e,1),e[0]=84;const n=await this._readReg(e);t.peerId=n}"loading"===t.peer.state&&(t.peer=await this.profileOf(t.peerId))}catch(e){console.warn("Failed resolving vibe.peer",e),t.peer={state:"error",errorMessage:e.message}}return t}function qd(t,e,n,r){const o={...function(t){return{id:t,head:null,peer:jd,peerId:null,box:null,state:"waiting",updatedAt:0,createdAt:1/0,expiresAt:0,remoteRejected:!1,localRejected:!1,a:null,b:null,myTurn:!1,health:-1}}(t),updatedAt:e.updatedAt,createdAt:e.createdAt,expiresAt:r?.expiresAt||e.expiresAt,box:e.remoteBox,initiator:n,localRejected:n&&"rejected"===e.state,remoteRejected:!n&&"rejected"===e.state,a:e.a,b:e.b,head:e.response};return n?e.b&&(o.peerId=o.b):o.peerId=o.a,"rejected"===e.state?o.state="rejected":e.a&&e.b?o.state="match":n||e.b?n&&!e.b?o.state="waiting_remote":o.state="mental_error":o.state="waiting_local",o.myTurn="match"===o.state?r?!(r.mLength%2^(n?0:1)):n:"waiting_local"===o.state,"end"===r?.state&&(o.myTurn=!1),o.health=r?Math.floor(r.hp):3,~["waiting_remote","waiting_local"].indexOf(o.state)&&o.expiresAt<Date.now()&&(o.state="expired"),o}const{mute:zd,combine:Jd}=n.exports,{ACTIVE:Wd}=nf.exports,{btok:Xd}=If;const{SimpleKernel:Zd}=ef,tA=nf.exports,eA=fg,nA=bg,{InventorySlice:rA,TransactionsSlice:oA}=Kg,iA=function(){return{$chats(){return nd(this.$vibes(),(t=>t.filter((t=>"match"===t.state))))},$chat(t){t=Zg(t);let e=null;const n=async(e,n=!1)=>{if(!i.myTurn)throw new Error("NotYourTurn");if(!n&&"string"!=typeof e)throw new Error("Message should be a string");if(!n&&!e.length)throw new Error("EmptyMessage");const o=await this._getRemoteChatKey(t),s=await this.repo.loadFeed(i.head),a=n?Gg:Wg(r.Buffer.from(e),o);await this.createBlock(s,jg,{content:a}),n||await this._setMessageBody(s.last.sig,r.Buffer.from(e))},o={id:t,state:"loading",initiator:!1,myTurn:null,peerId:null,peer:null,mLength:0,messages:[],updatedAt:0,createdAt:0,expiresAt:0,health:-1,errorMessage:null,head:null,send:async t=>n(t),pass:async()=>{if(!i.myTurn)throw new Error("NotYourTurn");return n(0,!0)},bye:async e=>{if(!i.myTurn)throw new Error("NotYourTurn");if(!~[qg,zg,Jg].indexOf(e))throw new Error("InvalidGesture");if(!~["active","finalizing"].indexOf(i.state))throw new Error("InvalidState");const n=await this.loadChat(t);if(!n)return console.error("branch dissapeared, expected head sig:",i.head?.toString("hex"));await this.createBlock(n,"active"===i.state?Hg:Vg,{gesture:e})}};let i=o;return od(rd(o,nd(ed(this._vibe(t),(t=>this.store.on("chats",t))),(async([n,r])=>{const s=r.chats[t.toString("hex")];if(!n||"error"===n.state)return o.state="error",o.errorMessage="ChatNotFound",o;if("loading"===n.state)return o;if(o.head=n.head,"match"===n.state?o.state="active":"rejected"===n.state&&(o.state="rejected"),o.createdAt=s?s.createdAt:n.createdAt,o.updatedAt=s?s.updatedAt:n.updatedAt,o.expiresAt=s?s.expiresAt:n.expiresAt,o.peerId=n.peerId,o.peer=n.peer,o.initiator=n.initiator,o.myTurn=n.myTurn,o.health=n.health,!s)return o;if(o.head=s.head,o.graph=s.graph,o.state=s.state,"active"===o.state&&o.expiresAt<Date.now()&&(o.state="expired"),o.mLength=s.mLength,o.messages.length===s.messages.length)return o;try{e||(e=await this._getLocalChatKey(t)),o.messages=[...o.messages];for(let t=o.messages.length;t<s.messages.length;t++){const n={...s.messages[t]};n.pass?n.content=Gg.toString():"received"===n.type?n.content=Xg(n.content,e.sk,e.pk).toString():n.content=await this._getMessageBody(n.sig),o.messages[t]=n}}catch(t){console.error("Message decryption failed",t)}return i=o,o}))))},async loadChat(t){const e=(t=Zg(t)).toString("hex");let n=null;const r=this.store.state.vibes.matches[e];n=r?.response||r?.chatId,r||Rg("vibe does not exist for chatId:",e);const o=this.store.state.chats.chats[e];if(r||o||Rg("conversation not found %h",t),n=o?.head||n,!n)return;return(await this._tracePath(n)).feed},async _inspectChat(t,e=!1){const n=await this.loadChat(t);console.log(td(n)),e&&n.inspect()}}},sA=function(){const t={};return{async _writeReg(e,n){if(await this.repo.writeReg(e,n),!t[e.toString()])return;const{set:r,timerId:o}=t[e.toString()];delete t[e.toString()],clearTimeout(o),r(n)},async _readReg(e){const n=await this.repo.readReg(e);if(n)return n;if(t[e.toString()])return t[e.toString()].promise;let r=null,o=null;const i=new Promise(((n,i)=>{r=n,o=setTimeout((()=>{delete t[e.toString()],i(new Error("BufferedReadTimedOut"))}),5e3)}));if(!r)throw new Error("ConcurrencyError");return t[e.toString()]={promise:i,set:r,timerId:o},i},async _storeLocalChatKey(t,e){const n=e.sk.length+e.pk.length;if(64!==n)throw new Error(`Expected box keypair to be 32bytes each, did algorithm change?: ${n}`);if((t=sd(t)).length!==id)throw new Error("Expected chatId to be a block signature");const o=r.Buffer.allocUnsafe(e.sk.length+e.pk.length);e.sk.copy(o),e.pk.copy(o,e.sk.length);const i=r.Buffer.allocUnsafe(id+1);return t.copy(i,1),i[0]=67,await this._writeReg(i,o)},async _getLocalChatKey(t){if("string"==typeof t&&(t=r.Buffer.from(t,"hex")),(t=sd(t)).length!==id)throw new Error("Expected chatId to be a block signature");const e=r.Buffer.allocUnsafe(id+1);t.copy(e,1),e[0]=67;const n=await this._readReg(e);if(!n)throw new Error("BoxPairNotFound");return{pk:n.slice(32),sk:n.slice(0,32)}},async _getRemoteChatKey(t){const e=t.toString("hex"),n=this.store.state.vibes.matches[e];if(!n)throw new Error("ConversationNotFound");if(!n.remoteBox)throw new Error("BoxPublicKeyNotAvailable");return n.remoteBox},async _setMessageBody(t,e){if(t=sd(t),!r.Buffer.isBuffer(t)||t.length!==id)throw new Error("Expected chatId to be a block signature");const n=r.Buffer.allocUnsafe(id+1);return t.copy(n,1),n[0]=77,await this._writeReg(n,sd(e))},async _getMessageBody(t){if(t=sd(t),!r.Buffer.isBuffer(t)||t.length!==id)throw new Error("Expected chatId to be a block signature");const e=r.Buffer.allocUnsafe(id+1);t.copy(e,1),e[0]=77;const n=await this._readReg(e);if(!n)throw new Error("MessageNotFound");return n.toString()}}},aA=function(t){const e=t.repo;let n=null;function o(t,n,o){const i=ud(o);e._db.put(i,function(t,e){t=r.Buffer.from(t);const n=e.length,o=r.Buffer.alloc(1+n+t.length);return e.copy(o,1),t.copy(o,n+1),o[0]=n,o}(t,n)).catch((t=>console.error("Failed queing GC: ",t)))}for(const e of t._stores)e._originalReducer=e.reducer,e.reducer=t=>e._originalReducer({...t,schedule:o});return{async _collectGarbage(e){ad("Locking store");const n=await t._waitLock();try{const t=await i.bind(this)(e);return n(),t}catch(t){throw n(),t}},startGC(t=3e3){this.ready&&!n&&(n=setInterval(this._collectGarbage.bind(this),t))},stopGC(){n&&(clearInterval(n),n=null)}};async function i(n=Date.now()){ad("Starting collecting garbage...");const r=await async function(t,e){const n={gt:ud(0),lt:ud(e)},r=t.iterator(n),o=[];for(;;)try{const[t,e]=await new Promise(((t,e)=>{r.next(((n,r,o)=>{n?e(n):t([r,o])}))}));if(!t)break;o.push({key:t,value:e})}catch(t){console.warn("Iterator died with an error",t);break}return await new Promise(((t,e)=>{r.close((n=>n?e(n):t()))})),o}(e._db,n);ad("Fetched pending from store:",r.length);let o=new Set;const i=[];for(const e of r){const{type:r,id:a}=ld(e.value);if(!r)throw new Error("GC OP missing");await s({now:n,id:a,gcType:r,rootState:t.state,didMutate:t=>o.add(t),drop:t=>i.push([t,"chat"===r?a:null])})}const a=[];for(const[t,e]of i)try{const n=await this._tracePath(t);if(e){if(!e.equals(n.chatId))throw new Error("InternalError: Attempted to evict wrong segment");const t=await this.repo.rollback(n.keys[0],n.heads[0]);a.push(t)}else a.push(await this.repo.rollback(n.keys[0]))}catch(t){"FeedNotFound"===t.message?ad("RollbackFailed, Feed already gone",t):console.error("Rollback failed",t)}return o=Array.from(o),t._notifyObservers(o),ad("Stores mutated",o,"segments evicted",a.length),{mutated:o,evicted:a}}function s({now:t,rootState:e,drop:n,gcType:r,id:o,didMutate:i}){if("chat"===r){const r=e.vibes.matches[o.toString("hex")],s=e.chats.chats[o.toString("hex")],a=s?.head||r?.response||r?.chatId;let c=!1;if(!a)return;const u=s?.expiresAt||r?.expiresAt||0,l=u<t;if(ad("Chat[%h] expired: %s, timeLeft: %d",o,l,u-t),!l)return;if(s){const{chats:t,heads:n,own:r}=e.chats;delete t[o.toString("hex")],delete n[a.toString("hex")];const s=r.findIndex((t=>t.equals(o)));~s&&r.splice(s,1),i("chats"),c=!0}if(r){const{seen:t,matches:n,own:s}=e.vibes;r.a&&t[r.a.toString("hex")]?.equals(o)&&delete t[r.a.toString("hex")],r.b&&t[r.b.toString("hex")]?.equals(o)&&delete t[r.b.toString("hex")],delete n[o.toString("hex")];const a=s.findIndex((t=>t.equals(o)));~a&&s.splice(a,1),i("vibes"),c=!0}c&&n(a,o)}else{if("peer"!==r)throw new Error(`Garbage collection for "${r}" not supported!`);{const{peers:r}=e,s=e.peer.pk?.equals(o);s&&e.peer.expiresAt<t&&(e.peer.state=cd,i("peer"));const a=r[o.toString("hex")];a&&a.expiresAt<t&&(a.state=cd,i("peers"),s||(delete r[o.toString("hex")],n(a.sig)))}}}},cA=hd.exports,uA=function(){return{async sendVibe(t,e=[]){if(t=Ud(t),this.pk.equals(t))throw new Error("SelfVibeNotAllowed");const{matches:n,own:o}=this.store.state.vibes;for(const e of o){const r=n[e.toString("hex")];if("wait"===r.state&&t.equals(r.a))return this.respondVibe(r.chatId)}Array.isArray(e)||(e=[e]),e=e.map((t=>Hd.validate(t)));if(!(await Rd(this.$cooldowns(),(t=>"loading"!==t.state))).canVibe)throw new Error("VibeNotReady");const i=Fd(),s=await this.profileOf(t);if("error"===s.state)throw new Error(s.errorMessage);const a=Od(i.pk,s.box),c=(await this.createBlock(Td,{box:a,t:e})).last.sig;await this._storeLocalChatKey(c,i);const u=r.Buffer.allocUnsafe(Dd.SIGNATURE_SIZE+1);return c.copy(u,1),u[0]=84,await this._writeReg(u,s.pk),c},async respondVibe(t,e=!0){t=Ud(t);const n=Fd(),{own:r,matches:o}=this.store.state.vibes;if(!r.find((e=>e.equals(t))))throw new Error("NotYourVibe");const i=o[t.toString("hex")];if(!i)throw new Error("VibeNotFound");if("wait"!==i.state)throw new Error("VibeResponseNotApplicable");const s=await this.profileOf(i.a);if(!s)throw new Error("PeerNotFound");const a=Od(n.pk,s.box),c=await this.repo.readBlock(t);if(!c)throw new Error("Vibe no longer exists");if(!await this.createBlock(Dd.from(c),Ld,{box:e?a:$d,link:this.store.state.peer.sig}))throw new Error("Failed creating block");return e&&await this._storeLocalChatKey(i.chatId,n),t},$vibe(t){return Yd(Kd({state:"loading",type:"vibe"},this._vibe(t)))},_vibe(t){try{t=function(t){if(!t||!(r.Buffer.isBuffer(t)&&64===t.length||"string"!=typeof t&&128===t.length))throw new Error(`ChatID expected got "${t}"`);return Ud(t)}(t)}catch(t){return Kd({state:"error",errorMessage:t.message})}return Nd(Pd((t=>this.store.on("chats",t)),(t=>this.store.on("vibes",t))),(([e,{matches:n}])=>{const r=n[t.toString("hex")],o=e.chats[t.toString("hex")];if(!r)return{state:"error",errorMessage:"VibeNotFound"};const i=this.pk.equals(r.a),s=qd(t,r,i,o);return Gd.bind(this)(s)}))},$vibes(){return Yd(Kd([],Nd(this._vibes(),(async t=>{const e=[];for(let n=0;n<t.length;n++){const r={...t[n]};await Gd.bind(this)(r),e.push(r)}return Vd("emit $vibes async"),e}))))},_vibes(){return Nd(Pd((t=>this.store.on("chats",t)),(t=>this.store.on("vibes",t))),(([t,{sent:e,received:n,own:r,matches:o}],i)=>{const s=[];for(const e of r){const n=o[e.toString("hex")],r=t.chats[e.toString("hex")],i=qd(e,n,this.pk.equals(n.a),r);"expired"!==i.state&&(r&&"end"===r.state||s.push(i))}return Vd("emit _vibes"),s}))}}},lA=function(){return{$cooldowns(){return zd(Jd(this.$profile(),(t=>this.store.on("vibes",t)),(t=>this.store.on("chats",t))),(([t,e,n])=>{const r={canVibe:t.state===Wd,vibe:-1};if("loading"===t.state)return{state:"loading",...r};const o=e.seen[Xd(t.pk)];if(!o)return r.vibe=0,r;const i=e.matches[Xd(o)];if(!i)throw new Error("MentalError");r.vibe=i.expiresAt;const s=n.chats[Xd(o)];return s&&(r.vibe=s.expiresAt),r}))}}},{KEY_SK:hA,KEY_BOX_LIKES_PK:fA,KEY_BOX_LIKES_SK:gA,TYPE_VIBE:dA,TYPE_VIBE_RESP:AA,TYPE_MESSAGE:pA,TYPE_PROFILE:yA,TYPE_BYE:IA,TYPE_BYE_RESP:mA,VIBE_REJECTED:EA,decodeBlock:wA,typeOfBlock:bA}=If,CA=Bg,BA=(0,_h.exports)("picochat:kernel");var vA=class extends Zd{static Transactions=CA;constructor(t,e={}){super(t,e),this._vibeBox=e.box??null,this.store.register(tA()),this.store.register(tA.ProfileCtrl((()=>this.pk))),this._vibeController=new eA,this.store.register(this._vibeController),this.store.register(nA()),this.store.register(rA()),this.store.register(oA()),Object.assign(this,cA()),Object.assign(this,uA()),Object.assign(this,iA()),Object.assign(this,sA()),Object.assign(this,aA(this.store)),Object.assign(this,lA())}async boot(){return this.__loading||(this.__loading=(async()=>{if(!this._secret)try{this._secret=await this.repo.readReg(hA)}catch(t){if(!t.notFound)throw t}return this._secret&&(this._vibeBox={sk:await this.repo.readReg(gA),pk:await this.repo.readReg(fA)},this._vibeController.setKeys(this.pk,this._vibeBox)),await this.store.load(),this.ready=!0,!(!this._secret||!this.store.state.peer)&&(this.__setHasProfile(!0),!0)})()),this.__loading}async _tracePath(t){const e=[],n=[];let r=null,o=0;const i=await this.repo.loadFeed(t,((t,i)=>{switch(bA(t.body)){case AA:e[1]=t.key,n[1]=wA(t.body).link;break;case yA:case mA:e[0]=t.key,n[0]=t.sig,o&&i();break;case dA:r=t.sig}o++}));if(!i)throw new Error("FeedNotFound");return{keys:e,heads:n,feed:i,chatId:r}}async mergeStrategy(t,e){const n=wA(t.body),{type:r}=n,o=await e.readBlock(t.parentSig),i=bA(o.body);if(r===AA){const r=await e.readBlock(t.parentSig);return i===dA&&(EA.equals(n.box)?BA("Rejection detected: %h </3 %h",t.key,r.key):BA("Match detected: %h <3 %h",t.key,r.key),!0)}return r===pA&&i===pA||(r===IA&&i===pA||(r===mA&&i===IA||(console.warn("MergeStrategy rejected",i,"<--",r),!1)))}},_A={binstr:function(t,e){e=e||8*t.length;let n="";for(let r=0;r<t.length;r++)for(let o=0;o<8;o++)e===8*r+o&&(n+="|"),n+=t[r]&1<<o?"1":"0";return n},roundByte:kA,shift:xA,unshift:SA,countTrailingZeroes:function(t){let e=t.length,n=0;for(;e--;)for(let r=7;r>=0;r--){if(t[e]&1<<r)return n;n++}return n},countOnes:function(t){let e=0;for(let n=0;n<t.length;n++){let r=t[n];for(;r;)1&r&&e++,r>>=1}return e},proximityOf:function(t,e){let n=0;for(;n<t.length&&TA(t,n)===TA(e,n);n++);return n},mapOverlap:function(t,e){e=e||(()=>{});const n=t.map((()=>0)),r=t.map((()=>0)),o=t.map((()=>0));let i=!1;const s=[];let a=!1;for(;!a;){for(let e=0;e<t.length;e++){if(!i&&r[e])continue;const a=t[e],c=n[e]++,u=a.length-1-(c>>3);if(u<0)return s;const l=a[u]>>7-c%8&1;r[e]?o[e]=l:l&&(r[e]=!0)}if(!i){i=r.reduce(((t,e)=>t&&e),!0);continue}const c=e(o,(()=>{a=!0}));xA(s,c)&&(s[s.length]=1)}return s},packGeo:function(t,e,n){e||(e=5*t.length);if(e<5)throw new Error("precision has to be at least 5");const o=kA(e);n||(n=r.Buffer.alloc(o));const i=t.split("").reverse().reduce(((t,e,n)=>t+MA[e]*32**n),0).toString(2).slice(0,e).split("").reverse();for(const t of i)xA(n,"0"===t?0:1);return n},unpackGeo:DA,gammaShift:function(t,e){const n=Math.ceil(Math.log2(e));for(let e=0;e<n;e++)SA(t,0);SA(t,1);for(let r=0;r<n;r++)SA(t,e>>r&1)},gammaUnshift:function(t){let e=0;const n=8*t.length;for(;e<n;e++){const r=SA(t);if(r)break;if(e===n-1&&!r)throw new Error("NBitNotFound: end of buffer reached")}let r=1<<e;for(;e--;)r|=SA(t)<<e;return r},dGapEncode:function(t,e){e||(e=8*t.length);const n=[TA(t,0)];let r=0,o=n[0],i=0;for(;i<e;){const e=TA(t,i);e!==o&&(o=e,n.push(r),r=0),r++,i++}return n.push(r),n},decodeSL:function(t,e=16){const n=e+1,r=[];for(let e=0;e<kA(n);e++)r[e]=t[e];const o=SA(r),i=DA(r,e);return{sex:o,geohash:i}},bitAt:TA,setBit:function(t,e,n=1){t[e>>3]=n?(t[e>>3]||0)|1<<e%8:(t[e>>3]||0)&~(1<<e%8);return t}};function kA(t){return(t>>3)+(t%8?1:0)}function xA(t,e=0){let n=e?1:0;for(let e=0;e<t.length;e++){const r=t[e]>>7&1;t[e]=t[e]<<1|n,n=r}return n}function SA(t,e=0){let n=t.length,r=(e?1:0)<<7;for(;n--;){const e=(1&t[n])<<7;t[n]=r|t[n]>>1,r=e}return r?1:0}const QA="0123456789bcdefghjkmnpqrstuvwxyz",MA=QA.split("").reduce(((t,e,n)=>(t[e]=n,t)),{});function DA(t,e=16){const n=kA(e);if(t.length<n)throw new Error("BufferUnderflow, dst buffer too small");const r=[];for(let e=0;e<n;e++)r[e]=t[e];let o="",i=0;for(let t=0;t<e;t++){i|=SA(r)<<4-t%5,!t||t%5||(o+=QA.charAt(i),i=0)}return o+=QA.charAt(i),o.replace(/0+$/,"")}function TA(t,e){return t[e>>3]>>e%8&1}const{crypto_sign_SECRETKEYBYTES:LA,crypto_sign_PUBLICKEYBYTES:$A,crypto_sign_keypair:UA}=or.exports,{packGeo:OA,shift:FA,binstr:NA,roundByte:PA,decodeSL:YA}=_A,{GEO_BITS:KA}=If,{pack:RA,unpack:jA}=Wl,HA="default_signpair",VA="default_profile";class GA{constructor(t){this.db=t}async readIdentity(t=HA){return this.db.get(t).catch((t=>{if(!t.notFound)throw t}))}async writeIdentity(t,e=HA){if(!r.Buffer.isBuffer(t)||t.length!==LA)throw new Error("Expected SigningSecret");return this.db.put(e,t)}async writeProfile(t,e=VA){return this.db.put(e,RA(t))}async readProfile(t=VA){const e=await this.db.get(t).catch((t=>{if(!t.notFound)throw t}));if(e)return jA(e)}static generateAnonymous(){const t=r.Buffer.allocUnsafe(LA),e=r.Buffer.allocUnsafe($A);return UA(e,t),{pk:e,sk:t}}static generate(t,e,n){if(console.info("generate(",t,e,n,")"),666===(t=t??666)&&!e)return GA.generateAnonymous();if(!e)return qA(r.Buffer.from([t]),3,n);const o=KA+1,i=r.Buffer.allocUnsafe(PA(o)),s=OA(e,KA,i);FA(s,1&t);const a=o%8?(1<<o%8)-1:255;return console.info("Searching for",o,s.toString("hex"),NA(s).length,"mask",a.toString(2)),qA(s,a,n)}static decodePk(t){return YA(t,KA)}}function qA(t,e=255,n=5e5){if(!r.Buffer.isBuffer(t)&&!Array.isArray(t))throw new Error("Array or Buffer Expected");const o=r.Buffer.allocUnsafe($A),i=r.Buffer.allocUnsafe(LA),s=t.length;for(let r=0;r<n;r++){UA(o,i);let n=!0;for(let r=0;n&&r<s;r++)n=r+1===s?(o[r]&e)==(t[r]&e):n=o[r]===t[r];if(n)return{pk:o,sk:i}}}var zA=GA,JA="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};function WA(){}function XA(t){return t()}function ZA(){return Object.create(null)}function tp(t){t.forEach(XA)}function ep(t){return"function"==typeof t}function np(t,e){return t!=t?e==e:t!==e||t&&"object"==typeof t||"function"==typeof t}let rp,op;function ip(t,e){return rp||(rp=document.createElement("a")),rp.href=e,t===rp.href}function sp(t,...e){if(null==t)return WA;const n=t.subscribe(...e);return n.unsubscribe?()=>n.unsubscribe():n}function ap(t,e,n){t.$$.on_destroy.push(sp(e,n))}function cp(t,e,n,r){if(t){const o=up(t,e,n,r);return t[0](o)}}function up(t,e,n,r){return t[1]&&r?function(t,e){for(const n in e)t[n]=e[n];return t}(n.ctx.slice(),t[1](r(e))):n.ctx}function lp(t,e,n,r){if(t[2]&&r){const o=t[2](r(n));if(void 0===e.dirty)return o;if("object"==typeof o){const t=[],n=Math.max(e.dirty.length,o.length);for(let r=0;r<n;r+=1)t[r]=e.dirty[r]|o[r];return t}return e.dirty|o}return e.dirty}function hp(t,e,n,r,o,i){if(o){const s=up(e,n,r,i);t.p(s,o)}}function fp(t){if(t.ctx.length>32){const e=[],n=t.ctx.length/32;for(let t=0;t<n;t++)e[t]=-1;return e}return-1}function gp(t){return null==t?"":t}function dp(t,e,n){return t.set(n),e}function Ap(t,e){t.appendChild(e)}function pp(t,e,n){t.insertBefore(e,n||null)}function yp(t){t.parentNode.removeChild(t)}function Ip(t,e){for(let n=0;n<t.length;n+=1)t[n]&&t[n].d(e)}function mp(t){return document.createElement(t)}function Ep(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function wp(t){return document.createTextNode(t)}function bp(){return wp(" ")}function Cp(){return wp("")}function Bp(t,e,n,r){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n,r)}function vp(t){return function(e){return e.preventDefault(),t.call(this,e)}}function _p(t){return function(e){return e.stopPropagation(),t.call(this,e)}}function kp(t,e,n){null==n?t.removeAttribute(e):t.getAttribute(e)!==n&&t.setAttribute(e,n)}function xp(t,e,n){e in t?t[e]="boolean"==typeof t[e]&&""===n||n:kp(t,e,n)}function Sp(t,e){e=""+e,t.wholeText!==e&&(t.data=e)}function Qp(t,e){t.value=null==e?"":e}function Mp(t,e,n,r){null===n?t.style.removeProperty(e):t.style.setProperty(e,n,r?"important":"")}function Dp(t,e,n){t.classList[n?"add":"remove"](e)}class Tp{constructor(t=!1){this.is_svg=!1,this.is_svg=t,this.e=this.n=null}c(t){this.h(t)}m(t,e,n=null){this.e||(this.is_svg?this.e=Ep(e.nodeName):this.e=mp(e.nodeName),this.t=e,this.c(t)),this.i(n)}h(t){this.e.innerHTML=t,this.n=Array.from(this.e.childNodes)}i(t){for(let e=0;e<this.n.length;e+=1)pp(this.t,this.n[e],t)}p(t){this.d(),this.h(t),this.i(this.a)}d(){this.n.forEach(yp)}}function Lp(t){op=t}function $p(){if(!op)throw new Error("Function called outside component initialization");return op}function Up(t){$p().$$.on_mount.push(t)}function Op(){const t=$p();return(e,n,{cancelable:r=!1}={})=>{const o=t.$$.callbacks[e];if(o){const i=function(t,e,{bubbles:n=!1,cancelable:r=!1}={}){const o=document.createEvent("CustomEvent");return o.initCustomEvent(t,n,r,e),o}(e,n,{cancelable:r});return o.slice().forEach((e=>{e.call(t,i)})),!i.defaultPrevented}return!0}}function Fp(t,e){const n=t.$$.callbacks[e.type];n&&n.slice().forEach((t=>t.call(this,e)))}const Np=[],Pp=[],Yp=[],Kp=[],Rp=Promise.resolve();let jp=!1;function Hp(t){Yp.push(t)}function Vp(t){Kp.push(t)}const Gp=new Set;let qp=0;function zp(){const t=op;do{for(;qp<Np.length;){const t=Np[qp];qp++,Lp(t),Jp(t.$$)}for(Lp(null),Np.length=0,qp=0;Pp.length;)Pp.pop()();for(let t=0;t<Yp.length;t+=1){const e=Yp[t];Gp.has(e)||(Gp.add(e),e())}Yp.length=0}while(Np.length);for(;Kp.length;)Kp.pop()();jp=!1,Gp.clear(),Lp(t)}function Jp(t){if(null!==t.fragment){t.update(),tp(t.before_update);const e=t.dirty;t.dirty=[-1],t.fragment&&t.fragment.p(t.ctx,e),t.after_update.forEach(Hp)}}const Wp=new Set;let Xp;function Zp(){Xp={r:0,c:[],p:Xp}}function ty(){Xp.r||tp(Xp.c),Xp=Xp.p}function ey(t,e){t&&t.i&&(Wp.delete(t),t.i(e))}function ny(t,e,n,r){if(t&&t.o){if(Wp.has(t))return;Wp.add(t),Xp.c.push((()=>{Wp.delete(t),r&&(n&&t.d(1),r())})),t.o(e)}else r&&r()}function ry(t,e){const n=e.token={};function r(t,r,o,i){if(e.token!==n)return;e.resolved=i;let s=e.ctx;void 0!==o&&(s=s.slice(),s[o]=i);const a=t&&(e.current=t)(s);let c=!1;e.block&&(e.blocks?e.blocks.forEach(((t,n)=>{n!==r&&t&&(Zp(),ny(t,1,1,(()=>{e.blocks[n]===t&&(e.blocks[n]=null)})),ty())})):e.block.d(1),a.c(),ey(a,1),a.m(e.mount(),e.anchor),c=!0),e.block=a,e.blocks&&(e.blocks[r]=a),c&&zp()}if((o=t)&&"object"==typeof o&&"function"==typeof o.then){const n=$p();if(t.then((t=>{Lp(n),r(e.then,1,e.value,t),Lp(null)}),(t=>{if(Lp(n),r(e.catch,2,e.error,t),Lp(null),!e.hasCatch)throw t})),e.current!==e.pending)return r(e.pending,0),!0}else{if(e.current!==e.then)return r(e.then,1,e.value,t),!0;e.resolved=t}var o}function oy(t,e,n){const r=e.slice(),{resolved:o}=t;t.current===t.then&&(r[t.value]=o),t.current===t.catch&&(r[t.error]=o),t.block.p(r,n)}const iy="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:JA;function sy(t,e,n){const r=t.$$.props[e];void 0!==r&&(t.$$.bound[r]=n,n(t.$$.ctx[r]))}function ay(t){t&&t.c()}function cy(t,e,n,r){const{fragment:o,on_mount:i,on_destroy:s,after_update:a}=t.$$;o&&o.m(e,n),r||Hp((()=>{const e=i.map(XA).filter(ep);s?s.push(...e):tp(e),t.$$.on_mount=[]})),a.forEach(Hp)}function uy(t,e){const n=t.$$;null!==n.fragment&&(tp(n.on_destroy),n.fragment&&n.fragment.d(e),n.on_destroy=n.fragment=null,n.ctx=[])}function ly(t,e){-1===t.$$.dirty[0]&&(Np.push(t),jp||(jp=!0,Rp.then(zp)),t.$$.dirty.fill(0)),t.$$.dirty[e/31|0]|=1<<e%31}function hy(t,e,n,r,o,i,s,a=[-1]){const c=op;Lp(t);const u=t.$$={fragment:null,ctx:null,props:i,update:WA,not_equal:o,bound:ZA(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(c?c.$$.context:[])),callbacks:ZA(),dirty:a,skip_bound:!1,root:e.target||c.$$.root};s&&s(u.root);let l=!1;if(u.ctx=n?n(t,e.props||{},((e,n,...r)=>{const i=r.length?r[0]:n;return u.ctx&&o(u.ctx[e],u.ctx[e]=i)&&(!u.skip_bound&&u.bound[e]&&u.bound[e](i),l&&ly(t,e)),n})):[],u.update(),l=!0,tp(u.before_update),u.fragment=!!r&&r(u.ctx),e.target){if(e.hydrate){const t=function(t){return Array.from(t.childNodes)}(e.target);u.fragment&&u.fragment.l(t),t.forEach(yp)}else u.fragment&&u.fragment.c();e.intro&&ey(t.$$.fragment),cy(t,e.target,e.anchor,e.customElement),zp()}Lp(c)}class fy{$destroy(){uy(this,1),this.$destroy=WA}$on(t,e){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(e),()=>{const t=n.indexOf(e);-1!==t&&n.splice(t,1)}}$set(t){var e;this.$$set&&(e=t,0!==Object.keys(e).length)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}const gy=[];function dy(t,e){return{subscribe:Ay(t,e).subscribe}}function Ay(t,e=WA){let n;const r=new Set;function o(e){if(np(t,e)&&(t=e,n)){const e=!gy.length;for(const e of r)e[1](),gy.push(e,t);if(e){for(let t=0;t<gy.length;t+=2)gy[t][0](gy[t+1]);gy.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(i,s=WA){const a=[i,s];return r.add(a),1===r.size&&(n=e(o)||WA),i(t),()=>{r.delete(a),0===r.size&&(n(),n=null)}}}}function py(t,e,n){const r=!Array.isArray(t),o=r?[t]:t,i=e.length<2;return dy(n,(t=>{let n=!1;const s=[];let a=0,c=WA;const u=()=>{if(a)return;c();const n=e(r?s[0]:s,t);i?t(n):c=ep(n)?n:WA},l=o.map(((t,e)=>sp(t,(t=>{s[e]=t,a&=~(1<<e),n&&u()}),(()=>{a|=1<<e}))));return n=!0,u(),function(){tp(l),c()}}))}var yy={drinks:[{id:53505,name:"Lager",time:20,short:"Cold, quenching",price:200,image:"",type:"consumable",desc:"Freshly brewed from the finest grains.\nThere's always more"},{id:53506,name:"Kosmo",time:18,short:"Sweet, intoxicating",price:300,mod:"Random perk",image:"",type:"consumable",desc:"Applies one random effect for the duration of the drink.\n\n- One part moonlight\n- Two parts autumn honey\n- An orange stolen from a dream\n- A leaf caught midair\nYou can barely taste the vodka"},{id:53507,name:"White",time:22,short:"Dry refreshing",price:320,image:"",type:"consumable"},{id:53508,name:"Stout",time:30,price:500,mod:"silence",short:"Liquid darkness",image:"",type:"consumable",desc:"Vibe disabled\n\nThe bitterness is intense with aftertones of\ndark chocolate.\nNot a lager"},{id:53509,name:"Sparkly Wine",time:15,mod:"1.5X Rewards",price:600,short:"Proof of Prestige",image:"",type:"consumable"}],misc:[{id:53504,name:"Tip",image:"",price:100,short:"Boost feature development",type:"passive",desc:"DecentLabs - Compressing the internet to fit in the palm of your hand.\n\nThank you for playing."},{id:53249,time:60,name:"Verified Badge",short:"Not a robot",type:"passive",image:"",desc:"\"Don't collect what you can't protect\"\n\nWe only store your email for a short while to keep track of your purchases."},{id:55040,name:"Water",time:60,price:0,short:"The developers best friend",image:"",type:"consumable",desc:'Lorem ipsum dolor sit amet went on a long journey\nbut lorem forgot to bring a snack. So amet said\n"Don\'t worry bruh, I got you, I brought enough chocolate to bring down the entire mountain!"\nAnd so the adventure continued.'}],gear:[{id:53760,name:"B.A.B.",slot:"head",price:1200,mod:"1.1X rewards",short:"Never leave home without it",image:"",type:"active",desc:"Consecutive wins increases rewards +0.3X stacks upto 3X.\nBut lose and you'll lose your stacks and\nget no reward for that game.\n\nLife's a gamble trust Cosmos"},{id:53761,name:"Fades",slot:"eyes",price:3800,mod:"Silenced, Timestrech 3X",short:"Lean back and enjoy your stay",image:"",type:"active",desc:"Vibe disabled and time flows 3X slower while active.\nRelax, listen to the music, you're not in a hurry."},{id:53763,name:"Tic Tac Nano",price:500,short:"No talk, Play!",image:"",type:"collectible",desc:"Attach to vibe to challenge someone to a round of tic-tac-toe."},{id:53762,name:"Boom Deck 202",slot:"hands",price:24e4,mod:"DJ mode | TIMEFLOW 3X",short:"Play the song of your people",image:"",type:"active",desc:"Take the DJ seat and broadcast your tunes.\nBut beware! Time flows 3X faster while active \nMake sure to collect tips."}]};const Iy=window.Modem56;function my(t,e){return dy(null,(r=>e?n.exports.nfo(t,e)(r):t(r)))}const Ey=new er("PicoChat"),wy=new vA(Ey.sublevel("app",{keyEncoding:"buffer",valueEncoding:"buffer"})),by=new zA(Ey.sublevel("key",{keyEncoding:"buffer",valueEncoding:"buffer"})),Cy=(t,e,n)=>zA.generate(t,e,n);function By(t){const e=zA.decodePk(t),n=rr.decode(e.geohash);return{...e,...n}}function vy(t){return my(wy.$profile(),t)}function _y(t){return my(wy.$vibes(),t)}let ky=null;const[xy,Sy]=n.exports.write("loading"),[Qy,My]=n.exports.write(),[Dy,Ty]=n.exports.write(!1),[Ly,$y]=n.exports.write(!1),[Uy,Oy]=n.exports.write(!1),[Fy,Ny]=n.exports.write(!1),[Py,Yy]=n.exports.write(null),Ky=n.exports.combine({state:xy,error:Qy,hasKey:Uy,hasProfile:Fy,entered:Dy,swarming:Ly}),Ry=my(Ky),jy=my(Py);function Hy(){return ky||(ky=by.readIdentity().then((t=>(Oy(!!t),by.readProfile()))).then((t=>(Ny(!!t),t?.picture&&Yy(t.picture),wy.boot()))).then((t=>{Ty(t),wy.startGC()})).catch((t=>{throw console.error("kernel boot failure",t),My(t),Sy("error"),t})).then((t=>{Sy("running");const e=n.exports.get(Ky);console.info("Final state",e);const r=JSON.parse(window.localStorage.getItem("auto_swarm"));if(e.error)window.location.hash="/error?message="+e.error.message;else if(e.hasKey){if(e.hasProfile)return r&&qy();Uv("/profile")}else Uv("/keygen")}))),ky}function Vy(t,e){return"mock"===t?my(function(){const[t,e]=n.exports.write(!0),[r,o]=n.exports.write(!0),i=n.exports.init(["Hello","Hi","Weather's nice! ","You're joking right?",void 0,"There's a thunderstorm going on!","No way! That's so cool!","The roof is gone ","Is your pants still on?",void 0,"Please tell me you're not stroking yourself during a hurricane","Yup!"]);return n.exports.mute(n.exports.combine(t,r,i,Py),(([t,n,r,i])=>{let s="";const a=r.map(((e,n)=>{const r=n%2;return s+=e?r?"":"":r?"":"",{type:r^t?"sent":"received",content:e||"",pass:!e}}));return{peer:{name:t?"Blackie":"Whitemane",picture:i,tagline:"mock tag",date:Date.now(),sex:0,score:99,age:23},myTurn:n,initiator:t,state:"active",graph:s,health:2,expiresAt:Date.now()+864e5,async send(){},pass:async()=>(o(!1),new Promise((t=>{setTimeout((()=>{o(!0),t()}),1e3)}))),async bye(){e(!t)},mLength:a.length,messages:a}}))}()):my(wy.$chat(t),e)}let Gy=null;async function qy(){if(!Iy)throw new Error("Modem not available, did you load it?");Gy||(Gy=new Iy(null,{}),Gy.join("picochat-testnet",wy.spawnWire.bind(wy)),$y(!0))}function zy(t){return"data:image/jpeg;base64,"+t?.toString("base64")}async function Jy(t=!1){const e=t?"You are about to burn your passport and everything with it... you sure about this?":"Permanently wipe ALL data, you sure?";window.confirm(e)&&(t&&await by.db.clear(),await wy.db.clear(),window.location.reload())}async function Wy(){const t=new(0,window.File)([(await by.readIdentity()).toString("hex")],"idsqr-insecure-backup.txt",{type:"application/text"}),e=URL.createObjectURL(t);window.open(e,"_blank")}const Xy=yy,Zy=Object.keys(Xy).reduce(((t,e)=>{for(const n of yy[e])n.category=e,t[n.id]=n;return t}),{});function tI(t){let e,n,r,o,i;const s=t[4].default,a=cp(s,t,t[3],null),c=a||function(t){let e;return{c(){e=wp("Empty Modal")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}();return{c(){e=mp("dialog"),c&&c.c()},m(s,a){var u;pp(s,e,a),c&&c.m(e,null),t[5](e),r=!0,o||(i=[(u=n=nI.call(null,e,["open",!!t[0]]),u&&ep(u.destroy)?u.destroy:WA),Bp(e,"click",t[2])],o=!0)},p(t,[e]){a&&a.p&&(!r||8&e)&&hp(a,s,t,t[3],r?lp(s,t[3],e,null):fp(t[3]),null),n&&ep(n.update)&&1&e&&n.update.call(null,["open",!!t[0]])},i(t){r||(ey(c,t),r=!0)},o(t){ny(c,t),r=!1},d(n){n&&yp(e),c&&c.d(n),t[5](null),o=!1,tp(i)}}}function eI(t,e,n){null===n||!1===n?t.removeAttribute(e):t.setAttribute(e,n+"")}function nI(t,e){return e&&eI(t,e[0],e[1]),{update(e){e&&eI(t,e[0],e[1])}}}function rI(t,e,n){let{$$slots:r={},$$scope:o}=e,{open:i=!0}=e;const s=Op();let a;return t.$$set=t=>{"open"in t&&n(0,i=t.open),"$$scope"in t&&n(3,o=t.$$scope)},[i,a,function(t){t.target===a&&s("fade")},o,r,function(t){Pp[t?"unshift":"push"]((()=>{a=t,n(1,a)}))}]}class oI extends fy{constructor(t){super(),hy(this,t,rI,tI,np,{open:0})}}function iI(t){let e,n;return{c(){var r,o,i;e=Ep("svg"),n=Ep("use"),r=n,o="xlink:href",i=t[1],r.setAttributeNS("http://www.w3.org/1999/xlink",o,i),kp(n,"href",t[1]),kp(e,"class",gp(t[2])+" svelte-16ydb8b"),Dp(e,"nofill",t[0])},m(t,r){pp(t,e,r),Ap(e,n)},p(t,[n]){1&n&&Dp(e,"nofill",t[0])},i:WA,o:WA,d(t){t&&yp(e)}}}function sI(t,e,n){let{id:r=""}=e,{tag:o=""}=e,{nofill:i=!1}=e;const s=`build/sprites.svg#${r}`,a=`icon ${o}`.trim();return t.$$set=t=>{"id"in t&&n(3,r=t.id),"tag"in t&&n(4,o=t.tag),"nofill"in t&&n(0,i=t.nofill)},[i,s,a,r,o]}class aI extends fy{constructor(t){super(),hy(this,t,sI,iI,np,{id:3,tag:4,nofill:0})}}var cI={exports:{}};!function(t,e){var n=function(){var t=function(t,e){var n=t,r=l[e],o=null,i=0,s=null,a=[],c={},u=function(t,e){o=function(t){for(var e=new Array(t),n=0;n<t;n+=1){e[n]=new Array(t);for(var r=0;r<t;r+=1)e[n][r]=null}return e}(i=4*n+17),h(0,0),h(i-7,0),h(0,i-7),g(),f(),A(t,e),n>=7&&d(t),null==s&&(s=y(n,r,a)),p(s,e)},h=function(t,e){for(var n=-1;n<=7;n+=1)if(!(t+n<=-1||i<=t+n))for(var r=-1;r<=7;r+=1)e+r<=-1||i<=e+r||(o[t+n][e+r]=0<=n&&n<=6&&(0==r||6==r)||0<=r&&r<=6&&(0==n||6==n)||2<=n&&n<=4&&2<=r&&r<=4)},f=function(){for(var t=8;t<i-8;t+=1)null==o[t][6]&&(o[t][6]=t%2==0);for(var e=8;e<i-8;e+=1)null==o[6][e]&&(o[6][e]=e%2==0)},g=function(){for(var t=m.getPatternPosition(n),e=0;e<t.length;e+=1)for(var r=0;r<t.length;r+=1){var i=t[e],s=t[r];if(null==o[i][s])for(var a=-2;a<=2;a+=1)for(var c=-2;c<=2;c+=1)o[i+a][s+c]=-2==a||2==a||-2==c||2==c||0==a&&0==c}},d=function(t){for(var e=m.getBCHTypeNumber(n),r=0;r<18;r+=1){var s=!t&&1==(e>>r&1);o[Math.floor(r/3)][r%3+i-8-3]=s}for(r=0;r<18;r+=1){s=!t&&1==(e>>r&1);o[r%3+i-8-3][Math.floor(r/3)]=s}},A=function(t,e){for(var n=r<<3|e,s=m.getBCHTypeInfo(n),a=0;a<15;a+=1){var c=!t&&1==(s>>a&1);a<6?o[a][8]=c:a<8?o[a+1][8]=c:o[i-15+a][8]=c}for(a=0;a<15;a+=1){c=!t&&1==(s>>a&1);a<8?o[8][i-a-1]=c:a<9?o[8][15-a-1+1]=c:o[8][15-a-1]=c}o[i-8][8]=!t},p=function(t,e){for(var n=-1,r=i-1,s=7,a=0,c=m.getMaskFunction(e),u=i-1;u>0;u-=2)for(6==u&&(u-=1);;){for(var l=0;l<2;l+=1)if(null==o[r][u-l]){var h=!1;a<t.length&&(h=1==(t[a]>>>s&1)),c(r,u-l)&&(h=!h),o[r][u-l]=h,-1==(s-=1)&&(a+=1,s=7)}if((r+=n)<0||i<=r){r-=n,n=-n;break}}},y=function(t,e,n){for(var r=b.getRSBlocks(t,e),o=C(),i=0;i<n.length;i+=1){var s=n[i];o.put(s.getMode(),4),o.put(s.getLength(),m.getLengthInBits(s.getMode(),t)),s.write(o)}var a=0;for(i=0;i<r.length;i+=1)a+=r[i].dataCount;if(o.getLengthInBits()>8*a)throw"code length overflow. ("+o.getLengthInBits()+">"+8*a+")";for(o.getLengthInBits()+4<=8*a&&o.put(0,4);o.getLengthInBits()%8!=0;)o.putBit(!1);for(;!(o.getLengthInBits()>=8*a||(o.put(236,8),o.getLengthInBits()>=8*a));)o.put(17,8);return function(t,e){for(var n=0,r=0,o=0,i=new Array(e.length),s=new Array(e.length),a=0;a<e.length;a+=1){var c=e[a].dataCount,u=e[a].totalCount-c;r=Math.max(r,c),o=Math.max(o,u),i[a]=new Array(c);for(var l=0;l<i[a].length;l+=1)i[a][l]=255&t.getBuffer()[l+n];n+=c;var h=m.getErrorCorrectPolynomial(u),f=w(i[a],h.getLength()-1).mod(h);for(s[a]=new Array(h.getLength()-1),l=0;l<s[a].length;l+=1){var g=l+f.getLength()-s[a].length;s[a][l]=g>=0?f.getAt(g):0}}var d=0;for(l=0;l<e.length;l+=1)d+=e[l].totalCount;var A=new Array(d),p=0;for(l=0;l<r;l+=1)for(a=0;a<e.length;a+=1)l<i[a].length&&(A[p]=i[a][l],p+=1);for(l=0;l<o;l+=1)for(a=0;a<e.length;a+=1)l<s[a].length&&(A[p]=s[a][l],p+=1);return A}(o,r)};c.addData=function(t,e){var n=null;switch(e=e||"Byte"){case"Numeric":n=B(t);break;case"Alphanumeric":n=v(t);break;case"Byte":n=_(t);break;case"Kanji":n=k(t);break;default:throw"mode:"+e}a.push(n),s=null},c.isDark=function(t,e){if(t<0||i<=t||e<0||i<=e)throw t+","+e;return o[t][e]},c.getModuleCount=function(){return i},c.make=function(){if(n<1){for(var t=1;t<40;t++){for(var e=b.getRSBlocks(t,r),o=C(),i=0;i<a.length;i++){var s=a[i];o.put(s.getMode(),4),o.put(s.getLength(),m.getLengthInBits(s.getMode(),t)),s.write(o)}var l=0;for(i=0;i<e.length;i++)l+=e[i].dataCount;if(o.getLengthInBits()<=8*l)break}n=t}u(!1,function(){for(var t=0,e=0,n=0;n<8;n+=1){u(!0,n);var r=m.getLostPoint(c);(0==n||t>r)&&(t=r,e=n)}return e}())},c.createTableTag=function(t,e){t=t||2;var n="";n+='<table style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: "+(e=void 0===e?4*t:e)+"px;",n+='">',n+="<tbody>";for(var r=0;r<c.getModuleCount();r+=1){n+="<tr>";for(var o=0;o<c.getModuleCount();o+=1)n+='<td style="',n+=" border-width: 0px; border-style: none;",n+=" border-collapse: collapse;",n+=" padding: 0px; margin: 0px;",n+=" width: "+t+"px;",n+=" height: "+t+"px;",n+=" background-color: ",n+=c.isDark(r,o)?"#000000":"#ffffff",n+=";",n+='"/>';n+="</tr>"}return n+="</tbody>",n+="</table>"},c.createSvgTag=function(t,e,n,r){var o={};"object"==typeof arguments[0]&&(t=(o=arguments[0]).cellSize,e=o.margin,n=o.alt,r=o.title),t=t||2,e=void 0===e?4*t:e,(n="string"==typeof n?{text:n}:n||{}).text=n.text||null,n.id=n.text?n.id||"qrcode-description":null,(r="string"==typeof r?{text:r}:r||{}).text=r.text||null,r.id=r.text?r.id||"qrcode-title":null;var i,s,a,u,l=c.getModuleCount()*t+2*e,h="";for(u="l"+t+",0 0,"+t+" -"+t+",0 0,-"+t+"z ",h+='<svg version="1.1" xmlns="http://www.w3.org/2000/svg"',h+=o.scalable?"":' width="'+l+'px" height="'+l+'px"',h+=' viewBox="0 0 '+l+" "+l+'" ',h+=' preserveAspectRatio="xMinYMin meet"',h+=r.text||n.text?' role="img" aria-labelledby="'+I([r.id,n.id].join(" ").trim())+'"':"",h+=">",h+=r.text?'<title id="'+I(r.id)+'">'+I(r.text)+"</title>":"",h+=n.text?'<description id="'+I(n.id)+'">'+I(n.text)+"</description>":"",h+='<rect width="100%" height="100%" fill="white" cx="0" cy="0"/>',h+='<path d="',s=0;s<c.getModuleCount();s+=1)for(a=s*t+e,i=0;i<c.getModuleCount();i+=1)c.isDark(s,i)&&(h+="M"+(i*t+e)+","+a+u);return h+='" stroke="transparent" fill="black"/>',h+="</svg>"},c.createDataURL=function(t,e){t=t||2,e=void 0===e?4*t:e;var n=c.getModuleCount()*t+2*e,r=e,o=n-e;return Q(n,n,(function(e,n){if(r<=e&&e<o&&r<=n&&n<o){var i=Math.floor((e-r)/t),s=Math.floor((n-r)/t);return c.isDark(s,i)?0:1}return 1}))},c.createImgTag=function(t,e,n){t=t||2,e=void 0===e?4*t:e;var r=c.getModuleCount()*t+2*e,o="";return o+="<img",o+=' src="',o+=c.createDataURL(t,e),o+='"',o+=' width="',o+=r,o+='"',o+=' height="',o+=r,o+='"',n&&(o+=' alt="',o+=I(n),o+='"'),o+="/>"};var I=function(t){for(var e="",n=0;n<t.length;n+=1){var r=t.charAt(n);switch(r){case"<":e+="&lt;";break;case">":e+="&gt;";break;case"&":e+="&amp;";break;case'"':e+="&quot;";break;default:e+=r}}return e};return c.createASCII=function(t,e){if((t=t||1)<2)return function(t){t=void 0===t?2:t;var e,n,r,o,i,s=1*c.getModuleCount()+2*t,a=t,u=s-t,l={"":""," ":""," ":"","  ":" "},h={"":""," ":""," ":" ","  ":" "},f="";for(e=0;e<s;e+=2){for(r=Math.floor((e-a)/1),o=Math.floor((e+1-a)/1),n=0;n<s;n+=1)i="",a<=n&&n<u&&a<=e&&e<u&&c.isDark(r,Math.floor((n-a)/1))&&(i=" "),a<=n&&n<u&&a<=e+1&&e+1<u&&c.isDark(o,Math.floor((n-a)/1))?i+=" ":i+="",f+=t<1&&e+1>=u?h[i]:l[i];f+="\n"}return s%2&&t>0?f.substring(0,f.length-s-1)+Array(s+1).join(""):f.substring(0,f.length-1)}(e);t-=1,e=void 0===e?2*t:e;var n,r,o,i,s=c.getModuleCount()*t+2*e,a=e,u=s-e,l=Array(t+1).join(""),h=Array(t+1).join("  "),f="",g="";for(n=0;n<s;n+=1){for(o=Math.floor((n-a)/t),g="",r=0;r<s;r+=1)i=1,a<=r&&r<u&&a<=n&&n<u&&c.isDark(o,Math.floor((r-a)/t))&&(i=0),g+=i?l:h;for(o=0;o<t;o+=1)f+=g+"\n"}return f.substring(0,f.length-1)},c.renderTo2dContext=function(t,e){e=e||2;for(var n=c.getModuleCount(),r=0;r<n;r++)for(var o=0;o<n;o++)t.fillStyle=c.isDark(r,o)?"black":"white",t.fillRect(r*e,o*e,e,e)},c};t.stringToBytes=(t.stringToBytesFuncs={default:function(t){for(var e=[],n=0;n<t.length;n+=1){var r=t.charCodeAt(n);e.push(255&r)}return e}}).default,t.createStringToBytes=function(t,e){var n=function(){for(var n=S(t),r=function(){var t=n.read();if(-1==t)throw"eof";return t},o=0,i={};;){var s=n.read();if(-1==s)break;var a=r(),c=r()<<8|r();i[String.fromCharCode(s<<8|a)]=c,o+=1}if(o!=e)throw o+" != "+e;return i}(),r="?".charCodeAt(0);return function(t){for(var e=[],o=0;o<t.length;o+=1){var i=t.charCodeAt(o);if(i<128)e.push(i);else{var s=n[t.charAt(o)];"number"==typeof s?(255&s)==s?e.push(s):(e.push(s>>>8),e.push(255&s)):e.push(r)}}return e}};var e,n,r,o,i,s=1,a=2,c=4,u=8,l={L:1,M:0,Q:3,H:2},h=0,f=1,g=2,d=3,A=4,p=5,y=6,I=7,m=(e=[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],n=1335,r=7973,i=function(t){for(var e=0;0!=t;)e+=1,t>>>=1;return e},(o={}).getBCHTypeInfo=function(t){for(var e=t<<10;i(e)-i(n)>=0;)e^=n<<i(e)-i(n);return 21522^(t<<10|e)},o.getBCHTypeNumber=function(t){for(var e=t<<12;i(e)-i(r)>=0;)e^=r<<i(e)-i(r);return t<<12|e},o.getPatternPosition=function(t){return e[t-1]},o.getMaskFunction=function(t){switch(t){case h:return function(t,e){return(t+e)%2==0};case f:return function(t,e){return t%2==0};case g:return function(t,e){return e%3==0};case d:return function(t,e){return(t+e)%3==0};case A:return function(t,e){return(Math.floor(t/2)+Math.floor(e/3))%2==0};case p:return function(t,e){return t*e%2+t*e%3==0};case y:return function(t,e){return(t*e%2+t*e%3)%2==0};case I:return function(t,e){return(t*e%3+(t+e)%2)%2==0};default:throw"bad maskPattern:"+t}},o.getErrorCorrectPolynomial=function(t){for(var e=w([1],0),n=0;n<t;n+=1)e=e.multiply(w([1,E.gexp(n)],0));return e},o.getLengthInBits=function(t,e){if(1<=e&&e<10)switch(t){case s:return 10;case a:return 9;case c:case u:return 8;default:throw"mode:"+t}else if(e<27)switch(t){case s:return 12;case a:return 11;case c:return 16;case u:return 10;default:throw"mode:"+t}else{if(!(e<41))throw"type:"+e;switch(t){case s:return 14;case a:return 13;case c:return 16;case u:return 12;default:throw"mode:"+t}}},o.getLostPoint=function(t){for(var e=t.getModuleCount(),n=0,r=0;r<e;r+=1)for(var o=0;o<e;o+=1){for(var i=0,s=t.isDark(r,o),a=-1;a<=1;a+=1)if(!(r+a<0||e<=r+a))for(var c=-1;c<=1;c+=1)o+c<0||e<=o+c||0==a&&0==c||s==t.isDark(r+a,o+c)&&(i+=1);i>5&&(n+=3+i-5)}for(r=0;r<e-1;r+=1)for(o=0;o<e-1;o+=1){var u=0;t.isDark(r,o)&&(u+=1),t.isDark(r+1,o)&&(u+=1),t.isDark(r,o+1)&&(u+=1),t.isDark(r+1,o+1)&&(u+=1),0!=u&&4!=u||(n+=3)}for(r=0;r<e;r+=1)for(o=0;o<e-6;o+=1)t.isDark(r,o)&&!t.isDark(r,o+1)&&t.isDark(r,o+2)&&t.isDark(r,o+3)&&t.isDark(r,o+4)&&!t.isDark(r,o+5)&&t.isDark(r,o+6)&&(n+=40);for(o=0;o<e;o+=1)for(r=0;r<e-6;r+=1)t.isDark(r,o)&&!t.isDark(r+1,o)&&t.isDark(r+2,o)&&t.isDark(r+3,o)&&t.isDark(r+4,o)&&!t.isDark(r+5,o)&&t.isDark(r+6,o)&&(n+=40);var l=0;for(o=0;o<e;o+=1)for(r=0;r<e;r+=1)t.isDark(r,o)&&(l+=1);return n+=Math.abs(100*l/e/e-50)/5*10},o),E=function(){for(var t=new Array(256),e=new Array(256),n=0;n<8;n+=1)t[n]=1<<n;for(n=8;n<256;n+=1)t[n]=t[n-4]^t[n-5]^t[n-6]^t[n-8];for(n=0;n<255;n+=1)e[t[n]]=n;var r={glog:function(t){if(t<1)throw"glog("+t+")";return e[t]},gexp:function(e){for(;e<0;)e+=255;for(;e>=256;)e-=255;return t[e]}};return r}();function w(t,e){if(void 0===t.length)throw t.length+"/"+e;var n=function(){for(var n=0;n<t.length&&0==t[n];)n+=1;for(var r=new Array(t.length-n+e),o=0;o<t.length-n;o+=1)r[o]=t[o+n];return r}(),r={getAt:function(t){return n[t]},getLength:function(){return n.length},multiply:function(t){for(var e=new Array(r.getLength()+t.getLength()-1),n=0;n<r.getLength();n+=1)for(var o=0;o<t.getLength();o+=1)e[n+o]^=E.gexp(E.glog(r.getAt(n))+E.glog(t.getAt(o)));return w(e,0)},mod:function(t){if(r.getLength()-t.getLength()<0)return r;for(var e=E.glog(r.getAt(0))-E.glog(t.getAt(0)),n=new Array(r.getLength()),o=0;o<r.getLength();o+=1)n[o]=r.getAt(o);for(o=0;o<t.getLength();o+=1)n[o]^=E.gexp(E.glog(t.getAt(o))+e);return w(n,0).mod(t)}};return r}var b=function(){var t=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12,7,37,13],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],e=function(t,e){var n={};return n.totalCount=t,n.dataCount=e,n},n={};return n.getRSBlocks=function(n,r){var o=function(e,n){switch(n){case l.L:return t[4*(e-1)+0];case l.M:return t[4*(e-1)+1];case l.Q:return t[4*(e-1)+2];case l.H:return t[4*(e-1)+3];default:return}}(n,r);if(void 0===o)throw"bad rs block @ typeNumber:"+n+"/errorCorrectionLevel:"+r;for(var i=o.length/3,s=[],a=0;a<i;a+=1)for(var c=o[3*a+0],u=o[3*a+1],h=o[3*a+2],f=0;f<c;f+=1)s.push(e(u,h));return s},n}(),C=function(){var t=[],e=0,n={getBuffer:function(){return t},getAt:function(e){var n=Math.floor(e/8);return 1==(t[n]>>>7-e%8&1)},put:function(t,e){for(var r=0;r<e;r+=1)n.putBit(1==(t>>>e-r-1&1))},getLengthInBits:function(){return e},putBit:function(n){var r=Math.floor(e/8);t.length<=r&&t.push(0),n&&(t[r]|=128>>>e%8),e+=1}};return n},B=function(t){var e=s,n=t,r={getMode:function(){return e},getLength:function(t){return n.length},write:function(t){for(var e=n,r=0;r+2<e.length;)t.put(o(e.substring(r,r+3)),10),r+=3;r<e.length&&(e.length-r==1?t.put(o(e.substring(r,r+1)),4):e.length-r==2&&t.put(o(e.substring(r,r+2)),7))}},o=function(t){for(var e=0,n=0;n<t.length;n+=1)e=10*e+i(t.charAt(n));return e},i=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);throw"illegal char :"+t};return r},v=function(t){var e=a,n=t,r={getMode:function(){return e},getLength:function(t){return n.length},write:function(t){for(var e=n,r=0;r+1<e.length;)t.put(45*o(e.charAt(r))+o(e.charAt(r+1)),11),r+=2;r<e.length&&t.put(o(e.charAt(r)),6)}},o=function(t){if("0"<=t&&t<="9")return t.charCodeAt(0)-"0".charCodeAt(0);if("A"<=t&&t<="Z")return t.charCodeAt(0)-"A".charCodeAt(0)+10;switch(t){case" ":return 36;case"$":return 37;case"%":return 38;case"*":return 39;case"+":return 40;case"-":return 41;case".":return 42;case"/":return 43;case":":return 44;default:throw"illegal char :"+t}};return r},_=function(e){var n=c,r=t.stringToBytes(e),o={getMode:function(){return n},getLength:function(t){return r.length},write:function(t){for(var e=0;e<r.length;e+=1)t.put(r[e],8)}};return o},k=function(e){var n=u,r=t.stringToBytesFuncs.SJIS;if(!r)throw"sjis not supported.";!function(t,e){var n=r("");if(2!=n.length||38726!=(n[0]<<8|n[1]))throw"sjis not supported."}();var o=r(e),i={getMode:function(){return n},getLength:function(t){return~~(o.length/2)},write:function(t){for(var e=o,n=0;n+1<e.length;){var r=(255&e[n])<<8|255&e[n+1];if(33088<=r&&r<=40956)r-=33088;else{if(!(57408<=r&&r<=60351))throw"illegal char at "+(n+1)+"/"+r;r-=49472}r=192*(r>>>8&255)+(255&r),t.put(r,13),n+=2}if(n<e.length)throw"illegal char at "+(n+1)}};return i},x=function(){var t=[],e={writeByte:function(e){t.push(255&e)},writeShort:function(t){e.writeByte(t),e.writeByte(t>>>8)},writeBytes:function(t,n,r){n=n||0,r=r||t.length;for(var o=0;o<r;o+=1)e.writeByte(t[o+n])},writeString:function(t){for(var n=0;n<t.length;n+=1)e.writeByte(t.charCodeAt(n))},toByteArray:function(){return t},toString:function(){var e="";e+="[";for(var n=0;n<t.length;n+=1)n>0&&(e+=","),e+=t[n];return e+="]"}};return e},S=function(t){var e=t,n=0,r=0,o=0,i={read:function(){for(;o<8;){if(n>=e.length){if(0==o)return-1;throw"unexpected end of file./"+o}var t=e.charAt(n);if(n+=1,"="==t)return o=0,-1;t.match(/^\s$/)||(r=r<<6|s(t.charCodeAt(0)),o+=6)}var i=r>>>o-8&255;return o-=8,i}},s=function(t){if(65<=t&&t<=90)return t-65;if(97<=t&&t<=122)return t-97+26;if(48<=t&&t<=57)return t-48+52;if(43==t)return 62;if(47==t)return 63;throw"c:"+t};return i},Q=function(t,e,n){for(var r=function(t,e){var n=t,r=e,o=new Array(t*e),i={setPixel:function(t,e,r){o[e*n+t]=r},write:function(t){t.writeString("GIF87a"),t.writeShort(n),t.writeShort(r),t.writeByte(128),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(0),t.writeByte(255),t.writeByte(255),t.writeByte(255),t.writeString(","),t.writeShort(0),t.writeShort(0),t.writeShort(n),t.writeShort(r),t.writeByte(0);var e=s(2);t.writeByte(2);for(var o=0;e.length-o>255;)t.writeByte(255),t.writeBytes(e,o,255),o+=255;t.writeByte(e.length-o),t.writeBytes(e,o,e.length-o),t.writeByte(0),t.writeString(";")}},s=function(t){for(var e=1<<t,n=1+(1<<t),r=t+1,i=a(),s=0;s<e;s+=1)i.add(String.fromCharCode(s));i.add(String.fromCharCode(e)),i.add(String.fromCharCode(n));var c=x(),u=function(t){var e=t,n=0,r=0,o={write:function(t,o){if(t>>>o!=0)throw"length over";for(;n+o>=8;)e.writeByte(255&(t<<n|r)),o-=8-n,t>>>=8-n,r=0,n=0;r|=t<<n,n+=o},flush:function(){n>0&&e.writeByte(r)}};return o}(c);u.write(e,r);var l=0,h=String.fromCharCode(o[l]);for(l+=1;l<o.length;){var f=String.fromCharCode(o[l]);l+=1,i.contains(h+f)?h+=f:(u.write(i.indexOf(h),r),i.size()<4095&&(i.size()==1<<r&&(r+=1),i.add(h+f)),h=f)}return u.write(i.indexOf(h),r),u.write(n,r),u.flush(),c.toByteArray()},a=function(){var t={},e=0,n={add:function(r){if(n.contains(r))throw"dup key:"+r;t[r]=e,e+=1},size:function(){return e},indexOf:function(e){return t[e]},contains:function(e){return void 0!==t[e]}};return n};return i}(t,e),o=0;o<e;o+=1)for(var i=0;i<t;i+=1)r.setPixel(i,o,n(i,o));var s=x();r.write(s);for(var a=function(){var t=0,e=0,n=0,r="",o={},i=function(t){r+=String.fromCharCode(s(63&t))},s=function(t){if(t<0);else{if(t<26)return 65+t;if(t<52)return t-26+97;if(t<62)return t-52+48;if(62==t)return 43;if(63==t)return 47}throw"n:"+t};return o.writeByte=function(r){for(t=t<<8|255&r,e+=8,n+=1;e>=6;)i(t>>>e-6),e-=6},o.flush=function(){if(e>0&&(i(t<<6-e),t=0,e=0),n%3!=0)for(var o=3-n%3,s=0;s<o;s+=1)r+="="},o.toString=function(){return r},o}(),c=s.toByteArray(),u=0;u<c.length;u+=1)a.writeByte(c[u]);return a.flush(),"data:image/gif;base64,"+a};return t}();n.stringToBytesFuncs["UTF-8"]=function(t){return function(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e.push(r):r<2048?e.push(192|r>>6,128|63&r):r<55296||r>=57344?e.push(224|r>>12,128|r>>6&63,128|63&r):(n++,r=65536+((1023&r)<<10|1023&t.charCodeAt(n)),e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r))}return e}(t)},t.exports=n}(cI);var uI=cI.exports;function lI(t){let e,n;return{c(){e=mp("pico-qr"),n=mp("img"),xp(e,"class","svelte-1qaazc0")},m(r,o){pp(r,e,o),Ap(e,n),t[5](n)},p:WA,i:WA,o:WA,d(n){n&&yp(e),t[5](null)}}}function hI(t,e,n){let o,{data:i=null}=e,{size:s=2}=e,{margin:a=0}=e,{level:c="L"}=e;function u(t){if(!t)return;r.Buffer.isBuffer(t)&&(t=t.toString("base64"));const e=new uI(0,c);e.addData(t),e.make();const i=e.createDataURL(s,a);n(0,o.src=i,o)}return Up((()=>{if("function"==typeof i?.subscribe)return i.subscribe(u);i&&u(i)})),t.$$set=t=>{"data"in t&&n(1,i=t.data),"size"in t&&n(2,s=t.size),"margin"in t&&n(3,a=t.margin),"level"in t&&n(4,c=t.level)},[o,i,s,a,c,function(t){Pp[t?"unshift":"push"]((()=>{o=t,n(0,o)}))}]}class fI extends fy{constructor(t){super(),hy(this,t,hI,lI,np,{data:1,size:2,margin:3,level:4})}}function gI(t){let e,n,r,o,i,s=t[38].message+"";return{c(){e=mp("div"),n=mp("h5"),n.textContent="Error:",r=bp(),o=mp("danger"),i=wp(s),kp(o,"class","svelte-1rqfs0r")},m(t,s){pp(t,e,s),Ap(e,n),Ap(e,r),Ap(e,o),Ap(o,i)},p:WA,i:WA,o:WA,d(t){t&&yp(e)}}}function dI(t){let e,n,r,o;const i=[pI,AI],s=[];function a(t,e){return t[3]?1:0}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=Cp()},m(t,n){s[e].m(t,n),pp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e===c?s[e].p(t,o):(Zp(),ny(s[c],1,1,(()=>{s[c]=null})),ty(),n=s[e],n?n.p(t,o):(n=s[e]=i[e](t),n.c()),ey(n,1),n.m(r.parentNode,r))},i(t){o||(ey(n),o=!0)},o(t){ny(n),o=!1},d(t){s[e].d(t),t&&yp(r)}}}function AI(t){let e,n;return e=new fI({props:{data:t[3].slice(32),size:10}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};8&n[0]&&(r.data=t[3].slice(32)),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function pI(t){let e,n,r,o,i,s,a,c,u,l,h;function f(t,e){return 100===t[0]?II:yI}let g=f(t),d=g(t),A=t[1]>1&&mI(t),p=t[2]&&EI();return{c(){e=mp("div"),d.c(),n=bp(),r=mp("div"),o=mp("div"),A&&A.c(),i=bp(),s=mp("button"),a=wp("Create"),u=bp(),p&&p.c(),s.disabled=c=100!==t[0]||t[3],kp(o,"class","row space-between xcenter")},m(c,f){pp(c,e,f),d.m(e,null),pp(c,n,f),pp(c,r,f),Ap(r,o),A&&A.m(o,null),Ap(o,i),Ap(o,s),Ap(s,a),Ap(r,u),p&&p.m(r,null),l||(h=Bp(s,"click",t[25]),l=!0)},p(t,n){g===(g=f(t))&&d?d.p(t,n):(d.d(1),d=g(t),d&&(d.c(),d.m(e,null))),t[1]>1?A?A.p(t,n):(A=mI(t),A.c(),A.m(o,i)):A&&(A.d(1),A=null),9&n[0]&&c!==(c=100!==t[0]||t[3])&&(s.disabled=c),t[2]?p||(p=EI(),p.c(),p.m(r,null)):p&&(p.d(1),p=null)},i:WA,o:WA,d(t){t&&yp(e),d.d(),t&&yp(n),t&&yp(r),A&&A.d(),p&&p.d(),l=!1,h()}}}function yI(t){let e;return{c(){e=mp("progress"),kp(e,"min","0"),kp(e,"max","100"),e.value=t[0]},m(t,n){pp(t,e,n)},p(t,n){1&n[0]&&(e.value=t[0])},d(t){t&&yp(e)}}}function II(t){let e;return{c(){e=mp("p"),e.textContent="Press the button to generate your own unique passport",kp(e,"class","text-center")},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function mI(t){let e,n,r,o,i;return{c(){e=mp("button"),n=wp("Give up"),e.disabled=r=100!==t[0]},m(r,s){pp(r,e,s),Ap(e,n),o||(i=Bp(e,"click",t[24]),o=!0)},p(t,n){1&n[0]&&r!==(r=100!==t[0])&&(e.disabled=r)},d(t){t&&yp(e),o=!1,i()}}}function EI(t){let e;return{c(){e=mp("danger"),e.textContent="Sorry.. RNG0D ignored your prayers, please try again",kp(e,"class","svelte-1rqfs0r")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function wI(t){let e;return{c(){e=mp("h1"),e.textContent="%nbsp;",kp(e,"aria-busy","true")},m(t,n){pp(t,e,n)},p:WA,i:WA,o:WA,d(t){t&&yp(e)}}}function bI(t){let e,n,r,o,i;return{c(){e=mp("a"),e.textContent="Anonkey",n=wp(" |\n        "),r=mp("a"),r.textContent="Import"},m(s,a){pp(s,e,a),pp(s,n,a),pp(s,r,a),o||(i=[Bp(e,"click",t[27]),Bp(r,"click",t[28])],o=!0)},p:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r),o=!1,tp(i)}}}function CI(t){let e,n,r,o,i;return{c(){e=mp("a"),e.textContent="Destroy",n=wp(" |\n        "),r=mp("a"),r.textContent="Backup"},m(s,a){pp(s,e,a),pp(s,n,a),pp(s,r,a),o||(i=[Bp(e,"click",t[26]),Bp(r,"click",Wy)],o=!0)},p:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r),o=!1,tp(i)}}}function BI(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[vI]},$$scope:{ctx:t}}}),e.$on("fade",t[32]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};192&n[0]|256&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function vI(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d;return{c(){e=mp("article"),n=mp("header"),n.innerHTML="<h5>Import Secret</h5>",r=bp(),o=mp("p"),o.textContent="Paste the secret as a hex-string",i=bp(),s=mp("textarea"),a=bp(),c=mp("footer"),u=mp("div"),l=mp("a"),l.textContent="Cancel",h=bp(),f=mp("a"),f.textContent="Import",kp(l,"role","button"),kp(f,"role","button"),kp(u,"class","row space-between")},m(A,p){pp(A,e,p),Ap(e,n),Ap(e,r),Ap(e,o),Ap(e,i),Ap(e,s),Qp(s,t[7]),Ap(e,a),Ap(e,c),Ap(c,u),Ap(u,l),Ap(u,h),Ap(u,f),g||(d=[Bp(s,"input",t[30]),Bp(l,"click",t[31]),Bp(f,"click",SI)],g=!0)},p(t,e){128&e[0]&&Qp(s,t[7])},d(t){t&&yp(e),g=!1,tp(d)}}}function _I(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[kI]},$$scope:{ctx:t}}}),e.$on("fade",t[34]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};32&n[0]|256&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function kI(t){let e,n,r,o,i,s,a,c,u;return{c(){e=mp("article"),n=mp("h3"),n.textContent="Welcome to True Decentralization",r=bp(),o=mp("div"),o.innerHTML="<p>Picochat is a <strong>coinless blockchain</strong>, there\n            are no super-nodes and everything is slightly different from\n            what you&#39;re used to.<br/>\n            But don&#39;t worry, it&#39;s all good.</p> \n          <p>First of all, you have to generate your own key.<br/>\n            It takes about a minute or two on a handheld device.<br/>\n            Once you&#39;ve found a one, keep it safe, it&#39;s your passport to hyperspace.\n            </p> \n          <p>If you don&#39;t care about location nor gender, then\n            feel free to use an <i>anonymous</i> key.<br/>\n            Trees say &quot;Thanks!&quot; </p> \n          <p>Please don&#39;t generate more keys than you need, mining of any form is a pointless waste of world-resources.\n            Hate to say it; but don&#39;t ever trade a key, it is <strong>insecure and dangerous</strong>.</p> \n          <p><i>The hyperspace is vast.<br/>\n            It&#39;s real-estate, just like air -\n            worth nothing while there&#39;s enough for everyone.<br/>\n            Let&#39;s keep it that way</i> </p>",i=bp(),s=mp("footer"),a=mp("button"),a.textContent="gotcha",kp(o,"class","about svelte-1rqfs0r")},m(l,h){pp(l,e,h),Ap(e,n),Ap(e,r),Ap(e,o),Ap(e,i),Ap(e,s),Ap(s,a),c||(u=Bp(a,"click",t[33]),c=!0)},p:WA,d(t){t&&yp(e),c=!1,u()}}}function xI(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v,_,k,x,S,Q,M,D,T,L,$,U,O,F,N,P;o=new aI({props:{id:"icon-info"}});let Y={ctx:t,current:null,token:null,hasCatch:!0,pending:wI,then:dI,catch:gI,error:38,blocks:[,,,]};function K(t,e){return t[3]?CI:bI}ry(t[17](),Y);let R=K(t),j=R(t),H=t[6]&&BI(t),V=t[5]&&_I(t);return{c(){e=mp("keygen-view"),n=mp("h1"),r=wp("Setup\n    "),ay(o.$$.fragment),i=bp(),s=mp("h5"),s.textContent="Gender",a=bp(),c=mp("fieldset"),u=mp("input"),l=bp(),h=mp("label"),h.textContent="M",f=bp(),g=mp("input"),d=bp(),A=mp("label"),A.textContent="F",p=bp(),y=mp("input"),I=bp(),m=mp("label"),m.textContent="NB",E=bp(),w=mp("br"),b=bp(),C=mp("h5"),C.textContent="IDSQR",B=bp(),v=mp("div"),_=mp("idsqr"),Y.block.c(),k=bp(),x=mp("div"),S=mp("small"),j.c(),Q=bp(),M=mp("br"),D=bp(),T=mp("button"),L=wp("next"),U=bp(),H&&H.c(),O=bp(),V&&V.c(),kp(u,"type","radio"),u.__value=1,u.value=u.__value,kp(u,"id","M"),kp(u,"name","gender"),t[21][0].push(u),kp(h,"for","M"),kp(g,"type","radio"),g.__value=0,g.value=g.__value,kp(g,"id","F"),kp(g,"name","gender"),t[21][0].push(g),kp(A,"for","F"),kp(y,"type","radio"),y.__value=2,y.value=y.__value,kp(y,"id","NB"),kp(y,"name","gender"),t[21][0].push(y),kp(m,"for","NB"),kp(_,"data-theme","dark"),kp(_,"class","flex column space-around"),kp(v,"class","flex column xcenter"),kp(x,"class","row end hpad"),T.disabled=$=!t[3],xp(e,"class","block container")},m($,K){pp($,e,K),Ap(e,n),Ap(n,r),cy(o,n,null),Ap(e,i),Ap(e,s),Ap(e,a),Ap(e,c),Ap(c,u),u.checked=u.__value===t[4],Ap(c,l),Ap(c,h),Ap(c,f),Ap(c,g),g.checked=g.__value===t[4],Ap(c,d),Ap(c,A),Ap(c,p),Ap(c,y),y.checked=y.__value===t[4],Ap(c,I),Ap(c,m),Ap(e,E),Ap(e,w),Ap(e,b),Ap(e,C),Ap(e,B),Ap(e,v),Ap(v,_),Y.block.m(_,Y.anchor=null),Y.mount=()=>_,Y.anchor=null,Ap(e,k),Ap(e,x),Ap(x,S),j.m(S,null),Ap(e,Q),Ap(e,M),Ap(e,D),Ap(e,T),Ap(T,L),Ap(e,U),H&&H.m(e,null),Ap(e,O),V&&V.m(e,null),F=!0,N||(P=[Bp(n,"click",t[19]),Bp(u,"change",t[20]),Bp(g,"change",t[22]),Bp(y,"change",t[23]),Bp(T,"click",t[29])],N=!0)},p(n,r){t=n,16&r[0]&&(u.checked=u.__value===t[4]),16&r[0]&&(g.checked=g.__value===t[4]),16&r[0]&&(y.checked=y.__value===t[4]),oy(Y,t,r),R===(R=K(t))&&j?j.p(t,r):(j.d(1),j=R(t),j&&(j.c(),j.m(S,null))),(!F||8&r[0]&&$!==($=!t[3]))&&(T.disabled=$),t[6]?H?(H.p(t,r),64&r[0]&&ey(H,1)):(H=BI(t),H.c(),ey(H,1),H.m(e,O)):H&&(Zp(),ny(H,1,1,(()=>{H=null})),ty()),t[5]?V?(V.p(t,r),32&r[0]&&ey(V,1)):(V=_I(t),V.c(),ey(V,1),V.m(e,null)):V&&(Zp(),ny(V,1,1,(()=>{V=null})),ty())},i(t){F||(ey(o.$$.fragment,t),ey(Y.block),ey(H),ey(V),F=!0)},o(t){ny(o.$$.fragment,t);for(let t=0;t<3;t+=1){ny(Y.blocks[t])}ny(H),ny(V),F=!1},d(n){n&&yp(e),uy(o),t[21][0].splice(t[21][0].indexOf(u),1),t[21][0].splice(t[21][0].indexOf(g),1),t[21][0].splice(t[21][0].indexOf(y),1),Y.block.d(),Y.token=null,Y=null,j.d(),H&&H.d(),V&&V.d(),N=!1,tp(P)}}}async function SI(){console.error("TODO: not yet implemented")}function QI(t,e,n){let r,o,i,s,a,c,u,l,h;const f=Ay(100);ap(t,f,(t=>n(0,o=t)));const g=Ay();ap(t,g,(t=>n(3,a=t)));const d=Ay(null);ap(t,d,(t=>n(35,r=t)));const A=Ay(0);ap(t,A,(t=>n(4,c=t)));const p=Ay(!1);ap(t,p,(t=>n(2,s=t)));const y=Ay(0);ap(t,y,(t=>n(1,i=t)));const I=Ay(!1);ap(t,I,(t=>n(6,l=t)));const m=Ay("");ap(t,m,(t=>n(7,h=t)));const E=Ay(!1);async function w(t=0){if(a)return;console.info(`roll(${t})`),dp(f,o=0,o),dp(p,s=!1,s);let e=null;for(let n=0;n<100&&(dp(f,o++,o),e=Cy(t<2?c:null,t<1?r:null,500),!e);n++)await new Promise((t=>setTimeout(t,100)));e?(await async function(t){await by.writeIdentity(t),Oy(!0)}(e.sk),dp(g,a=e.sk,a)):(dp(p,s=!0,s),dp(y,i++,i)),dp(f,o=100,o)}ap(t,E,(t=>n(5,u=t)));return[o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,async function(){try{const t=await by.readIdentity();if(!t)return;dp(g,a=t,a);const e=By(t.slice(32));dp(A,c=e.sex,c),dp(d,r=e.geohash,r)}catch(t){throw console.error("loadKeychain() failed:",t),t}},w,()=>dp(E,u=!0,u),function(){c=this.__value,A.set(c)},[[]],function(){c=this.__value,A.set(c)},function(){c=this.__value,A.set(c)},()=>w(1),()=>w(1),()=>Jy(!0),()=>w(2),()=>dp(I,l=!0,l),()=>Uv("/profile"),function(){h=this.value,m.set(h)},()=>dp(I,l=!1,l),()=>dp(I,l=!1,l),()=>dp(E,u=!1,u),()=>dp(E,u=!1,u)]}class MI extends fy{constructor(t){super(),hy(this,t,QI,xI,np,{},null,[-1,-1])}}var DI={exports:{}};!function(t,e){t.exports=function(){var t=1e3,e=6e4,n=36e5,r="millisecond",o="second",i="minute",s="hour",a="day",c="week",u="month",l="quarter",h="year",f="date",g="Invalid Date",d=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,p={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_")},y=function(t,e,n){var r=String(t);return!r||r.length>=e?t:""+Array(e+1-r.length).join(n)+t},I={s:y,z:function(t){var e=-t.utcOffset(),n=Math.abs(e),r=Math.floor(n/60),o=n%60;return(e<=0?"+":"-")+y(r,2,"0")+":"+y(o,2,"0")},m:function t(e,n){if(e.date()<n.date())return-t(n,e);var r=12*(n.year()-e.year())+(n.month()-e.month()),o=e.clone().add(r,u),i=n-o<0,s=e.clone().add(r+(i?-1:1),u);return+(-(r+(n-o)/(i?o-s:s-o))||0)},a:function(t){return t<0?Math.ceil(t)||0:Math.floor(t)},p:function(t){return{M:u,y:h,w:c,d:a,D:f,h:s,m:i,s:o,ms:r,Q:l}[t]||String(t||"").toLowerCase().replace(/s$/,"")},u:function(t){return void 0===t}},m="en",E={};E[m]=p;var w=function(t){return t instanceof v},b=function t(e,n,r){var o;if(!e)return m;if("string"==typeof e){var i=e.toLowerCase();E[i]&&(o=i),n&&(E[i]=n,o=i);var s=e.split("-");if(!o&&s.length>1)return t(s[0])}else{var a=e.name;E[a]=e,o=a}return!r&&o&&(m=o),o||!r&&m},C=function(t,e){if(w(t))return t.clone();var n="object"==typeof e?e:{};return n.date=t,n.args=arguments,new v(n)},B=I;B.l=b,B.i=w,B.w=function(t,e){return C(t,{locale:e.$L,utc:e.$u,x:e.$x,$offset:e.$offset})};var v=function(){function p(t){this.$L=b(t.locale,null,!0),this.parse(t)}var y=p.prototype;return y.parse=function(t){this.$d=function(t){var e=t.date,n=t.utc;if(null===e)return new Date(NaN);if(B.u(e))return new Date;if(e instanceof Date)return new Date(e);if("string"==typeof e&&!/Z$/i.test(e)){var r=e.match(d);if(r){var o=r[2]-1||0,i=(r[7]||"0").substring(0,3);return n?new Date(Date.UTC(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)):new Date(r[1],o,r[3]||1,r[4]||0,r[5]||0,r[6]||0,i)}}return new Date(e)}(t),this.$x=t.x||{},this.init()},y.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},y.$utils=function(){return B},y.isValid=function(){return!(this.$d.toString()===g)},y.isSame=function(t,e){var n=C(t);return this.startOf(e)<=n&&n<=this.endOf(e)},y.isAfter=function(t,e){return C(t)<this.startOf(e)},y.isBefore=function(t,e){return this.endOf(e)<C(t)},y.$g=function(t,e,n){return B.u(t)?this[e]:this.set(n,t)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(t,e){var n=this,r=!!B.u(e)||e,l=B.p(t),g=function(t,e){var o=B.w(n.$u?Date.UTC(n.$y,e,t):new Date(n.$y,e,t),n);return r?o:o.endOf(a)},d=function(t,e){return B.w(n.toDate()[t].apply(n.toDate("s"),(r?[0,0,0,0]:[23,59,59,999]).slice(e)),n)},A=this.$W,p=this.$M,y=this.$D,I="set"+(this.$u?"UTC":"");switch(l){case h:return r?g(1,0):g(31,11);case u:return r?g(1,p):g(0,p+1);case c:var m=this.$locale().weekStart||0,E=(A<m?A+7:A)-m;return g(r?y-E:y+(6-E),p);case a:case f:return d(I+"Hours",0);case s:return d(I+"Minutes",1);case i:return d(I+"Seconds",2);case o:return d(I+"Milliseconds",3);default:return this.clone()}},y.endOf=function(t){return this.startOf(t,!1)},y.$set=function(t,e){var n,c=B.p(t),l="set"+(this.$u?"UTC":""),g=(n={},n[a]=l+"Date",n[f]=l+"Date",n[u]=l+"Month",n[h]=l+"FullYear",n[s]=l+"Hours",n[i]=l+"Minutes",n[o]=l+"Seconds",n[r]=l+"Milliseconds",n)[c],d=c===a?this.$D+(e-this.$W):e;if(c===u||c===h){var A=this.clone().set(f,1);A.$d[g](d),A.init(),this.$d=A.set(f,Math.min(this.$D,A.daysInMonth())).$d}else g&&this.$d[g](d);return this.init(),this},y.set=function(t,e){return this.clone().$set(t,e)},y.get=function(t){return this[B.p(t)]()},y.add=function(r,l){var f,g=this;r=Number(r);var d=B.p(l),A=function(t){var e=C(g);return B.w(e.date(e.date()+Math.round(t*r)),g)};if(d===u)return this.set(u,this.$M+r);if(d===h)return this.set(h,this.$y+r);if(d===a)return A(1);if(d===c)return A(7);var p=(f={},f[i]=e,f[s]=n,f[o]=t,f)[d]||1,y=this.$d.getTime()+r*p;return B.w(y,this)},y.subtract=function(t,e){return this.add(-1*t,e)},y.format=function(t){var e=this,n=this.$locale();if(!this.isValid())return n.invalidDate||g;var r=t||"YYYY-MM-DDTHH:mm:ssZ",o=B.z(this),i=this.$H,s=this.$m,a=this.$M,c=n.weekdays,u=n.months,l=function(t,n,o,i){return t&&(t[n]||t(e,r))||o[n].slice(0,i)},h=function(t){return B.s(i%12||12,t,"0")},f=n.meridiem||function(t,e,n){var r=t<12?"AM":"PM";return n?r.toLowerCase():r},d={YY:String(this.$y).slice(-2),YYYY:this.$y,M:a+1,MM:B.s(a+1,2,"0"),MMM:l(n.monthsShort,a,u,3),MMMM:l(u,a),D:this.$D,DD:B.s(this.$D,2,"0"),d:String(this.$W),dd:l(n.weekdaysMin,this.$W,c,2),ddd:l(n.weekdaysShort,this.$W,c,3),dddd:c[this.$W],H:String(i),HH:B.s(i,2,"0"),h:h(1),hh:h(2),a:f(i,s,!0),A:f(i,s,!1),m:String(s),mm:B.s(s,2,"0"),s:String(this.$s),ss:B.s(this.$s,2,"0"),SSS:B.s(this.$ms,3,"0"),Z:o};return r.replace(A,(function(t,e){return e||d[t]||o.replace(":","")}))},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(r,f,g){var d,A=B.p(f),p=C(r),y=(p.utcOffset()-this.utcOffset())*e,I=this-p,m=B.m(this,p);return m=(d={},d[h]=m/12,d[u]=m,d[l]=m/3,d[c]=(I-y)/6048e5,d[a]=(I-y)/864e5,d[s]=I/n,d[i]=I/e,d[o]=I/t,d)[A]||I,g?m:B.a(m)},y.daysInMonth=function(){return this.endOf(u).$D},y.$locale=function(){return E[this.$L]},y.locale=function(t,e){if(!t)return this.$L;var n=this.clone(),r=b(t,e,!0);return r&&(n.$L=r),n},y.clone=function(){return B.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},p}(),_=v.prototype;return C.prototype=_,[["$ms",r],["$s",o],["$m",i],["$H",s],["$W",a],["$M",u],["$y",h],["$D",f]].forEach((function(t){_[t[1]]=function(e){return this.$g(e,t[0],t[1])}})),C.extend=function(t,e){return t.$i||(t(e,v,C),t.$i=!0),C},C.locale=b,C.isDayjs=w,C.unix=function(t){return C(1e3*t)},C.en=E[m],C.Ls=E,C.p={},C}()}(DI);var TI=DI.exports;function LI(t){let e,n=TI.duration(t[1]>0?t[1]:0).format(t[0])+"";return{c(){e=wp(n)},m(t,n){pp(t,e,n)},p(t,r){3&r&&n!==(n=TI.duration(t[1]>0?t[1]:0).format(t[0])+"")&&Sp(e,n)},d(t){t&&yp(e)}}}function $I(t){let e,n,r=t[3](t[1]>0?t[1]:0)+"";return{c(){e=new Tp(!1),n=Cp(),e.a=n},m(t,o){e.m(r,t,o),pp(t,n,o)},p(t,n){2&n&&r!==(r=t[3](t[1]>0?t[1]:0)+"")&&e.p(r)},d(t){t&&yp(n),t&&e.d()}}}function UI(t){let e,n;function r(t,e){return 1&e&&(n=null),null==n&&(n=!!/^+$/.test(t[0])),n?$I:LI}let o=r(t,-1),i=o(t);return{c(){e=mp("timer"),i.c()},m(t,n){pp(t,e,n),i.m(e,null)},p(t,[n]){o===(o=r(t,n))&&i?i.p(t,n):(i.d(1),i=o(t),i&&(i.c(),i.m(e,null)))},i:WA,o:WA,d(t){t&&yp(e),i.d()}}}function OI(t,e,n){let r,{expiresAt:o}=e,{format:i="HH:mm"}=e,s=null;const a=Ay(o-Date.now());return ap(t,a,(t=>n(1,r=t))),Up((()=>(s&&(clearInterval(s),s=null),s=setInterval((()=>{dp(a,r=o-Date.now(),r),r<=0&&clearInterval(s)}),200),()=>{clearInterval(s)}))),t.$$set=t=>{"expiresAt"in t&&n(4,o=t.expiresAt),"format"in t&&n(0,i=t.format)},[i,r,a,function(t){const e=t/1e3/60;switch(i){case"":return Math.floor(e);case"":return`${Math.floor(e)}<small>${(e-Math.floor(e)).toFixed(1).substr(1)}</small>`;case"":return`${Math.floor(e)}<small>${(e-Math.floor(e)).toFixed(2).substr(1)}</small>`}},o]}class FI extends fy{constructor(t){super(),hy(this,t,OI,UI,np,{expiresAt:4,format:0})}}var NI={},PI={},YI={};Object.defineProperty(YI,"__esModule",{value:!0}),YI.areaConversion=YI.timeConversion=YI.distanceConversion=YI.altitudeKeys=YI.latitudeKeys=YI.longitudeKeys=YI.MAXLON=YI.MINLON=YI.MAXLAT=YI.MINLAT=YI.earthRadius=YI.sexagesimalPattern=void 0;YI.sexagesimalPattern=/^([0-9]{1,3})\s*([0-9]{1,3}(?:\.(?:[0-9]{1,}))?)[']\s*(([0-9]{1,3}(\.([0-9]{1,}))?)["]\s*)?([NEOSW]?)$/;YI.earthRadius=6378137;YI.MINLAT=-90;YI.MAXLAT=90;YI.MINLON=-180;YI.MAXLON=180;YI.longitudeKeys=["lng","lon","longitude",0];YI.latitudeKeys=["lat","latitude",1];YI.altitudeKeys=["alt","altitude","elevation","elev",2];YI.distanceConversion={m:1,km:.001,cm:100,mm:1e3,mi:1/1609.344,sm:1/1852.216,ft:100/30.48,in:100/2.54,yd:1/.9144};YI.timeConversion={m:60,h:3600,d:86400};var KI={m2:1,km2:1e-6,ha:1e-4,a:.01,ft2:10.763911,yd2:1.19599,in2:1550.0031};YI.areaConversion=KI,KI.sqm=KI.m2,KI.sqkm=KI.km2,KI.sqft=KI.ft2,KI.sqyd=KI.yd2,KI.sqin=KI.in2;var RI={};Object.defineProperty(RI,"__esModule",{value:!0}),RI.default=void 0;var jI=function(t,e){return e.reduce((function(e,n){if(null==t)throw new Error("'".concat(t,"' is no valid coordinate."));return Object.prototype.hasOwnProperty.call(t,n)&&void 0!==n&&void 0===e?(e=n,n):e}),void 0)};RI.default=jI;var HI={},VI={};Object.defineProperty(VI,"__esModule",{value:!0}),VI.default=void 0;var GI=function(t){var e=t.toString().trim();return!isNaN(parseFloat(e))&&parseFloat(e)===Number(e)};VI.default=GI;var qI={};Object.defineProperty(qI,"__esModule",{value:!0}),qI.default=void 0;var zI=YI,JI=function(t){return zI.sexagesimalPattern.test(t.toString().trim())};qI.default=JI;var WI={};Object.defineProperty(WI,"__esModule",{value:!0}),WI.default=void 0;var XI=YI,ZI=function(t){var e=new RegExp(XI.sexagesimalPattern).exec(t.toString().trim());if(null==e)throw new Error("Given value is not in sexagesimal format");var n=Number(e[2])/60||0,r=Number(e[4])/3600||0,o=parseFloat(e[1])+n+r;return["S","W"].includes(e[7])?-o:o};WI.default=ZI;var tm={},em={};Object.defineProperty(em,"__esModule",{value:!0}),em.default=void 0;var nm,rm=YI,om=(nm=RI)&&nm.__esModule?nm:{default:nm};function im(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function sm(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?im(Object(n),!0).forEach((function(e){am(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):im(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function am(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var cm=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{longitude:rm.longitudeKeys,latitude:rm.latitudeKeys,altitude:rm.altitudeKeys},n=(0,om.default)(t,e.longitude),r=(0,om.default)(t,e.latitude),o=(0,om.default)(t,e.altitude);return sm({latitude:r,longitude:n},o?{altitude:o}:{})};em.default=cm;var um={};Object.defineProperty(um,"__esModule",{value:!0}),um.default=void 0;var lm=dm(VI),hm=dm(qI),fm=dm(WI),gm=YI;function dm(t){return t&&t.__esModule?t:{default:t}}var Am=function t(e){return(0,lm.default)(e)?!(parseFloat(e)>gm.MAXLAT||e<gm.MINLAT):!!(0,hm.default)(e)&&t((0,fm.default)(e))};um.default=Am;var pm={};Object.defineProperty(pm,"__esModule",{value:!0}),pm.default=void 0;var ym=wm(VI),Im=wm(qI),mm=wm(WI),Em=YI;function wm(t){return t&&t.__esModule?t:{default:t}}var bm=function t(e){return(0,ym.default)(e)?!(parseFloat(e)>Em.MAXLON||e<Em.MINLON):!!(0,Im.default)(e)&&t((0,mm.default)(e))};pm.default=bm,Object.defineProperty(tm,"__esModule",{value:!0}),tm.default=void 0;var Cm=_m(em),Bm=_m(um),vm=_m(pm);function _m(t){return t&&t.__esModule?t:{default:t}}var km=function(t){var e=(0,Cm.default)(t),n=e.latitude,r=e.longitude;if(Array.isArray(t)&&t.length>=2)return(0,vm.default)(t[0])&&(0,Bm.default)(t[1]);if(void 0===n||void 0===r)return!1;var o=t[r],i=t[n];return void 0!==i&&void 0!==o&&(!1!==(0,Bm.default)(i)&&!1!==(0,vm.default)(o))};tm.default=km,Object.defineProperty(HI,"__esModule",{value:!0}),HI.default=void 0;var xm=Tm(VI),Sm=Tm(qI),Qm=Tm(WI),Mm=Tm(tm),Dm=Tm(em);function Tm(t){return t&&t.__esModule?t:{default:t}}function Lm(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function $m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Lm(Object(n),!0).forEach((function(e){Um(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Lm(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Um(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var Om=function t(e){if((0,xm.default)(e))return Number(e);if((0,Sm.default)(e))return(0,Qm.default)(e);if((0,Mm.default)(e)){var n=(0,Dm.default)(e);return Array.isArray(e)?e.map((function(e,n){return[0,1].includes(n)?t(e):e})):$m($m($m({},e),n.latitude&&Um({},n.latitude,t(e[n.latitude]))),n.longitude&&Um({},n.longitude,t(e[n.longitude])))}return Array.isArray(e)?e.map((function(e){return(0,Mm.default)(e)?t(e):e})):e};HI.default=Om,Object.defineProperty(PI,"__esModule",{value:!0}),PI.default=void 0;var Fm=YI,Nm=Ym(RI),Pm=Ym(HI);function Ym(t){return t&&t.__esModule?t:{default:t}}var Km=function(t,e){var n=(0,Nm.default)(t,Fm.latitudeKeys);if(null!=n){var r=t[n];return!0===e?r:(0,Pm.default)(r)}};PI.default=Km;var Rm={};Object.defineProperty(Rm,"__esModule",{value:!0}),Rm.default=void 0;var jm=YI,Hm=Gm(RI),Vm=Gm(HI);function Gm(t){return t&&t.__esModule?t:{default:t}}var qm=function(t,e){var n=(0,Hm.default)(t,jm.longitudeKeys);if(null!=n){var r=t[n];return!0===e?r:(0,Vm.default)(r)}};Rm.default=qm;var zm={};Object.defineProperty(zm,"__esModule",{value:!0}),zm.default=void 0;var Jm=function(t){return t*Math.PI/180};zm.default=Jm;var Wm={};Object.defineProperty(Wm,"__esModule",{value:!0}),Wm.default=void 0;var Xm=function(t){return 180*t/Math.PI};Wm.default=Xm,Object.defineProperty(NI,"__esModule",{value:!0}),NI.default=void 0;var Zm=oE(PI),tE=oE(Rm),eE=oE(zm),nE=oE(Wm),rE=YI;function oE(t){return t&&t.__esModule?t:{default:t}}var iE=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:6371e3,o=(0,Zm.default)(t),i=(0,tE.default)(t),s=e/r,a=(0,eE.default)(n),c=(0,eE.default)(o),u=(0,eE.default)(i),l=Math.asin(Math.sin(c)*Math.cos(s)+Math.cos(c)*Math.sin(s)*Math.cos(a)),h=u+Math.atan2(Math.sin(a)*Math.sin(s)*Math.cos(c),Math.cos(s)-Math.sin(c)*Math.sin(l)),f=(0,nE.default)(h);return(f<rE.MINLON||f>rE.MAXLON)&&(h=(h+3*Math.PI)%(2*Math.PI)-Math.PI,f=(0,nE.default)(h)),{latitude:(0,nE.default)(l),longitude:f}};NI.default=iE;var sE={};Object.defineProperty(sE,"__esModule",{value:!0}),sE.default=void 0;var aE=YI,cE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",n=aE.areaConversion[e];if(n)return t*n;throw new Error("Invalid unit used for area conversion.")};sE.default=cE;var uE={};Object.defineProperty(uE,"__esModule",{value:!0}),uE.default=void 0;var lE=YI,hE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"m",n=lE.distanceConversion[e];if(n)return t*n;throw new Error("Invalid unit used for distance conversion.")};uE.default=hE;var fE={};Object.defineProperty(fE,"__esModule",{value:!0}),fE.default=void 0;var gE=YI,dE=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"kmh";switch(e){case"kmh":return t*gE.timeConversion.h*gE.distanceConversion.km;case"mph":return t*gE.timeConversion.h*gE.distanceConversion.mi;default:return t}};fE.default=dE;var AE={};function pE(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return yE(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yE(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yE(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(AE,"__esModule",{value:!0}),AE.default=void 0;var IE=function(t){var e=pE(t.toString().split("."),2),n=e[0],r=e[1],o=Math.abs(Number(n)),i=60*Number("0."+(r||0)),s=i.toString().split("."),a=Math.floor(i),c=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,n=Math.pow(10,e);return Math.round(t*n)/n}(60*Number("0."+(s[1]||0))).toString(),u=pE(c.split("."),2),l=u[0],h=u[1],f=void 0===h?"0":h;return o+" "+a.toString().padStart(2,"0")+"' "+l.padStart(2,"0")+"."+f.padEnd(1,"0")+'"'};AE.default=IE;var mE={},EE={},wE={},bE={};Object.defineProperty(bE,"__esModule",{value:!0}),bE.default=void 0;var CE=function(t){return t>1?1:t<-1?-1:t};bE.default=CE,Object.defineProperty(wE,"__esModule",{value:!0}),wE.default=void 0;var BE=SE(PI),vE=SE(Rm),_E=SE(zm),kE=SE(bE),xE=YI;function SE(t){return t&&t.__esModule?t:{default:t}}var QE=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;n=void 0===n||isNaN(n)?1:n;var r=(0,BE.default)(t),o=(0,vE.default)(t),i=(0,BE.default)(e),s=(0,vE.default)(e),a=Math.acos((0,kE.default)(Math.sin((0,_E.default)(i))*Math.sin((0,_E.default)(r))+Math.cos((0,_E.default)(i))*Math.cos((0,_E.default)(r))*Math.cos((0,_E.default)(o)-(0,_E.default)(s))))*xE.earthRadius;return Math.round(a/n)*n};wE.default=QE,Object.defineProperty(EE,"__esModule",{value:!0}),EE.default=void 0;var ME=function(t){return t&&t.__esModule?t:{default:t}}(wE);var DE=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ME.default;return n="function"==typeof n?n:ME.default,e.slice().sort((function(e,r){return n(t,e)-n(t,r)}))};EE.default=DE,Object.defineProperty(mE,"__esModule",{value:!0}),mE.default=void 0;var TE=function(t){return t&&t.__esModule?t:{default:t}}(EE);var LE=function(t,e){return(0,TE.default)(t,e)[0]};mE.default=LE;var $E={};Object.defineProperty($E,"__esModule",{value:!0}),$E.default=void 0;var UE=PE(zm),OE=PE(PI),FE=PE(Rm),NE=YI;function PE(t){return t&&t.__esModule?t:{default:t}}var YE=function(t){var e=0;if(t.length>2){for(var n,r,o,i=0;i<t.length;i++){i===t.length-2?(n=t.length-2,r=t.length-1,o=0):i===t.length-1?(n=t.length-1,r=0,o=1):(n=i,r=i+1,o=i+2);var s=(0,FE.default)(t[n]),a=(0,OE.default)(t[r]),c=(0,FE.default)(t[o]);e+=((0,UE.default)(c)-(0,UE.default)(s))*Math.sin((0,UE.default)(a))}e=e*NE.earthRadius*NE.earthRadius/2}return Math.abs(e)};$E.default=YE;var KE={};Object.defineProperty(KE,"__esModule",{value:!0}),KE.default=void 0;var RE=HE(PI),jE=HE(Rm);function HE(t){return t&&t.__esModule?t:{default:t}}var VE=function(t){if(!1===Array.isArray(t)||0===t.length)throw new Error("No points were given.");return t.reduce((function(t,e){var n=(0,RE.default)(e),r=(0,jE.default)(e);return{maxLat:Math.max(n,t.maxLat),minLat:Math.min(n,t.minLat),maxLng:Math.max(r,t.maxLng),minLng:Math.min(r,t.minLng)}}),{maxLat:-1/0,minLat:1/0,maxLng:-1/0,minLng:1/0})};KE.default=VE;var GE={};Object.defineProperty(GE,"__esModule",{value:!0}),GE.default=void 0;var qE=ZE(PI),zE=ZE(Rm),JE=ZE(zm),WE=ZE(Wm),XE=YI;function ZE(t){return t&&t.__esModule?t:{default:t}}var tw=function(t,e){var n,r,o=(0,qE.default)(t),i=(0,zE.default)(t),s=(0,JE.default)(o),a=(0,JE.default)(i),c=e/XE.earthRadius,u=s-c,l=s+c,h=(0,JE.default)(XE.MAXLAT),f=(0,JE.default)(XE.MINLAT),g=(0,JE.default)(XE.MAXLON),d=(0,JE.default)(XE.MINLON);if(u>f&&l<h){var A=Math.asin(Math.sin(c)/Math.cos(s));(n=a-A)<d&&(n+=2*Math.PI),(r=a+A)>g&&(r-=2*Math.PI)}else u=Math.max(u,f),l=Math.min(l,h),n=d,r=g;return[{latitude:(0,WE.default)(u),longitude:(0,WE.default)(n)},{latitude:(0,WE.default)(l),longitude:(0,WE.default)(r)}]};GE.default=tw;var ew={};Object.defineProperty(ew,"__esModule",{value:!0}),ew.default=void 0;var nw=sw(PI),rw=sw(Rm),ow=sw(zm),iw=sw(Wm);function sw(t){return t&&t.__esModule?t:{default:t}}var aw=function(t){if(!1===Array.isArray(t)||0===t.length)return!1;var e=t.length,n=t.reduce((function(t,e){var n=(0,ow.default)((0,nw.default)(e)),r=(0,ow.default)((0,rw.default)(e));return{X:t.X+Math.cos(n)*Math.cos(r),Y:t.Y+Math.cos(n)*Math.sin(r),Z:t.Z+Math.sin(n)}}),{X:0,Y:0,Z:0}),r=n.X/e,o=n.Y/e,i=n.Z/e;return{longitude:(0,iw.default)(Math.atan2(o,r)),latitude:(0,iw.default)(Math.atan2(i,Math.sqrt(r*r+o*o)))}};ew.default=aw;var cw={};Object.defineProperty(cw,"__esModule",{value:!0}),cw.default=void 0;var uw=function(t){return t&&t.__esModule?t:{default:t}}(KE);var lw=function(t){var e=(0,uw.default)(t),n=e.minLat+(e.maxLat-e.minLat)/2,r=e.minLng+(e.maxLng-e.minLng)/2;return{latitude:parseFloat(n.toFixed(6)),longitude:parseFloat(r.toFixed(6))}};cw.default=lw;var hw={},fw={};Object.defineProperty(fw,"__esModule",{value:!0}),fw.default=void 0;var gw=yw(PI),dw=yw(Rm),Aw=yw(zm),pw=yw(Wm);function yw(t){return t&&t.__esModule?t:{default:t}}var Iw=function(t,e){var n=(0,Aw.default)((0,dw.default)(e))-(0,Aw.default)((0,dw.default)(t)),r=Math.log(Math.tan((0,Aw.default)((0,gw.default)(e))/2+Math.PI/4)/Math.tan((0,Aw.default)((0,gw.default)(t))/2+Math.PI/4));return Math.abs(n)>Math.PI&&(n=n>0?-1*(2*Math.PI-n):2*Math.PI+n),((0,pw.default)(Math.atan2(n,r))+360)%360};fw.default=Iw,Object.defineProperty(hw,"__esModule",{value:!0}),hw.default=void 0;var mw=function(t){return t&&t.__esModule?t:{default:t}}(fw);var Ew=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:mw.default,r="function"==typeof n?n(t,e):(0,mw.default)(t,e);if(isNaN(r))throw new Error("Could not calculate bearing for given points. Check your bearing function");switch(Math.round(r/22.5)){case 1:return"NNE";case 2:return"NE";case 3:return"ENE";case 4:return"E";case 5:return"ESE";case 6:return"SE";case 7:return"SSE";case 8:return"S";case 9:return"SSW";case 10:return"SW";case 11:return"WSW";case 12:return"W";case 13:return"WNW";case 14:return"NW";case 15:return"NNW";default:return"N"}};hw.default=Ew;var ww={};Object.defineProperty(ww,"__esModule",{value:!0}),ww.default=void 0;var bw=Bw(wE),Cw=Bw(bE);function Bw(t){return t&&t.__esModule?t:{default:t}}var vw=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,o=(0,bw.default)(e,t,r),i=(0,bw.default)(t,n,r),s=(0,bw.default)(e,n,r),a=Math.acos((0,Cw.default)((o*o+s*s-i*i)/(2*o*s))),c=Math.acos((0,Cw.default)((i*i+s*s-o*o)/(2*i*s)));return a>Math.PI/2?o:c>Math.PI/2?i:Math.sin(a)*o};ww.default=vw;var _w={};Object.defineProperty(_w,"__esModule",{value:!0}),_w.default=void 0;var kw=Mw(PI),xw=Mw(Rm),Sw=Mw(zm),Qw=Mw(Wm);function Mw(t){return t&&t.__esModule?t:{default:t}}var Dw=function(t,e){var n=(0,kw.default)(e),r=(0,xw.default)(e),o=(0,kw.default)(t),i=(0,xw.default)(t);return((0,Qw.default)(Math.atan2(Math.sin((0,Sw.default)(r)-(0,Sw.default)(i))*Math.cos((0,Sw.default)(n)),Math.cos((0,Sw.default)(o))*Math.sin((0,Sw.default)(n))-Math.sin((0,Sw.default)(o))*Math.cos((0,Sw.default)(n))*Math.cos((0,Sw.default)(r)-(0,Sw.default)(i))))+360)%360};_w.default=Dw;var Tw={};Object.defineProperty(Tw,"__esModule",{value:!0}),Tw.default=void 0;var Lw=function(t){return t&&t.__esModule?t:{default:t}}(wE);function $w(t){return $w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$w(t)}var Uw=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lw.default;return t.reduce((function(t,n){return"object"===$w(t)&&null!==t.last&&(t.distance+=e(n,t.last)),t.last=n,t}),{last:null,distance:0}).distance};Tw.default=Uw;var Ow={};Object.defineProperty(Ow,"__esModule",{value:!0}),Ow.default=void 0;var Fw=Kw(PI),Nw=Kw(Rm),Pw=Kw(zm),Yw=YI;function Kw(t){return t&&t.__esModule?t:{default:t}}var Rw=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;n=void 0===n||isNaN(n)?1:n;var r,o,i,s,a,c,u,l=(0,Fw.default)(t),h=(0,Nw.default)(t),f=(0,Fw.default)(e),g=(0,Nw.default)(e),d=6356752.314245,A=1/298.257223563,p=(0,Pw.default)(g-h),y=Math.atan((1-A)*Math.tan((0,Pw.default)(parseFloat(l)))),I=Math.atan((1-A)*Math.tan((0,Pw.default)(parseFloat(f)))),m=Math.sin(y),E=Math.cos(y),w=Math.sin(I),b=Math.cos(I),C=p,B=100;do{var v=Math.sin(C),_=Math.cos(C);if(0===(c=Math.sqrt(b*v*(b*v)+(E*w-m*b*_)*(E*w-m*b*_))))return 0;r=m*w+E*b*_,o=Math.atan2(c,r),a=r-2*m*w/(s=1-(i=E*b*v/c)*i),isNaN(a)&&(a=0);var k=A/16*s*(4+A*(4-3*s));u=C,C=p+(1-k)*A*i*(o+k*c*(a+k*r*(2*a*a-1)))}while(Math.abs(C-u)>1e-12&&--B>0);if(0===B)return NaN;var x=s*(Yw.earthRadius*Yw.earthRadius-d*d)/(d*d),S=1+x/16384*(4096+x*(x*(320-175*x)-768)),Q=x/1024*(256+x*(x*(74-47*x)-128)),M=Q*c*(a+Q/4*(r*(2*a*a-1)-Q/6*a*(4*c*c-3)*(4*a*a-3))),D=d*S*(o-M);return Math.round(D/n)*n};Ow.default=Rw;var jw={};Object.defineProperty(jw,"__esModule",{value:!0}),jw.default=void 0;var Hw=function(t){return/^NNE|NE|NNW|N$/.test(t)?"N":/^ENE|E|ESE|SE$/.test(t)?"E":/^SSE|S|SSW|SW$/.test(t)?"S":/^WSW|W|WNW|NW$/.test(t)?"W":void 0};jw.default=Hw;var Vw={};Object.defineProperty(Vw,"__esModule",{value:!0}),Vw.default=void 0;var Gw=function(t){return t&&t.__esModule?t:{default:t}}(wE);var qw=function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Gw.default,r=n(t,e),o=Number(e.time)-Number(t.time),i=r/o*1e3;return i};Vw.default=qw;var zw={};Object.defineProperty(zw,"__esModule",{value:!0}),zw.default=void 0;var Jw=function(t){return t&&t.__esModule?t:{default:t}}(wE);var Ww=function(t,e,n){return(0,Jw.default)(e,t)+(0,Jw.default)(t,n)===(0,Jw.default)(e,n)};zw.default=Ww;var Xw={};Object.defineProperty(Xw,"__esModule",{value:!0}),Xw.default=void 0;var Zw=eb(PI),tb=eb(Rm);function eb(t){return t&&t.__esModule?t:{default:t}}var nb=function(t,e){for(var n=!1,r=e.length,o=-1,i=r-1;++o<r;i=o)((0,tb.default)(e[o])<=(0,tb.default)(t)&&(0,tb.default)(t)<(0,tb.default)(e[i])||(0,tb.default)(e[i])<=(0,tb.default)(t)&&(0,tb.default)(t)<(0,tb.default)(e[o]))&&(0,Zw.default)(t)<((0,Zw.default)(e[i])-(0,Zw.default)(e[o]))*((0,tb.default)(t)-(0,tb.default)(e[o]))/((0,tb.default)(e[i])-(0,tb.default)(e[o]))+(0,Zw.default)(e[o])&&(n=!n);return n};Xw.default=nb;var rb={};Object.defineProperty(rb,"__esModule",{value:!0}),rb.default=void 0;var ob=function(t){return t&&t.__esModule?t:{default:t}}(ww);var ib=function(t,e,n,r){return(0,ob.default)(t,e,n)<r};rb.default=ib;var sb={};Object.defineProperty(sb,"__esModule",{value:!0}),sb.default=void 0;var ab=function(t){return t&&t.__esModule?t:{default:t}}(wE);var cb=function(t,e,n){return(0,ab.default)(t,e)<n};sb.default=cb;var ub={};function lb(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(o)throw i}}return n}(t,e)||function(t,e){if(!t)return;if("string"==typeof t)return hb(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hb(t,e)}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function hb(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}Object.defineProperty(ub,"__esModule",{value:!0}),ub.default=void 0;var fb=function(t){if(!t.startsWith("POLYGON"))throw new Error("Invalid wkt.");return t.slice(t.indexOf("(")+2,t.indexOf(")")).split(", ").map((function(t){var e=lb(t.split(" "),2),n=e[0],r=e[1];return{longitude:parseFloat(n),latitude:parseFloat(r)}}))};function gb(t){let e,n;return{c(){e=mp("img"),kp(e,"class","bimg"),kp(e,"style",t[1]),ip(e.src,n=zy(t[0]))||kp(e,"src",n)},m(t,n){pp(t,e,n)},p(t,[r]){1&r&&!ip(e.src,n=zy(t[0]))&&kp(e,"src",n)},i:WA,o:WA,d(t){t&&yp(e)}}}function db(t,e,n){let{src:r=null}=e,{size:o=null}=e;const i=o?`width: ${o}; height: ${o}`:"";return t.$$set=t=>{"src"in t&&n(0,r=t.src),"size"in t&&n(2,o=t.size)},[r,i,o]}ub.default=fb,function(t){Object.defineProperty(t,"__esModule",{value:!0});var e={computeDestinationPoint:!0,convertArea:!0,convertDistance:!0,convertSpeed:!0,decimalToSexagesimal:!0,findNearest:!0,getAreaOfPolygon:!0,getBounds:!0,getBoundsOfDistance:!0,getCenter:!0,getCenterOfBounds:!0,getCompassDirection:!0,getCoordinateKey:!0,getCoordinateKeys:!0,getDistance:!0,getDistanceFromLine:!0,getGreatCircleBearing:!0,getLatitude:!0,getLongitude:!0,getPathLength:!0,getPreciseDistance:!0,getRhumbLineBearing:!0,getRoughCompassDirection:!0,getSpeed:!0,isDecimal:!0,isPointInLine:!0,isPointInPolygon:!0,isPointNearLine:!0,isPointWithinRadius:!0,isSexagesimal:!0,isValidCoordinate:!0,isValidLatitude:!0,isValidLongitude:!0,orderByDistance:!0,sexagesimalToDecimal:!0,toDecimal:!0,toRad:!0,toDeg:!0,wktToPolygon:!0};Object.defineProperty(t,"computeDestinationPoint",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(t,"convertArea",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(t,"convertDistance",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(t,"convertSpeed",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(t,"decimalToSexagesimal",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(t,"findNearest",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(t,"getAreaOfPolygon",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(t,"getBounds",{enumerable:!0,get:function(){return u.default}}),Object.defineProperty(t,"getBoundsOfDistance",{enumerable:!0,get:function(){return l.default}}),Object.defineProperty(t,"getCenter",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(t,"getCenterOfBounds",{enumerable:!0,get:function(){return f.default}}),Object.defineProperty(t,"getCompassDirection",{enumerable:!0,get:function(){return g.default}}),Object.defineProperty(t,"getCoordinateKey",{enumerable:!0,get:function(){return d.default}}),Object.defineProperty(t,"getCoordinateKeys",{enumerable:!0,get:function(){return A.default}}),Object.defineProperty(t,"getDistance",{enumerable:!0,get:function(){return p.default}}),Object.defineProperty(t,"getDistanceFromLine",{enumerable:!0,get:function(){return y.default}}),Object.defineProperty(t,"getGreatCircleBearing",{enumerable:!0,get:function(){return I.default}}),Object.defineProperty(t,"getLatitude",{enumerable:!0,get:function(){return m.default}}),Object.defineProperty(t,"getLongitude",{enumerable:!0,get:function(){return E.default}}),Object.defineProperty(t,"getPathLength",{enumerable:!0,get:function(){return w.default}}),Object.defineProperty(t,"getPreciseDistance",{enumerable:!0,get:function(){return b.default}}),Object.defineProperty(t,"getRhumbLineBearing",{enumerable:!0,get:function(){return C.default}}),Object.defineProperty(t,"getRoughCompassDirection",{enumerable:!0,get:function(){return B.default}}),Object.defineProperty(t,"getSpeed",{enumerable:!0,get:function(){return v.default}}),Object.defineProperty(t,"isDecimal",{enumerable:!0,get:function(){return _.default}}),Object.defineProperty(t,"isPointInLine",{enumerable:!0,get:function(){return k.default}}),Object.defineProperty(t,"isPointInPolygon",{enumerable:!0,get:function(){return x.default}}),Object.defineProperty(t,"isPointNearLine",{enumerable:!0,get:function(){return S.default}}),Object.defineProperty(t,"isPointWithinRadius",{enumerable:!0,get:function(){return Q.default}}),Object.defineProperty(t,"isSexagesimal",{enumerable:!0,get:function(){return M.default}}),Object.defineProperty(t,"isValidCoordinate",{enumerable:!0,get:function(){return D.default}}),Object.defineProperty(t,"isValidLatitude",{enumerable:!0,get:function(){return T.default}}),Object.defineProperty(t,"isValidLongitude",{enumerable:!0,get:function(){return L.default}}),Object.defineProperty(t,"orderByDistance",{enumerable:!0,get:function(){return $.default}}),Object.defineProperty(t,"sexagesimalToDecimal",{enumerable:!0,get:function(){return U.default}}),Object.defineProperty(t,"toDecimal",{enumerable:!0,get:function(){return O.default}}),Object.defineProperty(t,"toRad",{enumerable:!0,get:function(){return F.default}}),Object.defineProperty(t,"toDeg",{enumerable:!0,get:function(){return N.default}}),Object.defineProperty(t,"wktToPolygon",{enumerable:!0,get:function(){return P.default}});var n=K(NI),r=K(sE),o=K(uE),i=K(fE),s=K(AE),a=K(mE),c=K($E),u=K(KE),l=K(GE),h=K(ew),f=K(cw),g=K(hw),d=K(RI),A=K(em),p=K(wE),y=K(ww),I=K(_w),m=K(PI),E=K(Rm),w=K(Tw),b=K(Ow),C=K(fw),B=K(jw),v=K(Vw),_=K(VI),k=K(zw),x=K(Xw),S=K(rb),Q=K(sb),M=K(qI),D=K(tm),T=K(um),L=K(pm),$=K(EE),U=K(WI),O=K(HI),F=K(zm),N=K(Wm),P=K(ub),Y=YI;function K(t){return t&&t.__esModule?t:{default:t}}Object.keys(Y).forEach((function(n){"default"!==n&&"__esModule"!==n&&(Object.prototype.hasOwnProperty.call(e,n)||Object.defineProperty(t,n,{enumerable:!0,get:function(){return Y[n]}}))}))}({});class Ab extends fy{constructor(t){super(),hy(this,t,db,gb,np,{src:0,size:2})}}const pb=t=>({}),yb=t=>({});function Ib(t,e,n){const r=t.slice();return r[5]=e[n],r}const mb=t=>({}),Eb=t=>({});function wb(t){let e,n=Zy[t[5].id].image+"";return{c(){e=wp(n)},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function bb(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E=t[0].name+"";const w=t[4].nw,b=cp(w,t,t[3],Eb),C=b||function(t){let e,n,r=t[0].score+"";return{c(){e=mp("h3"),n=wp(r)},m(t,r){pp(t,e,r),Ap(e,n)},p(t,e){1&e&&r!==(r=t[0].score+"")&&Sp(n,r)},d(t){t&&yp(e)}}}(t);let B=t[1],v=[];for(let e=0;e<B.length;e+=1)v[e]=wb(Ib(t,B,e));p=new Ab({props:{src:t[0].picture}});const _=t[4].genderloc,k=cp(_,t,t[3],yb),x=t[4].default,S=cp(x,t,t[3],null);return{c(){e=mp("article"),n=mp("legend"),r=mp("overlay"),o=mp("div"),C&&C.c(),i=bp(),s=mp("div"),a=mp("h2"),c=mp("dot"),u=wp(""),h=wp(E),f=bp(),g=mp("div"),d=mp("h2");for(let t=0;t<v.length;t+=1)v[t].c();A=bp(),ay(p.$$.fragment),y=bp(),k&&k.c(),I=bp(),S&&S.c(),Mp(o,"grid-area","nw"),kp(o,"class","hpad"),kp(c,"class",l=t[0].state),Mp(s,"grid-area","sw"),Mp(s,"align-self","end"),Mp(g,"grid-area","se"),Mp(g,"align-self","end"),Mp(g,"justify-self","end"),kp(g,"class","end"),kp(e,"class","peer")},m(t,l){pp(t,e,l),Ap(e,n),Ap(n,r),Ap(r,o),C&&C.m(o,null),Ap(r,i),Ap(r,s),Ap(s,a),Ap(a,c),Ap(c,u),Ap(a,h),Ap(r,f),Ap(r,g),Ap(g,d);for(let t=0;t<v.length;t+=1)v[t].m(d,null);Ap(n,A),cy(p,n,null),Ap(e,y),k&&k.m(e,null),Ap(e,I),S&&S.m(e,null),m=!0},p(t,[e]){if(b?b.p&&(!m||8&e)&&hp(b,w,t,t[3],m?lp(w,t[3],e,mb):fp(t[3]),Eb):C&&C.p&&(!m||1&e)&&C.p(t,m?e:-1),(!m||1&e&&l!==(l=t[0].state))&&kp(c,"class",l),(!m||1&e)&&E!==(E=t[0].name+"")&&Sp(h,E),2&e){let n;for(B=t[1],n=0;n<B.length;n+=1){const r=Ib(t,B,n);v[n]?v[n].p(r,e):(v[n]=wb(r),v[n].c(),v[n].m(d,null))}for(;n<v.length;n+=1)v[n].d(1);v.length=B.length}const n={};1&e&&(n.src=t[0].picture),p.$set(n),k&&k.p&&(!m||8&e)&&hp(k,_,t,t[3],m?lp(_,t[3],e,pb):fp(t[3]),yb),S&&S.p&&(!m||8&e)&&hp(S,x,t,t[3],m?lp(x,t[3],e,null):fp(t[3]),null)},i(t){m||(ey(C,t),ey(p.$$.fragment,t),ey(k,t),ey(S,t),m=!0)},o(t){ny(C,t),ny(p.$$.fragment,t),ny(k,t),ny(S,t),m=!1},d(t){t&&yp(e),C&&C.d(t),Ip(v,t),uy(p),k&&k.d(t),S&&S.d(t)}}}function Cb(t,e,n){let{$$slots:r={},$$scope:o}=e,{peer:i}=e,{size:s="normal"}=e;const a=i.inventory||[];return t.$$set=t=>{"peer"in t&&n(0,i=t.peer),"size"in t&&n(2,s=t.size),"$$scope"in t&&n(3,o=t.$$scope)},[i,a,s,o,r]}class Bb extends fy{constructor(t){super(),hy(this,t,Cb,bb,np,{peer:0,size:2})}}function vb(t,e,n){const r=t.slice();return r[26]=e[n],r}function _b(t){let e,n,r;return n=new FI({props:{expiresAt:t[2].vibe,format:"mm:ss"}}),{c(){e=wp("Vibe available in again "),ay(n.$$.fragment)},m(t,o){pp(t,e,o),cy(n,t,o),r=!0},p(t,e){const r={};4&e&&(r.expiresAt=t[2].vibe),n.$set(r)},i(t){r||(ey(n.$$.fragment,t),r=!0)},o(t){ny(n.$$.fragment,t),r=!1},d(t){t&&yp(e),uy(n,t)}}}function kb(t){let e,n,r,o;return{c(){e=wp("Your "),n=mp("strong"),n.innerHTML="<purple>vibe</purple>",r=wp(" is primed and loaded.\n      "),o=mp("sup"),o.textContent="Pow pow! ",kp(n,"class","purple")},m(t,i){pp(t,e,i),pp(t,n,i),pp(t,r,i),pp(t,o,i)},p:WA,i:WA,o:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r),t&&yp(o)}}}function xb(t){let e,n,r;return{c(){e=wp("Press the "),n=mp("strong"),n.textContent="START",r=wp(" button to play.")},m(t,o){pp(t,e,o),pp(t,n,o),pp(t,r,o)},p:WA,i:WA,o:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r)}}}function Sb(t){let e,n,r,o=t[26].tagline+"";return{c(){e=mp("div"),n=mp("p"),r=wp(o),kp(n,"class","nogap"),kp(e,"class","flex row space-between pad")},m(t,o){pp(t,e,o),Ap(e,n),Ap(n,r)},p(t,e){8&e&&o!==(o=t[26].tagline+"")&&Sp(r,o)},d(t){t&&yp(e)}}}function Qb(t){let e,n,r,o,i,s;function a(){return t[17](t[26])}return n=new Bb({props:{peer:t[26],$$slots:{default:[Sb]},$$scope:{ctx:t}}}),{c(){e=mp("div"),ay(n.$$.fragment),r=bp()},m(t,c){pp(t,e,c),cy(n,e,null),Ap(e,r),o=!0,i||(s=Bp(e,"click",a),i=!0)},p(e,r){t=e;const o={};8&r&&(o.peer=t[26]),536870920&r&&(o.$$scope={dirty:r,ctx:t}),n.$set(o)},i(t){o||(ey(n.$$.fragment,t),o=!0)},o(t){ny(n.$$.fragment,t),o=!1},d(t){t&&yp(e),uy(n),i=!1,s()}}}function Mb(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[Db]},$$scope:{ctx:t}}}),e.$on("fade",t[19]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};536870928&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function Db(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m;return{c(){e=mp("article"),n=mp("h6"),n.textContent="Genders",r=bp(),o=mp("fieldset"),o.innerHTML='<label for="m"><input type="checkbox" id="m" name="m" role="switch"/>\n            M</label>',i=bp(),s=mp("fieldset"),s.innerHTML='<label for="f"><input type="checkbox" id="f" name="f" role="switch"/>\n            F</label>',a=bp(),c=mp("fieldset"),c.innerHTML='<label for="nb"><input type="checkbox" id="nb" name="nb" role="switch"/>\n            NB</label>',u=bp(),l=mp("h6"),l.textContent="Distance",h=bp(),f=mp("label"),f.innerHTML='GLOBAL\n          <input type="range" min="0" max="100" value="100" id="distance" name="distance"/>',g=bp(),d=mp("footer"),A=mp("b"),A.textContent="reset",p=bp(),y=mp("b"),y.textContent="filter",kp(f,"for","distance"),kp(A,"role","button"),kp(y,"role","button")},m(E,w){pp(E,e,w),Ap(e,n),Ap(e,r),Ap(e,o),Ap(e,i),Ap(e,s),Ap(e,a),Ap(e,c),Ap(e,u),Ap(e,l),Ap(e,h),Ap(e,f),Ap(e,g),Ap(e,d),Ap(d,A),Ap(d,p),Ap(d,y),I||(m=Bp(y,"click",t[18]),I=!0)},p:WA,d(t){t&&yp(e),I=!1,m()}}}function Tb(t){let e,n;return e=new oI({props:{$$slots:{default:[Pb]},$$scope:{ctx:t}}}),e.$on("fade",t[24]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};536871143&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function Lb(t){let e;return{c(){e=mp("span"),kp(e,"slot","nw")},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function $b(t){let e;return{c(){e=mp("div"),e.innerHTML='<sup class="hpad">Press START to play</sup>',kp(e,"class","text-right")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function Ub(t){let e,n,r;return n=new FI({props:{expiresAt:t[2].vibe,format:"mm:ss"}}),{c(){e=mp("button"),ay(n.$$.fragment),kp(e,"class","hgap red"),e.disabled=!0},m(t,o){pp(t,e,o),cy(n,e,null),r=!0},p(t,e){const r={};4&e&&(r.expiresAt=t[2].vibe),n.$set(r)},i(t){r||(ey(n.$$.fragment,t),r=!0)},o(t){ny(n.$$.fragment,t),r=!1},d(t){t&&yp(e),uy(n)}}}function Ob(t){let e,n,r;return{c(){e=mp("button"),e.textContent="chat",kp(e,"class","hgap green")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[23]),n=!0)},p:WA,i:WA,o:WA,d(t){t&&yp(e),n=!1,r()}}}function Fb(t){let e,n,r;return{c(){e=mp("button"),e.textContent="vibe",kp(e,"class","hgap purple")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[22]),n=!0)},p:WA,i:WA,o:WA,d(t){t&&yp(e),n=!1,r()}}}function Nb(t){let e;return{c(){e=mp("button"),e.textContent="vibe",kp(e,"class","hgap purple"),e.disabled=!0},m(t,n){pp(t,e,n)},p:WA,i:WA,o:WA,d(t){t&&yp(e)}}}function Pb(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v,_,k,x,S,Q,M,D,T,L,$,U,O,F,N,P,Y,K,R,j,H,V,G,q=t[5].score+"",z=t[5].balance+"",J=t[5].tagline+"",W=Zy[55040].image+"";n=new Bb({props:{peer:t[5],$$slots:{nw:[Lb]},$$scope:{ctx:t}}}),y=new FI({props:{expiresAt:t[5].expiresAt,format:"HH:mm:ss"}});let X=!t[1].entered&&$b();const Z=[Nb,Fb,Ob,Ub],tt=[];function et(t,e){return t[1].entered?t[1].entered&&!t[2].vibe?1:"match"===t[6]?.state?2:3:0}return R=et(t),j=tt[R]=Z[R](t),{c(){e=mp("div"),ay(n.$$.fragment),r=bp(),o=mp("article"),i=mp("div"),s=mp("h6"),a=wp("Score "),c=wp(q),u=wp("\n              | "),l=mp("blue"),h=wp(""),f=wp(z),g=bp(),d=mp("h6"),A=wp(" "),p=mp("code"),ay(y.$$.fragment),I=bp(),m=mp("p"),E=wp(J),w=bp(),b=mp("h6"),b.textContent="Vibe Options",C=bp(),B=mp("label"),v=mp("h6"),_=mp("input"),x=wp("\n            mint water "),S=wp(W),Q=bp(),M=mp("label"),D=mp("h6"),T=mp("input"),U=wp("\n            offer tradeable"),O=bp(),F=mp("footer"),X&&X.c(),N=bp(),P=mp("div"),Y=mp("button"),Y.textContent="ok",K=bp(),j.c(),kp(s,"class","nogap"),kp(d,"class","nogap"),kp(i,"class","row space-between xcenter"),kp(_,"type","checkbox"),kp(_,"name","water"),kp(_,"id","water"),_.disabled=k="match"===t[6]?.state,kp(B,"for","water"),kp(T,"type","checkbox"),kp(T,"name","item"),kp(T,"id","item"),T.value=L=!!t[7],T.disabled=$="match"===t[6]?.state,kp(M,"for","item"),kp(Y,"class","hgap"),kp(P,"class","row space-between"),kp(o,"class","nogap")},m(k,L){pp(k,e,L),cy(n,e,null),Ap(e,r),Ap(e,o),Ap(o,i),Ap(i,s),Ap(s,a),Ap(s,c),Ap(s,u),Ap(s,l),Ap(l,h),Ap(l,f),Ap(i,g),Ap(i,d),Ap(d,A),Ap(d,p),cy(y,p,null),Ap(o,I),Ap(o,m),Ap(m,E),Ap(o,w),Ap(o,b),Ap(o,C),Ap(o,B),Ap(B,v),Ap(v,_),Qp(_,t[0]),Ap(v,x),Ap(v,S),Ap(o,Q),Ap(o,M),Ap(M,D),Ap(D,T),Ap(D,U),Ap(o,O),Ap(o,F),X&&X.m(F,null),Ap(F,N),Ap(F,P),Ap(P,Y),Ap(P,K),tt[R].m(P,null),H=!0,V||(G=[Bp(_,"change",t[20]),Bp(Y,"click",t[21])],V=!0)},p(t,e){const r={};32&e&&(r.peer=t[5]),536870912&e&&(r.$$scope={dirty:e,ctx:t}),n.$set(r),(!H||32&e)&&q!==(q=t[5].score+"")&&Sp(c,q),(!H||32&e)&&z!==(z=t[5].balance+"")&&Sp(f,z);const o={};32&e&&(o.expiresAt=t[5].expiresAt),y.$set(o),(!H||32&e)&&J!==(J=t[5].tagline+"")&&Sp(E,J),(!H||64&e&&k!==(k="match"===t[6]?.state))&&(_.disabled=k),1&e&&Qp(_,t[0]),(!H||128&e&&L!==(L=!!t[7]))&&(T.value=L),(!H||64&e&&$!==($="match"===t[6]?.state))&&(T.disabled=$),t[1].entered?X&&(X.d(1),X=null):X||(X=$b(),X.c(),X.m(F,N));let i=R;R=et(t),R===i?tt[R].p(t,e):(Zp(),ny(tt[i],1,1,(()=>{tt[i]=null})),ty(),j=tt[R],j?j.p(t,e):(j=tt[R]=Z[R](t),j.c()),ey(j,1),j.m(P,null))},i(t){H||(ey(n.$$.fragment,t),ey(y.$$.fragment,t),ey(j),H=!0)},o(t){ny(n.$$.fragment,t),ny(y.$$.fragment,t),ny(j),H=!1},d(t){t&&yp(e),uy(n),uy(y),X&&X.d(),tt[R].d(),V=!1,tp(G)}}}function Yb(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C=t[3].length+"";const B=[xb,kb,_b],v=[];function _(t,e){return t[1].entered?t[2].vibe?2:1:0}a=_(t),c=v[a]=B[a](t);let k=t[3],x=[];for(let e=0;e<k.length;e+=1)x[e]=Qb(vb(t,k,e));const S=t=>ny(x[t],1,1,(()=>{x[t]=null}));let Q=t[4]&&Mb(t),M=t[5]&&Tb(t);return{c(){e=mp("pub-view"),n=mp("h1"),n.textContent="Club Room",r=bp(),o=mp("p"),o.innerHTML="This is the common room, see someone interesting?<br/>\n    Shoot!",i=bp(),s=mp("p"),c.c(),u=bp(),l=mp("div"),h=mp("h6"),f=wp("Patrons "),g=wp(C),d=bp(),A=mp("b"),A.textContent="Filter",p=bp(),y=mp("peers");for(let t=0;t<x.length;t+=1)x[t].c();I=bp(),Q&&Q.c(),m=bp(),M&&M.c(),kp(n,"class","view-header"),kp(h,"class","nogap"),kp(A,"role","button"),kp(A,"class","outline hpad vgap"),kp(l,"class","row space-between xcenter"),kp(y,"class","row wrap center"),xp(e,"class","block container")},m(c,C){pp(c,e,C),Ap(e,n),Ap(e,r),Ap(e,o),Ap(e,i),Ap(e,s),v[a].m(s,null),Ap(e,u),Ap(e,l),Ap(l,h),Ap(h,f),Ap(h,g),Ap(l,d),Ap(l,A),Ap(e,p),Ap(e,y);for(let t=0;t<x.length;t+=1)x[t].m(y,null);Ap(e,I),Q&&Q.m(e,null),Ap(e,m),M&&M.m(e,null),E=!0,w||(b=Bp(A,"click",t[16]),w=!0)},p(t,[n]){let r=a;if(a=_(t),a===r?v[a].p(t,n):(Zp(),ny(v[r],1,1,(()=>{v[r]=null})),ty(),c=v[a],c?c.p(t,n):(c=v[a]=B[a](t),c.c()),ey(c,1),c.m(s,null)),(!E||8&n)&&C!==(C=t[3].length+"")&&Sp(g,C),40&n){let e;for(k=t[3],e=0;e<k.length;e+=1){const r=vb(t,k,e);x[e]?(x[e].p(r,n),ey(x[e],1)):(x[e]=Qb(r),x[e].c(),ey(x[e],1),x[e].m(y,null))}for(Zp(),e=k.length;e<x.length;e+=1)S(e);ty()}t[4]?Q?(Q.p(t,n),16&n&&ey(Q,1)):(Q=Mb(t),Q.c(),ey(Q,1),Q.m(e,m)):Q&&(Zp(),ny(Q,1,1,(()=>{Q=null})),ty()),t[5]?M?(M.p(t,n),32&n&&ey(M,1)):(M=Tb(t),M.c(),ey(M,1),M.m(e,null)):M&&(Zp(),ny(M,1,1,(()=>{M=null})),ty())},i(t){if(!E){ey(c);for(let t=0;t<k.length;t+=1)ey(x[t]);ey(Q),ey(M),E=!0}},o(t){ny(c),x=x.filter(Boolean);for(let t=0;t<x.length;t+=1)ny(x[t]);ny(Q),ny(M),E=!1},d(t){t&&yp(e),v[a].d(),Ip(x,t),Q&&Q.d(),M&&M.d(),w=!1,b()}}}function Kb(t,e,n){let r,o,i,s,a,c,u,l;ap(t,Ry,(t=>n(1,o=t)));const h=my(wy.$cooldowns());ap(t,h,(t=>n(2,i=t)));const f=my(wy.$peers(),g);var g;ap(t,f,(t=>n(3,s=t)));const d=_y(),A=Ay(!1);ap(t,A,(t=>n(4,a=t)));const p=Ay(!1);ap(t,p,(t=>n(5,c=t)));const y=py([d,p],(([t,e])=>{const n={state:"none"};return e&&t.find((t=>t.peerId?.equals(e.pk)))||n}));ap(t,y,(t=>n(6,u=t))),o.swarming||Hy().catch(console.error.bind(null,"Auto-connect failed"));const I=Ay(!1);ap(t,I,(t=>n(0,r=t)));const m=Ay(null);function E(t){const e=[];r&&e.push({t:Bg.ACTION_CONJURE_WATER}),wy.sendVibe(t,e).catch((t=>console.error("Failed sending vibe",t)))}ap(t,m,(t=>n(7,l=t)));return[r,o,i,s,a,c,u,l,h,f,A,p,y,I,m,E,()=>dp(A,a=!0,a),t=>dp(p,c=t,c),()=>dp(A,a=!1,a),()=>dp(A,a=!1,a),function(){r=this.value,I.set(r)},()=>dp(p,c=!1,c),()=>E(c.pk),()=>Uv(`chat/${If.btok(u.id)}`),()=>dp(p,c=!1,c)]}class Rb extends fy{constructor(t){super(),hy(this,t,Kb,Yb,np,{})}}function jb(t,e,n){return t>=e*n?{width:e*n,height:e}:{width:t,height:t/n}}function Hb(t,e,n,r){return{x:Vb(t.x,e.width,n.width,r),y:Vb(t.y,e.height,n.height,r)}}function Vb(t,e,n,r){const o=e*r/2-n/2;return Math.min(o,Math.max(t,-o))}function Gb(t,e){return Math.sqrt(Math.pow(t.y-e.y,2)+Math.pow(t.x-e.x,2))}function qb(t,e,n=!1){const r=n?Math.round(e):e;return Math.min(t,Math.max(0,r))}function zb(t,e){return e}function Jb(t,e){return{x:(e.x+t.x)/2,y:(e.y+t.y)/2}}const{window:Wb}=iy;function Xb(t){let e;return{c(){e=mp("div"),kp(e,"class","cropperArea svelte-12kodkg"),Mp(e,"width",t[7].width+"px"),Mp(e,"height",t[7].height+"px"),kp(e,"data-testid","cropper"),Dp(e,"round","round"===t[3]),Dp(e,"grid",t[4])},m(t,n){pp(t,e,n)},p(t,n){128&n[0]&&Mp(e,"width",t[7].width+"px"),128&n[0]&&Mp(e,"height",t[7].height+"px"),8&n[0]&&Dp(e,"round","round"===t[3]),16&n[0]&&Dp(e,"grid",t[4])},d(t){t&&yp(e)}}}function Zb(t){let e,n,r,o,i,s,a=t[7]&&Xb(t);return{c(){e=mp("div"),n=mp("img"),o=bp(),a&&a.c(),kp(n,"class","image svelte-12kodkg"),ip(n.src,r=t[2])||kp(n,"src",r),kp(n,"alt",""),Mp(n,"transform","translate("+t[1].x+"px, "+t[1].y+"px) scale("+t[0]+")"),kp(n,"crossorigin",t[5]),kp(e,"class","container svelte-12kodkg"),kp(e,"data-testid","container")},m(r,c){pp(r,e,c),Ap(e,n),t[22](n),Ap(e,o),a&&a.m(e,null),t[23](e),i||(s=[Bp(Wb,"resize",t[10]),Bp(n,"load",t[9]),Bp(e,"mousedown",vp(t[11])),Bp(e,"touchstart",vp(t[12])),Bp(e,"wheel",vp(t[13])),Bp(e,"gesturestart",vp(t[20])),Bp(e,"gesturechange",vp(t[21]))],i=!0)},p(t,o){4&o[0]&&!ip(n.src,r=t[2])&&kp(n,"src",r),3&o[0]&&Mp(n,"transform","translate("+t[1].x+"px, "+t[1].y+"px) scale("+t[0]+")"),32&o[0]&&kp(n,"crossorigin",t[5]),t[7]?a?a.p(t,o):(a=Xb(t),a.c(),a.m(e,null)):a&&(a.d(1),a=null)},i:WA,o:WA,d(n){n&&yp(e),t[22](null),a&&a.d(),t[23](null),i=!1,tp(s)}}}function tC(t,e,n){let{image:r}=e,{crop:o={x:0,y:0}}=e,{zoom:i=1}=e,{aspect:s=4/3}=e,{minZoom:a=1}=e,{maxZoom:c=3}=e,{cropSize:u=null}=e,{cropShape:l="rect"}=e,{showGrid:h=!0}=e,{zoomSpeed:f=1}=e,{crossOrigin:g=null}=e,{restrictPosition:d=!0}=e,A=null,p={width:0,height:0,naturalWidth:0,naturalHeight:0},y=null,I=null,m=null,E={x:0,y:0},w={x:0,y:0},b=0,C=null,B=null;const v=Op();var _;Up((()=>{m&&m.complete&&x()})),_=()=>{k()},$p().$$.on_destroy.push(_);const k=()=>{document.removeEventListener("mousemove",D),document.removeEventListener("mouseup",U),document.removeEventListener("touchmove",T),document.removeEventListener("touchend",U)},x=()=>{S(),P()},S=()=>{m&&(p={width:m.width,height:m.height,naturalWidth:m.naturalWidth,naturalHeight:m.naturalHeight},n(7,A=u||jb(m.width,m.height,s))),y&&(I=y.getBoundingClientRect())},Q=t=>({x:Number(t.clientX),y:Number(t.clientY)}),M=t=>({x:Number(t.clientX),y:Number(t.clientY)}),D=t=>$(Q(t)),T=t=>{t.preventDefault(),2===t.touches.length?F(t):1===t.touches.length&&$(M(t.touches[0]))},L=({x:t,y:e})=>{E={x:t,y:e},w={x:o.x,y:o.y}},$=({x:t,y:e})=>{C&&window.cancelAnimationFrame(C),C=window.requestAnimationFrame((()=>{if(void 0===t||void 0===e)return;const r=t-E.x,s=e-E.y,a={x:w.x+r,y:w.y+s};n(1,o=d?Hb(a,p,A,i):a)}))},U=()=>{k(),P()},O=t=>{const e=M(t.touches[0]),n=M(t.touches[1]);b=Gb(e,n),L(Jb(e,n))},F=t=>{const e=M(t.touches[0]),n=M(t.touches[1]),r=Jb(e,n);$(r),B&&window.cancelAnimationFrame(B),B=window.requestAnimationFrame((()=>{const t=Gb(e,n);N(i*(t/b),r),b=t}))},N=(t,e)=>{const r=(({x:t,y:e})=>{if(!I)throw new Error("The Cropper is not mounted");return{x:I.width/2-(t-I.left),y:I.height/2-(e-I.top)}})(e),s=(({x:t,y:e})=>({x:(t+o.x)/i,y:(e+o.y)/i}))(r);n(0,i=Math.min(c,Math.max(t,a)));const u={x:s.x*i-r.x,y:s.y*i-r.y};n(1,o=d?Hb(u,p,A,i):u)},P=()=>{if(!A||0===A.width)return;const t=d?Hb(o,p,A,i):o,{croppedAreaPercentages:e,croppedAreaPixels:n}=function(t,e,n,r,o,i=!0){const s=i?qb:zb,a={x:s(100,((e.width-n.width/o)/2-t.x/o)/e.width*100),y:s(100,((e.height-n.height/o)/2-t.y/o)/e.height*100),width:s(100,n.width/e.width*100/o),height:s(100,n.height/e.height*100/o)},c=s(e.naturalWidth,a.width*e.naturalWidth/100,!0),u=s(e.naturalHeight,a.height*e.naturalHeight/100,!0),l=e.naturalWidth>=e.naturalHeight*r?{width:Math.round(u*r),height:u}:{width:c,height:Math.round(c/r)};return{croppedAreaPercentages:a,croppedAreaPixels:{...l,x:s(e.naturalWidth-l.width,a.x*e.naturalWidth/100,!0),y:s(e.naturalHeight-l.height,a.y*e.naturalHeight/100,!0)}}}(t,p,A,u?u.width/u.height:s,i,d);v("cropcomplete",{percent:e,pixels:n})};return t.$$set=t=>{"image"in t&&n(2,r=t.image),"crop"in t&&n(1,o=t.crop),"zoom"in t&&n(0,i=t.zoom),"aspect"in t&&n(14,s=t.aspect),"minZoom"in t&&n(15,a=t.minZoom),"maxZoom"in t&&n(16,c=t.maxZoom),"cropSize"in t&&n(17,u=t.cropSize),"cropShape"in t&&n(3,l=t.cropShape),"showGrid"in t&&n(4,h=t.showGrid),"zoomSpeed"in t&&n(18,f=t.zoomSpeed),"crossOrigin"in t&&n(5,g=t.crossOrigin),"restrictPosition"in t&&n(19,d=t.restrictPosition)},t.$$.update=()=>{147520&t.$$.dirty[0]&&m&&n(7,A=u||jb(m.width,m.height,s)),1&t.$$.dirty[0]&&i&&P()},[i,o,r,l,h,g,m,A,y,x,S,t=>{document.addEventListener("mousemove",D),document.addEventListener("mouseup",U),L(Q(t))},t=>{document.addEventListener("touchmove",T,{passive:!1}),document.addEventListener("touchend",U),2===t.touches.length?O(t):1===t.touches.length&&L(M(t.touches[0]))},t=>{const e=Q(t),n=i-t.deltaY*f/200;N(n,e)},s,a,c,u,f,d,function(e){Fp.call(this,t,e)},function(e){Fp.call(this,t,e)},function(t){Pp[t?"unshift":"push"]((()=>{m=t,n(6,m)}))},function(t){Pp[t?"unshift":"push"]((()=>{y=t,n(8,y)}))}]}class eC extends fy{constructor(t){super(),hy(this,t,tC,Zb,np,{image:2,crop:1,zoom:0,aspect:14,minZoom:15,maxZoom:16,cropSize:17,cropShape:3,showGrid:4,zoomSpeed:18,crossOrigin:5,restrictPosition:19},null,[-1,-1])}}function nC(t){let e,n,r,o;return{c(){e=mp("div"),n=mp("canvas"),r=bp(),o=mp("img"),kp(n,"width","300"),kp(n,"height","300"),kp(e,"class","row center"),kp(o,"alt","preview"),kp(o,"id","preview"),Mp(o,"display","none"),kp(o,"class","svelte-7zl4gf")},m(i,s){pp(i,e,s),Ap(e,n),t[12](n),pp(i,r,s),pp(i,o,s),t[13](o)},p:WA,i:WA,o:WA,d(n){n&&yp(e),t[12](null),n&&yp(r),n&&yp(o),t[13](null)}}}function rC(t){let e,n,r,o,i,s;function a(e){t[10](e)}function c(e){t[11](e)}let u={image:t[6],aspect:1,showGrid:!1};return void 0!==t[4]&&(u.crop=t[4]),void 0!==t[5]&&(u.zoom=t[5]),r=new eC({props:u}),Pp.push((()=>sy(r,"crop",a))),Pp.push((()=>sy(r,"zoom",c))),r.$on("cropcomplete",t[8]),{c(){e=mp("button"),e.textContent="done",n=bp(),ay(r.$$.fragment)},m(t,o){pp(t,e,o),pp(t,n,o),cy(r,t,o),s=!0},p(t,e){const n={};64&e&&(n.image=t[6]),!o&&16&e&&(o=!0,n.crop=t[4],Vp((()=>o=!1))),!i&&32&e&&(i=!0,n.zoom=t[5],Vp((()=>i=!1))),r.$set(n)},i(t){s||(ey(r.$$.fragment,t),s=!0)},o(t){ny(r.$$.fragment,t),s=!1},d(t){t&&yp(e),t&&yp(n),uy(r,t)}}}function oC(t){let e,n,r,o,i,s,a,c;const u=[rC,nC],l=[];return o=1,i=l[1]=u[1](t),{c(){e=mp("image-loader"),n=mp("input"),r=bp(),i.c(),kp(n,"type","file"),kp(n,"accept","image/*"),kp(n,"id","picture"),kp(n,"name","picture")},m(o,i){pp(o,e,i),Ap(e,n),Ap(e,r),l[1].m(e,null),s=!0,a||(c=Bp(n,"change",t[9]),a=!0)},p(t,[e]){i.p(t,e)},i(t){s||(ey(i),s=!0)},o(t){ny(i),s=!1},d(t){t&&yp(e),l[1].d(),a=!1,c()}}}function iC(t,e,n){let o,i,s=WA,a=()=>(s(),s=sp(h,(t=>n(15,o=t))),h);t.$$.on_destroy.push((()=>s()));let c,u,l,{output:h}=e;a();const f=Ay();let g;ap(t,f,(t=>n(6,i=t)));let d={x:0,y:0},A=1;async function p(t){return new Promise((e=>{n(3,l.onload=()=>{if(""===l.src)return;console.info(l.width,l.height);const t=Math.min(l.height,l.width);u.drawImage(l,(l.width-t)/2,(l.height-t)/2,t,t,0,0,300,300),n(3,l.src="",l),e()},l),n(3,l.src=t,l)}))}async function y(t){let e;try{e=URL.createObjectURL(t),await p(e),URL.revokeObjectURL(e);const n=c.toDataURL("image/jpeg",.35),i=function(t){const e=/^data:([^;]+);base64,/,n=t.match(e);if("image/jpeg"!==n[1])throw new Error("CanvasExportedUnexpectedFiletype: "+n[1]);return r.Buffer.from(t.replace(e,""),"base64")}(n);console.info(`DataURL: ${n.length}, Binary: ${i.length}, compression: ${i.length/n.length}`),dp(h,o=i,o)}catch(t){throw t}}return Up((()=>{u=c.getContext("2d"),u.fillStyle="gray",u.fillRect(0,0,300,300);const t=h?.subscribe((t=>{if(console.info("Redrawing preview due to change",t?.length),t){p(zy(o))}}));return()=>{t&&t()}})),t.$$set=t=>{"output"in t&&a(n(0,h=t.output))},t.$$.update=()=>{if(2&t.$$.dirty&&g){y(g[0]).catch(console.error.bind(null,"Preprocess failed"))}},[h,g,c,l,d,A,i,f,function(t){const{percent:e,pixels:n}=t.detail;console.info("CropComplete",e,n),console.info("Crop",d,"Zoom",A),dp(h,o=!1,o)},function(){g=this.files,n(1,g)},function(t){d=t,n(4,d)},function(t){A=t,n(5,A)},function(t){Pp[t?"unshift":"push"]((()=>{c=t,n(2,c)}))},function(t){Pp[t?"unshift":"push"]((()=>{l=t,n(3,l)}))}]}class sC extends fy{constructor(t){super(),hy(this,t,iC,oC,np,{output:0})}}function aC(t){let e,n,r,o=t[2]?.length+"";return{c(){e=mp("small"),n=wp(o),r=wp(" B"),kp(e,"class","block text-center")},m(t,o){pp(t,e,o),Ap(e,n),Ap(e,r)},p(t,e){4&e[0]&&o!==(o=t[2]?.length+"")&&Sp(n,o)},d(t){t&&yp(e)}}}function cC(t){let e,n,r,o,i,s,a=t[35].message+"",c=t[35].stack+"";return{c(){e=mp("danger"),n=wp("Loading profile failed "),r=wp(a),o=bp(),i=mp("pre"),s=wp(c)},m(t,a){pp(t,e,a),Ap(e,n),Ap(e,r),pp(t,o,a),pp(t,i,a),Ap(i,s)},p(t,e){1&e[0]&&a!==(a=t[35].message+"")&&Sp(r,a),1&e[0]&&c!==(c=t[35].stack+"")&&Sp(s,c)},d(t){t&&yp(e),t&&yp(o),t&&yp(i)}}}function uC(t){let e,n,r,o,i;return{c(){e=mp("button"),n=wp("save"),e.disabled=r=!t[5]},m(r,s){pp(r,e,s),Ap(e,n),o||(i=Bp(e,"click",t[25]),o=!0)},p(t,n){32&n[0]&&r!==(r=!t[5])&&(e.disabled=r)},d(t){t&&yp(e),o=!1,i()}}}function lC(t){let e;return{c(){e=wp("Loading...")},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function hC(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[gC]},$$scope:{ctx:t}}}),e.$on("fade",t[28]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};130&n[0]|32&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function fC(t){let e,n,r,o,i,s,a,c,u=["F","M","NB"][By(t[1]).sex]+"",l=By(t[1]).geohash+"";return{c(){e=mp("ul"),n=mp("li"),r=wp("Gender: "),o=wp(u),i=bp(),s=mp("li"),a=wp("Location: "),c=wp(l)},m(t,u){pp(t,e,u),Ap(e,n),Ap(n,r),Ap(n,o),Ap(e,i),Ap(e,s),Ap(s,a),Ap(s,c)},p(t,e){2&e[0]&&u!==(u=["F","M","NB"][By(t[1]).sex]+"")&&Sp(o,u),2&e[0]&&l!==(l=By(t[1]).geohash+"")&&Sp(c,l)},d(t){t&&yp(e)}}}function gC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w=t[1]&&fC(t);return a=new fI({props:{data:t[13],size:6}}),{c(){e=mp("article"),n=mp("header"),n.innerHTML="<h5>IDSQR</h5>",r=bp(),o=mp("div"),w&&w.c(),i=bp(),s=mp("div"),ay(a.$$.fragment),c=bp(),u=mp("p"),u.innerHTML="This is your cryptographic identity.\n            <br/>\n            Let your friends scan your code\n            but keep the backed up image safe.",l=bp(),h=mp("footer"),f=mp("div"),g=mp("b"),g.textContent="purge",d=bp(),A=mp("b"),A.textContent="backup",p=bp(),y=mp("b"),y.textContent="close",kp(s,"class","vpad"),kp(o,"class","column xcenter"),kp(g,"role","button"),kp(A,"role","button"),kp(y,"role","button"),kp(f,"class","row space-between")},m(b,C){pp(b,e,C),Ap(e,n),Ap(e,r),Ap(e,o),w&&w.m(o,null),Ap(o,i),Ap(o,s),cy(a,s,null),Ap(o,c),Ap(o,u),Ap(e,l),Ap(e,h),Ap(h,f),Ap(f,g),Ap(f,d),Ap(f,A),Ap(f,p),Ap(f,y),I=!0,m||(E=[Bp(g,"click",t[26]),Bp(A,"click",Wy),Bp(y,"click",t[27])],m=!0)},p(t,e){t[1]?w?w.p(t,e):(w=fC(t),w.c(),w.m(o,i)):w&&(w.d(1),w=null)},i(t){I||(ey(a.$$.fragment,t),I=!0)},o(t){ny(a.$$.fragment,t),I=!1},d(t){t&&yp(e),w&&w.d(),uy(a),m=!1,tp(E)}}}function dC(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[AC]},$$scope:{ctx:t}}}),e.$on("fade",t[30]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};320&n[0]|32&n[1]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function AC(t){let e,n,r,o,i,s,a,c,u,l;return o=new Bb({props:{peer:t[8]}}),{c(){e=mp("article"),n=mp("header"),n.innerHTML="<h5>Preview</h5>",r=bp(),ay(o.$$.fragment),i=bp(),s=mp("footer"),a=mp("button"),a.textContent="close"},m(h,f){pp(h,e,f),Ap(e,n),Ap(e,r),cy(o,e,null),Ap(e,i),Ap(e,s),Ap(s,a),c=!0,u||(l=Bp(a,"click",t[29]),u=!0)},p(t,e){const n={};256&e[0]&&(n.peer=t[8]),o.$set(n)},i(t){c||(ey(o.$$.fragment,t),c=!0)},o(t){ny(o.$$.fragment,t),c=!1},d(t){t&&yp(e),uy(o),u=!1,l()}}}function pC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v,_,k,x,S,Q,M,D,T;a=new aI({props:{id:"icon-qr"}}),l=new aI({props:{id:"icon-info"}}),A=new sC({props:{output:t[11]}});let L=t[2]?.length&&aC(t),$={ctx:t,current:null,token:null,hasCatch:!0,pending:lC,then:uC,catch:cC,error:35};ry(x=t[0],$);let U=t[7]&&hC(t),O=t[6]&&dC(t);return{c(){e=mp("profile-view"),n=mp("div"),r=mp("h1"),r.textContent=" Profile",o=bp(),i=mp("div"),s=mp("h2"),ay(a.$$.fragment),c=bp(),u=mp("h2"),ay(l.$$.fragment),h=bp(),f=mp("label"),g=mp("h5"),g.textContent="picture",d=bp(),ay(A.$$.fragment),p=bp(),L&&L.c(),y=bp(),I=mp("label"),m=mp("h5"),m.textContent="name",E=bp(),w=mp("input"),b=bp(),C=mp("label"),B=mp("h5"),B.textContent="spark",v=bp(),_=mp("input"),k=bp(),$.block.c(),S=bp(),U&&U.c(),Q=bp(),O&&O.c(),kp(i,"class","row"),kp(n,"class","row space-between xstart"),kp(f,"for","file"),kp(w,"type","text"),kp(w,"placeholder","You got a street name?"),kp(w,"id","name"),kp(w,"name","name"),kp(I,"for","name"),kp(_,"type","text"),kp(_,"placeholder","what's on your mind?"),kp(_,"id","tagline"),kp(_,"name","tagline"),kp(C,"for","tagline"),xp(e,"class","block container")},m(x,F){pp(x,e,F),Ap(e,n),Ap(n,r),Ap(n,o),Ap(n,i),Ap(i,s),cy(a,s,null),Ap(i,c),Ap(i,u),cy(l,u,null),Ap(e,h),Ap(e,f),Ap(f,g),Ap(f,d),cy(A,f,null),Ap(f,p),L&&L.m(f,null),Ap(e,y),Ap(e,I),Ap(I,m),Ap(I,E),Ap(I,w),Qp(w,t[4]),Ap(e,b),Ap(e,C),Ap(C,B),Ap(C,v),Ap(C,_),Qp(_,t[3]),Ap(e,k),$.block.m(e,$.anchor=null),$.mount=()=>e,$.anchor=S,Ap(e,S),U&&U.m(e,null),Ap(e,Q),O&&O.m(e,null),M=!0,D||(T=[Bp(r,"click",t[20]),Bp(s,"click",t[21]),Bp(u,"click",t[22]),Bp(w,"input",t[23]),Bp(_,"input",t[24])],D=!0)},p(n,r){(t=n)[2]?.length?L?L.p(t,r):(L=aC(t),L.c(),L.m(f,null)):L&&(L.d(1),L=null),16&r[0]&&w.value!==t[4]&&Qp(w,t[4]),8&r[0]&&_.value!==t[3]&&Qp(_,t[3]),$.ctx=t,1&r[0]&&x!==(x=t[0])&&ry(x,$)||oy($,t,r),t[7]?U?(U.p(t,r),128&r[0]&&ey(U,1)):(U=hC(t),U.c(),ey(U,1),U.m(e,Q)):U&&(Zp(),ny(U,1,1,(()=>{U=null})),ty()),t[6]?O?(O.p(t,r),64&r[0]&&ey(O,1)):(O=dC(t),O.c(),ey(O,1),O.m(e,null)):O&&(Zp(),ny(O,1,1,(()=>{O=null})),ty())},i(t){M||(ey(a.$$.fragment,t),ey(l.$$.fragment,t),ey(A.$$.fragment,t),ey(U),ey(O),M=!0)},o(t){ny(a.$$.fragment,t),ny(l.$$.fragment,t),ny(A.$$.fragment,t),ny(U),ny(O),M=!1},d(t){t&&yp(e),uy(a),uy(l),uy(A),L&&L.d(),$.block.d(),$.token=null,$=null,U&&U.d(),O&&O.d(),D=!1,tp(T)}}}function yC(t,e,r){let o,i,s,a,c,u,l,h,f,g;const d=Ay();ap(t,d,(t=>r(4,u=t)));const A=Ay();ap(t,A,(t=>r(3,c=t)));const p=Ay();ap(t,p,(t=>r(2,a=t)));const y=Ay();ap(t,y,(t=>r(31,o=t)));const I=Ay();ap(t,I,(t=>r(1,s=t)));const m=Ay();ap(t,m,(t=>r(32,i=t)));const E=Ay(!1);ap(t,E,(t=>r(7,f=t)));const w=Ay(!0);ap(t,w,(t=>r(5,l=t)));const b=vy(!0);ap(t,b,(t=>r(8,g=t)));const C=Ay(!1);async function B(){await async function(t){await by.writeProfile(t),Ny(!0),t.picture&&Yy(t.picture),n.exports.get(Uy)&&!n.exports.get(Ly)&&(await qy(),Uv("/pub"))}({name:u,tagline:c,age:99,sex:0,picture:a,geohash:o}),dp(w,l=!1,l)}ap(t,C,(t=>r(6,h=t)));let v=async function(){const t=await by.readProfile();if(t)return dp(d,u=t.name,u),dp(A,c=t.tagline,c),dp(p,a=t.picture,a),dp(m,i=await by.readIdentity(),i),dp(I,s=i.slice(32),s),dp(y,o=t.geohash,o),t}();return[v,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,()=>dp(C,h=!0,h),()=>dp(E,f=!0,f),()=>Uv("/about"),function(){u=this.value,d.set(u)},function(){c=this.value,A.set(c)},()=>r(0,v=B()),()=>Jy(!0),()=>dp(E,f=!1,f),()=>dp(E,f=!1,f),()=>dp(C,h=!1,h),()=>dp(C,h=!1,h)]}class IC extends fy{constructor(t){super(),hy(this,t,yC,pC,np,{},null,[-1,-1])}}const mC="https://api.pico.pub";async function EC(t,e,n={}){const r=new window.Headers,o={"Content-Type":"pico/feed",...n?.headers||{}};for(const t in o)r.append(t,o[t]);const i=await fetch(t,{method:"POST",headers:r,body:e.buf.slice(0,e.tail)}),s=await i.json();if(!i.ok)throw s.error||console.error(s),new Error(`[${i.status}] ${s.error}`);return s}async function wC(t,e){const n=await async function(t,e={}){const n=new window.Headers,r={...e?.headers||{}};for(const t in r)n.append(t,r[t]);const o=await fetch(t,{method:"GET",headers:n}),i=o.headers.get("Content-Type");let s;if(/application\/json/.test(i)&&(s=await o.json()),!o.ok)throw new Error(`[${o.status}] ${s?.error||""}`);if(!s?.feed)throw new Error("Feed missing");return hu.from(s.feed)}(mC+"/v0/checkout/redeem/"+t);if(!(await wy.dispatch(n,!0)).length)throw new Error("Merge Failed");return"Enjoy!"}function bC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g=t[2].time&&function(t){let e,n,r=t[2].time+"";return{c(){e=wp("| "),n=wp(r)},m(t,r){pp(t,e,r),pp(t,n,r)},p:WA,d(t){t&&yp(e),t&&yp(n)}}}(t),d=t[2].mod&&function(t){let e,n,r=t[2].mod+"";return{c(){e=wp("| "),n=wp(r)},m(t,r){pp(t,e,r),pp(t,n,r)},p:WA,d(t){t&&yp(e),t&&yp(n)}}}(t),A=!t[1]&&BC(t);return{c(){e=mp("h3"),e.textContent=`${t[2].name}`,n=bp(),r=mp("i"),r.textContent=`${t[2].short}`,o=bp(),i=mp("emo"),i.textContent=`${t[2].image}`,s=bp(),a=mp("h6"),c=mp("small"),c.textContent=`${t[2].type}`,u=bp(),g&&g.c(),l=bp(),d&&d.c(),h=bp(),A&&A.c(),f=Cp(),kp(e,"class","nogap"),kp(i,"class","svelte-mp8u49")},m(t,p){pp(t,e,p),pp(t,n,p),pp(t,r,p),pp(t,o,p),pp(t,i,p),pp(t,s,p),pp(t,a,p),Ap(a,c),Ap(a,u),g&&g.m(a,null),Ap(a,l),d&&d.m(a,null),pp(t,h,p),A&&A.m(t,p),pp(t,f,p)},p(t,e){t[2].time&&g.p(t,e),t[2].mod&&d.p(t,e),t[1]?A&&(A.d(1),A=null):A?A.p(t,e):(A=BC(t),A.c(),A.m(f.parentNode,f))},d(t){t&&yp(e),t&&yp(n),t&&yp(r),t&&yp(o),t&&yp(i),t&&yp(s),t&&yp(a),g&&g.d(),d&&d.d(),t&&yp(h),A&&A.d(t),t&&yp(f)}}}function CC(t){let e,n,r,o,i,s,a,c,u;return{c(){e=mp("h3"),e.innerHTML="<error>Item Not Found!</error>",n=bp(),r=mp("emo"),r.textContent="",o=bp(),i=mp("div"),s=mp("p"),a=wp("Unknown item ["),c=wp(t[0]),u=wp("]"),kp(e,"class","nogap"),kp(r,"class","svelte-mp8u49")},m(t,l){pp(t,e,l),pp(t,n,l),pp(t,r,l),pp(t,o,l),pp(t,i,l),Ap(i,s),Ap(s,a),Ap(s,c),Ap(s,u)},p(t,e){1&e&&Sp(c,t[0])},d(t){t&&yp(e),t&&yp(n),t&&yp(r),t&&yp(o),t&&yp(i)}}}function BC(t){let e,n;let r=function(t,e){return t[2].desc?vC:_C}(t),o=r(t);return{c(){e=mp("div"),n=mp("p"),o.c()},m(t,r){pp(t,e,r),Ap(e,n),o.m(n,null)},p(t,e){o.p(t,e)},d(t){t&&yp(e),o.d()}}}function vC(t){let e,n,r=t[2].desc.replace(/\n/g,"<br/>\n")+"";return{c(){e=new Tp(!1),n=Cp(),e.a=n},m(t,o){e.m(r,t,o),pp(t,n,o)},p:WA,d(t){t&&yp(n),t&&e.d()}}}function _C(t){let e;return{c(){e=mp("error"),e.textContent="The description for this item seems to be missing"},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function kC(t){let e;let n=function(t,e){return t[2]?bC:CC}(t),r=n(t);return{c(){e=mp("item-description"),r.c(),xp(e,"class","flex column xcenter start")},m(t,n){pp(t,e,n),r.m(e,null)},p(t,[e]){r.p(t,e)},i:WA,o:WA,d(t){t&&yp(e),r.d()}}}function xC(t,e,n){let{id:r=-1}=e,{noDescription:o=!1}=e;const i=Zy[r];return t.$$set=t=>{"id"in t&&n(0,r=t.id),"noDescription"in t&&n(1,o=t.noDescription)},[r,o,i]}class SC extends fy{constructor(t){super(),hy(this,t,xC,kC,np,{id:0,noDescription:1})}}function QC(t,e,n){const r=t.slice();return r[62]=e[n],r}function MC(t,e,n){const r=t.slice();return r[62]=e[n],r}function DC(t,e,n){const r=t.slice();return r[67]=e[n],r}function TC(t){let e,n,r;return{c(){e=mp("a"),e.innerHTML="<div>Verify your profile to buy drinks</div>",kp(e,"class","row xcenter center")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[37]),n=!0)},p:WA,d(t){t&&yp(e),n=!1,r()}}}function LC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v=t[67].image+"",_=t[67].name+"",k=t[67].time+"",x=t[67].short+"",S=t[67].price/100+"",Q=t[67].mod&&function(t){let e,n,r=t[67].mod+"";return{c(){e=wp("| "),n=wp(r)},m(t,r){pp(t,e,r),pp(t,n,r)},p:WA,d(t){t&&yp(e),t&&yp(n)}}}(t);function M(){return t[38](t[67])}function D(){return t[39](t[67])}return{c(){e=mp("item"),n=mp("iimage"),r=wp(v),o=bp(),i=mp("description"),s=mp("h3"),a=wp(_),c=bp(),u=mp("h6"),l=wp(" "),h=wp(k),f=bp(),Q&&Q.c(),g=bp(),d=mp("short"),A=wp(x),p=bp(),y=mp("buy"),I=mp("button"),m=wp(" "),E=wp(S),b=bp(),kp(n,"class","svelte-weffh7"),kp(s,"class","svelte-weffh7"),kp(u,"class","svelte-weffh7"),kp(d,"class","svelte-weffh7"),kp(i,"class","column xstart grow2 space-between svelte-weffh7"),kp(I,"class","blue svelte-weffh7"),I.disabled=w=!t[7],kp(y,"class","column center"),kp(e,"class","drink row xcenter svelte-weffh7")},m(t,w){pp(t,e,w),Ap(e,n),Ap(n,r),Ap(e,o),Ap(e,i),Ap(i,s),Ap(s,a),Ap(i,c),Ap(i,u),Ap(u,l),Ap(u,h),Ap(u,f),Q&&Q.m(u,null),Ap(i,g),Ap(i,d),Ap(d,A),Ap(e,p),Ap(e,y),Ap(y,I),Ap(I,m),Ap(I,E),Ap(e,b),C||(B=[Bp(I,"click",_p(M)),Bp(e,"click",D)],C=!0)},p(e,n){(t=e)[67].mod&&Q.p(t,n),128&n[0]&&w!==(w=!t[7])&&(I.disabled=w)},d(t){t&&yp(e),Q&&Q.d(),C=!1,tp(B)}}}function $C(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w=t[62].image+"",b=t[62].name+"",C=t[62].short+"",B=Math.ceil(t[62].price/100)+"",v=t[62].mod&&function(t){let e,n=t[62].mod+"";return{c(){e=wp(n)},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}(t);function _(){return t[41](t[62])}return{c(){e=mp("item"),n=mp("iimage"),r=wp(w),o=bp(),i=mp("description"),s=mp("h3"),a=wp(b),c=bp(),u=mp("h6"),v&&v.c(),l=bp(),h=mp("short"),f=wp(C),g=bp(),d=mp("buy"),A=mp("button"),p=wp(" "),y=wp(B),I=bp(),kp(n,"class","svelte-weffh7"),kp(s,"class","svelte-weffh7"),kp(u,"class","svelte-weffh7"),kp(h,"class","svelte-weffh7"),kp(i,"class","column xstart grow2 space-between svelte-weffh7"),kp(A,"class","svelte-weffh7"),kp(d,"class","column center"),kp(e,"class","item row xcenter svelte-weffh7")},m(w,b){pp(w,e,b),Ap(e,n),Ap(n,r),Ap(e,o),Ap(e,i),Ap(i,s),Ap(s,a),Ap(i,c),Ap(i,u),v&&v.m(u,null),Ap(i,l),Ap(i,h),Ap(h,f),Ap(e,g),Ap(e,d),Ap(d,A),Ap(A,p),Ap(A,y),Ap(e,I),m||(E=[Bp(A,"click",_p(t[40])),Bp(e,"click",_)],m=!0)},p(e,n){(t=e)[62].mod&&v.p(t,n)},d(t){t&&yp(e),v&&v.d(),m=!1,tp(E)}}}function UC(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[KC]},$$scope:{ctx:t}}}),e.$on("fade",t[45]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};248&n[0]|256&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function OC(t){let e,n,r,o,i,s,a,c,u,l,h={ctx:t,current:null,token:null,hasCatch:!0,pending:YC,then:PC,catch:NC,value:59,error:60};return ry(c=t[5],h),{c(){e=mp("label"),n=mp("div"),n.textContent="Verify your email to buy drinks",r=bp(),o=mp("input"),s=bp(),a=mp("div"),h.block.c(),kp(o,"type","email"),kp(o,"placeholder","name@host.tld"),o.disabled=i=t[3]?"true":null,kp(e,"for","email"),kp(a,"class","row center xcenter")},m(i,c){pp(i,e,c),Ap(e,n),Ap(e,r),Ap(e,o),Qp(o,t[4]),pp(i,s,c),pp(i,a,c),h.block.m(a,h.anchor=null),h.mount=()=>a,h.anchor=null,u||(l=[Bp(o,"input",t[42]),Bp(o,"keypress",t[43])],u=!0)},p(e,n){t=e,8&n[0]&&i!==(i=t[3]?"true":null)&&(o.disabled=i),16&n[0]&&o.value!==t[4]&&Qp(o,t[4]),h.ctx=t,32&n[0]&&c!==(c=t[5])&&ry(c,h)||oy(h,t,n)},d(t){t&&yp(e),t&&yp(s),t&&yp(a),h.block.d(),h.token=null,h=null,u=!1,tp(l)}}}function FC(t){let e,n,r;return{c(){e=mp("br"),n=bp(),r=mp("p"),r.innerHTML="<blue>Your email is verified</blue>",kp(r,"class","text-center")},m(t,o){pp(t,e,o),pp(t,n,o),pp(t,r,o)},p:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r)}}}function NC(t){let e,n,r=t[60].message+"";return{c(){e=mp("error"),n=wp(r)},m(t,r){pp(t,e,r),Ap(e,n)},p(t,e){32&e[0]&&r!==(r=t[60].message+"")&&Sp(n,r)},d(t){t&&yp(e)}}}function PC(t){let e,n,r=t[59]+"";return{c(){e=mp("p"),n=wp(r)},m(t,r){pp(t,e,r),Ap(e,n)},p(t,e){32&e[0]&&r!==(r=t[59]+"")&&Sp(n,r)},d(t){t&&yp(e)}}}function YC(t){let e;return{c(){e=mp("p"),e.textContent="Requesting badge",kp(e,"aria-busy","true")},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function KC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g;function d(t,e){return t[7]?FC:OC}n=new SC({props:{id:lB,noDescription:!t[7]}});let A=d(t),p=A(t);return{c(){e=mp("article"),ay(n.$$.fragment),r=bp(),p.c(),o=bp(),i=mp("footer"),s=mp("button"),s.textContent="ok",a=bp(),c=mp("button"),u=wp("verify"),kp(s,"class","hgap"),kp(c,"class","hgap green"),c.disabled=l=t[3]||t[7]?"true":null,kp(i,"class","row space-between")},m(l,d){pp(l,e,d),cy(n,e,null),Ap(e,r),p.m(e,null),Ap(e,o),Ap(e,i),Ap(i,s),Ap(i,a),Ap(i,c),Ap(c,u),h=!0,f||(g=[Bp(s,"click",t[44]),Bp(c,"click",t[21])],f=!0)},p(t,r){const i={};128&r[0]&&(i.noDescription=!t[7]),n.$set(i),A===(A=d(t))&&p?p.p(t,r):(p.d(1),p=A(t),p&&(p.c(),p.m(e,o))),(!h||136&r[0]&&l!==(l=t[3]||t[7]?"true":null))&&(c.disabled=l)},i(t){h||(ey(n.$$.fragment,t),h=!0)},o(t){ny(n.$$.fragment,t),h=!1},d(t){t&&yp(e),uy(n),p.d(),f=!1,tp(g)}}}function RC(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[JC]},$$scope:{ctx:t}}}),e.$on("fade",t[50]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};1542&n[0]|256&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function jC(t){let e;return{c(){e=mp("h3"),e.textContent="Your cart is empty"},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function HC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w=Zy[t[62].id].image+"",b=Zy[t[62].id].name+"",C=Zy[t[62].id].short+"",B=t[62].qty+"";function v(){return t[46](t[62])}function _(){return t[47](t[62])}return{c(){e=mp("item"),n=mp("iimage"),r=wp(w),o=bp(),i=mp("description"),s=mp("h3"),a=wp(b),c=bp(),u=mp("short"),l=wp(C),h=bp(),f=mp("buy"),g=mp("b"),g.textContent="-",d=bp(),A=mp("h3"),p=wp(B),y=bp(),I=mp("b"),I.textContent="+",kp(n,"class","svelte-weffh7"),kp(s,"class","svelte-weffh7"),kp(u,"class","svelte-weffh7"),kp(i,"class","column xstart grow2 space-between svelte-weffh7"),kp(g,"role","button"),kp(g,"class","blue"),kp(A,"class","nogap nopad hpad svelte-weffh7"),kp(I,"role","button"),kp(I,"class","blue"),kp(f,"class","row center xcenter"),kp(e,"class","item row xcenter svelte-weffh7")},m(t,w){pp(t,e,w),Ap(e,n),Ap(n,r),Ap(e,o),Ap(e,i),Ap(i,s),Ap(s,a),Ap(i,c),Ap(i,u),Ap(u,l),Ap(e,h),Ap(e,f),Ap(f,g),Ap(f,d),Ap(f,A),Ap(A,p),Ap(f,y),Ap(f,I),m||(E=[Bp(g,"click",v),Bp(I,"click",_)],m=!0)},p(e,n){t=e,2&n[0]&&w!==(w=Zy[t[62].id].image+"")&&Sp(r,w),2&n[0]&&b!==(b=Zy[t[62].id].name+"")&&Sp(a,b),2&n[0]&&C!==(C=Zy[t[62].id].short+"")&&Sp(l,C),2&n[0]&&B!==(B=t[62].qty+"")&&Sp(p,B)},d(t){t&&yp(e),m=!1,tp(E)}}}function VC(t){let e,n,r=t[60].message+"";return{c(){e=mp("p"),n=wp(r),kp(e,"class","error text-center")},m(t,r){pp(t,e,r),Ap(e,n)},p(t,e){4&e[0]&&r!==(r=t[60].message+"")&&Sp(n,r)},d(t){t&&yp(e)}}}function GC(t){let e,n=t[61]?.length&&qC(t);return{c(){n&&n.c(),e=Cp()},m(t,r){n&&n.m(t,r),pp(t,e,r)},p(t,r){t[61]?.length?n?n.p(t,r):(n=qC(t),n.c(),n.m(e.parentNode,e)):n&&(n.d(1),n=null)},d(t){n&&n.d(t),t&&yp(e)}}}function qC(t){let e,n,r,o;return{c(){e=mp("h3"),n=mp("a"),r=wp("Proceed to checkout"),kp(n,"href",o=t[61]),kp(e,"class","nogap text-center")},m(t,o){pp(t,e,o),Ap(e,n),Ap(n,r)},p(t,e){4&e[0]&&o!==(o=t[61])&&kp(n,"href",o)},d(t){t&&yp(e)}}}function zC(t){let e;return{c(){e=mp("h2"),e.textContent="Loading...",kp(e,"aria-busy","true"),kp(e,"class","nogap text-center")},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function JC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B=(t[10]/100).toFixed(2)+"",v=!t[1].length&&jC(),_=t[1],k=[];for(let e=0;e<_.length;e+=1)k[e]=HC(QC(t,_,e));let x={ctx:t,current:null,token:null,hasCatch:!0,pending:zC,then:GC,catch:VC,value:61,error:60};return ry(f=t[2],x),{c(){e=mp("article"),n=mp("header"),n.innerHTML="<h5>Cart</h5>",r=bp(),v&&v.c(),o=bp();for(let t=0;t<k.length;t+=1)k[t].c();i=bp(),s=mp("h3"),a=wp("Sum  "),c=wp(B),u=bp(),l=mp("b"),l.textContent="Add tip",h=bp(),x.block.c(),g=bp(),d=mp("footer"),A=mp("button"),A.textContent="hide",p=bp(),y=mp("div"),y.textContent="",I=bp(),m=mp("button"),E=wp("checkout"),kp(s,"class","text-right"),kp(l,"role","button"),kp(m,"class","green"),m.disabled=w=!t[1].length,kp(d,"class","flex row space-between xcenter")},m(f,w){pp(f,e,w),Ap(e,n),Ap(e,r),v&&v.m(e,null),Ap(e,o);for(let t=0;t<k.length;t+=1)k[t].m(e,null);Ap(e,i),Ap(e,s),Ap(s,a),Ap(s,c),Ap(e,u),Ap(e,l),Ap(e,h),x.block.m(e,x.anchor=null),x.mount=()=>e,x.anchor=g,Ap(e,g),Ap(e,d),Ap(d,A),Ap(d,p),Ap(d,y),Ap(d,I),Ap(d,m),Ap(m,E),b||(C=[Bp(l,"click",t[48]),Bp(A,"click",t[49]),Bp(m,"click",t[29])],b=!0)},p(n,r){if((t=n)[1].length?v&&(v.d(1),v=null):v||(v=jC(),v.c(),v.m(e,o)),201326594&r[0]){let n;for(_=t[1],n=0;n<_.length;n+=1){const o=QC(t,_,n);k[n]?k[n].p(o,r):(k[n]=HC(o),k[n].c(),k[n].m(e,i))}for(;n<k.length;n+=1)k[n].d(1);k.length=_.length}1024&r[0]&&B!==(B=(t[10]/100).toFixed(2)+"")&&Sp(c,B),x.ctx=t,4&r[0]&&f!==(f=t[2])&&ry(f,x)||oy(x,t,r),2&r[0]&&w!==(w=!t[1].length)&&(m.disabled=w)},d(t){t&&yp(e),v&&v.d(),Ip(k,t),x.block.d(),x.token=null,x=null,b=!1,tp(C)}}}function WC(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[oB]},$$scope:{ctx:t}}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};1&n[0]|256&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function XC(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p=t[60].message+"",y=window.location+"",I=t[60].message+"",m=t[60].stack+"";return{c(){e=mp("emo"),e.textContent="",n=bp(),r=mp("error"),o=wp(p),i=bp(),s=mp("p"),s.innerHTML="Something went wrong, please contact support\n            tony@decentlabs.se and include error report\n            below in the message<br/>\n            We&#39;re very sorry to be us right now.",a=bp(),c=mp("pre"),u=wp(""),l=wp(y),h=wp("\n"),f=wp(I),g=wp("\n"),d=wp(m),A=wp("\n"),kp(e,"class","svelte-weffh7"),kp(c,"class","error-report vgap svelte-weffh7")},m(t,p){pp(t,e,p),pp(t,n,p),pp(t,r,p),Ap(r,o),pp(t,i,p),pp(t,s,p),pp(t,a,p),pp(t,c,p),Ap(c,u),Ap(c,l),Ap(c,h),Ap(c,f),Ap(c,g),Ap(c,d),Ap(c,A)},p(t,e){1&e[0]&&p!==(p=t[60].message+"")&&Sp(o,p),1&e[0]&&I!==(I=t[60].message+"")&&Sp(f,I),1&e[0]&&m!==(m=t[60].stack+"")&&Sp(d,m)},d(t){t&&yp(e),t&&yp(n),t&&yp(r),t&&yp(i),t&&yp(s),t&&yp(a),t&&yp(c)}}}function ZC(t){let e,n,r,o,i=t[59]+"";return{c(){e=mp("emo"),e.textContent="",n=bp(),r=mp("p"),o=wp(i),kp(e,"class","svelte-weffh7")},m(t,i){pp(t,e,i),pp(t,n,i),pp(t,r,i),Ap(r,o)},p(t,e){1&e[0]&&i!==(i=t[59]+"")&&Sp(o,i)},d(t){t&&yp(e),t&&yp(n),t&&yp(r)}}}function tB(t){let e;return{c(){e=mp("emo"),e.textContent="",kp(e,"aria-busy","true"),kp(e,"class","svelte-weffh7")},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function eB(t){let e,n,r;return{c(){e=mp("button"),e.textContent="Retry",kp(e,"class","red")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[33]),n=!0)},p:WA,d(t){t&&yp(e),n=!1,r()}}}function nB(t){let e,n,r;return{c(){e=mp("button"),e.textContent="Ok",kp(e,"class","green")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[51]),n=!0)},p:WA,d(t){t&&yp(e),n=!1,r()}}}function rB(t){let e;return{c(){e=mp("button"),e.textContent="Ok",kp(e,"class","green"),e.disabled="true"},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function oB(t){let e,n,r,o,i,s,a,c,u={ctx:t,current:null,token:null,hasCatch:!0,pending:tB,then:ZC,catch:XC,value:59,error:60};ry(i=t[0],u);let l={ctx:t,current:null,token:null,hasCatch:!0,pending:rB,then:nB,catch:eB};return ry(c=t[0],l),{c(){e=mp("article"),n=mp("header"),n.innerHTML="<h5>Redeeming order</h5>",r=bp(),o=mp("div"),u.block.c(),s=bp(),a=mp("footer"),l.block.c(),kp(o,"class","flex column xcenter"),kp(a,"class","flex row space-between xcenter")},m(t,i){pp(t,e,i),Ap(e,n),Ap(e,r),Ap(e,o),u.block.m(o,u.anchor=null),u.mount=()=>o,u.anchor=null,Ap(e,s),Ap(e,a),l.block.m(a,l.anchor=null),l.mount=()=>a,l.anchor=null},p(e,n){t=e,u.ctx=t,1&n[0]&&i!==(i=t[0])&&ry(i,u)||oy(u,t,n),l.ctx=t,1&n[0]&&c!==(c=t[0])&&ry(c,l)||oy(l,t,n)},d(t){t&&yp(e),u.block.d(),u.token=null,u=null,l.block.d(),l.token=null,l=null}}}function iB(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[cB]},$$scope:{ctx:t}}}),e.$on("fade",t[55]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};384&n[0]|256&n[2]&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function sB(t){let e,n,r,o,i,s=t[8].price/100+"";return{c(){e=mp("button"),n=wp(" "),r=wp(s),kp(e,"class","hgap red")},m(s,a){pp(s,e,a),Ap(e,n),Ap(e,r),o||(i=Bp(e,"click",t[54]),o=!0)},p(t,e){256&e[0]&&s!==(s=t[8].price/100+"")&&Sp(r,s)},d(t){t&&yp(e),o=!1,i()}}}function aB(t){let e,n,r,o,i,s,a=t[8].price/100+"";return{c(){e=mp("button"),n=wp(" "),r=wp(a),kp(e,"class","hgap blue"),e.disabled=o=!t[7]},m(o,a){pp(o,e,a),Ap(e,n),Ap(e,r),i||(s=Bp(e,"click",t[53]),i=!0)},p(t,n){256&n[0]&&a!==(a=t[8].price/100+"")&&Sp(r,a),128&n[0]&&o!==(o=!t[7])&&(e.disabled=o)},d(t){t&&yp(e),i=!1,s()}}}function cB(t){let e,n,r,o,i,s,a,c,u;function l(t,e){return t[8].id<53760&&t[8].id>=53504?aB:t[8].id>=53760&&t[8].price?sB:void 0}n=new SC({props:{id:t[8].id}});let h=l(t),f=h&&h(t);return{c(){e=mp("article"),ay(n.$$.fragment),r=bp(),o=mp("footer"),i=mp("button"),i.textContent="ok",s=bp(),f&&f.c(),kp(i,"class","hgap"),kp(o,"class","row space-between")},m(l,h){pp(l,e,h),cy(n,e,null),Ap(e,r),Ap(e,o),Ap(o,i),Ap(o,s),f&&f.m(o,null),a=!0,c||(u=Bp(i,"click",t[52]),c=!0)},p(t,e){const r={};256&e[0]&&(r.id=t[8].id),n.$set(r),h===(h=l(t))&&f?f.p(t,e):(f&&f.d(1),f=h&&h(t),f&&(f.c(),f.m(o,null)))},i(t){a||(ey(n.$$.fragment,t),a=!0)},o(t){ny(n.$$.fragment,t),a=!1},d(t){t&&yp(e),uy(n),f&&f.d(),c=!1,u()}}}function uB(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v,_,k,x,S,Q,M,D,T,L,$,U,O,F,N,P,Y,K,R,j,H,V,G,q,z=t[12].balance+"",J=!t[7]&&TC(t),W=Xy.drinks,X=[];for(let e=0;e<W.length;e+=1)X[e]=LC(DC(t,W,e));let Z=Xy.gear,tt=[];for(let e=0;e<Z.length;e+=1)tt[e]=$C(MC(t,Z,e));let et=t[6]&&UC(t),nt=t[9]&&RC(t),rt=t[11]&&WC(t),ot=t[8]&&iB(t);return N=new FI({props:{expiresAt:t[12].expiresAt}}),{c(){e=mp("shop-view"),n=mp("splash"),n.innerHTML='<img src="/gfx/shop.jpg" alt="The Bar"/>',r=bp(),o=mp("section"),i=mp("h1"),i.textContent="Bar",s=bp(),a=mp("drinks"),c=mp("item"),u=mp("iimage"),u.textContent=`${t[16].image}`,l=bp(),h=mp("description"),f=mp("h3"),f.textContent=`${t[16].name}`,g=bp(),d=mp("h6"),d.textContent=` ${t[16].time} | ONE TIME`,A=bp(),p=mp("short"),p.textContent=`${t[16].short}`,y=bp(),I=mp("buy"),m=mp("button"),E=wp("free"),w=bp(),b=mp("h2"),b.textContent="Drinks",C=bp(),J&&J.c(),B=bp();for(let t=0;t<X.length;t+=1)X[t].c();v=bp(),_=mp("h2"),_.textContent="Gear",k=bp(),x=mp("gear");for(let t=0;t<tt.length;t+=1)tt[t].c();S=bp(),et&&et.c(),Q=bp(),nt&&nt.c(),M=bp(),rt&&rt.c(),D=bp(),ot&&ot.c(),T=bp(),L=mp("bar"),$=mp("div"),U=mp("button"),U.textContent="back",O=bp(),F=mp("h3"),ay(N.$$.fragment),P=wp(" /\n      "),Y=wp(z),K=bp(),R=mp("h3"),j=wp(" "),H=wp(t[13]),kp(n,"class","column xcenter svelte-weffh7"),kp(i,"class","text-center"),kp(u,"class","svelte-weffh7"),kp(f,"class","svelte-weffh7"),kp(d,"class","svelte-weffh7"),kp(p,"class","svelte-weffh7"),kp(h,"class","column xstart grow2 space-between svelte-weffh7"),m.disabled=t[7],kp(m,"class","green svelte-weffh7"),kp(I,"class","column center"),kp(c,"class","drink row xcenter svelte-weffh7"),kp(b,"class","text-center nogap"),kp(a,"class","svelte-weffh7"),kp(_,"class","text-center nogap"),kp(x,"class","svelte-weffh7"),kp(o,"class","block container"),kp(U,"class","nogap"),kp(F,"class","stat nopad nogap"),kp(R,"class","nopad nogap"),kp(L,"class","flex row space-between xcenter svelte-weffh7"),xp(e,"data-theme","dark")},m(z,W){pp(z,e,W),Ap(e,n),Ap(e,r),Ap(e,o),Ap(o,i),Ap(o,s),Ap(o,a),Ap(a,c),Ap(c,u),Ap(c,l),Ap(c,h),Ap(h,f),Ap(h,g),Ap(h,d),Ap(h,A),Ap(h,p),Ap(c,y),Ap(c,I),Ap(I,m),Ap(m,E),Ap(a,w),Ap(a,b),Ap(a,C),J&&J.m(a,null),Ap(a,B);for(let t=0;t<X.length;t+=1)X[t].m(a,null);Ap(o,v),Ap(o,_),Ap(o,k),Ap(o,x);for(let t=0;t<tt.length;t+=1)tt[t].m(x,null);Ap(e,S),et&&et.m(e,null),Ap(e,Q),nt&&nt.m(e,null),Ap(e,M),rt&&rt.m(e,null),Ap(e,D),ot&&ot.m(e,null),Ap(e,T),Ap(e,L),Ap(L,$),Ap($,U),Ap(L,O),Ap(L,F),cy(N,F,null),Ap(F,P),Ap(F,Y),Ap(L,K),Ap(L,R),Ap(R,j),Ap(R,H),V=!0,G||(q=[Bp(m,"click",_p(t[35])),Bp(c,"click",t[36]),Bp(U,"click",t[56]),Bp(R,"click",t[57])],G=!0)},p(t,n){if((!V||128&n[0])&&(m.disabled=t[7]),t[7]?J&&(J.d(1),J=null):J?J.p(t,n):(J=TC(t),J.c(),J.m(a,B)),67109248&n[0]){let e;for(W=Xy.drinks,e=0;e<W.length;e+=1){const r=DC(t,W,e);X[e]?X[e].p(r,n):(X[e]=LC(r),X[e].c(),X[e].m(a,null))}for(;e<X.length;e+=1)X[e].d(1);X.length=W.length}if(256&n[0]){let e;for(Z=Xy.gear,e=0;e<Z.length;e+=1){const r=MC(t,Z,e);tt[e]?tt[e].p(r,n):(tt[e]=$C(r),tt[e].c(),tt[e].m(x,null))}for(;e<tt.length;e+=1)tt[e].d(1);tt.length=Z.length}t[6]?et?(et.p(t,n),64&n[0]&&ey(et,1)):(et=UC(t),et.c(),ey(et,1),et.m(e,Q)):et&&(Zp(),ny(et,1,1,(()=>{et=null})),ty()),t[9]?nt?(nt.p(t,n),512&n[0]&&ey(nt,1)):(nt=RC(t),nt.c(),ey(nt,1),nt.m(e,M)):nt&&(Zp(),ny(nt,1,1,(()=>{nt=null})),ty()),t[11]?rt?(rt.p(t,n),2048&n[0]&&ey(rt,1)):(rt=WC(t),rt.c(),ey(rt,1),rt.m(e,D)):rt&&(Zp(),ny(rt,1,1,(()=>{rt=null})),ty()),t[8]?ot?(ot.p(t,n),256&n[0]&&ey(ot,1)):(ot=iB(t),ot.c(),ey(ot,1),ot.m(e,T)):ot&&(Zp(),ny(ot,1,1,(()=>{ot=null})),ty());const r={};4096&n[0]&&(r.expiresAt=t[12].expiresAt),N.$set(r),(!V||4096&n[0])&&z!==(z=t[12].balance+"")&&Sp(Y,z),(!V||8192&n[0])&&Sp(H,t[13])},i(t){V||(ey(et),ey(nt),ey(rt),ey(ot),ey(N.$$.fragment,t),V=!0)},o(t){ny(et),ny(nt),ny(rt),ny(ot),ny(N.$$.fragment,t),V=!1},d(t){t&&yp(e),J&&J.d(),Ip(X,t),Ip(tt,t),et&&et.d(),nt&&nt.d(),rt&&rt.d(),ot&&ot.d(),uy(N),G=!1,tp(q)}}}const lB=53249;function hB(t){console.info("TODO: Network purchases")}function fB(t,e,r){let o,s,a,c,u,l,h,f,g,d,A,p,y,I,{q:m={}}=e;const E=vy();ap(t,E,(t=>r(12,y=t)));const w=py(E,(t=>t?.hasBadge));ap(t,w,(t=>r(7,f=t)));const b=Zy[lB],C=Ay(!1);ap(t,C,(t=>r(8,g=t)));const B=Ay(!1);ap(t,B,(t=>r(6,h=t)));const v=Ay("");ap(t,v,(t=>r(4,u=t)));const _=Ay(!1);function k(){dp(_,c=!0,c),dp(x,l=async function(t){const e=await wy.feed();return e.append(wy.constructor.encodeBlock("badge-plz",await wy.seq(),{email:t}),wy._secret),(await EC(mC+"/v0/verify",e)).message}(u).catch((t=>{throw dp(_,c=!1,c),console.error(t),t})),l)}ap(t,_,(t=>r(3,c=t)));let x=Ay(Promise.resolve(""));ap(t,x,(t=>r(5,l=t)));const S=Ay([]);ap(t,S,(t=>r(1,s=t)));const Q=py(S,(t=>t.reduce(((t,e)=>t+Zy[e.id].price*e.qty),0)));ap(t,Q,(t=>r(10,A=t)));const M=py(S,(t=>t.reduce(((t,e)=>t+e.qty),0)));function D(t){const e=s.find((e=>e.id===t))?.qty||0;L(t,e+1)}function T(t){const e=s.find((e=>e.id===t))?.qty||0;L(t,e-1)}function L(t,e=0){let n=s.find((e=>e.id===t));n||(n={id:t,qty:0},s.push(n)),n.qty=Math.max(e,0),S.set(s)}ap(t,M,(t=>r(13,I=t)));const $=Ay(Promise.resolve());ap(t,$,(t=>r(2,a=t)));const U=Ay(!1);ap(t,U,(t=>r(9,d=t)));const O=Ay(m.redeem);ap(t,O,(t=>r(11,p=t)));const F=Ay(Promise.resolve());function N(){m.redeem;const t=m.session;dp(F,o=wC(t),o)}ap(t,F,(t=>r(0,o=t))),m.redeem&&N();return t.$$set=t=>{"q"in t&&r(34,m=t.q)},[o,s,a,c,u,l,h,f,g,d,A,p,y,I,E,w,b,C,B,v,_,k,x,S,Q,M,D,T,$,function(){dp($,a=async function(t){if(console.log("checkout cart",t),"active"!==(await n.exports.until(wy.$profile(),(t=>"loading"!==t.state))).state)throw new Error("Feed busy");const e=await wy.feed(),r=await wy.seq()+1;t=t.map((t=>53504!==t.id?{id:t.id,q:t.qty}:{id:t.id,q:1,a:100*t.qty})),e.append(wy.constructor.encodeBlock("cart",r,{items:t}),wy._secret);const o=await EC(mC+"/v0/checkout",e);return window.location=o.url,o.url}(s),a)},U,O,F,N,m,()=>dp(B,h=!0,h),()=>dp(B,h=!0,h),()=>dp(B,h=!0,h),t=>D(t.id),t=>dp(C,g=t,g),()=>hB(i),t=>dp(C,g=t,g),function(){u=this.value,v.set(u)},t=>13===t.charCode&&k(),()=>dp(B,h=!1,h),()=>dp(B,h=!1,h),t=>T(t.id),t=>D(t.id),()=>D(53504),()=>dp(U,d=!1,d),()=>dp(U,d=!1,d),()=>Uv("/wallet"),()=>dp(C,g=!1,g),()=>{D(g.id),dp(C,g=!1,g)},()=>{hB(),dp(C,g=!1,g)},()=>dp(C,g=!1,g),()=>Uv("/"),()=>dp(U,d=!d,d)]}class gB extends fy{constructor(t){super(),hy(this,t,fB,uB,np,{q:34},null,[-1,-1,-1])}}function dB(t){let e,n,r,o,i,s,a,c;return a=new Ab({props:{src:t[0].peer.picture}}),{c(){e=mp("vibe"),n=Ep("mask"),r=Ep("tint"),i=bp(),s=mp("portrait"),ay(a.$$.fragment),kp(r,"style",o=`width: ${100*t[1]}px;`),kp(r,"class","svelte-ns996z"),kp(n,"class","svelte-ns996z"),kp(s,"class","svelte-ns996z"),kp(e,"class","svelte-ns996z")},m(t,o){pp(t,e,o),Ap(e,n),Ap(n,r),Ap(e,i),Ap(e,s),cy(a,s,null),c=!0},p(t,[e]){(!c||2&e&&o!==(o=`width: ${100*t[1]}px;`))&&kp(r,"style",o);const n={};1&e&&(n.src=t[0].peer.picture),a.$set(n)},i(t){c||(ey(a.$$.fragment,t),c=!0)},o(t){ny(a.$$.fragment,t),c=!1},d(t){t&&yp(e),uy(a)}}}function AB(t,e,n){let r,{vibe:o}=e;const i=o.expiresAt-o.createdAt,s=dy(1,(t=>{const e=setInterval((()=>{const n=o.expiresAt-Date.now();n<=0?(t(0),clearInterval(e)):t(n/i)}),1e3);return()=>clearInterval(e)}));return ap(t,s,(t=>n(1,r=t))),t.$$set=t=>{"vibe"in t&&n(0,o=t.vibe)},[o,r,s]}class pB extends fy{constructor(t){super(),hy(this,t,AB,dB,np,{vibe:0})}}function yB(t,e,n){const r=t.slice();return r[13]=e[n],r}function IB(t,e,n){const r=t.slice();return r[16]=e[n],r}function mB(t,e,n){const r=t.slice();return r[19]=e[n],r}function EB(t){let e,n,r,o,i,s;function a(){return t[7](t[19])}return n=new pB({props:{vibe:t[19]}}),{c(){e=mp("div"),ay(n.$$.fragment),r=bp()},m(t,c){pp(t,e,c),cy(n,e,null),Ap(e,r),o=!0,i||(s=Bp(e,"click",a),i=!0)},p(e,r){t=e;const o={};2&r&&(o.vibe=t[19]),n.$set(o)},i(t){o||(ey(n.$$.fragment,t),o=!0)},o(t){ny(n.$$.fragment,t),o=!1},d(t){t&&yp(e),uy(n),i=!1,s()}}}function wB(t){let e,n,r="match"!==t[19].state&&EB(t);return{c(){r&&r.c(),e=Cp()},m(t,o){r&&r.m(t,o),pp(t,e,o),n=!0},p(t,n){"match"!==t[19].state?r?(r.p(t,n),2&n&&ey(r,1)):(r=EB(t),r.c(),ey(r,1),r.m(e.parentNode,e)):r&&(Zp(),ny(r,1,1,(()=>{r=null})),ty())},i(t){n||(ey(r),n=!0)},o(t){ny(r),n=!1},d(t){r&&r.d(t),t&&yp(e)}}}function bB(t){let e,n;return e=new aI({props:{id:"heal_resp",tag:"empty"}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function CB(t){let e,n;return e=new aI({props:{id:"heal_resp",tag:"full"}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function BB(t){let e,n,r,o;const i=[CB,bB],s=[];function a(t,e){return t[16]<t[13].health?0:1}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=Cp()},m(t,n){s[e].m(t,n),pp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e!==c&&(Zp(),ny(s[c],1,1,(()=>{s[c]=null})),ty(),n=s[e],n||(n=s[e]=i[e](t),n.c()),ey(n,1),n.m(r.parentNode,r))},i(t){o||(ey(n),o=!0)},o(t){ny(n),o=!1},d(t){s[e].d(t),t&&yp(r)}}}function vB(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w=t[13].peer.name+"",b=t[13].myTurn?"your turn":"waiting";r=new Ab({props:{src:t[13].peer.picture,size:"80px"}});let C=[0,1,2],B=[];for(let e=0;e<3;e+=1)B[e]=BB(IB(t,C,e));const v=t=>ny(B[t],1,1,(()=>{B[t]=null}));function _(){return t[8](t[13])}return p=new FI({props:{expiresAt:t[13].expiresAt,format:"mm:ss"}}),{c(){e=mp("div"),n=mp("div"),ay(r.$$.fragment),o=bp(),i=mp("div"),s=mp("h3"),a=wp(w),c=bp(),u=mp("h6"),l=wp(b),h=bp(),f=mp("div"),g=mp("health");for(let t=0;t<3;t+=1)B[t].c();d=bp(),A=mp("h3"),ay(p.$$.fragment),y=bp(),kp(s,"class","no-margin"),kp(u,"class","no-margin"),kp(i,"class","columns space-between gap"),kp(n,"class","row xcenter"),kp(A,"class","no-margin"),kp(f,"class","columns xcenter gap"),kp(e,"class","row space-between")},m(t,w){pp(t,e,w),Ap(e,n),cy(r,n,null),Ap(n,o),Ap(n,i),Ap(i,s),Ap(s,a),Ap(i,c),Ap(i,u),Ap(u,l),Ap(e,h),Ap(e,f),Ap(f,g);for(let t=0;t<3;t+=1)B[t].m(g,null);Ap(f,d),Ap(f,A),cy(p,A,null),Ap(e,y),I=!0,m||(E=Bp(e,"click",_),m=!0)},p(e,n){t=e;const o={};if(4&n&&(o.src=t[13].peer.picture),r.$set(o),(!I||4&n)&&w!==(w=t[13].peer.name+"")&&Sp(a,w),(!I||4&n)&&b!==(b=t[13].myTurn?"your turn":"waiting")&&Sp(l,b),4&n){let e;for(C=[0,1,2],e=0;e<3;e+=1){const r=IB(t,C,e);B[e]?(B[e].p(r,n),ey(B[e],1)):(B[e]=BB(r),B[e].c(),ey(B[e],1),B[e].m(g,null))}for(Zp(),e=3;e<3;e+=1)v(e);ty()}const i={};4&n&&(i.expiresAt=t[13].expiresAt),p.$set(i)},i(t){if(!I){ey(r.$$.fragment,t);for(let t=0;t<3;t+=1)ey(B[t]);ey(p.$$.fragment,t),I=!0}},o(t){ny(r.$$.fragment,t),B=B.filter(Boolean);for(let t=0;t<3;t+=1)ny(B[t]);ny(p.$$.fragment,t),I=!1},d(t){t&&yp(e),uy(r),Ip(B,t),uy(p),m=!1,E()}}}function _B(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[SB]},$$scope:{ctx:t}}}),e.$on("fade",t[12]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};4194305&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function kB(t){let e,n,r,o,i;return{c(){e=mp("button"),e.textContent="hide",n=bp(),r=mp("div"),r.textContent="Waiting for player2",kp(e,"class","hgap"),kp(r,"class","text-center")},m(s,a){pp(s,e,a),pp(s,n,a),pp(s,r,a),o||(i=Bp(e,"click",t[11]),o=!0)},p:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r),o=!1,i()}}}function xB(t){let e,n,r,o,i;return{c(){e=mp("button"),e.textContent="reject",n=bp(),r=mp("button"),r.textContent="accept",kp(e,"class","hgap reject svelte-wwtn89"),kp(r,"class","hgap accept svelte-wwtn89")},m(s,a){pp(s,e,a),pp(s,n,a),pp(s,r,a),o||(i=[Bp(e,"click",t[9]),Bp(r,"click",t[10])],o=!0)},p:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r),o=!1,tp(i)}}}function SB(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p=t[0].peer.tagline+"";function y(t,e){return t[0].initiator?kB:xB}n=new Ab({props:{src:t[0]?.peer.picture}}),f=new FI({props:{expiresAt:t[0].expiresAt,format:"mm:ss"}});let I=y(t),m=I(t);return{c(){e=mp("article"),ay(n.$$.fragment),r=bp(),o=mp("p"),i=wp(p),s=bp(),a=mp("p"),a.textContent="TODO: transaction details",c=bp(),u=mp("h6"),u.textContent="Vibe Expires in",l=bp(),h=mp("h2"),ay(f.$$.fragment),g=bp(),d=mp("footer"),m.c(),kp(u,"class","text-center no-margin"),kp(h,"class","text-center timer svelte-wwtn89"),kp(d,"class","row space-between")},m(t,p){pp(t,e,p),cy(n,e,null),Ap(e,r),Ap(e,o),Ap(o,i),Ap(e,s),Ap(e,a),Ap(e,c),Ap(e,u),Ap(e,l),Ap(e,h),cy(f,h,null),Ap(e,g),Ap(e,d),m.m(d,null),A=!0},p(t,e){const r={};1&e&&(r.src=t[0]?.peer.picture),n.$set(r),(!A||1&e)&&p!==(p=t[0].peer.tagline+"")&&Sp(i,p);const o={};1&e&&(o.expiresAt=t[0].expiresAt),f.$set(o),I===(I=y(t))&&m?m.p(t,e):(m.d(1),m=I(t),m&&(m.c(),m.m(d,null)))},i(t){A||(ey(n.$$.fragment,t),ey(f.$$.fragment,t),A=!0)},o(t){ny(n.$$.fragment,t),ny(f.$$.fragment,t),A=!1},d(t){t&&yp(e),uy(n),uy(f),m.d()}}}function QB(t){let e,n,r,o,i,s,a,c,u,l,h,f,g=t[1],d=[];for(let e=0;e<g.length;e+=1)d[e]=wB(mB(t,g,e));const A=t=>ny(d[t],1,1,(()=>{d[t]=null}));let p=t[2],y=[];for(let e=0;e<p.length;e+=1)y[e]=vB(yB(t,p,e));const I=t=>ny(y[t],1,1,(()=>{y[t]=null}));let m=t[0]&&_B(t);return{c(){e=mp("messages-view"),n=mp("h1"),n.textContent=" Messages",r=bp(),o=mp("h5"),o.textContent="Vibes",i=bp(),s=mp("vibes");for(let t=0;t<d.length;t+=1)d[t].c();a=bp(),c=mp("h5"),c.textContent="Conversations",u=bp(),l=mp("conversations");for(let t=0;t<y.length;t+=1)y[t].c();h=bp(),m&&m.c(),kp(s,"class","row xcenter"),xp(e,"class","block container")},m(t,g){pp(t,e,g),Ap(e,n),Ap(e,r),Ap(e,o),Ap(e,i),Ap(e,s);for(let t=0;t<d.length;t+=1)d[t].m(s,null);Ap(e,a),Ap(e,c),Ap(e,u),Ap(e,l);for(let t=0;t<y.length;t+=1)y[t].m(l,null);Ap(e,h),m&&m.m(e,null),f=!0},p(t,[n]){if(3&n){let e;for(g=t[1],e=0;e<g.length;e+=1){const r=mB(t,g,e);d[e]?(d[e].p(r,n),ey(d[e],1)):(d[e]=wB(r),d[e].c(),ey(d[e],1),d[e].m(s,null))}for(Zp(),e=g.length;e<d.length;e+=1)A(e);ty()}if(4&n){let e;for(p=t[2],e=0;e<p.length;e+=1){const r=yB(t,p,e);y[e]?(y[e].p(r,n),ey(y[e],1)):(y[e]=vB(r),y[e].c(),ey(y[e],1),y[e].m(l,null))}for(Zp(),e=p.length;e<y.length;e+=1)I(e);ty()}t[0]?m?(m.p(t,n),1&n&&ey(m,1)):(m=_B(t),m.c(),ey(m,1),m.m(e,null)):m&&(Zp(),ny(m,1,1,(()=>{m=null})),ty())},i(t){if(!f){for(let t=0;t<g.length;t+=1)ey(d[t]);for(let t=0;t<p.length;t+=1)ey(y[t]);ey(m),f=!0}},o(t){d=d.filter(Boolean);for(let t=0;t<d.length;t+=1)ny(d[t]);y=y.filter(Boolean);for(let t=0;t<y.length;t+=1)ny(y[t]);ny(m),f=!1},d(t){t&&yp(e),Ip(d,t),Ip(y,t),m&&m.d()}}}function MB(t,e,n){let r,o,i;const s=my(wy.$chats());ap(t,s,(t=>n(2,i=t)));const a=_y();ap(t,a,(t=>n(1,o=t)));const c=Ay(null);function u(t,e){wy.respondVibe(t,e).then((()=>{dp(c,r=null,r)})).catch((t=>console.error("Vibe response failed",t)))}ap(t,c,(t=>n(0,r=t)));return[r,o,i,s,a,c,u,t=>dp(c,r=t,r),t=>Uv("/chat/"+t.id.toString("hex")),()=>u(r.id,!0),()=>u(r.id),()=>dp(c,r=null,r),()=>dp(c,r=null,r)]}class DB extends fy{constructor(t){super(),hy(this,t,MB,QB,np,{})}}function TB(t,e,n){const r=t.slice();return r[25]=e[n],r}function LB(t,e,n){const r=t.slice();return r[28]=e[n],r}function $B(t){let e;return{c(){e=mp("placeholder"),e.textContent="",kp(e,"aria-busy","true")},m(t,n){pp(t,e,n)},p:WA,i:WA,o:WA,d(t){t&&yp(e)}}}function UB(t){let e,n,r,o,i,s,a,c,u,l=t[0].peer.name+"";return n=new Ab({props:{src:t[0].peer.picture,size:"70px"}}),{c(){e=mp("portrait"),ay(n.$$.fragment),r=bp(),o=mp("div"),i=mp("h1"),s=wp(l),a=bp(),c=mp("div"),kp(e,"class","svelte-1secqat"),kp(i,"class","hgap svelte-1secqat"),kp(c,"class","hgap"),kp(o,"class","column")},m(t,l){pp(t,e,l),cy(n,e,null),pp(t,r,l),pp(t,o,l),Ap(o,i),Ap(i,s),Ap(o,a),Ap(o,c),u=!0},p(t,e){const r={};1&e&&(r.src=t[0].peer.picture),n.$set(r),(!u||1&e)&&l!==(l=t[0].peer.name+"")&&Sp(s,l)},i(t){u||(ey(n.$$.fragment,t),u=!0)},o(t){ny(n.$$.fragment,t),u=!1},d(t){t&&yp(e),uy(n),t&&yp(r),t&&yp(o)}}}function OB(t){let e,n;return e=new aI({props:{id:"heal_resp",tag:"empty"}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function FB(t){let e,n;return e=new aI({props:{id:"heal_resp",tag:"full"}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function NB(t){let e,n,r,o;const i=[FB,OB],s=[];function a(t,e){return t[28]?0:1}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=Cp()},m(t,n){s[e].m(t,n),pp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e!==c&&(Zp(),ny(s[c],1,1,(()=>{s[c]=null})),ty(),n=s[e],n||(n=s[e]=i[e](t),n.c()),ey(n,1),n.m(r.parentNode,r))},i(t){o||(ey(n),o=!0)},o(t){ny(n),o=!1},d(t){s[e].d(t),t&&yp(r)}}}function PB(t){let e,n,r=t[25].content+"";return{c(){e=mp("txt"),n=wp(r),kp(e,"class","svelte-1secqat")},m(t,r){pp(t,e,r),Ap(e,n)},p(t,e){1&e&&r!==(r=t[25].content+"")&&Sp(n,r)},d(t){t&&yp(e)}}}function YB(t){let e;function n(t,e){return t[0].initiator&&"sent"===t[25].type||!t[0].initiator&&"received"===t[25].type?RB:KB}let r=n(t),o=r(t);return{c(){e=mp("sym"),o.c(),kp(e,"class","hgap svelte-1secqat")},m(t,n){pp(t,e,n),o.m(e,null)},p(t,i){r!==(r=n(t))&&(o.d(1),o=r(t),o&&(o.c(),o.m(e,null)))},d(t){t&&yp(e),o.d()}}}function KB(t){let e;return{c(){e=wp("")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function RB(t){let e;return{c(){e=wp("")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function jB(t){let e;function n(t,e){return t[25].pass?YB:PB}let r=n(t),o=r(t);return{c(){e=mp("msg"),o.c(),kp(e,"class","row xcenter svelte-1secqat"),Dp(e,"start","received"===t[25].type),Dp(e,"remote","received"===t[25].type),Dp(e,"local","sent"===t[25].type),Dp(e,"end","sent"===t[25].type)},m(t,n){pp(t,e,n),o.m(e,null)},p(t,i){r===(r=n(t))&&o?o.p(t,i):(o.d(1),o=r(t),o&&(o.c(),o.m(e,null))),1&i&&Dp(e,"start","received"===t[25].type),1&i&&Dp(e,"remote","received"===t[25].type),1&i&&Dp(e,"local","sent"===t[25].type),1&i&&Dp(e,"end","sent"===t[25].type)},d(t){t&&yp(e),o.d()}}}function HB(t){let e,n,r,o,i,s=t[6][0]+"",a=t[6][1]+"";return{c(){e=mp("white"),n=wp(s),r=bp(),o=mp("black"),i=wp(a)},m(t,s){pp(t,e,s),Ap(e,n),pp(t,r,s),pp(t,o,s),Ap(o,i)},p(t,e){64&e&&s!==(s=t[6][0]+"")&&Sp(n,s),64&e&&a!==(a=t[6][1]+"")&&Sp(i,a)},d(t){t&&yp(e),t&&yp(r),t&&yp(o)}}}function VB(t){let e,n,r,o,i,s=t[6][1]+"",a=t[6][0]+"";return{c(){e=mp("black"),n=wp(s),r=bp(),o=mp("white"),i=wp(a)},m(t,s){pp(t,e,s),Ap(e,n),pp(t,r,s),pp(t,o,s),Ap(o,i)},p(t,e){64&e&&s!==(s=t[6][1]+"")&&Sp(n,s),64&e&&a!==(a=t[6][0]+"")&&Sp(i,a)},d(t){t&&yp(e),t&&yp(r),t&&yp(o)}}}function GB(t){let e,n,r=t[0].state+"";return{c(){e=mp("h2"),n=wp(r),kp(e,"class","text-center nogap svelte-1secqat")},m(t,r){pp(t,e,r),Ap(e,n)},p(t,e){1&e&&r!==(r=t[0].state+"")&&Sp(n,r)},d(t){t&&yp(e)}}}function qB(t){let e;return{c(){e=mp("h2"),e.textContent="Conversion ended",kp(e,"class","text-center nogap svelte-1secqat")},m(t,n){pp(t,e,n)},p:WA,d(t){t&&yp(e)}}}function zB(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d=t[7][0].join("/")+"",A=t[7][1].join("/")+"",p=t[7][2].join("/")+"";function y(t,e){return t[0].myTurn?WB:JB}let I=y(t),m=I(t);function E(t,e){return t[3]?XB:ZB}let w=E(t),b=w(t);return{c(){e=mp("h2"),m.c(),n=bp(),r=mp("div"),b.c(),o=bp(),i=mp("div"),s=mp("samp"),a=wp(d),c=bp(),u=mp("samp"),l=wp(A),h=bp(),f=mp("samp"),g=wp(p),kp(e,"class","text-center nogap svelte-1secqat"),kp(r,"class","row space-between"),kp(i,"class","row space-between")},m(t,d){pp(t,e,d),m.m(e,null),pp(t,n,d),pp(t,r,d),b.m(r,null),pp(t,o,d),pp(t,i,d),Ap(i,s),Ap(s,a),Ap(i,c),Ap(i,u),Ap(u,l),Ap(i,h),Ap(i,f),Ap(f,g)},p(t,n){I!==(I=y(t))&&(m.d(1),m=I(t),m&&(m.c(),m.m(e,null))),w===(w=E(t))&&b?b.p(t,n):(b.d(1),b=w(t),b&&(b.c(),b.m(r,null))),128&n&&d!==(d=t[7][0].join("/")+"")&&Sp(a,d),128&n&&A!==(A=t[7][1].join("/")+"")&&Sp(l,A),128&n&&p!==(p=t[7][2].join("/")+"")&&Sp(g,p)},d(t){t&&yp(e),m.d(),t&&yp(n),t&&yp(r),b.d(),t&&yp(o),t&&yp(i)}}}function JB(t){let e;return{c(){e=wp("Waiting")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function WB(t){let e;return{c(){e=wp("Your turn")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function XB(t){let e,n,r;return{c(){e=mp("input"),kp(e,"class","line")},m(o,i){pp(o,e,i),t[21](e),Qp(e,t[4]),n||(r=[Bp(e,"input",t[22]),Bp(e,"keypress",t[16]),Bp(e,"blur",t[23])],n=!0)},p(t,n){16&n&&e.value!==t[4]&&Qp(e,t[4])},d(o){o&&yp(e),t[21](null),n=!1,tp(r)}}}function ZB(t){let e,n,r,o,i,s,a,c,u,l,h,f,g;return{c(){e=mp("button"),n=wp("end"),o=bp(),i=mp("button"),s=wp("msg"),c=bp(),u=mp("button"),l=wp("pass"),kp(e,"class","hgap"),e.disabled=r=!t[0].myTurn,kp(i,"class","hgap"),i.disabled=a=!t[0].myTurn,kp(u,"class","hgap"),u.disabled=h=!t[0].myTurn},m(r,a){pp(r,e,a),Ap(e,n),pp(r,o,a),pp(r,i,a),Ap(i,s),pp(r,c,a),pp(r,u,a),Ap(u,l),f||(g=[Bp(e,"click",t[19]),Bp(i,"click",t[20]),Bp(u,"click",t[15])],f=!0)},p(t,n){1&n&&r!==(r=!t[0].myTurn)&&(e.disabled=r),1&n&&a!==(a=!t[0].myTurn)&&(i.disabled=a),1&n&&h!==(h=!t[0].myTurn)&&(u.disabled=h)},d(t){t&&yp(e),t&&yp(o),t&&yp(i),t&&yp(c),t&&yp(u),f=!1,tp(g)}}}function tv(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C=Lf.rewrite(t[0].graph||"")+"";const B=[UB,$B],v=[];function _(t,e){return t[0].peer?0:1}o=_(t),i=v[o]=B[o](t);let k=t[5],x=[];for(let e=0;e<k.length;e+=1)x[e]=NB(LB(t,k,e));const S=t=>ny(x[t],1,1,(()=>{x[t]=null}));h=new FI({props:{expiresAt:t[0].expiresAt,format:"mm:ss"}});let Q=t[0].messages,M=[];for(let e=0;e<Q.length;e+=1)M[e]=jB(TB(t,Q,e));function D(t,e){return t[0].initiator?VB:HB}let T=D(t),L=T(t);function $(t,e){return"active"===t[0].state?zB:"end"===t[0].state?qB:GB}let U=$(t),O=U(t);return{c(){e=mp("chat"),n=mp("header"),r=mp("div"),i.c(),s=bp(),a=mp("div"),c=mp("health");for(let t=0;t<x.length;t+=1)x[t].c();u=bp(),l=mp("h3"),ay(h.$$.fragment),f=bp(),g=mp("messages"),d=mp("p"),A=wp(C),p=bp();for(let t=0;t<M.length;t+=1)M[t].c();y=bp(),I=mp("msg"),m=mp("balance"),L.c(),E=bp(),w=mp("ctrls"),O.c(),kp(r,"class","row xcenter"),kp(l,"class","svelte-1secqat"),kp(a,"class","column xend"),kp(n,"class","container row space-between svelte-1secqat"),kp(d,"class","text-center"),Dp(m,"inv",!t[0].initiator),kp(I,"class","row xcenter center svelte-1secqat"),kp(g,"class","container svelte-1secqat"),kp(e,"class","svelte-1secqat"),Dp(e,"white",t[0].initiator),Dp(e,"black",!t[0].initiator)},m(i,C){pp(i,e,C),Ap(e,n),Ap(n,r),v[o].m(r,null),Ap(n,s),Ap(n,a),Ap(a,c);for(let t=0;t<x.length;t+=1)x[t].m(c,null);Ap(a,u),Ap(a,l),cy(h,l,null),Ap(e,f),Ap(e,g),Ap(g,d),Ap(d,A),Ap(g,p);for(let t=0;t<M.length;t+=1)M[t].m(g,null);Ap(g,y),Ap(g,I),Ap(I,m),L.m(m,null),t[18](g),Ap(e,E),Ap(e,w),O.m(w,null),b=!0},p(t,[n]){let s=o;if(o=_(t),o===s?v[o].p(t,n):(Zp(),ny(v[s],1,1,(()=>{v[s]=null})),ty(),i=v[o],i?i.p(t,n):(i=v[o]=B[o](t),i.c()),ey(i,1),i.m(r,null)),32&n){let e;for(k=t[5],e=0;e<k.length;e+=1){const r=LB(t,k,e);x[e]?(x[e].p(r,n),ey(x[e],1)):(x[e]=NB(r),x[e].c(),ey(x[e],1),x[e].m(c,null))}for(Zp(),e=k.length;e<x.length;e+=1)S(e);ty()}const a={};if(1&n&&(a.expiresAt=t[0].expiresAt),h.$set(a),(!b||1&n)&&C!==(C=Lf.rewrite(t[0].graph||"")+"")&&Sp(A,C),1&n){let e;for(Q=t[0].messages,e=0;e<Q.length;e+=1){const r=TB(t,Q,e);M[e]?M[e].p(r,n):(M[e]=jB(r),M[e].c(),M[e].m(g,y))}for(;e<M.length;e+=1)M[e].d(1);M.length=Q.length}T===(T=D(t))&&L?L.p(t,n):(L.d(1),L=T(t),L&&(L.c(),L.m(m,null))),1&n&&Dp(m,"inv",!t[0].initiator),U===(U=$(t))&&O?O.p(t,n):(O.d(1),O=U(t),O&&(O.c(),O.m(w,null))),1&n&&Dp(e,"white",t[0].initiator),1&n&&Dp(e,"black",!t[0].initiator)},i(t){if(!b){ey(i);for(let t=0;t<k.length;t+=1)ey(x[t]);ey(h.$$.fragment,t),b=!0}},o(t){ny(i),x=x.filter(Boolean);for(let t=0;t<x.length;t+=1)ny(x[t]);ny(h.$$.fragment,t),b=!1},d(n){n&&yp(e),v[o].d(),Ip(x,n),uy(h),Ip(M,n),L.d(),t[18](null),O.d()}}}function ev(t,e,n){let r,o,i,s,a,c,u,l,{id:h}=e;const f=Vy(h,"Chat");ap(t,f,(t=>n(0,r=t)));const g=Ay(!1);ap(t,g,(t=>n(3,o=t)));const d=Ay("");ap(t,d,(t=>n(4,i=t)));const A=py(f,(t=>Array.from(new Array(3)).map(((e,n)=>n<t.health))));ap(t,A,(t=>n(5,s=t)));const p=py(f,(t=>t.graph?t.initiator?Lf.scoreGraph(t.graph):Lf.scoreGraph(t.graph).reverse():[0,0]));ap(t,p,(t=>n(6,a=t)));const y=py([f,p],(([t,e])=>t.graph?(t.initiator||(e=e.reverse()),[t.initiator?"":"",t.initiator?"":"",t.initiator?"":""].map((n=>{const r=Lf.scoreGraph(t.graph+n).map(((t,n)=>t-e[n])).map((t=>function(t){return t>0?`+${t}`:t}(t)));return t.initiator?r:r.reverse()}))):[[0,0],[0,0],[0,0]]));var I;function m(t=0){console.log("Bye button pressed"),r.bye(t).then((()=>console.info("Bye published"))).catch((t=>console.error("Failed publishing Bye",t)))}ap(t,y,(t=>n(7,c=t))),I=()=>{u.scrollTo({top:u.scrollHeight,left:0,behaviour:"smooth"}),o&&l.focus()},$p().$$.after_update.push(I);return t.$$set=t=>{"id"in t&&n(17,h=t.id)},t.$$.update=()=>{1&t.$$.dirty&&"finalizing"===r.state&&r.myTurn&&m()},[r,u,l,o,i,s,a,c,f,g,d,A,p,y,m,function(){r.pass().then((()=>console.info("Pass published"))).catch((t=>console.error("Failed publishing Pass",t)))},function({charCode:t}){if(13===t)r.send(i.trim()).then((()=>{console.info("Message published"),dp(d,i="",i),dp(g,o=!1,o)})).catch((t=>console.error("Failed publishing Message",t)))},h,function(t){Pp[t?"unshift":"push"]((()=>{u=t,n(1,u)}))},()=>m(0),()=>dp(g,o=!0,o),function(t){Pp[t?"unshift":"push"]((()=>{l=t,n(2,l)}))},function(){i=this.value,d.set(i)},()=>dp(g,o=!!i.length,o)]}class nv extends fy{constructor(t){super(),hy(this,t,ev,tv,np,{id:17})}}function rv(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v,_,k,x,S,Q,M,D;return o=new aI({props:{id:"dl-logo-red"}}),{c(){e=mp("about"),n=mp("div"),r=mp("logo"),ay(o.$$.fragment),i=bp(),s=mp("h1"),a=wp("Picochat\n    "),c=mp("samp"),c.textContent=`${"3.0.0".replace(/^(\d+).+/,"$1")}`,u=bp(),l=mp("p"),l.textContent="Where ever we're going, we'll get there eventually.\n    Meanwhile, come say hi!\n  ",h=mp("ul"),h.innerHTML='<li class="svelte-1eldk8a"><a href="https://discord.gg/K5XjmZx" class="svelte-1eldk8a">Discord (community chat)</a></li> \n    <li class="svelte-1eldk8a"><a href="https://github.com/telamon/picochat/issues" class="svelte-1eldk8a">Questions &amp; Support</a></li> \n    <li class="svelte-1eldk8a"><a href="https://github.com/telamon/picochat" class="svelte-1eldk8a">Source code</a></li>',f=bp(),g=mp("h5"),g.textContent="Legalities",d=bp(),A=mp("table"),p=mp("tdata"),y=mp("tr"),I=mp("td"),I.textContent="build",m=mp("td"),m.textContent=`production-3.0.0-${"cf0f7f1ed4a876ccfa2e2924764b0eb3b87b7a85".substr(0,8)}`,E=bp(),w=mp("tr"),w.innerHTML="<td>Cookies</td><td>none, zilch, zero</td>",b=bp(),C=mp("tr"),C.innerHTML="<td>GDPR</td><td>All blocks are automatically erased when timers hit <code>00:00</code></td>",B=bp(),v=mp("tr"),v.innerHTML="<td>User</td><td>We have absolutley no control over p2p interactions, apply common sense, be polite</td>",_=bp(),k=mp("tr"),k.innerHTML="<td>License</td><td>GNU AGPL version 3</td>",x=bp(),S=mp("tr"),S.innerHTML="<td>Motto</td><td>No servers, no supernodes, liberate humans and machines alike</td>",Q=bp(),M=mp("p"),M.innerHTML="<sub>Bottom line</sub><br/> \n    <samp>This software is presented to you as is,\n      Decent Labs AB takes no responsibility for how this software is used or distributed.\n      <br/>\n      Refer to the contents of the aforementioned license for more details.</samp>",kp(n,"class","column xcenter vgap"),kp(h,"class","svelte-1eldk8a"),kp(e,"class","block container")},m(t,T){pp(t,e,T),Ap(e,n),Ap(n,r),cy(o,r,null),Ap(e,i),Ap(e,s),Ap(s,a),Ap(s,c),Ap(e,u),Ap(e,l),Ap(e,h),Ap(e,f),Ap(e,g),Ap(e,d),Ap(e,A),Ap(A,p),Ap(p,y),Ap(y,I),Ap(y,m),Ap(p,E),Ap(p,w),Ap(p,b),Ap(p,C),Ap(p,B),Ap(p,v),Ap(p,_),Ap(p,k),Ap(p,x),Ap(p,S),Ap(e,Q),Ap(e,M),D=!0},p:WA,i(t){D||(ey(o.$$.fragment,t),D=!0)},o(t){ny(o.$$.fragment,t),D=!1},d(t){t&&yp(e),uy(o)}}}class ov extends fy{constructor(t){super(),hy(this,t,null,rv,np,{})}}function iv(t){let e,n,r,o,i;return{c(){e=mp("h3"),e.textContent="Done!",n=bp(),r=mp("button"),r.textContent="done"},m(s,a){pp(s,e,a),pp(s,n,a),pp(s,r,a),o||(i=Bp(r,"click",t[3]),o=!0)},p:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r),o=!1,i()}}}function sv(t){let e,n,r,o,i=t[0].error+"";return{c(){e=mp("h3"),e.textContent="Not imported",n=bp(),r=mp("danger"),o=wp(i)},m(t,i){pp(t,e,i),pp(t,n,i),pp(t,r,i),Ap(r,o)},p(t,e){1&e&&i!==(i=t[0].error+"")&&Sp(o,i)},d(t){t&&yp(e),t&&yp(n),t&&yp(r)}}}function av(t){let e,n,r;return{c(){e=mp("h3"),e.textContent="Reading blocks...",n=bp(),r=mp("h1"),kp(r,"aria-busy","true")},m(t,o){pp(t,e,o),pp(t,n,o),pp(t,r,o)},p:WA,d(t){t&&yp(e),t&&yp(n),t&&yp(r)}}}function cv(t){let e,n,r,o;function i(t,e){return t[0].loading?av:t[0].imported?iv:sv}let s=i(t),a=s(t);return{c(){e=mp("append"),n=mp("div"),r=mp("h1"),r.textContent="",o=bp(),a.c(),kp(n,"class","flex column xcenter center"),kp(e,"class","block container")},m(t,i){pp(t,e,i),Ap(e,n),Ap(n,r),Ap(n,o),a.m(n,null)},p(t,[e]){s===(s=i(t))&&a?a.p(t,e):(a.d(1),a=s(t),a&&(a.c(),a.m(n,null)))},i:WA,o:WA,d(t){t&&yp(e),a.d()}}}function uv(t,e,r){let o,{id:i}=e;const s=my(n.exports.init({loading:!0},n.exports.mute(Dv,(async t=>{if(!t)return{loading:!0};const e=ef.Feed.from(t),n=ef.SimpleKernel.decodeBlock(e.last.body).type;let r=null,o=!1;if(!!await wy.repo.readBlock(e.last.sig))r="Already merged","items"===n&&Uv("shop");else try{if(!(await wy.dispatch(e,!0)).length)throw new Error("Rejected by kernel");o=!0,"items"===n&&Uv("shop")}catch(t){console.error(t),r=t.message}return{loading:!1,imported:o,error:r,feed:e}}))));ap(t,s,(t=>r(0,o=t)));return t.$$set=t=>{"id"in t&&r(2,i=t.id)},[o,s,i,()=>Uv("/")]}class lv extends fy{constructor(t){super(),hy(this,t,uv,cv,np,{id:2})}}function hv(t,e,n){const r=t.slice();return r[11]=e[n],r}function fv(t){let e,n=t[11].qty+"";return{c(){e=wp(n)},m(t,n){pp(t,e,n)},p(t,r){2&r&&n!==(n=t[11].qty+"")&&Sp(e,n)},d(t){t&&yp(e)}}}function gv(t){let e,n,r,o,i,s,a,c,u=Zy[t[11].id].image+"",l="consumable"===Zy[t[11].id].type&&fv(t);function h(){return t[6](t[11])}return{c(){e=mp("item"),n=mp("emo"),r=wp(u),o=bp(),l&&l.c(),i=bp(),kp(e,"role","button"),kp(e,"class",s=Zy[t[11].id].category)},m(t,s){pp(t,e,s),Ap(e,n),Ap(n,r),Ap(e,o),l&&l.m(e,null),Ap(e,i),a||(c=Bp(e,"click",h),a=!0)},p(n,o){t=n,2&o&&u!==(u=Zy[t[11].id].image+"")&&Sp(r,u),"consumable"===Zy[t[11].id].type?l?l.p(t,o):(l=fv(t),l.c(),l.m(e,i)):l&&(l.d(1),l=null),2&o&&s!==(s=Zy[t[11].id].category)&&kp(e,"class",s)},d(t){t&&yp(e),l&&l.d(),a=!1,c()}}}function dv(t){let e,n;return e=new oI({props:{open:!0,$$slots:{default:[yv]},$$scope:{ctx:t}}}),e.$on("fade",t[10]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};16388&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function Av(t){let e,n,r;return{c(){e=mp("button"),e.textContent="Use",kp(e,"class","hgap")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[8]),n=!0)},p:WA,d(t){t&&yp(e),n=!1,r()}}}function pv(t){let e,n,r;return{c(){e=mp("button"),e.textContent="Activate",kp(e,"class","hgap")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[9]),n=!0)},p:WA,d(t){t&&yp(e),n=!1,r()}}}function yv(t){let e,n,r,o,i,s,a,c,u,l;n=new SC({props:{id:t[2].id}});let h="consumable"===Zy[t[2].id].type&&Av(t),f="active"===Zy[t[2].id].type&&pv(t);return{c(){e=mp("article"),ay(n.$$.fragment),r=bp(),o=mp("footer"),i=mp("button"),i.textContent="ok",s=bp(),h&&h.c(),a=bp(),f&&f.c(),kp(i,"class","hgap"),kp(o,"class","row space-between")},m(g,d){pp(g,e,d),cy(n,e,null),Ap(e,r),Ap(e,o),Ap(o,i),Ap(o,s),h&&h.m(o,null),Ap(o,a),f&&f.m(o,null),c=!0,u||(l=Bp(i,"click",t[7]),u=!0)},p(t,e){const r={};4&e&&(r.id=t[2].id),n.$set(r),"consumable"===Zy[t[2].id].type?h?h.p(t,e):(h=Av(t),h.c(),h.m(o,a)):h&&(h.d(1),h=null),"active"===Zy[t[2].id].type?f?f.p(t,e):(f=pv(t),f.c(),f.m(o,null)):f&&(f.d(1),f=null)},i(t){c||(ey(n.$$.fragment,t),c=!0)},o(t){ny(n.$$.fragment,t),c=!1},d(t){t&&yp(e),uy(n),h&&h.d(),f&&f.d(),u=!1,l()}}}function Iv(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B=t[0].balance+"",v=t[0].score+"";l=new FI({props:{expiresAt:t[0].expiresAt,format:"HH:mm:ss"}});let _=t[1],k=[];for(let e=0;e<_.length;e+=1)k[e]=gv(hv(t,_,e));let x=t[2]&&dv(t);return{c(){e=mp("wallet-view"),n=mp("div"),r=mp("h1"),r.textContent="Balance",o=bp(),i=mp("h1"),s=wp(""),a=wp(B),c=bp(),u=mp("div"),ay(l.$$.fragment),h=wp(""),f=mp("br"),g=wp("\n      Score "),d=wp(v),A=mp("br"),p=bp(),y=mp("h1"),y.textContent="",I=bp(),m=mp("h1"),m.textContent="Inventory",E=bp(),w=mp("inventory");for(let t=0;t<k.length;t+=1)k[t].c();b=bp(),x&&x.c(),kp(r,"class","nogap"),kp(m,"class","nogap"),kp(n,"class","row column xcenter start")},m(t,B){pp(t,e,B),Ap(e,n),Ap(n,r),Ap(n,o),Ap(n,i),Ap(i,s),Ap(i,a),Ap(n,c),Ap(n,u),cy(l,u,null),Ap(u,h),Ap(u,f),Ap(u,g),Ap(u,d),Ap(u,A),Ap(n,p),Ap(n,y),Ap(n,I),Ap(n,m),Ap(n,E),Ap(n,w);for(let t=0;t<k.length;t+=1)k[t].m(w,null);Ap(n,b),x&&x.m(n,null),C=!0},p(t,[e]){(!C||1&e)&&B!==(B=t[0].balance+"")&&Sp(a,B);const r={};if(1&e&&(r.expiresAt=t[0].expiresAt),l.$set(r),(!C||1&e)&&v!==(v=t[0].score+"")&&Sp(d,v),6&e){let n;for(_=t[1],n=0;n<_.length;n+=1){const r=hv(t,_,n);k[n]?k[n].p(r,e):(k[n]=gv(r),k[n].c(),k[n].m(w,null))}for(;n<k.length;n+=1)k[n].d(1);k.length=_.length}t[2]?x?(x.p(t,e),4&e&&ey(x,1)):(x=dv(t),x.c(),ey(x,1),x.m(n,null)):x&&(Zp(),ny(x,1,1,(()=>{x=null})),ty())},i(t){C||(ey(l.$$.fragment,t),ey(x),C=!0)},o(t){ny(l.$$.fragment,t),ny(x),C=!1},d(t){t&&yp(e),uy(l),Ip(k,t),x&&x.d()}}}function mv(t,e,n){let r,o,i;const s=vy();ap(t,s,(t=>n(0,r=t)));const a=py(s,(t=>t.inventory||[]));ap(t,a,(t=>n(1,o=t)));const c=Ay(!1);ap(t,c,(t=>n(2,i=t)));return[r,o,i,s,a,c,t=>dp(c,i=t,i),()=>dp(c,i=!1,i),()=>(i.id,void console.info("Todo implement item consumption")),()=>toggle(i.id),()=>dp(c,i=!1,i)]}class Ev extends fy{constructor(t){super(),hy(this,t,mv,Iv,np,{})}}const[wv,bv]=n.exports.writable(),[Cv,Bv]=n.exports.writable(),[vv,_v]=n.exports.writable(),kv=n.exports.gate(n.exports.mute(wv,(t=>{switch(t){case"shop":return gB;case"msgs":return DB;case"profile":return IC;case"chat":return nv;case"about":return ov;case"keygen":return MI;case"append":return lv;case"wallet":return Ev;default:return Rb}}))),xv=my(wv),Sv=my(kv),Qv=my(Cv),Mv=my(vv),Dv=Cv;let Tv=null;function Lv(t,e,n){if(Tv&&t===Tv)return!1;Tv=t,console.info("Rerouting to path:",t,"id:",e,"Q/Search:",n),bv(t),Bv(e),_v(n)}function $v(){if(""===window.location.hash)return Lv("pub",null,new URLSearchParams);const t=new URL(window.location.hash.replace(/^#\/?/,"x:")),[e,n]=t.pathname.split("/"),r=new URLSearchParams(t.search),o={};let i=!0;for(const[t,e]of r.entries())o[t]=e,i=!1;Lv(e.toLowerCase(),n,i?void 0:o)}function Uv(t){window.history.pushState(null,null,`/#${t}`.replace(/^#\/+/,"#/")),$v()}function Ov(t,e,n){const r=t.slice();return r[11]=e[n],r}function Fv(t){let e,n,r,o,i,s,a=t[11]+"";function c(){return t[8](t[11])}return{c(){e=mp("div"),n=mp("a"),r=mp("code"),o=wp(a)},m(t,a){pp(t,e,a),Ap(e,n),Ap(n,r),Ap(r,o),i||(s=Bp(n,"click",c),i=!0)},p(e,n){t=e},d(t){t&&yp(e),i=!1,s()}}}function Nv(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p=t[3],y=[];for(let e=0;e<p.length;e+=1)y[e]=Fv(Ov(t,p,e));return{c(){e=mp("article"),n=mp("h6"),n.textContent="namespaces",r=bp(),o=mp("input"),i=bp(),s=mp("h6"),s.textContent="quickfilters",a=bp(),c=mp("div"),u=mp("a"),u.innerHTML="<code>DEBUG:OFF</code>",l=bp();for(let t=0;t<y.length;t+=1)y[t].c();h=bp(),f=mp("footer"),g=mp("button"),g.textContent="ok",kp(o,"type","text")},m(p,I){pp(p,e,I),Ap(e,n),Ap(e,r),Ap(e,o),Qp(o,t[1]),Ap(e,i),Ap(e,s),Ap(e,a),Ap(e,c),Ap(c,u),Ap(e,l);for(let t=0;t<y.length;t+=1)y[t].m(e,null);Ap(e,h),Ap(e,f),Ap(f,g),d||(A=[Bp(o,"input",t[6]),Bp(u,"click",t[7]),Bp(g,"click",t[9])],d=!0)},p(t,n){if(2&n&&o.value!==t[1]&&Qp(o,t[1]),40&n){let r;for(p=t[3],r=0;r<p.length;r+=1){const o=Ov(t,p,r);y[r]?y[r].p(o,n):(y[r]=Fv(o),y[r].c(),y[r].m(e,h))}for(;r<y.length;r+=1)y[r].d(1);y.length=p.length}},d(t){t&&yp(e),Ip(y,t),d=!1,tp(A)}}}function Pv(t){let e,n;return e=new oI({props:{open:t[2],$$slots:{default:[Nv]},$$scope:{ctx:t}}}),e.$on("fade",t[10]),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,[n]){const r={};4&n&&(r.open=t[2]),16390&n&&(r.$$scope={dirty:n,ctx:t}),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function Yv(t,e,n){let r,o,i=WA,s=()=>(i(),i=sp(a,(t=>n(2,o=t))),a);t.$$.on_destroy.push((()=>i()));let{open:a=Ay(!1)}=e;s();const c=Ay(Sh.namespaces);function u(t){""===t?(Sh.disable(),dp(c,r="",r)):(Sh.enable(t),dp(c,r=Sh.namespaces,r))}ap(t,c,(t=>n(1,r=t)));return t.$$set=t=>{"open"in t&&s(n(0,a=t.open))},[a,r,o,["*","hyper*","pico*","picochat:kernel","picochat:mod:*","picochat:mod:net","picochat:mod:gc","picochat:mod:reg","picochat:slice*"],c,u,function(){r=this.value,c.set(r)},()=>u(""),t=>u(t),()=>dp(a,o=!1,o),()=>dp(a,o=!1,o)]}window.addEventListener("popstate",$v),$v();class Kv extends fy{constructor(t){super(),hy(this,t,Yv,Pv,np,{open:0})}}const{window:Rv}=iy;function jv(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B,v,_,k,x,S,Q,M,D=t[2]?.state[0]+"",T=(t[2].hasKey?1:0)+"",L=(t[2].hasProfile?1:0)+"",$=(t[2].entered?1:0)+"";function U(t,e){return t[2].swarming?t[3]?2>t[3]?Vv:Hv:Gv:qv}let O=U(t),F=O(t);return x=new Kv({props:{open:t[16]}}),{c(){e=mp("dev-bar"),n=mp("div"),r=wp("K["),o=wp(D),i=wp("]\n      ID["),s=wp(T),a=wp("]\n      P["),c=wp(L),u=wp("]\n      m56["),l=wp(t[3]),h=wp("]\n      E["),f=wp($),g=wp("]"),d=bp(),A=mp("div"),p=mp("btn"),F.c(),y=bp(),I=mp("btn"),I.textContent="r",m=bp(),E=mp("btn"),E.textContent="D",w=bp(),b=mp("btn"),b.textContent="t",C=bp(),B=mp("btn"),B.textContent="i",v=bp(),_=mp("btn"),_.textContent="X",k=bp(),ay(x.$$.fragment),kp(p,"class",gp(t[22]?"m56 auto":"m56 no-auto")+" svelte-107qq9w"),kp(_,"class","danger"),xp(e,"class","flex row xcenter space-between")},m(D,T){pp(D,e,T),Ap(e,n),Ap(n,r),Ap(n,o),Ap(n,i),Ap(n,s),Ap(n,a),Ap(n,c),Ap(n,u),Ap(n,l),Ap(n,h),Ap(n,f),Ap(n,g),Ap(e,d),Ap(e,A),Ap(A,p),F.m(p,null),Ap(A,y),Ap(A,I),Ap(A,m),Ap(A,E),Ap(A,w),Ap(A,b),Ap(A,C),Ap(A,B),Ap(A,v),Ap(A,_),pp(D,k,T),cy(x,D,T),S=!0,Q||(M=[Bp(p,"click",t[23]),Bp(I,"click",t[20]),Bp(E,"click",t[24]),Bp(b,"click",c_),Bp(B,"click",t[19]),Bp(_,"click",t[25])],Q=!0)},p(t,e){(!S||4&e[0])&&D!==(D=t[2]?.state[0]+"")&&Sp(o,D),(!S||4&e[0])&&T!==(T=(t[2].hasKey?1:0)+"")&&Sp(s,T),(!S||4&e[0])&&L!==(L=(t[2].hasProfile?1:0)+"")&&Sp(c,L),(!S||8&e[0])&&Sp(l,t[3]),(!S||4&e[0])&&$!==($=(t[2].entered?1:0)+"")&&Sp(f,$),O!==(O=U(t))&&(F.d(1),F=O(t),F&&(F.c(),F.m(p,null)))},i(t){S||(ey(x.$$.fragment,t),S=!0)},o(t){ny(x.$$.fragment,t),S=!1},d(t){t&&yp(e),F.d(),t&&yp(k),uy(x,t),Q=!1,tp(M)}}}function Hv(t){let e;return{c(){e=wp("|_|")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function Vv(t){let e;return{c(){e=wp("|o_o|")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function Gv(t){let e;return{c(){e=wp("|o_=|")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function qv(t){let e;return{c(){e=wp("|=_=|")},m(t,n){pp(t,e,n)},d(t){t&&yp(e)}}}function zv(t){let e,n,r,o,i,s,a=t[31].message+"",c=t[31].stack+"";return{c(){e=mp("h3"),n=wp("KernelPanic! "),r=wp(a),o=bp(),i=mp("pre"),s=wp(c)},m(t,a){pp(t,e,a),Ap(e,n),Ap(e,r),pp(t,o,a),pp(t,i,a),Ap(i,s)},p:WA,i:WA,o:WA,d(t){t&&yp(e),t&&yp(o),t&&yp(i)}}}function Jv(t){let e,n,r,o;const i=[t_,Zv,Xv,Wv],s=[];function a(t,e){return t[6]&&t[7]?0:t[7]?1:t[6]?2:3}return e=a(t),n=s[e]=i[e](t),{c(){n.c(),r=Cp()},m(t,n){s[e].m(t,n),pp(t,r,n),o=!0},p(t,o){let c=e;e=a(t),e===c?s[e].p(t,o):(Zp(),ny(s[c],1,1,(()=>{s[c]=null})),ty(),n=s[e],n?n.p(t,o):(n=s[e]=i[e](t),n.c()),ey(n,1),n.m(r.parentNode,r))},i(t){o||(ey(n),o=!0)},o(t){ny(n),o=!1},d(t){s[e].d(t),t&&yp(r)}}}function Wv(t){let e,n,r;var o=t[8];return o&&(e=new o({})),{c(){e&&ay(e.$$.fragment),n=Cp()},m(t,o){e&&cy(e,t,o),pp(t,n,o),r=!0},p(t,r){if(o!==(o=t[8])){if(e){Zp();const t=e;ny(t.$$.fragment,1,0,(()=>{uy(t,1)})),ty()}o?(e=new o({}),ay(e.$$.fragment),ey(e.$$.fragment,1),cy(e,n.parentNode,n)):e=null}},i(t){r||(e&&ey(e.$$.fragment,t),r=!0)},o(t){e&&ny(e.$$.fragment,t),r=!1},d(t){t&&yp(n),e&&uy(e,t)}}}function Xv(t){let e,n,r;var o=t[8];function i(t){return{props:{id:t[6]}}}return o&&(e=new o(i(t))),{c(){e&&ay(e.$$.fragment),n=Cp()},m(t,o){e&&cy(e,t,o),pp(t,n,o),r=!0},p(t,r){const s={};if(64&r[0]&&(s.id=t[6]),o!==(o=t[8])){if(e){Zp();const t=e;ny(t.$$.fragment,1,0,(()=>{uy(t,1)})),ty()}o?(e=new o(i(t)),ay(e.$$.fragment),ey(e.$$.fragment,1),cy(e,n.parentNode,n)):e=null}else o&&e.$set(s)},i(t){r||(e&&ey(e.$$.fragment,t),r=!0)},o(t){e&&ny(e.$$.fragment,t),r=!1},d(t){t&&yp(n),e&&uy(e,t)}}}function Zv(t){let e,n,r;var o=t[8];function i(t){return{props:{q:t[7]}}}return o&&(e=new o(i(t))),{c(){e&&ay(e.$$.fragment),n=Cp()},m(t,o){e&&cy(e,t,o),pp(t,n,o),r=!0},p(t,r){const s={};if(128&r[0]&&(s.q=t[7]),o!==(o=t[8])){if(e){Zp();const t=e;ny(t.$$.fragment,1,0,(()=>{uy(t,1)})),ty()}o?(e=new o(i(t)),ay(e.$$.fragment),ey(e.$$.fragment,1),cy(e,n.parentNode,n)):e=null}else o&&e.$set(s)},i(t){r||(e&&ey(e.$$.fragment,t),r=!0)},o(t){e&&ny(e.$$.fragment,t),r=!1},d(t){t&&yp(n),e&&uy(e,t)}}}function t_(t){let e,n,r;var o=t[8];function i(t){return{props:{id:t[6],q:t[7]}}}return o&&(e=new o(i(t))),{c(){e&&ay(e.$$.fragment),n=Cp()},m(t,o){e&&cy(e,t,o),pp(t,n,o),r=!0},p(t,r){const s={};if(64&r[0]&&(s.id=t[6]),128&r[0]&&(s.q=t[7]),o!==(o=t[8])){if(e){Zp();const t=e;ny(t.$$.fragment,1,0,(()=>{uy(t,1)})),ty()}o?(e=new o(i(t)),ay(e.$$.fragment),ey(e.$$.fragment,1),cy(e,n.parentNode,n)):e=null}else o&&e.$set(s)},i(t){r||(e&&ey(e.$$.fragment,t),r=!0)},o(t){e&&ny(e.$$.fragment,t),r=!1},d(t){t&&yp(n),e&&uy(e,t)}}}function e_(t){let e;return{c(){e=mp("div"),e.innerHTML='<h5 aria-busy="true">Booting up...</h5>',kp(e,"class","column center xcenter"),Mp(e,"height","100%")},m(t,n){pp(t,e,n)},p:WA,i:WA,o:WA,d(t){t&&yp(e)}}}function n_(t){let e,n,r,o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,C,B;r=new aI({props:{id:"gfx-vibe",nofill:!0}}),s=new aI({props:{id:"gfx-shop",nofill:!0}});const v=[o_,r_],_=[];function k(t,e){return t[2].entered?1:0}u=k(t),l=_[u]=v[u](t),g=new aI({props:{id:"gfx-msgs",nofill:!0}});const x=[s_,i_],S=[];function Q(t,e){return t[11]?1:0}return E=Q(t),w=S[E]=x[E](t),{c(){e=mp("bar"),n=mp("round"),ay(r.$$.fragment),o=bp(),i=mp("round"),ay(s.$$.fragment),c=bp(),l.c(),h=bp(),f=mp("round"),ay(g.$$.fragment),d=bp(),A=mp("samp"),p=wp(t[10]),I=bp(),m=mp("round"),w.c(),kp(n,"class","flex column center xcenter noselect"),kp(i,"class","flex column center xcenter noselect"),kp(i,"disabled",a=!t[2].entered||null),kp(A,"class","notifications-badge"),Dp(A,"zero",!t[10]),kp(f,"class","flex column center xcenter noselect"),kp(f,"disabled",y=!t[2].entered||null),kp(m,"class","flex column center xcenter noselect"),kp(e,"class","flex row xcenter space-between")},m(a,l){pp(a,e,l),Ap(e,n),cy(r,n,null),Ap(e,o),Ap(e,i),cy(s,i,null),Ap(e,c),_[u].m(e,null),Ap(e,h),Ap(e,f),cy(g,f,null),Ap(f,d),Ap(f,A),Ap(A,p),Ap(e,I),Ap(e,m),S[E].m(m,null),b=!0,C||(B=[Bp(n,"click",t[26]),Bp(i,"click",t[27]),Bp(f,"click",t[29]),Bp(m,"click",t[30])],C=!0)},p(t,n){(!b||4&n[0]&&a!==(a=!t[2].entered||null))&&kp(i,"disabled",a);let r=u;u=k(t),u===r?_[u].p(t,n):(Zp(),ny(_[r],1,1,(()=>{_[r]=null})),ty(),l=_[u],l?l.p(t,n):(l=_[u]=v[u](t),l.c()),ey(l,1),l.m(e,h)),(!b||1024&n[0])&&Sp(p,t[10]),1024&n[0]&&Dp(A,"zero",!t[10]),(!b||4&n[0]&&y!==(y=!t[2].entered||null))&&kp(f,"disabled",y);let o=E;E=Q(t),E===o?S[E].p(t,n):(Zp(),ny(S[o],1,1,(()=>{S[o]=null})),ty(),w=S[E],w?w.p(t,n):(w=S[E]=x[E](t),w.c()),ey(w,1),w.m(m,null))},i(t){b||(ey(r.$$.fragment,t),ey(s.$$.fragment,t),ey(l),ey(g.$$.fragment,t),ey(w),b=!0)},o(t){ny(r.$$.fragment,t),ny(s.$$.fragment,t),ny(l),ny(g.$$.fragment,t),ny(w),b=!1},d(t){t&&yp(e),uy(r),uy(s),_[u].d(),uy(g),S[E].d(),C=!1,tp(B)}}}function r_(t){let e,n,r,o,i,s,a,c;return r=new FI({props:{expiresAt:t[9].expiresAt,format:"HH:mm"}}),{c(){e=mp("stat"),n=mp("h3"),ay(r.$$.fragment),o=bp(),i=mp("h6"),i.textContent="wallet",kp(n,"class","primary svelte-107qq9w"),kp(i,"class","muted svelte-107qq9w"),kp(e,"class","flex column center xcenter inside noselect svelte-107qq9w")},m(u,l){pp(u,e,l),Ap(e,n),cy(r,n,null),Ap(e,o),Ap(e,i),s=!0,a||(c=Bp(e,"click",t[28]),a=!0)},p(t,e){const n={};512&e[0]&&(n.expiresAt=t[9].expiresAt),r.$set(n)},i(t){s||(ey(r.$$.fragment,t),s=!0)},o(t){ny(r.$$.fragment,t),s=!1},d(t){t&&yp(e),uy(r),a=!1,c()}}}function o_(t){let e,n,r;return{c(){e=mp("stat"),e.innerHTML='<h3 class="muted svelte-107qq9w">--:--</h3> \n        <h6 class="primary svelte-107qq9w">start</h6>',kp(e,"class","flex column center xcenter outside noselect btn-enter svelte-107qq9w")},m(o,i){pp(o,e,i),n||(r=Bp(e,"click",t[21]),n=!0)},p:WA,i:WA,o:WA,d(t){t&&yp(e),n=!1,r()}}}function i_(t){let e,n;return e=new Ab({props:{src:t[11]}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p(t,n){const r={};2048&n[0]&&(r.src=t[11]),e.$set(r)},i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function s_(t){let e,n;return e=new aI({props:{id:"gfx-profile",nofill:!0}}),{c(){ay(e.$$.fragment)},m(t,r){cy(e,t,r),n=!0},p:WA,i(t){n||(ey(e.$$.fragment,t),n=!0)},o(t){ny(e.$$.fragment,t),n=!1},d(t){uy(e,t)}}}function a_(t){let e,n,r,o,i,s,a,c,u=t[1]&&jv(t),l={ctx:t,current:null,token:null,hasCatch:!0,pending:e_,then:Jv,catch:zv,error:31,blocks:[,,,]};ry(t[12],l);let h=t[5]&&n_(t);return{c(){e=mp("root"),u&&u.c(),n=bp(),r=mp("main"),l.block.c(),o=bp(),h&&h.c(),Dp(r,"has-dev",t[1]),Dp(r,"has-bar",t[5]),kp(e,"class",i=gp("view-"+t[0])+" svelte-107qq9w")},m(t,i){pp(t,e,i),u&&u.m(e,null),Ap(e,n),Ap(e,r),l.block.m(r,l.anchor=null),l.mount=()=>r,l.anchor=null,Ap(e,o),h&&h.m(e,null),s=!0,a||(c=[Bp(Rv,"error",l_),Bp(Rv,"unhandledrejection",u_)],a=!0)},p(o,a){(t=o)[1]?u?(u.p(t,a),2&a[0]&&ey(u,1)):(u=jv(t),u.c(),ey(u,1),u.m(e,n)):u&&(Zp(),ny(u,1,1,(()=>{u=null})),ty()),oy(l,t,a),2&a[0]&&Dp(r,"has-dev",t[1]),32&a[0]&&Dp(r,"has-bar",t[5]),t[5]?h?(h.p(t,a),32&a[0]&&ey(h,1)):(h=n_(t),h.c(),ey(h,1),h.m(e,null)):h&&(Zp(),ny(h,1,1,(()=>{h=null})),ty()),(!s||1&a[0]&&i!==(i=gp("view-"+t[0])+" svelte-107qq9w"))&&kp(e,"class",i)},i(t){s||(ey(u),ey(l.block),ey(h),s=!0)},o(t){ny(u);for(let t=0;t<3;t+=1){ny(l.blocks[t])}ny(h),s=!1},d(t){t&&yp(e),u&&u.d(),l.block.d(),l.token=null,l=null,h&&h.d(),a=!1,tp(c)}}}function c_(){const t=document.documentElement;t.dataset.theme?delete t.dataset.theme:t.dataset.theme="dark"}function u_(t){console.error("[Unhandled Rejection]",t)}function l_(t){console.error("[GlobError]",t)}function h_(t,e,r){let o,i,s,a,c,u,l,h,f,g,d,A;ap(t,xv,(t=>r(0,o=t))),ap(t,Ry,(t=>r(2,s=t))),ap(t,Qv,(t=>r(6,l=t))),ap(t,Mv,(t=>r(7,h=t))),ap(t,Sv,(t=>r(8,f=t))),ap(t,jy,(t=>r(11,A=t)));const p=Hy(),y=my(n.exports.gate(n.exports.init(0,n.exports.mute(wy.$connections(),(t=>t.length)))));ap(t,y,(t=>r(3,a=t)));const I=py([Ry,xv],(([t,e])=>t.hasKey&&t.hasProfile&&"shop"!==e));ap(t,I,(t=>r(5,u=t)));const m=py(xv,(t=>"profile"===t));ap(t,m,(t=>r(1,i=t)));const E=Ay(!1);ap(t,E,(t=>r(4,c=t)));const w=my(n.exports.mute(n.exports.combine(wy.$vibes(),wy.$chats()),(([t,e])=>t.reduce(((t,e)=>"waiting_local"===e.state?t+1:t),0)+e.reduce(((t,e)=>e.myTurn?t+1:t),0))));ap(t,w,(t=>r(10,d=t)));const b=vy();ap(t,b,(t=>r(9,g=t)));const C=JSON.parse(window.localStorage.getItem("auto_swarm"));Up((()=>Sv.subscribe((()=>{window.document.scrollingElement.scrollTo({top:0,left:0})}))));return[o,i,s,a,c,u,l,h,f,g,d,A,p,y,I,m,E,w,b,async function(){const t=await wy.feed();t.inspect(),console.log(`Size: ${(t.tail/1024).toFixed(2)} kB`)},async function(){await wy.store.reload(),console.info("Internal cache`s cleared")},function(){!async function(){if(!n.exports.get(Uy))return Uv("/keygen");if(!n.exports.get(Fy))return Uv("/profile");if(!n.exports.get(Dy)){const t=await by.readIdentity(),e=await by.readProfile();await wy.register(e,t),Ty(!0)}qy()}()},C,function(){window.localStorage.setItem("auto_swarm",!C),window.location.reload()},()=>dp(E,c=!0,c),()=>Jy(!1),()=>Uv("pub"),()=>s.entered&&Uv("shop"),()=>Uv("wallet"),()=>s.entered&&Uv("msgs"),()=>Uv("profile")]}var f_={exports:{}};!function(t,e){t.exports=function(){var t,e,n=1e3,r=6e4,o=36e5,i=864e5,s=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,a=31536e6,c=2592e6,u=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/,l={years:a,months:c,days:i,hours:o,minutes:r,seconds:n,milliseconds:1,weeks:6048e5},h=function(t){return t instanceof I},f=function(t,e,n){return new I(t,n,e.$l)},g=function(t){return e.p(t)+"s"},d=function(t){return t<0},A=function(t){return d(t)?Math.ceil(t):Math.floor(t)},p=function(t){return Math.abs(t)},y=function(t,e){return t?d(t)?{negative:!0,format:""+p(t)+e}:{negative:!1,format:""+t+e}:{negative:!1,format:""}},I=function(){function d(t,e,n){var r=this;if(this.$d={},this.$l=n,void 0===t&&(this.$ms=0,this.parseFromMilliseconds()),e)return f(t*l[g(e)],this);if("number"==typeof t)return this.$ms=t,this.parseFromMilliseconds(),this;if("object"==typeof t)return Object.keys(t).forEach((function(e){r.$d[g(e)]=t[e]})),this.calMilliseconds(),this;if("string"==typeof t){var o=t.match(u);if(o){var i=o.slice(2).map((function(t){return null!=t?Number(t):0}));return this.$d.years=i[0],this.$d.months=i[1],this.$d.weeks=i[2],this.$d.days=i[3],this.$d.hours=i[4],this.$d.minutes=i[5],this.$d.seconds=i[6],this.calMilliseconds(),this}}return this}var p=d.prototype;return p.calMilliseconds=function(){var t=this;this.$ms=Object.keys(this.$d).reduce((function(e,n){return e+(t.$d[n]||0)*l[n]}),0)},p.parseFromMilliseconds=function(){var t=this.$ms;this.$d.years=A(t/a),t%=a,this.$d.months=A(t/c),t%=c,this.$d.days=A(t/i),t%=i,this.$d.hours=A(t/o),t%=o,this.$d.minutes=A(t/r),t%=r,this.$d.seconds=A(t/n),t%=n,this.$d.milliseconds=t},p.toISOString=function(){var t=y(this.$d.years,"Y"),e=y(this.$d.months,"M"),n=+this.$d.days||0;this.$d.weeks&&(n+=7*this.$d.weeks);var r=y(n,"D"),o=y(this.$d.hours,"H"),i=y(this.$d.minutes,"M"),s=this.$d.seconds||0;this.$d.milliseconds&&(s+=this.$d.milliseconds/1e3);var a=y(s,"S"),c=t.negative||e.negative||r.negative||o.negative||i.negative||a.negative,u=o.format||i.format||a.format?"T":"",l=(c?"-":"")+"P"+t.format+e.format+r.format+u+o.format+i.format+a.format;return"P"===l||"-P"===l?"P0D":l},p.toJSON=function(){return this.toISOString()},p.format=function(t){var n=t||"YYYY-MM-DDTHH:mm:ss",r={Y:this.$d.years,YY:e.s(this.$d.years,2,"0"),YYYY:e.s(this.$d.years,4,"0"),M:this.$d.months,MM:e.s(this.$d.months,2,"0"),D:this.$d.days,DD:e.s(this.$d.days,2,"0"),H:this.$d.hours,HH:e.s(this.$d.hours,2,"0"),m:this.$d.minutes,mm:e.s(this.$d.minutes,2,"0"),s:this.$d.seconds,ss:e.s(this.$d.seconds,2,"0"),SSS:e.s(this.$d.milliseconds,3,"0")};return n.replace(s,(function(t,e){return e||String(r[t])}))},p.as=function(t){return this.$ms/l[g(t)]},p.get=function(t){var e=this.$ms,n=g(t);return"milliseconds"===n?e%=1e3:e="weeks"===n?A(e/l[n]):this.$d[n],0===e?0:e},p.add=function(t,e,n){var r;return r=e?t*l[g(e)]:h(t)?t.$ms:f(t,this).$ms,f(this.$ms+r*(n?-1:1),this)},p.subtract=function(t,e){return this.add(t,e,!0)},p.locale=function(t){var e=this.clone();return e.$l=t,e},p.clone=function(){return f(this.$ms,this)},p.humanize=function(e){return t().add(this.$ms,"ms").locale(this.$l).fromNow(!e)},p.milliseconds=function(){return this.get("milliseconds")},p.asMilliseconds=function(){return this.as("milliseconds")},p.seconds=function(){return this.get("seconds")},p.asSeconds=function(){return this.as("seconds")},p.minutes=function(){return this.get("minutes")},p.asMinutes=function(){return this.as("minutes")},p.hours=function(){return this.get("hours")},p.asHours=function(){return this.as("hours")},p.days=function(){return this.get("days")},p.asDays=function(){return this.as("days")},p.weeks=function(){return this.get("weeks")},p.asWeeks=function(){return this.as("weeks")},p.months=function(){return this.get("months")},p.asMonths=function(){return this.as("months")},p.years=function(){return this.get("years")},p.asYears=function(){return this.as("years")},d}();return function(n,r,o){t=o,e=o().$utils(),o.duration=function(t,e){var n=o.locale();return f(t,{$l:n},e)},o.isDuration=h;var i=r.prototype.add,s=r.prototype.subtract;r.prototype.add=function(t,e){return h(t)&&(t=t.asMilliseconds()),i.bind(this)(t,e)},r.prototype.subtract=function(t,e){return h(t)&&(t=t.asMilliseconds()),s.bind(this)(t,e)}}}()}(f_);var g_=f_.exports;TI.extend(g_);return new class extends fy{constructor(t){super(),hy(this,t,h_,a_,np,{},null,[-1,-1])}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
